/*! For license information please see main.1b094571.js.LICENSE.txt */
!function(){"use strict";var e={166:function(e,t,i){var n=i(381),a=i(46);function l(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,r={};function c(e,t){o(e,t),o(e+"Capture",t)}function o(e,t){for(r[e]=t,e=0;e<t.length;e++)s.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},b={};function p(e,t,i,n,a,l,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new p(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new p(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new p(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new p(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new p(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new p(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)}));var Z=/[\-:]([a-z])/g;function I(e){return e[1].toUpperCase()}function y(e,t,i,n){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,i,n){if(null===t||"undefined"===typeof t||function(e,t,i,n){if(null!==i&&0===i.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==i?!i.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,i,n))return!0;if(n)return!1;if(null!==i)switch(i.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,i,a,n)&&(i=null),n||null===a?function(e){return!!u.call(b,e)||!u.call(m,e)&&(h.test(e)?b[e]=!0:(m[e]=!0,!1))}(t)&&(null===i?e.removeAttribute(t):e.setAttribute(t,""+i)):a.mustUseProperty?e[a.propertyName]=null===i?3!==a.type&&"":i:(t=a.attributeName,n=a.attributeNamespace,null===i?e.removeAttribute(t):(i=3===(a=a.type)||4===a&&!0===i?"":""+i,n?e.setAttributeNS(n,t,i):e.setAttribute(t,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(Z,I);g[t]=new p(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(Z,I);g[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(Z,I);g[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)}));var R=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,f=Symbol.for("react.element"),v=Symbol.for("react.portal"),W=Symbol.for("react.fragment"),G=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),X=Symbol.for("react.provider"),S=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),Y=Symbol.for("react.memo"),F=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var k=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var x=Symbol.iterator;function w(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=x&&e[x]||e["@@iterator"])?e:null}var L,T=Object.assign;function U(e){if(void 0===L)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var K=!1;function J(e,t){if(!e||K)return"";K=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(o){var n=o}Reflect.construct(e,[],t)}else{try{t.call()}catch(o){n=o}e.call(t.prototype)}else{try{throw Error()}catch(o){n=o}e()}}catch(o){if(o&&n&&"string"===typeof o.stack){for(var a=o.stack.split("\n"),l=n.stack.split("\n"),s=a.length-1,r=l.length-1;1<=s&&0<=r&&a[s]!==l[r];)r--;for(;1<=s&&0<=r;s--,r--)if(a[s]!==l[r]){if(1!==s||1!==r)do{if(s--,0>--r||a[s]!==l[r]){var c="\n"+a[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=s&&0<=r);break}}}finally{K=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?U(e):""}function H(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=J(e.type,!1);case 11:return e=J(e.type.render,!1);case 1:return e=J(e.type,!0);default:return""}}function A(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case W:return"Fragment";case v:return"Portal";case V:return"Profiler";case G:return"StrictMode";case N:return"Suspense";case E:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case S:return(e.displayName||"Context")+".Consumer";case X:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case Y:return null!==(t=e.displayName||null)?t:A(e.type)||"Memo";case F:t=e._payload,e=e._init;try{return A(e(t))}catch(i){}}return null}function M(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return A(t);case 8:return t===G?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function P(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function B(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function z(e){e._valueTracker||(e._valueTracker=function(e){var t=B(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var a=i.get,l=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,l.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function O(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),n="";return e&&(n=B(e)?e.checked?"true":"false":e.value),(e=n)!==i&&(t.setValue(e),!0)}function D(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function _(e,t){var i=t.checked;return T({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:e._wrapperState.initialChecked})}function j(e,t){var i=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;i=P(null!=t.value?t.value:i),e._wrapperState={initialChecked:n,initialValue:i,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function q(e,t){Q(e,t);var i=P(t.value),n=t.type;if(null!=i)"number"===n?(0===i&&""===e.value||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,i):t.hasOwnProperty("defaultValue")&&ee(e,t.type,P(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}""!==(i=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==i&&(e.name=i)}function ee(e,t,i){"number"===t&&D(e.ownerDocument)===e||(null==i?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var te=Array.isArray;function ie(e,t,i,n){if(e=e.options,t){t={};for(var a=0;a<i.length;a++)t["$"+i[a]]=!0;for(i=0;i<e.length;i++)a=t.hasOwnProperty("$"+e[i].value),e[i].selected!==a&&(e[i].selected=a),a&&n&&(e[i].defaultSelected=!0)}else{for(i=""+P(i),t=null,a=0;a<e.length;a++){if(e[a].value===i)return e[a].selected=!0,void(n&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(l(91));return T({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var i=t.value;if(null==i){if(i=t.children,t=t.defaultValue,null!=i){if(null!=t)throw Error(l(92));if(te(i)){if(1<i.length)throw Error(l(93));i=i[0]}t=i}null==t&&(t=""),i=t}e._wrapperState={initialValue:P(i)}}function le(e,t){var i=P(t.value),n=P(t.defaultValue);null!=i&&((i=""+i)!==e.value&&(e.value=i),null==t.defaultValue&&e.defaultValue!==i&&(e.defaultValue=i)),null!=n&&(e.defaultValue=""+n)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function re(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?re(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var oe,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((oe=oe||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=oe.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,i,n){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function he(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&3===i.nodeType)return void(i.nodeValue=t)}e.textContent=t}var me={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},be=["Webkit","ms","Moz","O"];function pe(e,t,i){return null==t||"boolean"===typeof t||""===t?"":i||"number"!==typeof t||0===t||me.hasOwnProperty(e)&&me[e]?(""+t).trim():t+"px"}function ge(e,t){for(var i in e=e.style,t)if(t.hasOwnProperty(i)){var n=0===i.indexOf("--"),a=pe(i,t[i],n);"float"===i&&(i="cssFloat"),n?e.setProperty(i,a):e[i]=a}}Object.keys(me).forEach((function(e){be.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),me[t]=me[e]}))}));var Ze=T({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ie(e,t){if(t){if(Ze[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(l(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(l(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(l(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(l(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Re=null;function fe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ve=null,We=null,Ge=null;function Ve(e){if(e=ya(e)){if("function"!==typeof ve)throw Error(l(280));var t=e.stateNode;t&&(t=fa(t),ve(e.stateNode,e.type,t))}}function Xe(e){We?Ge?Ge.push(e):Ge=[e]:We=e}function Se(){if(We){var e=We,t=Ge;if(Ge=We=null,Ve(e),t)for(e=0;e<t.length;e++)Ve(t[e])}}function Ce(e,t){return e(t)}function Ne(){}var Ee=!1;function Ye(e,t,i){if(Ee)return e(t,i);Ee=!0;try{return Ce(e,t,i)}finally{Ee=!1,(null!==We||null!==Ge)&&(Ne(),Se())}}function Fe(e,t){var i=e.stateNode;if(null===i)return null;var n=fa(i);if(null===n)return null;i=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(i&&"function"!==typeof i)throw Error(l(231,t,typeof i));return i}var ke=!1;if(d)try{var xe={};Object.defineProperty(xe,"passive",{get:function(){ke=!0}}),window.addEventListener("test",xe,xe),window.removeEventListener("test",xe,xe)}catch(de){ke=!1}function we(e,t,i,n,a,l,s,r,c){var o=Array.prototype.slice.call(arguments,3);try{t.apply(i,o)}catch(d){this.onError(d)}}var Le=!1,Te=null,Ue=!1,Ke=null,Je={onError:function(e){Le=!0,Te=e}};function He(e,t,i,n,a,l,s,r,c){Le=!1,Te=null,we.apply(Je,arguments)}function Ae(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(i=t.return),e=t.return}while(e)}return 3===t.tag?i:null}function Me(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Pe(e){if(Ae(e)!==e)throw Error(l(188))}function Be(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ae(e)))throw Error(l(188));return t!==e?null:e}for(var i=e,n=t;;){var a=i.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(n=a.return)){i=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===i)return Pe(a),e;if(s===n)return Pe(a),t;s=s.sibling}throw Error(l(188))}if(i.return!==n.return)i=a,n=s;else{for(var r=!1,c=a.child;c;){if(c===i){r=!0,i=a,n=s;break}if(c===n){r=!0,n=a,i=s;break}c=c.sibling}if(!r){for(c=s.child;c;){if(c===i){r=!0,i=s,n=a;break}if(c===n){r=!0,n=s,i=a;break}c=c.sibling}if(!r)throw Error(l(189))}}if(i.alternate!==n)throw Error(l(190))}if(3!==i.tag)throw Error(l(188));return i.stateNode.current===i?e:t}(e))?ze(e):null}function ze(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=ze(e);if(null!==t)return t;e=e.sibling}return null}var Oe=a.unstable_scheduleCallback,De=a.unstable_cancelCallback,_e=a.unstable_shouldYield,je=a.unstable_requestPaint,Qe=a.unstable_now,qe=a.unstable_getCurrentPriorityLevel,$e=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,it=a.unstable_LowPriority,nt=a.unstable_IdlePriority,at=null,lt=null;var st=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(rt(e)/ct|0)|0},rt=Math.log,ct=Math.LN2;var ot=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var i=e.pendingLanes;if(0===i)return 0;var n=0,a=e.suspendedLanes,l=e.pingedLanes,s=268435455&i;if(0!==s){var r=s&~a;0!==r?n=ut(r):0!==(l&=s)&&(n=ut(l))}else 0!==(s=i&~a)?n=ut(s):0!==l&&(n=ut(l));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&a)&&((a=n&-n)>=(l=t&-t)||16===a&&0!==(4194240&l)))return t;if(0!==(4&n)&&(n|=16&i),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)a=1<<(i=31-st(t)),n|=e[i],t&=~a;return n}function mt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function bt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ot;return 0===(4194240&(ot<<=1))&&(ot=64),e}function gt(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function Zt(e,t,i){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=i}function It(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var n=31-st(i),a=1<<n;a&t|e[n]&t&&(e[n]|=t),i&=~a}}var yt=0;function Rt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var ft,vt,Wt,Gt,Vt,Xt=!1,St=[],Ct=null,Nt=null,Et=null,Yt=new Map,Ft=new Map,kt=[],xt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":Et=null;break;case"pointerover":case"pointerout":Yt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ft.delete(t.pointerId)}}function Lt(e,t,i,n,a,l){return null===e||e.nativeEvent!==l?(e={blockedOn:t,domEventName:i,eventSystemFlags:n,nativeEvent:l,targetContainers:[a]},null!==t&&(null!==(t=ya(t))&&vt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Tt(e){var t=Ia(e.target);if(null!==t){var i=Ae(t);if(null!==i)if(13===(t=i.tag)){if(null!==(t=Me(i)))return e.blockedOn=t,void Vt(e.priority,(function(){Wt(i)}))}else if(3===t&&i.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var i=_t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==i)return null!==(t=ya(i))&&vt(t),e.blockedOn=i,!1;var n=new(i=e.nativeEvent).constructor(i.type,i);Re=n,i.target.dispatchEvent(n),Re=null,t.shift()}return!0}function Kt(e,t,i){Ut(e)&&i.delete(t)}function Jt(){Xt=!1,null!==Ct&&Ut(Ct)&&(Ct=null),null!==Nt&&Ut(Nt)&&(Nt=null),null!==Et&&Ut(Et)&&(Et=null),Yt.forEach(Kt),Ft.forEach(Kt)}function Ht(e,t){e.blockedOn===t&&(e.blockedOn=null,Xt||(Xt=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Jt)))}function At(e){function t(t){return Ht(t,e)}if(0<St.length){Ht(St[0],e);for(var i=1;i<St.length;i++){var n=St[i];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Ct&&Ht(Ct,e),null!==Nt&&Ht(Nt,e),null!==Et&&Ht(Et,e),Yt.forEach(t),Ft.forEach(t),i=0;i<kt.length;i++)(n=kt[i]).blockedOn===e&&(n.blockedOn=null);for(;0<kt.length&&null===(i=kt[0]).blockedOn;)Tt(i),null===i.blockedOn&&kt.shift()}var Mt=R.ReactCurrentBatchConfig,Pt=!0;function Bt(e,t,i,n){var a=yt,l=Mt.transition;Mt.transition=null;try{yt=1,Ot(e,t,i,n)}finally{yt=a,Mt.transition=l}}function zt(e,t,i,n){var a=yt,l=Mt.transition;Mt.transition=null;try{yt=4,Ot(e,t,i,n)}finally{yt=a,Mt.transition=l}}function Ot(e,t,i,n){if(Pt){var a=_t(e,t,i,n);if(null===a)Pn(e,t,n,Dt,i),wt(e,n);else if(function(e,t,i,n,a){switch(t){case"focusin":return Ct=Lt(Ct,e,t,i,n,a),!0;case"dragenter":return Nt=Lt(Nt,e,t,i,n,a),!0;case"mouseover":return Et=Lt(Et,e,t,i,n,a),!0;case"pointerover":var l=a.pointerId;return Yt.set(l,Lt(Yt.get(l)||null,e,t,i,n,a)),!0;case"gotpointercapture":return l=a.pointerId,Ft.set(l,Lt(Ft.get(l)||null,e,t,i,n,a)),!0}return!1}(a,e,t,i,n))n.stopPropagation();else if(wt(e,n),4&t&&-1<xt.indexOf(e)){for(;null!==a;){var l=ya(a);if(null!==l&&ft(l),null===(l=_t(e,t,i,n))&&Pn(e,t,n,Dt,i),l===a)break;a=l}null!==a&&n.stopPropagation()}else Pn(e,t,n,null,i)}}var Dt=null;function _t(e,t,i,n){if(Dt=null,null!==(e=Ia(e=fe(n))))if(null===(t=Ae(e)))e=null;else if(13===(i=t.tag)){if(null!==(e=Me(t)))return e;e=null}else if(3===i){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Dt=e,null}function jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qe()){case $e:return 1;case et:return 4;case tt:case it:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Qt=null,qt=null,$t=null;function ei(){if($t)return $t;var e,t,i=qt,n=i.length,a="value"in Qt?Qt.value:Qt.textContent,l=a.length;for(e=0;e<n&&i[e]===a[e];e++);var s=n-e;for(t=1;t<=s&&i[n-t]===a[l-t];t++);return $t=a.slice(e,1<t?1-t:void 0)}function ti(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ii(){return!0}function ni(){return!1}function ai(e){function t(t,i,n,a,l){for(var s in this._reactName=t,this._targetInst=n,this.type=i,this.nativeEvent=a,this.target=l,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?ii:ni,this.isPropagationStopped=ni,this}return T(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ii)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ii)},persist:function(){},isPersistent:ii}),t}var li,si,ri,ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},oi=ai(ci),di=T({},ci,{view:0,detail:0}),ui=ai(di),hi=T({},di,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gi,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ri&&(ri&&"mousemove"===e.type?(li=e.screenX-ri.screenX,si=e.screenY-ri.screenY):si=li=0,ri=e),li)},movementY:function(e){return"movementY"in e?e.movementY:si}}),mi=ai(hi),bi=ai(T({},hi,{dataTransfer:0})),pi=ai(T({},di,{relatedTarget:0})),gi=ai(T({},ci,{animationName:0,elapsedTime:0,pseudoElement:0})),Zi=T({},ci,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ii=ai(Zi),yi=ai(T({},ci,{data:0})),Ri={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wi(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=vi[e])&&!!t[e]}function Gi(){return Wi}var Vi=T({},di,{key:function(e){if(e.key){var t=Ri[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ti(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?fi[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gi,charCode:function(e){return"keypress"===e.type?ti(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ti(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Xi=ai(Vi),Si=ai(T({},hi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ci=ai(T({},di,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gi})),Ni=ai(T({},ci,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ei=T({},hi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Yi=ai(Ei),Fi=[9,13,27,32],ki=d&&"CompositionEvent"in window,xi=null;d&&"documentMode"in document&&(xi=document.documentMode);var wi=d&&"TextEvent"in window&&!xi,Li=d&&(!ki||xi&&8<xi&&11>=xi),Ti=String.fromCharCode(32),Ui=!1;function Ki(e,t){switch(e){case"keyup":return-1!==Fi.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ji(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Hi=!1;var Ai={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ai[e.type]:"textarea"===t}function Pi(e,t,i,n){Xe(n),0<(t=zn(t,"onChange")).length&&(i=new oi("onChange","change",null,i,n),e.push({event:i,listeners:t}))}var Bi=null,zi=null;function Oi(e){Un(e,0)}function Di(e){if(O(Ra(e)))return e}function _i(e,t){if("change"===e)return t}var ji=!1;if(d){var Qi;if(d){var qi="oninput"in document;if(!qi){var $i=document.createElement("div");$i.setAttribute("oninput","return;"),qi="function"===typeof $i.oninput}Qi=qi}else Qi=!1;ji=Qi&&(!document.documentMode||9<document.documentMode)}function en(){Bi&&(Bi.detachEvent("onpropertychange",tn),zi=Bi=null)}function tn(e){if("value"===e.propertyName&&Di(zi)){var t=[];Pi(t,zi,e,fe(e)),Ye(Oi,t)}}function nn(e,t,i){"focusin"===e?(en(),zi=i,(Bi=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function an(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Di(zi)}function ln(e,t){if("click"===e)return Di(t)}function sn(e,t){if("input"===e||"change"===e)return Di(t)}var rn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cn(e,t){if(rn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var a=i[n];if(!u.call(t,a)||!rn(e[a],t[a]))return!1}return!0}function on(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dn(e,t){var i,n=on(e);for(e=0;n;){if(3===n.nodeType){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=on(n)}}function un(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?un(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hn(){for(var e=window,t=D();t instanceof e.HTMLIFrameElement;){try{var i="string"===typeof t.contentWindow.location.href}catch(n){i=!1}if(!i)break;t=D((e=t.contentWindow).document)}return t}function mn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function bn(e){var t=hn(),i=e.focusedElem,n=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&un(i.ownerDocument.documentElement,i)){if(null!==n&&mn(i))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if((e=(t=i.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=i.textContent.length,l=Math.min(n.start,a);n=void 0===n.end?l:Math.min(n.end,a),!e.extend&&l>n&&(a=n,n=l,l=a),a=dn(i,l);var s=dn(i,n);a&&s&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),l>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=i;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof i.focus&&i.focus(),i=0;i<t.length;i++)(e=t[i]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pn=d&&"documentMode"in document&&11>=document.documentMode,gn=null,Zn=null,In=null,yn=!1;function Rn(e,t,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;yn||null==gn||gn!==D(n)||("selectionStart"in(n=gn)&&mn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},In&&cn(In,n)||(In=n,0<(n=zn(Zn,"onSelect")).length&&(t=new oi("onSelect","select",null,t,i),e.push({event:t,listeners:n}),t.target=gn)))}function fn(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var vn={animationend:fn("Animation","AnimationEnd"),animationiteration:fn("Animation","AnimationIteration"),animationstart:fn("Animation","AnimationStart"),transitionend:fn("Transition","TransitionEnd")},Wn={},Gn={};function Vn(e){if(Wn[e])return Wn[e];if(!vn[e])return e;var t,i=vn[e];for(t in i)if(i.hasOwnProperty(t)&&t in Gn)return Wn[e]=i[t];return e}d&&(Gn=document.createElement("div").style,"AnimationEvent"in window||(delete vn.animationend.animation,delete vn.animationiteration.animation,delete vn.animationstart.animation),"TransitionEvent"in window||delete vn.transitionend.transition);var Xn=Vn("animationend"),Sn=Vn("animationiteration"),Cn=Vn("animationstart"),Nn=Vn("transitionend"),En=new Map,Yn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fn(e,t){En.set(e,t),c(t,[e])}for(var kn=0;kn<Yn.length;kn++){var xn=Yn[kn];Fn(xn.toLowerCase(),"on"+(xn[0].toUpperCase()+xn.slice(1)))}Fn(Xn,"onAnimationEnd"),Fn(Sn,"onAnimationIteration"),Fn(Cn,"onAnimationStart"),Fn("dblclick","onDoubleClick"),Fn("focusin","onFocus"),Fn("focusout","onBlur"),Fn(Nn,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ln=new Set("cancel close invalid load scroll toggle".split(" ").concat(wn));function Tn(e,t,i){var n=e.type||"unknown-event";e.currentTarget=i,function(e,t,i,n,a,s,r,c,o){if(He.apply(this,arguments),Le){if(!Le)throw Error(l(198));var d=Te;Le=!1,Te=null,Ue||(Ue=!0,Ke=d)}}(n,t,void 0,e),e.currentTarget=null}function Un(e,t){t=0!==(4&t);for(var i=0;i<e.length;i++){var n=e[i],a=n.event;n=n.listeners;e:{var l=void 0;if(t)for(var s=n.length-1;0<=s;s--){var r=n[s],c=r.instance,o=r.currentTarget;if(r=r.listener,c!==l&&a.isPropagationStopped())break e;Tn(a,r,o),l=c}else for(s=0;s<n.length;s++){if(c=(r=n[s]).instance,o=r.currentTarget,r=r.listener,c!==l&&a.isPropagationStopped())break e;Tn(a,r,o),l=c}}}if(Ue)throw e=Ke,Ue=!1,Ke=null,e}function Kn(e,t){var i=t[pa];void 0===i&&(i=t[pa]=new Set);var n=e+"__bubble";i.has(n)||(Mn(t,e,2,!1),i.add(n))}function Jn(e,t,i){var n=0;t&&(n|=4),Mn(i,e,n,t)}var Hn="_reactListening"+Math.random().toString(36).slice(2);function An(e){if(!e[Hn]){e[Hn]=!0,s.forEach((function(t){"selectionchange"!==t&&(Ln.has(t)||Jn(t,!1,e),Jn(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Hn]||(t[Hn]=!0,Jn("selectionchange",!1,t))}}function Mn(e,t,i,n){switch(jt(t)){case 1:var a=Bt;break;case 4:a=zt;break;default:a=Ot}i=a.bind(null,t,i,e),a=void 0,!ke||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),n?void 0!==a?e.addEventListener(t,i,{capture:!0,passive:a}):e.addEventListener(t,i,!0):void 0!==a?e.addEventListener(t,i,{passive:a}):e.addEventListener(t,i,!1)}function Pn(e,t,i,n,a){var l=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var s=n.tag;if(3===s||4===s){var r=n.stateNode.containerInfo;if(r===a||8===r.nodeType&&r.parentNode===a)break;if(4===s)for(s=n.return;null!==s;){var c=s.tag;if((3===c||4===c)&&((c=s.stateNode.containerInfo)===a||8===c.nodeType&&c.parentNode===a))return;s=s.return}for(;null!==r;){if(null===(s=Ia(r)))return;if(5===(c=s.tag)||6===c){n=l=s;continue e}r=r.parentNode}}n=n.return}Ye((function(){var n=l,a=fe(i),s=[];e:{var r=En.get(e);if(void 0!==r){var c=oi,o=e;switch(e){case"keypress":if(0===ti(i))break e;case"keydown":case"keyup":c=Xi;break;case"focusin":o="focus",c=pi;break;case"focusout":o="blur",c=pi;break;case"beforeblur":case"afterblur":c=pi;break;case"click":if(2===i.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=mi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=bi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Ci;break;case Xn:case Sn:case Cn:c=gi;break;case Nn:c=Ni;break;case"scroll":c=ui;break;case"wheel":c=Yi;break;case"copy":case"cut":case"paste":c=Ii;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Si}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==r?r+"Capture":null:r;d=[];for(var m,b=n;null!==b;){var p=(m=b).stateNode;if(5===m.tag&&null!==p&&(m=p,null!==h&&(null!=(p=Fe(b,h))&&d.push(Bn(b,p,m)))),u)break;b=b.return}0<d.length&&(r=new c(r,o,null,i,a),s.push({event:r,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(r="mouseover"===e||"pointerover"===e)||i===Re||!(o=i.relatedTarget||i.fromElement)||!Ia(o)&&!o[ba])&&(c||r)&&(r=a.window===a?a:(r=a.ownerDocument)?r.defaultView||r.parentWindow:window,c?(c=n,null!==(o=(o=i.relatedTarget||i.toElement)?Ia(o):null)&&(o!==(u=Ae(o))||5!==o.tag&&6!==o.tag)&&(o=null)):(c=null,o=n),c!==o)){if(d=mi,p="onMouseLeave",h="onMouseEnter",b="mouse","pointerout"!==e&&"pointerover"!==e||(d=Si,p="onPointerLeave",h="onPointerEnter",b="pointer"),u=null==c?r:Ra(c),m=null==o?r:Ra(o),(r=new d(p,b+"leave",c,i,a)).target=u,r.relatedTarget=m,p=null,Ia(a)===n&&((d=new d(h,b+"enter",o,i,a)).target=m,d.relatedTarget=u,p=d),u=p,c&&o)e:{for(h=o,b=0,m=d=c;m;m=On(m))b++;for(m=0,p=h;p;p=On(p))m++;for(;0<b-m;)d=On(d),b--;for(;0<m-b;)h=On(h),m--;for(;b--;){if(d===h||null!==h&&d===h.alternate)break e;d=On(d),h=On(h)}d=null}else d=null;null!==c&&Dn(s,r,c,d,!1),null!==o&&null!==u&&Dn(s,u,o,d,!0)}if("select"===(c=(r=n?Ra(n):window).nodeName&&r.nodeName.toLowerCase())||"input"===c&&"file"===r.type)var g=_i;else if(Mi(r))if(ji)g=sn;else{g=an;var Z=nn}else(c=r.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===r.type||"radio"===r.type)&&(g=ln);switch(g&&(g=g(e,n))?Pi(s,g,i,a):(Z&&Z(e,r,n),"focusout"===e&&(Z=r._wrapperState)&&Z.controlled&&"number"===r.type&&ee(r,"number",r.value)),Z=n?Ra(n):window,e){case"focusin":(Mi(Z)||"true"===Z.contentEditable)&&(gn=Z,Zn=n,In=null);break;case"focusout":In=Zn=gn=null;break;case"mousedown":yn=!0;break;case"contextmenu":case"mouseup":case"dragend":yn=!1,Rn(s,i,a);break;case"selectionchange":if(pn)break;case"keydown":case"keyup":Rn(s,i,a)}var I;if(ki)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Hi?Ki(e,i)&&(y="onCompositionEnd"):"keydown"===e&&229===i.keyCode&&(y="onCompositionStart");y&&(Li&&"ko"!==i.locale&&(Hi||"onCompositionStart"!==y?"onCompositionEnd"===y&&Hi&&(I=ei()):(qt="value"in(Qt=a)?Qt.value:Qt.textContent,Hi=!0)),0<(Z=zn(n,y)).length&&(y=new yi(y,e,null,i,a),s.push({event:y,listeners:Z}),I?y.data=I:null!==(I=Ji(i))&&(y.data=I))),(I=wi?function(e,t){switch(e){case"compositionend":return Ji(t);case"keypress":return 32!==t.which?null:(Ui=!0,Ti);case"textInput":return(e=t.data)===Ti&&Ui?null:e;default:return null}}(e,i):function(e,t){if(Hi)return"compositionend"===e||!ki&&Ki(e,t)?(e=ei(),$t=qt=Qt=null,Hi=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Li&&"ko"!==t.locale?null:t.data}}(e,i))&&(0<(n=zn(n,"onBeforeInput")).length&&(a=new yi("onBeforeInput","beforeinput",null,i,a),s.push({event:a,listeners:n}),a.data=I))}Un(s,t)}))}function Bn(e,t,i){return{instance:e,listener:t,currentTarget:i}}function zn(e,t){for(var i=t+"Capture",n=[];null!==e;){var a=e,l=a.stateNode;5===a.tag&&null!==l&&(a=l,null!=(l=Fe(e,i))&&n.unshift(Bn(e,l,a)),null!=(l=Fe(e,t))&&n.push(Bn(e,l,a))),e=e.return}return n}function On(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Dn(e,t,i,n,a){for(var l=t._reactName,s=[];null!==i&&i!==n;){var r=i,c=r.alternate,o=r.stateNode;if(null!==c&&c===n)break;5===r.tag&&null!==o&&(r=o,a?null!=(c=Fe(i,l))&&s.unshift(Bn(i,c,r)):a||null!=(c=Fe(i,l))&&s.push(Bn(i,c,r))),i=i.return}0!==s.length&&e.push({event:t,listeners:s})}var _n=/\r\n?/g,jn=/\u0000|\uFFFD/g;function Qn(e){return("string"===typeof e?e:""+e).replace(_n,"\n").replace(jn,"")}function qn(e,t,i){if(t=Qn(t),Qn(e)!==t&&i)throw Error(l(425))}function $n(){}var ea=null,ta=null;function ia(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var na="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,la="function"===typeof Promise?Promise:void 0,sa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof la?function(e){return la.resolve(null).then(e).catch(ra)}:na;function ra(e){setTimeout((function(){throw e}))}function ca(e,t){var i=t,n=0;do{var a=i.nextSibling;if(e.removeChild(i),a&&8===a.nodeType)if("/$"===(i=a.data)){if(0===n)return e.removeChild(a),void At(t);n--}else"$"!==i&&"$?"!==i&&"$!"!==i||n++;i=a}while(i);At(t)}function oa(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function da(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var i=e.data;if("$"===i||"$!"===i||"$?"===i){if(0===t)return e;t--}else"/$"===i&&t++}e=e.previousSibling}return null}var ua=Math.random().toString(36).slice(2),ha="__reactFiber$"+ua,ma="__reactProps$"+ua,ba="__reactContainer$"+ua,pa="__reactEvents$"+ua,ga="__reactListeners$"+ua,Za="__reactHandles$"+ua;function Ia(e){var t=e[ha];if(t)return t;for(var i=e.parentNode;i;){if(t=i[ba]||i[ha]){if(i=t.alternate,null!==t.child||null!==i&&null!==i.child)for(e=da(e);null!==e;){if(i=e[ha])return i;e=da(e)}return t}i=(e=i).parentNode}return null}function ya(e){return!(e=e[ha]||e[ba])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Ra(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(l(33))}function fa(e){return e[ma]||null}var va=[],Wa=-1;function Ga(e){return{current:e}}function Va(e){0>Wa||(e.current=va[Wa],va[Wa]=null,Wa--)}function Xa(e,t){Wa++,va[Wa]=e.current,e.current=t}var Sa={},Ca=Ga(Sa),Na=Ga(!1),Ea=Sa;function Ya(e,t){var i=e.type.contextTypes;if(!i)return Sa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a,l={};for(a in i)l[a]=t[a];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function Fa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function ka(){Va(Na),Va(Ca)}function xa(e,t,i){if(Ca.current!==Sa)throw Error(l(168));Xa(Ca,t),Xa(Na,i)}function wa(e,t,i){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return i;for(var a in n=n.getChildContext())if(!(a in t))throw Error(l(108,M(e)||"Unknown",a));return T({},i,n)}function La(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Sa,Ea=Ca.current,Xa(Ca,e),Xa(Na,Na.current),!0}function Ta(e,t,i){var n=e.stateNode;if(!n)throw Error(l(169));i?(e=wa(e,t,Ea),n.__reactInternalMemoizedMergedChildContext=e,Va(Na),Va(Ca),Xa(Ca,e)):Va(Na),Xa(Na,i)}var Ua=null,Ka=!1,Ja=!1;function Ha(e){null===Ua?Ua=[e]:Ua.push(e)}function Aa(){if(!Ja&&null!==Ua){Ja=!0;var e=0,t=yt;try{var i=Ua;for(yt=1;e<i.length;e++){var n=i[e];do{n=n(!0)}while(null!==n)}Ua=null,Ka=!1}catch(a){throw null!==Ua&&(Ua=Ua.slice(e+1)),Oe($e,Aa),a}finally{yt=t,Ja=!1}}return null}var Ma=[],Pa=0,Ba=null,za=0,Oa=[],Da=0,_a=null,ja=1,Qa="";function qa(e,t){Ma[Pa++]=za,Ma[Pa++]=Ba,Ba=e,za=t}function $a(e,t,i){Oa[Da++]=ja,Oa[Da++]=Qa,Oa[Da++]=_a,_a=e;var n=ja;e=Qa;var a=32-st(n)-1;n&=~(1<<a),i+=1;var l=32-st(t)+a;if(30<l){var s=a-a%5;l=(n&(1<<s)-1).toString(32),n>>=s,a-=s,ja=1<<32-st(t)+a|i<<a|n,Qa=l+e}else ja=1<<l|i<<a|n,Qa=e}function el(e){null!==e.return&&(qa(e,1),$a(e,1,0))}function tl(e){for(;e===Ba;)Ba=Ma[--Pa],Ma[Pa]=null,za=Ma[--Pa],Ma[Pa]=null;for(;e===_a;)_a=Oa[--Da],Oa[Da]=null,Qa=Oa[--Da],Oa[Da]=null,ja=Oa[--Da],Oa[Da]=null}var il=null,nl=null,al=!1,ll=null;function sl(e,t){var i=Yo(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,null===(t=e.deletions)?(e.deletions=[i],e.flags|=16):t.push(i)}function rl(e,t){switch(e.tag){case 5:var i=e.type;return null!==(t=1!==t.nodeType||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,il=e,nl=oa(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,il=e,nl=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(i=null!==_a?{id:ja,overflow:Qa}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},(i=Yo(18,null,null,0)).stateNode=t,i.return=e,e.child=i,il=e,nl=null,!0);default:return!1}}function cl(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ol(e){if(al){var t=nl;if(t){var i=t;if(!rl(e,t)){if(cl(e))throw Error(l(418));t=oa(i.nextSibling);var n=il;t&&rl(e,t)?sl(n,i):(e.flags=-4097&e.flags|2,al=!1,il=e)}}else{if(cl(e))throw Error(l(418));e.flags=-4097&e.flags|2,al=!1,il=e}}}function dl(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;il=e}function ul(e){if(e!==il)return!1;if(!al)return dl(e),al=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ia(e.type,e.memoizedProps)),t&&(t=nl)){if(cl(e))throw hl(),Error(l(418));for(;t;)sl(e,t),t=oa(t.nextSibling)}if(dl(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(l(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var i=e.data;if("/$"===i){if(0===t){nl=oa(e.nextSibling);break e}t--}else"$"!==i&&"$!"!==i&&"$?"!==i||t++}e=e.nextSibling}nl=null}}else nl=il?oa(e.stateNode.nextSibling):null;return!0}function hl(){for(var e=nl;e;)e=oa(e.nextSibling)}function ml(){nl=il=null,al=!1}function bl(e){null===ll?ll=[e]:ll.push(e)}var pl=R.ReactCurrentBatchConfig;function gl(e,t){if(e&&e.defaultProps){for(var i in t=T({},t),e=e.defaultProps)void 0===t[i]&&(t[i]=e[i]);return t}return t}var Zl=Ga(null),Il=null,yl=null,Rl=null;function fl(){Rl=yl=Il=null}function vl(e){var t=Zl.current;Va(Zl),e._currentValue=t}function Wl(e,t,i){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===i)break;e=e.return}}function Gl(e,t){Il=e,Rl=yl=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(yr=!0),e.firstContext=null)}function Vl(e){var t=e._currentValue;if(Rl!==e)if(e={context:e,memoizedValue:t,next:null},null===yl){if(null===Il)throw Error(l(308));yl=e,Il.dependencies={lanes:0,firstContext:e}}else yl=yl.next=e;return t}var Xl=null;function Sl(e){null===Xl?Xl=[e]:Xl.push(e)}function Cl(e,t,i,n){var a=t.interleaved;return null===a?(i.next=i,Sl(t)):(i.next=a.next,a.next=i),t.interleaved=i,Nl(e,n)}function Nl(e,t){e.lanes|=t;var i=e.alternate;for(null!==i&&(i.lanes|=t),i=e,e=e.return;null!==e;)e.childLanes|=t,null!==(i=e.alternate)&&(i.childLanes|=t),i=e,e=e.return;return 3===i.tag?i.stateNode:null}var El=!1;function Yl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fl(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function kl(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function xl(e,t,i){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Sc)){var a=n.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Nl(e,i)}return null===(a=n.interleaved)?(t.next=t,Sl(n)):(t.next=a.next,a.next=t),n.interleaved=t,Nl(e,i)}function wl(e,t,i){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&i))){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,It(e,i)}}function Ll(e,t){var i=e.updateQueue,n=e.alternate;if(null!==n&&i===(n=n.updateQueue)){var a=null,l=null;if(null!==(i=i.firstBaseUpdate)){do{var s={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===l?a=l=s:l=l.next=s,i=i.next}while(null!==i);null===l?a=l=t:l=l.next=t}else a=l=t;return i={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:n.shared,effects:n.effects},void(e.updateQueue=i)}null===(e=i.lastBaseUpdate)?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function Tl(e,t,i,n){var a=e.updateQueue;El=!1;var l=a.firstBaseUpdate,s=a.lastBaseUpdate,r=a.shared.pending;if(null!==r){a.shared.pending=null;var c=r,o=c.next;c.next=null,null===s?l=o:s.next=o,s=c;var d=e.alternate;null!==d&&((r=(d=d.updateQueue).lastBaseUpdate)!==s&&(null===r?d.firstBaseUpdate=o:r.next=o,d.lastBaseUpdate=c))}if(null!==l){var u=a.baseState;for(s=0,d=o=c=null,r=l;;){var h=r.lane,m=r.eventTime;if((n&h)===h){null!==d&&(d=d.next={eventTime:m,lane:0,tag:r.tag,payload:r.payload,callback:r.callback,next:null});e:{var b=e,p=r;switch(h=t,m=i,p.tag){case 1:if("function"===typeof(b=p.payload)){u=b.call(m,u,h);break e}u=b;break e;case 3:b.flags=-65537&b.flags|128;case 0:if(null===(h="function"===typeof(b=p.payload)?b.call(m,u,h):b)||void 0===h)break e;u=T({},u,h);break e;case 2:El=!0}}null!==r.callback&&0!==r.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[r]:h.push(r))}else m={eventTime:m,lane:h,tag:r.tag,payload:r.payload,callback:r.callback,next:null},null===d?(o=d=m,c=u):d=d.next=m,s|=h;if(null===(r=r.next)){if(null===(r=a.shared.pending))break;r=(h=r).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===d&&(c=u),a.baseState=c,a.firstBaseUpdate=o,a.lastBaseUpdate=d,null!==(t=a.shared.interleaved)){a=t;do{s|=a.lane,a=a.next}while(a!==t)}else null===l&&(a.shared.lanes=0);wc|=s,e.lanes=s,e.memoizedState=u}}function Ul(e,t,i){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(null!==a){if(n.callback=null,n=i,"function"!==typeof a)throw Error(l(191,a));a.call(n)}}}var Kl=(new n.Component).refs;function Jl(e,t,i,n){i=null===(i=i(n,t=e.memoizedState))||void 0===i?t:T({},t,i),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}var Hl={isMounted:function(e){return!!(e=e._reactInternals)&&Ae(e)===e},enqueueSetState:function(e,t,i){e=e._reactInternals;var n=$c(),a=eo(e),l=kl(n,a);l.payload=t,void 0!==i&&null!==i&&(l.callback=i),null!==(t=xl(e,l,a))&&(to(t,e,a,n),wl(t,e,a))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var n=$c(),a=eo(e),l=kl(n,a);l.tag=1,l.payload=t,void 0!==i&&null!==i&&(l.callback=i),null!==(t=xl(e,l,a))&&(to(t,e,a,n),wl(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=$c(),n=eo(e),a=kl(i,n);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=xl(e,a,n))&&(to(t,e,n,i),wl(t,e,n))}};function Al(e,t,i,n,a,l,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,l,s):!t.prototype||!t.prototype.isPureReactComponent||(!cn(i,n)||!cn(a,l))}function Ml(e,t,i){var n=!1,a=Sa,l=t.contextType;return"object"===typeof l&&null!==l?l=Vl(l):(a=Fa(t)?Ea:Ca.current,l=(n=null!==(n=t.contextTypes)&&void 0!==n)?Ya(e,a):Sa),t=new t(i,l),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Hl,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=l),t}function Pl(e,t,i,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==e&&Hl.enqueueReplaceState(t,t.state,null)}function Bl(e,t,i,n){var a=e.stateNode;a.props=i,a.state=e.memoizedState,a.refs=Kl,Yl(e);var l=t.contextType;"object"===typeof l&&null!==l?a.context=Vl(l):(l=Fa(t)?Ea:Ca.current,a.context=Ya(e,l)),a.state=e.memoizedState,"function"===typeof(l=t.getDerivedStateFromProps)&&(Jl(e,t,l,i),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&Hl.enqueueReplaceState(a,a.state,null),Tl(e,i,a,n),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function zl(e,t,i){if(null!==(e=i.ref)&&"function"!==typeof e&&"object"!==typeof e){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(l(309));var n=i.stateNode}if(!n)throw Error(l(147,e));var a=n,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=a.refs;t===Kl&&(t=a.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(l(284));if(!i._owner)throw Error(l(290,e))}return e}function Ol(e,t){throw e=Object.prototype.toString.call(t),Error(l(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Dl(e){return(0,e._init)(e._payload)}function _l(e){function t(t,i){if(e){var n=t.deletions;null===n?(t.deletions=[i],t.flags|=16):n.push(i)}}function i(i,n){if(!e)return null;for(;null!==n;)t(i,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=ko(e,t)).index=0,e.sibling=null,e}function s(t,i,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<i?(t.flags|=2,i):n:(t.flags|=2,i):(t.flags|=1048576,i)}function r(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,i,n){return null===t||6!==t.tag?((t=To(i,e.mode,n)).return=e,t):((t=a(t,i)).return=e,t)}function o(e,t,i,n){var l=i.type;return l===W?u(e,t,i.props.children,n,i.key):null!==t&&(t.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===F&&Dl(l)===t.type)?((n=a(t,i.props)).ref=zl(e,t,i),n.return=e,n):((n=xo(i.type,i.key,i.props,null,e.mode,n)).ref=zl(e,t,i),n.return=e,n)}function d(e,t,i,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((t=Uo(i,e.mode,n)).return=e,t):((t=a(t,i.children||[])).return=e,t)}function u(e,t,i,n,l){return null===t||7!==t.tag?((t=wo(i,e.mode,n,l)).return=e,t):((t=a(t,i)).return=e,t)}function h(e,t,i){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=To(""+t,e.mode,i)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case f:return(i=xo(t.type,t.key,t.props,null,e.mode,i)).ref=zl(e,null,t),i.return=e,i;case v:return(t=Uo(t,e.mode,i)).return=e,t;case F:return h(e,(0,t._init)(t._payload),i)}if(te(t)||w(t))return(t=wo(t,e.mode,i,null)).return=e,t;Ol(e,t)}return null}function m(e,t,i,n){var a=null!==t?t.key:null;if("string"===typeof i&&""!==i||"number"===typeof i)return null!==a?null:c(e,t,""+i,n);if("object"===typeof i&&null!==i){switch(i.$$typeof){case f:return i.key===a?o(e,t,i,n):null;case v:return i.key===a?d(e,t,i,n):null;case F:return m(e,t,(a=i._init)(i._payload),n)}if(te(i)||w(i))return null!==a?null:u(e,t,i,n,null);Ol(e,i)}return null}function b(e,t,i,n,a){if("string"===typeof n&&""!==n||"number"===typeof n)return c(t,e=e.get(i)||null,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case f:return o(t,e=e.get(null===n.key?i:n.key)||null,n,a);case v:return d(t,e=e.get(null===n.key?i:n.key)||null,n,a);case F:return b(e,t,i,(0,n._init)(n._payload),a)}if(te(n)||w(n))return u(t,e=e.get(i)||null,n,a,null);Ol(t,n)}return null}function p(a,l,r,c){for(var o=null,d=null,u=l,p=l=0,g=null;null!==u&&p<r.length;p++){u.index>p?(g=u,u=null):g=u.sibling;var Z=m(a,u,r[p],c);if(null===Z){null===u&&(u=g);break}e&&u&&null===Z.alternate&&t(a,u),l=s(Z,l,p),null===d?o=Z:d.sibling=Z,d=Z,u=g}if(p===r.length)return i(a,u),al&&qa(a,p),o;if(null===u){for(;p<r.length;p++)null!==(u=h(a,r[p],c))&&(l=s(u,l,p),null===d?o=u:d.sibling=u,d=u);return al&&qa(a,p),o}for(u=n(a,u);p<r.length;p++)null!==(g=b(u,a,p,r[p],c))&&(e&&null!==g.alternate&&u.delete(null===g.key?p:g.key),l=s(g,l,p),null===d?o=g:d.sibling=g,d=g);return e&&u.forEach((function(e){return t(a,e)})),al&&qa(a,p),o}function g(a,r,c,o){var d=w(c);if("function"!==typeof d)throw Error(l(150));if(null==(c=d.call(c)))throw Error(l(151));for(var u=d=null,p=r,g=r=0,Z=null,I=c.next();null!==p&&!I.done;g++,I=c.next()){p.index>g?(Z=p,p=null):Z=p.sibling;var y=m(a,p,I.value,o);if(null===y){null===p&&(p=Z);break}e&&p&&null===y.alternate&&t(a,p),r=s(y,r,g),null===u?d=y:u.sibling=y,u=y,p=Z}if(I.done)return i(a,p),al&&qa(a,g),d;if(null===p){for(;!I.done;g++,I=c.next())null!==(I=h(a,I.value,o))&&(r=s(I,r,g),null===u?d=I:u.sibling=I,u=I);return al&&qa(a,g),d}for(p=n(a,p);!I.done;g++,I=c.next())null!==(I=b(p,a,g,I.value,o))&&(e&&null!==I.alternate&&p.delete(null===I.key?g:I.key),r=s(I,r,g),null===u?d=I:u.sibling=I,u=I);return e&&p.forEach((function(e){return t(a,e)})),al&&qa(a,g),d}return function e(n,l,s,c){if("object"===typeof s&&null!==s&&s.type===W&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case f:e:{for(var o=s.key,d=l;null!==d;){if(d.key===o){if((o=s.type)===W){if(7===d.tag){i(n,d.sibling),(l=a(d,s.props.children)).return=n,n=l;break e}}else if(d.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===F&&Dl(o)===d.type){i(n,d.sibling),(l=a(d,s.props)).ref=zl(n,d,s),l.return=n,n=l;break e}i(n,d);break}t(n,d),d=d.sibling}s.type===W?((l=wo(s.props.children,n.mode,c,s.key)).return=n,n=l):((c=xo(s.type,s.key,s.props,null,n.mode,c)).ref=zl(n,l,s),c.return=n,n=c)}return r(n);case v:e:{for(d=s.key;null!==l;){if(l.key===d){if(4===l.tag&&l.stateNode.containerInfo===s.containerInfo&&l.stateNode.implementation===s.implementation){i(n,l.sibling),(l=a(l,s.children||[])).return=n,n=l;break e}i(n,l);break}t(n,l),l=l.sibling}(l=Uo(s,n.mode,c)).return=n,n=l}return r(n);case F:return e(n,l,(d=s._init)(s._payload),c)}if(te(s))return p(n,l,s,c);if(w(s))return g(n,l,s,c);Ol(n,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==l&&6===l.tag?(i(n,l.sibling),(l=a(l,s)).return=n,n=l):(i(n,l),(l=To(s,n.mode,c)).return=n,n=l),r(n)):i(n,l)}}var jl=_l(!0),Ql=_l(!1),ql={},$l=Ga(ql),es=Ga(ql),ts=Ga(ql);function is(e){if(e===ql)throw Error(l(174));return e}function ns(e,t){switch(Xa(ts,t),Xa(es,e),Xa($l,ql),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Va($l),Xa($l,t)}function as(){Va($l),Va(es),Va(ts)}function ls(e){is(ts.current);var t=is($l.current),i=ce(t,e.type);t!==i&&(Xa(es,e),Xa($l,i))}function ss(e){es.current===e&&(Va($l),Va(es))}var rs=Ga(0);function cs(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var os=[];function ds(){for(var e=0;e<os.length;e++)os[e]._workInProgressVersionPrimary=null;os.length=0}var us=R.ReactCurrentDispatcher,hs=R.ReactCurrentBatchConfig,ms=0,bs=null,ps=null,gs=null,Zs=!1,Is=!1,ys=0,Rs=0;function fs(){throw Error(l(321))}function vs(e,t){if(null===t)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!rn(e[i],t[i]))return!1;return!0}function Ws(e,t,i,n,a,s){if(ms=s,bs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,us.current=null===e||null===e.memoizedState?sr:rr,e=i(n,a),Is){s=0;do{if(Is=!1,ys=0,25<=s)throw Error(l(301));s+=1,gs=ps=null,t.updateQueue=null,us.current=cr,e=i(n,a)}while(Is)}if(us.current=lr,t=null!==ps&&null!==ps.next,ms=0,gs=ps=bs=null,Zs=!1,t)throw Error(l(300));return e}function Gs(){var e=0!==ys;return ys=0,e}function Vs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===gs?bs.memoizedState=gs=e:gs=gs.next=e,gs}function Xs(){if(null===ps){var e=bs.alternate;e=null!==e?e.memoizedState:null}else e=ps.next;var t=null===gs?bs.memoizedState:gs.next;if(null!==t)gs=t,ps=e;else{if(null===e)throw Error(l(310));e={memoizedState:(ps=e).memoizedState,baseState:ps.baseState,baseQueue:ps.baseQueue,queue:ps.queue,next:null},null===gs?bs.memoizedState=gs=e:gs=gs.next=e}return gs}function Ss(e,t){return"function"===typeof t?t(e):t}function Cs(e){var t=Xs(),i=t.queue;if(null===i)throw Error(l(311));i.lastRenderedReducer=e;var n=ps,a=n.baseQueue,s=i.pending;if(null!==s){if(null!==a){var r=a.next;a.next=s.next,s.next=r}n.baseQueue=a=s,i.pending=null}if(null!==a){s=a.next,n=n.baseState;var c=r=null,o=null,d=s;do{var u=d.lane;if((ms&u)===u)null!==o&&(o=o.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===o?(c=o=h,r=n):o=o.next=h,bs.lanes|=u,wc|=u}d=d.next}while(null!==d&&d!==s);null===o?r=n:o.next=c,rn(n,t.memoizedState)||(yr=!0),t.memoizedState=n,t.baseState=r,t.baseQueue=o,i.lastRenderedState=n}if(null!==(e=i.interleaved)){a=e;do{s=a.lane,bs.lanes|=s,wc|=s,a=a.next}while(a!==e)}else null===a&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function Ns(e){var t=Xs(),i=t.queue;if(null===i)throw Error(l(311));i.lastRenderedReducer=e;var n=i.dispatch,a=i.pending,s=t.memoizedState;if(null!==a){i.pending=null;var r=a=a.next;do{s=e(s,r.action),r=r.next}while(r!==a);rn(s,t.memoizedState)||(yr=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),i.lastRenderedState=s}return[s,n]}function Es(){}function Ys(e,t){var i=bs,n=Xs(),a=t(),s=!rn(n.memoizedState,a);if(s&&(n.memoizedState=a,yr=!0),n=n.queue,Ms(xs.bind(null,i,n,e),[e]),n.getSnapshot!==t||s||null!==gs&&1&gs.memoizedState.tag){if(i.flags|=2048,Us(9,ks.bind(null,i,n,a,t),void 0,null),null===Cc)throw Error(l(349));0!==(30&ms)||Fs(i,t,a)}return a}function Fs(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},null===(t=bs.updateQueue)?(t={lastEffect:null,stores:null},bs.updateQueue=t,t.stores=[e]):null===(i=t.stores)?t.stores=[e]:i.push(e)}function ks(e,t,i,n){t.value=i,t.getSnapshot=n,ws(t)&&Ls(e)}function xs(e,t,i){return i((function(){ws(t)&&Ls(e)}))}function ws(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!rn(e,i)}catch(n){return!0}}function Ls(e){var t=Nl(e,1);null!==t&&to(t,e,1,-1)}function Ts(e){var t=Vs();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:e},t.queue=e,e=e.dispatch=tr.bind(null,bs,e),[t.memoizedState,e]}function Us(e,t,i,n){return e={tag:e,create:t,destroy:i,deps:n,next:null},null===(t=bs.updateQueue)?(t={lastEffect:null,stores:null},bs.updateQueue=t,t.lastEffect=e.next=e):null===(i=t.lastEffect)?t.lastEffect=e.next=e:(n=i.next,i.next=e,e.next=n,t.lastEffect=e),e}function Ks(){return Xs().memoizedState}function Js(e,t,i,n){var a=Vs();bs.flags|=e,a.memoizedState=Us(1|t,i,void 0,void 0===n?null:n)}function Hs(e,t,i,n){var a=Xs();n=void 0===n?null:n;var l=void 0;if(null!==ps){var s=ps.memoizedState;if(l=s.destroy,null!==n&&vs(n,s.deps))return void(a.memoizedState=Us(t,i,l,n))}bs.flags|=e,a.memoizedState=Us(1|t,i,l,n)}function As(e,t){return Js(8390656,8,e,t)}function Ms(e,t){return Hs(2048,8,e,t)}function Ps(e,t){return Hs(4,2,e,t)}function Bs(e,t){return Hs(4,4,e,t)}function zs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Os(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,Hs(4,4,zs.bind(null,t,e),i)}function Ds(){}function _s(e,t){var i=Xs();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&vs(t,n[1])?n[0]:(i.memoizedState=[e,t],e)}function js(e,t){var i=Xs();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&vs(t,n[1])?n[0]:(e=e(),i.memoizedState=[e,t],e)}function Qs(e,t,i){return 0===(21&ms)?(e.baseState&&(e.baseState=!1,yr=!0),e.memoizedState=i):(rn(i,t)||(i=pt(),bs.lanes|=i,wc|=i,e.baseState=!0),t)}function qs(e,t){var i=yt;yt=0!==i&&4>i?i:4,e(!0);var n=hs.transition;hs.transition={};try{e(!1),t()}finally{yt=i,hs.transition=n}}function $s(){return Xs().memoizedState}function er(e,t,i){var n=eo(e);if(i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},ir(e))nr(t,i);else if(null!==(i=Cl(e,t,i,n))){to(i,e,n,$c()),ar(i,t,n)}}function tr(e,t,i){var n=eo(e),a={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(ir(e))nr(t,a);else{var l=e.alternate;if(0===e.lanes&&(null===l||0===l.lanes)&&null!==(l=t.lastRenderedReducer))try{var s=t.lastRenderedState,r=l(s,i);if(a.hasEagerState=!0,a.eagerState=r,rn(r,s)){var c=t.interleaved;return null===c?(a.next=a,Sl(t)):(a.next=c.next,c.next=a),void(t.interleaved=a)}}catch(o){}null!==(i=Cl(e,t,a,n))&&(to(i,e,n,a=$c()),ar(i,t,n))}}function ir(e){var t=e.alternate;return e===bs||null!==t&&t===bs}function nr(e,t){Is=Zs=!0;var i=e.pending;null===i?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function ar(e,t,i){if(0!==(4194240&i)){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,It(e,i)}}var lr={readContext:Vl,useCallback:fs,useContext:fs,useEffect:fs,useImperativeHandle:fs,useInsertionEffect:fs,useLayoutEffect:fs,useMemo:fs,useReducer:fs,useRef:fs,useState:fs,useDebugValue:fs,useDeferredValue:fs,useTransition:fs,useMutableSource:fs,useSyncExternalStore:fs,useId:fs,unstable_isNewReconciler:!1},sr={readContext:Vl,useCallback:function(e,t){return Vs().memoizedState=[e,void 0===t?null:t],e},useContext:Vl,useEffect:As,useImperativeHandle:function(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,Js(4194308,4,zs.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Js(4194308,4,e,t)},useInsertionEffect:function(e,t){return Js(4,2,e,t)},useMemo:function(e,t){var i=Vs();return t=void 0===t?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var n=Vs();return t=void 0!==i?i(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=er.bind(null,bs,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Vs().memoizedState=e},useState:Ts,useDebugValue:Ds,useDeferredValue:function(e){return Vs().memoizedState=e},useTransition:function(){var e=Ts(!1),t=e[0];return e=qs.bind(null,e[1]),Vs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var n=bs,a=Vs();if(al){if(void 0===i)throw Error(l(407));i=i()}else{if(i=t(),null===Cc)throw Error(l(349));0!==(30&ms)||Fs(n,t,i)}a.memoizedState=i;var s={value:i,getSnapshot:t};return a.queue=s,As(xs.bind(null,n,s,e),[e]),n.flags|=2048,Us(9,ks.bind(null,n,s,i,t),void 0,null),i},useId:function(){var e=Vs(),t=Cc.identifierPrefix;if(al){var i=Qa;t=":"+t+"R"+(i=(ja&~(1<<32-st(ja)-1)).toString(32)+i),0<(i=ys++)&&(t+="H"+i.toString(32)),t+=":"}else t=":"+t+"r"+(i=Rs++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},rr={readContext:Vl,useCallback:_s,useContext:Vl,useEffect:Ms,useImperativeHandle:Os,useInsertionEffect:Ps,useLayoutEffect:Bs,useMemo:js,useReducer:Cs,useRef:Ks,useState:function(){return Cs(Ss)},useDebugValue:Ds,useDeferredValue:function(e){return Qs(Xs(),ps.memoizedState,e)},useTransition:function(){return[Cs(Ss)[0],Xs().memoizedState]},useMutableSource:Es,useSyncExternalStore:Ys,useId:$s,unstable_isNewReconciler:!1},cr={readContext:Vl,useCallback:_s,useContext:Vl,useEffect:Ms,useImperativeHandle:Os,useInsertionEffect:Ps,useLayoutEffect:Bs,useMemo:js,useReducer:Ns,useRef:Ks,useState:function(){return Ns(Ss)},useDebugValue:Ds,useDeferredValue:function(e){var t=Xs();return null===ps?t.memoizedState=e:Qs(t,ps.memoizedState,e)},useTransition:function(){return[Ns(Ss)[0],Xs().memoizedState]},useMutableSource:Es,useSyncExternalStore:Ys,useId:$s,unstable_isNewReconciler:!1};function or(e,t){try{var i="",n=t;do{i+=H(n),n=n.return}while(n);var a=i}catch(l){a="\nError generating stack: "+l.message+"\n"+l.stack}return{value:e,source:t,stack:a,digest:null}}function dr(e,t,i){return{value:e,source:null,stack:null!=i?i:null,digest:null!=t?t:null}}function ur(e,t){try{console.error(t.value)}catch(i){setTimeout((function(){throw i}))}}var hr="function"===typeof WeakMap?WeakMap:Map;function mr(e,t,i){(i=kl(-1,i)).tag=3,i.payload={element:null};var n=t.value;return i.callback=function(){Mc||(Mc=!0,Pc=n),ur(0,t)},i}function br(e,t,i){(i=kl(-1,i)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var a=t.value;i.payload=function(){return n(a)},i.callback=function(){ur(0,t)}}var l=e.stateNode;return null!==l&&"function"===typeof l.componentDidCatch&&(i.callback=function(){ur(0,t),"function"!==typeof n&&(null===Bc?Bc=new Set([this]):Bc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),i}function pr(e,t,i){var n=e.pingCache;if(null===n){n=e.pingCache=new hr;var a=new Set;n.set(t,a)}else void 0===(a=n.get(t))&&(a=new Set,n.set(t,a));a.has(i)||(a.add(i),e=Vo.bind(null,e,t,i),t.then(e,e))}function gr(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function Zr(e,t,i,n,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((t=kl(-1,1)).tag=2,xl(i,t,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var Ir=R.ReactCurrentOwner,yr=!1;function Rr(e,t,i,n){t.child=null===e?Ql(t,null,i,n):jl(t,e.child,i,n)}function fr(e,t,i,n,a){i=i.render;var l=t.ref;return Gl(t,a),n=Ws(e,t,i,n,l,a),i=Gs(),null===e||yr?(al&&i&&el(t),t.flags|=1,Rr(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Mr(e,t,a))}function vr(e,t,i,n,a){if(null===e){var l=i.type;return"function"!==typeof l||Fo(l)||void 0!==l.defaultProps||null!==i.compare||void 0!==i.defaultProps?((e=xo(i.type,null,n,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=l,Wr(e,t,l,n,a))}if(l=e.child,0===(e.lanes&a)){var s=l.memoizedProps;if((i=null!==(i=i.compare)?i:cn)(s,n)&&e.ref===t.ref)return Mr(e,t,a)}return t.flags|=1,(e=ko(l,n)).ref=t.ref,e.return=t,t.child=e}function Wr(e,t,i,n,a){if(null!==e){var l=e.memoizedProps;if(cn(l,n)&&e.ref===t.ref){if(yr=!1,t.pendingProps=n=l,0===(e.lanes&a))return t.lanes=e.lanes,Mr(e,t,a);0!==(131072&e.flags)&&(yr=!0)}}return Xr(e,t,i,n,a)}function Gr(e,t,i){var n=t.pendingProps,a=n.children,l=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xa(Fc,Yc),Yc|=i;else{if(0===(1073741824&i))return e=null!==l?l.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Xa(Fc,Yc),Yc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==l?l.baseLanes:i,Xa(Fc,Yc),Yc|=n}else null!==l?(n=l.baseLanes|i,t.memoizedState=null):n=i,Xa(Fc,Yc),Yc|=n;return Rr(e,t,a,i),t.child}function Vr(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function Xr(e,t,i,n,a){var l=Fa(i)?Ea:Ca.current;return l=Ya(t,l),Gl(t,a),i=Ws(e,t,i,n,l,a),n=Gs(),null===e||yr?(al&&n&&el(t),t.flags|=1,Rr(e,t,i,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Mr(e,t,a))}function Sr(e,t,i,n,a){if(Fa(i)){var l=!0;La(t)}else l=!1;if(Gl(t,a),null===t.stateNode)Ar(e,t),Ml(t,i,n),Bl(t,i,n,a),n=!0;else if(null===e){var s=t.stateNode,r=t.memoizedProps;s.props=r;var c=s.context,o=i.contextType;"object"===typeof o&&null!==o?o=Vl(o):o=Ya(t,o=Fa(i)?Ea:Ca.current);var d=i.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate;u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(r!==n||c!==o)&&Pl(t,s,n,o),El=!1;var h=t.memoizedState;s.state=h,Tl(t,n,s,a),c=t.memoizedState,r!==n||h!==c||Na.current||El?("function"===typeof d&&(Jl(t,i,d,n),c=t.memoizedState),(r=El||Al(t,i,r,n,h,c,o))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=o,n=r):("function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,Fl(e,t),r=t.memoizedProps,o=t.type===t.elementType?r:gl(t.type,r),s.props=o,u=t.pendingProps,h=s.context,"object"===typeof(c=i.contextType)&&null!==c?c=Vl(c):c=Ya(t,c=Fa(i)?Ea:Ca.current);var m=i.getDerivedStateFromProps;(d="function"===typeof m||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(r!==u||h!==c)&&Pl(t,s,n,c),El=!1,h=t.memoizedState,s.state=h,Tl(t,n,s,a);var b=t.memoizedState;r!==u||h!==b||Na.current||El?("function"===typeof m&&(Jl(t,i,m,n),b=t.memoizedState),(o=El||Al(t,i,o,n,h,b,c)||!1)?(d||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(n,b,c),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,b,c)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||r===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||r===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=b),s.props=n,s.state=b,s.context=c,n=o):("function"!==typeof s.componentDidUpdate||r===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||r===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Cr(e,t,i,n,l,a)}function Cr(e,t,i,n,a,l){Vr(e,t);var s=0!==(128&t.flags);if(!n&&!s)return a&&Ta(t,i,!1),Mr(e,t,l);n=t.stateNode,Ir.current=t;var r=s&&"function"!==typeof i.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&s?(t.child=jl(t,e.child,null,l),t.child=jl(t,null,r,l)):Rr(e,t,r,l),t.memoizedState=n.state,a&&Ta(t,i,!0),t.child}function Nr(e){var t=e.stateNode;t.pendingContext?xa(0,t.pendingContext,t.pendingContext!==t.context):t.context&&xa(0,t.context,!1),ns(e,t.containerInfo)}function Er(e,t,i,n,a){return ml(),bl(a),t.flags|=256,Rr(e,t,i,n),t.child}var Yr,Fr,kr,xr={dehydrated:null,treeContext:null,retryLane:0};function wr(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lr(e,t,i){var n,a=t.pendingProps,s=rs.current,r=!1,c=0!==(128&t.flags);if((n=c)||(n=(null===e||null!==e.memoizedState)&&0!==(2&s)),n?(r=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Xa(rs,1&s),null===e)return ol(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=a.children,e=a.fallback,r?(a=t.mode,r=t.child,c={mode:"hidden",children:c},0===(1&a)&&null!==r?(r.childLanes=0,r.pendingProps=c):r=Lo(c,a,0,null),e=wo(e,a,i,null),r.return=t,e.return=t,r.sibling=e,t.child=r,t.child.memoizedState=wr(i),t.memoizedState=xr,e):Tr(t,c));if(null!==(s=e.memoizedState)&&null!==(n=s.dehydrated))return function(e,t,i,n,a,s,r){if(i)return 256&t.flags?(t.flags&=-257,Ur(e,t,r,n=dr(Error(l(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=Lo({mode:"visible",children:n.children},a,0,null),(s=wo(s,a,r,null)).flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,0!==(1&t.mode)&&jl(t,e.child,null,r),t.child.memoizedState=wr(r),t.memoizedState=xr,s);if(0===(1&t.mode))return Ur(e,t,r,null);if("$!"===a.data){if(n=a.nextSibling&&a.nextSibling.dataset)var c=n.dgst;return n=c,Ur(e,t,r,n=dr(s=Error(l(419)),n,void 0))}if(c=0!==(r&e.childLanes),yr||c){if(null!==(n=Cc)){switch(r&-r){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(n.suspendedLanes|r))?0:a)&&a!==s.retryLane&&(s.retryLane=a,Nl(e,a),to(n,e,a,-1))}return po(),Ur(e,t,r,n=dr(Error(l(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=So.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,nl=oa(a.nextSibling),il=t,al=!0,ll=null,null!==e&&(Oa[Da++]=ja,Oa[Da++]=Qa,Oa[Da++]=_a,ja=e.id,Qa=e.overflow,_a=t),(t=Tr(t,n.children)).flags|=4096,t)}(e,t,c,a,n,s,i);if(r){r=a.fallback,c=t.mode,n=(s=e.child).sibling;var o={mode:"hidden",children:a.children};return 0===(1&c)&&t.child!==s?((a=t.child).childLanes=0,a.pendingProps=o,t.deletions=null):(a=ko(s,o)).subtreeFlags=14680064&s.subtreeFlags,null!==n?r=ko(n,r):(r=wo(r,c,i,null)).flags|=2,r.return=t,a.return=t,a.sibling=r,t.child=a,a=r,r=t.child,c=null===(c=e.child.memoizedState)?wr(i):{baseLanes:c.baseLanes|i,cachePool:null,transitions:c.transitions},r.memoizedState=c,r.childLanes=e.childLanes&~i,t.memoizedState=xr,a}return e=(r=e.child).sibling,a=ko(r,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=i),a.return=t,a.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=a,t.memoizedState=null,a}function Tr(e,t){return(t=Lo({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ur(e,t,i,n){return null!==n&&bl(n),jl(t,e.child,null,i),(e=Tr(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Kr(e,t,i){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Wl(e.return,t,i)}function Jr(e,t,i,n,a){var l=e.memoizedState;null===l?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:a}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=n,l.tail=i,l.tailMode=a)}function Hr(e,t,i){var n=t.pendingProps,a=n.revealOrder,l=n.tail;if(Rr(e,t,n.children,i),0!==(2&(n=rs.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Kr(e,i,t);else if(19===e.tag)Kr(e,i,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Xa(rs,n),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(i=t.child,a=null;null!==i;)null!==(e=i.alternate)&&null===cs(e)&&(a=i),i=i.sibling;null===(i=a)?(a=t.child,t.child=null):(a=i.sibling,i.sibling=null),Jr(t,!1,a,i,l);break;case"backwards":for(i=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===cs(e)){t.child=a;break}e=a.sibling,a.sibling=i,i=a,a=e}Jr(t,!0,i,null,l);break;case"together":Jr(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ar(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Mr(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),wc|=t.lanes,0===(i&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(l(153));if(null!==t.child){for(i=ko(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=ko(e,e.pendingProps)).return=t;i.sibling=null}return t.child}function Pr(e,t){if(!al)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Br(e){var t=null!==e.alternate&&e.alternate.child===e.child,i=0,n=0;if(t)for(var a=e.child;null!==a;)i|=a.lanes|a.childLanes,n|=14680064&a.subtreeFlags,n|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)i|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=i,t}function zr(e,t,i){var n=t.pendingProps;switch(tl(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Br(t),null;case 1:case 17:return Fa(t.type)&&ka(),Br(t),null;case 3:return n=t.stateNode,as(),Va(Na),Va(Ca),ds(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ul(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ll&&(lo(ll),ll=null))),Br(t),null;case 5:ss(t);var a=is(ts.current);if(i=t.type,null!==e&&null!=t.stateNode)Fr(e,t,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(l(166));return Br(t),null}if(e=is($l.current),ul(t)){n=t.stateNode,i=t.type;var s=t.memoizedProps;switch(n[ha]=t,n[ma]=s,e=0!==(1&t.mode),i){case"dialog":Kn("cancel",n),Kn("close",n);break;case"iframe":case"object":case"embed":Kn("load",n);break;case"video":case"audio":for(a=0;a<wn.length;a++)Kn(wn[a],n);break;case"source":Kn("error",n);break;case"img":case"image":case"link":Kn("error",n),Kn("load",n);break;case"details":Kn("toggle",n);break;case"input":j(n,s),Kn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Kn("invalid",n);break;case"textarea":ae(n,s),Kn("invalid",n)}for(var c in Ie(i,s),a=null,s)if(s.hasOwnProperty(c)){var o=s[c];"children"===c?"string"===typeof o?n.textContent!==o&&(!0!==s.suppressHydrationWarning&&qn(n.textContent,o,e),a=["children",o]):"number"===typeof o&&n.textContent!==""+o&&(!0!==s.suppressHydrationWarning&&qn(n.textContent,o,e),a=["children",""+o]):r.hasOwnProperty(c)&&null!=o&&"onScroll"===c&&Kn("scroll",n)}switch(i){case"input":z(n),$(n,s,!0);break;case"textarea":z(n),se(n);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(n.onclick=$n)}n=a,t.updateQueue=n,null!==n&&(t.flags|=4)}else{c=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=re(i)),"http://www.w3.org/1999/xhtml"===e?"script"===i?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=c.createElement(i,{is:n.is}):(e=c.createElement(i),"select"===i&&(c=e,n.multiple?c.multiple=!0:n.size&&(c.size=n.size))):e=c.createElementNS(e,i),e[ha]=t,e[ma]=n,Yr(e,t),t.stateNode=e;e:{switch(c=ye(i,n),i){case"dialog":Kn("cancel",e),Kn("close",e),a=n;break;case"iframe":case"object":case"embed":Kn("load",e),a=n;break;case"video":case"audio":for(a=0;a<wn.length;a++)Kn(wn[a],e);a=n;break;case"source":Kn("error",e),a=n;break;case"img":case"image":case"link":Kn("error",e),Kn("load",e),a=n;break;case"details":Kn("toggle",e),a=n;break;case"input":j(e,n),a=_(e,n),Kn("invalid",e);break;case"option":default:a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=T({},n,{value:void 0}),Kn("invalid",e);break;case"textarea":ae(e,n),a=ne(e,n),Kn("invalid",e)}for(s in Ie(i,a),o=a)if(o.hasOwnProperty(s)){var d=o[s];"style"===s?ge(e,d):"dangerouslySetInnerHTML"===s?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===s?"string"===typeof d?("textarea"!==i||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(r.hasOwnProperty(s)?null!=d&&"onScroll"===s&&Kn("scroll",e):null!=d&&y(e,s,d,c))}switch(i){case"input":z(e),$(e,n,!1);break;case"textarea":z(e),se(e);break;case"option":null!=n.value&&e.setAttribute("value",""+P(n.value));break;case"select":e.multiple=!!n.multiple,null!=(s=n.value)?ie(e,!!n.multiple,s,!1):null!=n.defaultValue&&ie(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=$n)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Br(t),null;case 6:if(e&&null!=t.stateNode)kr(0,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(l(166));if(i=is(ts.current),is($l.current),ul(t)){if(n=t.stateNode,i=t.memoizedProps,n[ha]=t,(s=n.nodeValue!==i)&&null!==(e=il))switch(e.tag){case 3:qn(n.nodeValue,i,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&qn(n.nodeValue,i,0!==(1&e.mode))}s&&(t.flags|=4)}else(n=(9===i.nodeType?i:i.ownerDocument).createTextNode(n))[ha]=t,t.stateNode=n}return Br(t),null;case 13:if(Va(rs),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(al&&null!==nl&&0!==(1&t.mode)&&0===(128&t.flags))hl(),ml(),t.flags|=98560,s=!1;else if(s=ul(t),null!==n&&null!==n.dehydrated){if(null===e){if(!s)throw Error(l(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(l(317));s[ha]=t}else ml(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Br(t),s=!1}else null!==ll&&(lo(ll),ll=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=i,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&rs.current)?0===kc&&(kc=3):po())),null!==t.updateQueue&&(t.flags|=4),Br(t),null);case 4:return as(),null===e&&An(t.stateNode.containerInfo),Br(t),null;case 10:return vl(t.type._context),Br(t),null;case 19:if(Va(rs),null===(s=t.memoizedState))return Br(t),null;if(n=0!==(128&t.flags),null===(c=s.rendering))if(n)Pr(s,!1);else{if(0!==kc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=cs(e))){for(t.flags|=128,Pr(s,!1),null!==(n=c.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=i,i=t.child;null!==i;)e=n,(s=i).flags&=14680066,null===(c=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,e=c.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Xa(rs,1&rs.current|2),t.child}e=e.sibling}null!==s.tail&&Qe()>Hc&&(t.flags|=128,n=!0,Pr(s,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=cs(c))){if(t.flags|=128,n=!0,null!==(i=e.updateQueue)&&(t.updateQueue=i,t.flags|=4),Pr(s,!0),null===s.tail&&"hidden"===s.tailMode&&!c.alternate&&!al)return Br(t),null}else 2*Qe()-s.renderingStartTime>Hc&&1073741824!==i&&(t.flags|=128,n=!0,Pr(s,!1),t.lanes=4194304);s.isBackwards?(c.sibling=t.child,t.child=c):(null!==(i=s.last)?i.sibling=c:t.child=c,s.last=c)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Qe(),t.sibling=null,i=rs.current,Xa(rs,n?1&i|2:1&i),t):(Br(t),null);case 22:case 23:return uo(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Yc)&&(Br(t),6&t.subtreeFlags&&(t.flags|=8192)):Br(t),null;case 24:case 25:return null}throw Error(l(156,t.tag))}function Or(e,t){switch(tl(t),t.tag){case 1:return Fa(t.type)&&ka(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return as(),Va(Na),Va(Ca),ds(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ss(t),null;case 13:if(Va(rs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(l(340));ml()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Va(rs),null;case 4:return as(),null;case 10:return vl(t.type._context),null;case 22:case 23:return uo(),null;default:return null}}Yr=function(e,t){for(var i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Fr=function(e,t,i,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,is($l.current);var l,s=null;switch(i){case"input":a=_(e,a),n=_(e,n),s=[];break;case"select":a=T({},a,{value:void 0}),n=T({},n,{value:void 0}),s=[];break;case"textarea":a=ne(e,a),n=ne(e,n),s=[];break;default:"function"!==typeof a.onClick&&"function"===typeof n.onClick&&(e.onclick=$n)}for(d in Ie(i,n),i=null,a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&null!=a[d])if("style"===d){var c=a[d];for(l in c)c.hasOwnProperty(l)&&(i||(i={}),i[l]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(r.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in n){var o=n[d];if(c=null!=a?a[d]:void 0,n.hasOwnProperty(d)&&o!==c&&(null!=o||null!=c))if("style"===d)if(c){for(l in c)!c.hasOwnProperty(l)||o&&o.hasOwnProperty(l)||(i||(i={}),i[l]="");for(l in o)o.hasOwnProperty(l)&&c[l]!==o[l]&&(i||(i={}),i[l]=o[l])}else i||(s||(s=[]),s.push(d,i)),i=o;else"dangerouslySetInnerHTML"===d?(o=o?o.__html:void 0,c=c?c.__html:void 0,null!=o&&c!==o&&(s=s||[]).push(d,o)):"children"===d?"string"!==typeof o&&"number"!==typeof o||(s=s||[]).push(d,""+o):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(r.hasOwnProperty(d)?(null!=o&&"onScroll"===d&&Kn("scroll",e),s||c===o||(s=[])):(s=s||[]).push(d,o))}i&&(s=s||[]).push("style",i);var d=s;(t.updateQueue=d)&&(t.flags|=4)}},kr=function(e,t,i,n){i!==n&&(t.flags|=4)};var Dr=!1,_r=!1,jr="function"===typeof WeakSet?WeakSet:Set,Qr=null;function qr(e,t){var i=e.ref;if(null!==i)if("function"===typeof i)try{i(null)}catch(n){Go(e,t,n)}else i.current=null}function $r(e,t,i){try{i()}catch(n){Go(e,t,n)}}var ec=!1;function tc(e,t,i){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var a=n=n.next;do{if((a.tag&e)===e){var l=a.destroy;a.destroy=void 0,void 0!==l&&$r(t,i,l)}a=a.next}while(a!==n)}}function ic(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var i=t=t.next;do{if((i.tag&e)===e){var n=i.create;i.destroy=n()}i=i.next}while(i!==t)}}function nc(e){var t=e.ref;if(null!==t){var i=e.stateNode;e.tag,e=i,"function"===typeof t?t(e):t.current=e}}function ac(e){var t=e.alternate;null!==t&&(e.alternate=null,ac(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[ma],delete t[pa],delete t[ga],delete t[Za])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function lc(e){return 5===e.tag||3===e.tag||4===e.tag}function sc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||lc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function rc(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===i.nodeType?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(8===i.nodeType?(t=i.parentNode).insertBefore(e,i):(t=i).appendChild(e),null!==(i=i._reactRootContainer)&&void 0!==i||null!==t.onclick||(t.onclick=$n));else if(4!==n&&null!==(e=e.child))for(rc(e,t,i),e=e.sibling;null!==e;)rc(e,t,i),e=e.sibling}function cc(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(4!==n&&null!==(e=e.child))for(cc(e,t,i),e=e.sibling;null!==e;)cc(e,t,i),e=e.sibling}var oc=null,dc=!1;function uc(e,t,i){for(i=i.child;null!==i;)hc(e,t,i),i=i.sibling}function hc(e,t,i){if(lt&&"function"===typeof lt.onCommitFiberUnmount)try{lt.onCommitFiberUnmount(at,i)}catch(r){}switch(i.tag){case 5:_r||qr(i,t);case 6:var n=oc,a=dc;oc=null,uc(e,t,i),dc=a,null!==(oc=n)&&(dc?(e=oc,i=i.stateNode,8===e.nodeType?e.parentNode.removeChild(i):e.removeChild(i)):oc.removeChild(i.stateNode));break;case 18:null!==oc&&(dc?(e=oc,i=i.stateNode,8===e.nodeType?ca(e.parentNode,i):1===e.nodeType&&ca(e,i),At(e)):ca(oc,i.stateNode));break;case 4:n=oc,a=dc,oc=i.stateNode.containerInfo,dc=!0,uc(e,t,i),oc=n,dc=a;break;case 0:case 11:case 14:case 15:if(!_r&&(null!==(n=i.updateQueue)&&null!==(n=n.lastEffect))){a=n=n.next;do{var l=a,s=l.destroy;l=l.tag,void 0!==s&&(0!==(2&l)||0!==(4&l))&&$r(i,t,s),a=a.next}while(a!==n)}uc(e,t,i);break;case 1:if(!_r&&(qr(i,t),"function"===typeof(n=i.stateNode).componentWillUnmount))try{n.props=i.memoizedProps,n.state=i.memoizedState,n.componentWillUnmount()}catch(r){Go(i,t,r)}uc(e,t,i);break;case 21:uc(e,t,i);break;case 22:1&i.mode?(_r=(n=_r)||null!==i.memoizedState,uc(e,t,i),_r=n):uc(e,t,i);break;default:uc(e,t,i)}}function mc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var i=e.stateNode;null===i&&(i=e.stateNode=new jr),t.forEach((function(t){var n=Co.bind(null,e,t);i.has(t)||(i.add(t),t.then(n,n))}))}}function bc(e,t){var i=t.deletions;if(null!==i)for(var n=0;n<i.length;n++){var a=i[n];try{var s=e,r=t,c=r;e:for(;null!==c;){switch(c.tag){case 5:oc=c.stateNode,dc=!1;break e;case 3:case 4:oc=c.stateNode.containerInfo,dc=!0;break e}c=c.return}if(null===oc)throw Error(l(160));hc(s,r,a),oc=null,dc=!1;var o=a.alternate;null!==o&&(o.return=null),a.return=null}catch(d){Go(a,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)pc(t,e),t=t.sibling}function pc(e,t){var i=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(bc(t,e),gc(e),4&n){try{tc(3,e,e.return),ic(3,e)}catch(g){Go(e,e.return,g)}try{tc(5,e,e.return)}catch(g){Go(e,e.return,g)}}break;case 1:bc(t,e),gc(e),512&n&&null!==i&&qr(i,i.return);break;case 5:if(bc(t,e),gc(e),512&n&&null!==i&&qr(i,i.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(g){Go(e,e.return,g)}}if(4&n&&null!=(a=e.stateNode)){var s=e.memoizedProps,r=null!==i?i.memoizedProps:s,c=e.type,o=e.updateQueue;if(e.updateQueue=null,null!==o)try{"input"===c&&"radio"===s.type&&null!=s.name&&Q(a,s),ye(c,r);var d=ye(c,s);for(r=0;r<o.length;r+=2){var u=o[r],h=o[r+1];"style"===u?ge(a,h):"dangerouslySetInnerHTML"===u?ue(a,h):"children"===u?he(a,h):y(a,u,h,d)}switch(c){case"input":q(a,s);break;case"textarea":le(a,s);break;case"select":var m=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var b=s.value;null!=b?ie(a,!!s.multiple,b,!1):m!==!!s.multiple&&(null!=s.defaultValue?ie(a,!!s.multiple,s.defaultValue,!0):ie(a,!!s.multiple,s.multiple?[]:"",!1))}a[ma]=s}catch(g){Go(e,e.return,g)}}break;case 6:if(bc(t,e),gc(e),4&n){if(null===e.stateNode)throw Error(l(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(g){Go(e,e.return,g)}}break;case 3:if(bc(t,e),gc(e),4&n&&null!==i&&i.memoizedState.isDehydrated)try{At(t.containerInfo)}catch(g){Go(e,e.return,g)}break;case 4:default:bc(t,e),gc(e);break;case 13:bc(t,e),gc(e),8192&(a=e.child).flags&&(s=null!==a.memoizedState,a.stateNode.isHidden=s,!s||null!==a.alternate&&null!==a.alternate.memoizedState||(Jc=Qe())),4&n&&mc(e);break;case 22:if(u=null!==i&&null!==i.memoizedState,1&e.mode?(_r=(d=_r)||u,bc(t,e),_r=d):bc(t,e),gc(e),8192&n){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Qr=e,u=e.child;null!==u;){for(h=Qr=u;null!==Qr;){switch(b=(m=Qr).child,m.tag){case 0:case 11:case 14:case 15:tc(4,m,m.return);break;case 1:qr(m,m.return);var p=m.stateNode;if("function"===typeof p.componentWillUnmount){n=m,i=m.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){Go(n,i,g)}}break;case 5:qr(m,m.return);break;case 22:if(null!==m.memoizedState){Rc(h);continue}}null!==b?(b.return=m,Qr=b):Rc(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{a=h.stateNode,d?"function"===typeof(s=a.style).setProperty?s.setProperty("display","none","important"):s.display="none":(c=h.stateNode,r=void 0!==(o=h.memoizedProps.style)&&null!==o&&o.hasOwnProperty("display")?o.display:null,c.style.display=pe("display",r))}catch(g){Go(e,e.return,g)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){Go(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:bc(t,e),gc(e),4&n&&mc(e);case 21:}}function gc(e){var t=e.flags;if(2&t){try{e:{for(var i=e.return;null!==i;){if(lc(i)){var n=i;break e}i=i.return}throw Error(l(160))}switch(n.tag){case 5:var a=n.stateNode;32&n.flags&&(he(a,""),n.flags&=-33),cc(e,sc(e),a);break;case 3:case 4:var s=n.stateNode.containerInfo;rc(e,sc(e),s);break;default:throw Error(l(161))}}catch(r){Go(e,e.return,r)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Zc(e,t,i){Qr=e,Ic(e,t,i)}function Ic(e,t,i){for(var n=0!==(1&e.mode);null!==Qr;){var a=Qr,l=a.child;if(22===a.tag&&n){var s=null!==a.memoizedState||Dr;if(!s){var r=a.alternate,c=null!==r&&null!==r.memoizedState||_r;r=Dr;var o=_r;if(Dr=s,(_r=c)&&!o)for(Qr=a;null!==Qr;)c=(s=Qr).child,22===s.tag&&null!==s.memoizedState?fc(a):null!==c?(c.return=s,Qr=c):fc(a);for(;null!==l;)Qr=l,Ic(l,t,i),l=l.sibling;Qr=a,Dr=r,_r=o}yc(e)}else 0!==(8772&a.subtreeFlags)&&null!==l?(l.return=a,Qr=l):yc(e)}}function yc(e){for(;null!==Qr;){var t=Qr;if(0!==(8772&t.flags)){var i=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:_r||ic(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!_r)if(null===i)n.componentDidMount();else{var a=t.elementType===t.type?i.memoizedProps:gl(t.type,i.memoizedProps);n.componentDidUpdate(a,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Ul(t,s,n);break;case 3:var r=t.updateQueue;if(null!==r){if(i=null,null!==t.child)switch(t.child.tag){case 5:case 1:i=t.child.stateNode}Ul(t,r,i)}break;case 5:var c=t.stateNode;if(null===i&&4&t.flags){i=c;var o=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":o.autoFocus&&i.focus();break;case"img":o.src&&(i.src=o.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&At(h)}}}break;default:throw Error(l(163))}_r||512&t.flags&&nc(t)}catch(m){Go(t,t.return,m)}}if(t===e){Qr=null;break}if(null!==(i=t.sibling)){i.return=t.return,Qr=i;break}Qr=t.return}}function Rc(e){for(;null!==Qr;){var t=Qr;if(t===e){Qr=null;break}var i=t.sibling;if(null!==i){i.return=t.return,Qr=i;break}Qr=t.return}}function fc(e){for(;null!==Qr;){var t=Qr;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{ic(4,t)}catch(c){Go(t,i,c)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var a=t.return;try{n.componentDidMount()}catch(c){Go(t,a,c)}}var l=t.return;try{nc(t)}catch(c){Go(t,l,c)}break;case 5:var s=t.return;try{nc(t)}catch(c){Go(t,s,c)}}}catch(c){Go(t,t.return,c)}if(t===e){Qr=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Qr=r;break}Qr=t.return}}var vc,Wc=Math.ceil,Gc=R.ReactCurrentDispatcher,Vc=R.ReactCurrentOwner,Xc=R.ReactCurrentBatchConfig,Sc=0,Cc=null,Nc=null,Ec=0,Yc=0,Fc=Ga(0),kc=0,xc=null,wc=0,Lc=0,Tc=0,Uc=null,Kc=null,Jc=0,Hc=1/0,Ac=null,Mc=!1,Pc=null,Bc=null,zc=!1,Oc=null,Dc=0,_c=0,jc=null,Qc=-1,qc=0;function $c(){return 0!==(6&Sc)?Qe():-1!==Qc?Qc:Qc=Qe()}function eo(e){return 0===(1&e.mode)?1:0!==(2&Sc)&&0!==Ec?Ec&-Ec:null!==pl.transition?(0===qc&&(qc=pt()),qc):0!==(e=yt)?e:e=void 0===(e=window.event)?16:jt(e.type)}function to(e,t,i,n){if(50<_c)throw _c=0,jc=null,Error(l(185));Zt(e,i,n),0!==(2&Sc)&&e===Cc||(e===Cc&&(0===(2&Sc)&&(Lc|=i),4===kc&&so(e,Ec)),io(e,n),1===i&&0===Sc&&0===(1&t.mode)&&(Hc=Qe()+500,Ka&&Aa()))}function io(e,t){var i=e.callbackNode;!function(e,t){for(var i=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,l=e.pendingLanes;0<l;){var s=31-st(l),r=1<<s,c=a[s];-1===c?0!==(r&i)&&0===(r&n)||(a[s]=mt(r,t)):c<=t&&(e.expiredLanes|=r),l&=~r}}(e,t);var n=ht(e,e===Cc?Ec:0);if(0===n)null!==i&&De(i),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=i&&De(i),1===t)0===e.tag?function(e){Ka=!0,Ha(e)}(ro.bind(null,e)):Ha(ro.bind(null,e)),sa((function(){0===(6&Sc)&&Aa()})),i=null;else{switch(Rt(n)){case 1:i=$e;break;case 4:i=et;break;case 16:default:i=tt;break;case 536870912:i=nt}i=No(i,no.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function no(e,t){if(Qc=-1,qc=0,0!==(6&Sc))throw Error(l(327));var i=e.callbackNode;if(vo()&&e.callbackNode!==i)return null;var n=ht(e,e===Cc?Ec:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=go(e,n);else{t=n;var a=Sc;Sc|=2;var s=bo();for(Cc===e&&Ec===t||(Ac=null,Hc=Qe()+500,ho(e,t));;)try{Io();break}catch(c){mo(e,c)}fl(),Gc.current=s,Sc=a,null!==Nc?t=0:(Cc=null,Ec=0,t=kc)}if(0!==t){if(2===t&&(0!==(a=bt(e))&&(n=a,t=ao(e,a))),1===t)throw i=xc,ho(e,0),so(e,n),io(e,Qe()),i;if(6===t)so(e,n);else{if(a=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var i=t.updateQueue;if(null!==i&&null!==(i=i.stores))for(var n=0;n<i.length;n++){var a=i[n],l=a.getSnapshot;a=a.value;try{if(!rn(l(),a))return!1}catch(r){return!1}}}if(i=t.child,16384&t.subtreeFlags&&null!==i)i.return=t,t=i;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=go(e,n))&&(0!==(s=bt(e))&&(n=s,t=ao(e,s))),1===t))throw i=xc,ho(e,0),so(e,n),io(e,Qe()),i;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(l(345));case 2:case 5:fo(e,Kc,Ac);break;case 3:if(so(e,n),(130023424&n)===n&&10<(t=Jc+500-Qe())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&n)!==n){$c(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=na(fo.bind(null,e,Kc,Ac),t);break}fo(e,Kc,Ac);break;case 4:if(so(e,n),(4194240&n)===n)break;for(t=e.eventTimes,a=-1;0<n;){var r=31-st(n);s=1<<r,(r=t[r])>a&&(a=r),n&=~s}if(n=a,10<(n=(120>(n=Qe()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Wc(n/1960))-n)){e.timeoutHandle=na(fo.bind(null,e,Kc,Ac),n);break}fo(e,Kc,Ac);break;default:throw Error(l(329))}}}return io(e,Qe()),e.callbackNode===i?no.bind(null,e):null}function ao(e,t){var i=Uc;return e.current.memoizedState.isDehydrated&&(ho(e,t).flags|=256),2!==(e=go(e,t))&&(t=Kc,Kc=i,null!==t&&lo(t)),e}function lo(e){null===Kc?Kc=e:Kc.push.apply(Kc,e)}function so(e,t){for(t&=~Tc,t&=~Lc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-st(t),n=1<<i;e[i]=-1,t&=~n}}function ro(e){if(0!==(6&Sc))throw Error(l(327));vo();var t=ht(e,0);if(0===(1&t))return io(e,Qe()),null;var i=go(e,t);if(0!==e.tag&&2===i){var n=bt(e);0!==n&&(t=n,i=ao(e,n))}if(1===i)throw i=xc,ho(e,0),so(e,t),io(e,Qe()),i;if(6===i)throw Error(l(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,fo(e,Kc,Ac),io(e,Qe()),null}function co(e,t){var i=Sc;Sc|=1;try{return e(t)}finally{0===(Sc=i)&&(Hc=Qe()+500,Ka&&Aa())}}function oo(e){null!==Oc&&0===Oc.tag&&0===(6&Sc)&&vo();var t=Sc;Sc|=1;var i=Xc.transition,n=yt;try{if(Xc.transition=null,yt=1,e)return e()}finally{yt=n,Xc.transition=i,0===(6&(Sc=t))&&Aa()}}function uo(){Yc=Fc.current,Va(Fc)}function ho(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(-1!==i&&(e.timeoutHandle=-1,aa(i)),null!==Nc)for(i=Nc.return;null!==i;){var n=i;switch(tl(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&ka();break;case 3:as(),Va(Na),Va(Ca),ds();break;case 5:ss(n);break;case 4:as();break;case 13:case 19:Va(rs);break;case 10:vl(n.type._context);break;case 22:case 23:uo()}i=i.return}if(Cc=e,Nc=e=ko(e.current,null),Ec=Yc=t,kc=0,xc=null,Tc=Lc=wc=0,Kc=Uc=null,null!==Xl){for(t=0;t<Xl.length;t++)if(null!==(n=(i=Xl[t]).interleaved)){i.interleaved=null;var a=n.next,l=i.pending;if(null!==l){var s=l.next;l.next=a,n.next=s}i.pending=n}Xl=null}return e}function mo(e,t){for(;;){var i=Nc;try{if(fl(),us.current=lr,Zs){for(var n=bs.memoizedState;null!==n;){var a=n.queue;null!==a&&(a.pending=null),n=n.next}Zs=!1}if(ms=0,gs=ps=bs=null,Is=!1,ys=0,Vc.current=null,null===i||null===i.return){kc=1,xc=t,Nc=null;break}e:{var s=e,r=i.return,c=i,o=t;if(t=Ec,c.flags|=32768,null!==o&&"object"===typeof o&&"function"===typeof o.then){var d=o,u=c,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var b=gr(r);if(null!==b){b.flags&=-257,Zr(b,r,c,0,t),1&b.mode&&pr(s,d,t),o=d;var p=(t=b).updateQueue;if(null===p){var g=new Set;g.add(o),t.updateQueue=g}else p.add(o);break e}if(0===(1&t)){pr(s,d,t),po();break e}o=Error(l(426))}else if(al&&1&c.mode){var Z=gr(r);if(null!==Z){0===(65536&Z.flags)&&(Z.flags|=256),Zr(Z,r,c,0,t),bl(or(o,c));break e}}s=o=or(o,c),4!==kc&&(kc=2),null===Uc?Uc=[s]:Uc.push(s),s=r;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Ll(s,mr(0,o,t));break e;case 1:c=o;var I=s.type,y=s.stateNode;if(0===(128&s.flags)&&("function"===typeof I.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Bc||!Bc.has(y)))){s.flags|=65536,t&=-t,s.lanes|=t,Ll(s,br(s,c,t));break e}}s=s.return}while(null!==s)}Ro(i)}catch(R){t=R,Nc===i&&null!==i&&(Nc=i=i.return);continue}break}}function bo(){var e=Gc.current;return Gc.current=lr,null===e?lr:e}function po(){0!==kc&&3!==kc&&2!==kc||(kc=4),null===Cc||0===(268435455&wc)&&0===(268435455&Lc)||so(Cc,Ec)}function go(e,t){var i=Sc;Sc|=2;var n=bo();for(Cc===e&&Ec===t||(Ac=null,ho(e,t));;)try{Zo();break}catch(a){mo(e,a)}if(fl(),Sc=i,Gc.current=n,null!==Nc)throw Error(l(261));return Cc=null,Ec=0,kc}function Zo(){for(;null!==Nc;)yo(Nc)}function Io(){for(;null!==Nc&&!_e();)yo(Nc)}function yo(e){var t=vc(e.alternate,e,Yc);e.memoizedProps=e.pendingProps,null===t?Ro(e):Nc=t,Vc.current=null}function Ro(e){var t=e;do{var i=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(i=zr(i,t,Yc)))return void(Nc=i)}else{if(null!==(i=Or(i,t)))return i.flags&=32767,void(Nc=i);if(null===e)return kc=6,void(Nc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Nc=t);Nc=t=e}while(null!==t);0===kc&&(kc=5)}function fo(e,t,i){var n=yt,a=Xc.transition;try{Xc.transition=null,yt=1,function(e,t,i,n){do{vo()}while(null!==Oc);if(0!==(6&Sc))throw Error(l(327));i=e.finishedWork;var a=e.finishedLanes;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(l(177));e.callbackNode=null,e.callbackPriority=0;var s=i.lanes|i.childLanes;if(function(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<i;){var a=31-st(i),l=1<<a;t[a]=0,n[a]=-1,e[a]=-1,i&=~l}}(e,s),e===Cc&&(Nc=Cc=null,Ec=0),0===(2064&i.subtreeFlags)&&0===(2064&i.flags)||zc||(zc=!0,No(tt,(function(){return vo(),null}))),s=0!==(15990&i.flags),0!==(15990&i.subtreeFlags)||s){s=Xc.transition,Xc.transition=null;var r=yt;yt=1;var c=Sc;Sc|=4,Vc.current=null,function(e,t){if(ea=Pt,mn(e=hn())){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(i=(i=e.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(n&&0!==n.rangeCount){i=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{i.nodeType,s.nodeType}catch(f){i=null;break e}var r=0,c=-1,o=-1,d=0,u=0,h=e,m=null;t:for(;;){for(var b;h!==i||0!==a&&3!==h.nodeType||(c=r+a),h!==s||0!==n&&3!==h.nodeType||(o=r+n),3===h.nodeType&&(r+=h.nodeValue.length),null!==(b=h.firstChild);)m=h,h=b;for(;;){if(h===e)break t;if(m===i&&++d===a&&(c=r),m===s&&++u===n&&(o=r),null!==(b=h.nextSibling))break;m=(h=m).parentNode}h=b}i=-1===c||-1===o?null:{start:c,end:o}}else i=null}i=i||{start:0,end:0}}else i=null;for(ta={focusedElem:e,selectionRange:i},Pt=!1,Qr=t;null!==Qr;)if(e=(t=Qr).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qr=e;else for(;null!==Qr;){t=Qr;try{var p=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var g=p.memoizedProps,Z=p.memoizedState,I=t.stateNode,y=I.getSnapshotBeforeUpdate(t.elementType===t.type?g:gl(t.type,g),Z);I.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var R=t.stateNode.containerInfo;1===R.nodeType?R.textContent="":9===R.nodeType&&R.documentElement&&R.removeChild(R.documentElement);break;default:throw Error(l(163))}}catch(f){Go(t,t.return,f)}if(null!==(e=t.sibling)){e.return=t.return,Qr=e;break}Qr=t.return}p=ec,ec=!1}(e,i),pc(i,e),bn(ta),Pt=!!ea,ta=ea=null,e.current=i,Zc(i,e,a),je(),Sc=c,yt=r,Xc.transition=s}else e.current=i;if(zc&&(zc=!1,Oc=e,Dc=a),0===(s=e.pendingLanes)&&(Bc=null),function(e){if(lt&&"function"===typeof lt.onCommitFiberRoot)try{lt.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(i.stateNode),io(e,Qe()),null!==t)for(n=e.onRecoverableError,i=0;i<t.length;i++)n((a=t[i]).value,{componentStack:a.stack,digest:a.digest});if(Mc)throw Mc=!1,e=Pc,Pc=null,e;0!==(1&Dc)&&0!==e.tag&&vo(),0!==(1&(s=e.pendingLanes))?e===jc?_c++:(_c=0,jc=e):_c=0,Aa()}(e,t,i,n)}finally{Xc.transition=a,yt=n}return null}function vo(){if(null!==Oc){var e=Rt(Dc),t=Xc.transition,i=yt;try{if(Xc.transition=null,yt=16>e?16:e,null===Oc)var n=!1;else{if(e=Oc,Oc=null,Dc=0,0!==(6&Sc))throw Error(l(331));var a=Sc;for(Sc|=4,Qr=e.current;null!==Qr;){var s=Qr,r=s.child;if(0!==(16&Qr.flags)){var c=s.deletions;if(null!==c){for(var o=0;o<c.length;o++){var d=c[o];for(Qr=d;null!==Qr;){var u=Qr;switch(u.tag){case 0:case 11:case 15:tc(8,u,s)}var h=u.child;if(null!==h)h.return=u,Qr=h;else for(;null!==Qr;){var m=(u=Qr).sibling,b=u.return;if(ac(u),u===d){Qr=null;break}if(null!==m){m.return=b,Qr=m;break}Qr=b}}}var p=s.alternate;if(null!==p){var g=p.child;if(null!==g){p.child=null;do{var Z=g.sibling;g.sibling=null,g=Z}while(null!==g)}}Qr=s}}if(0!==(2064&s.subtreeFlags)&&null!==r)r.return=s,Qr=r;else e:for(;null!==Qr;){if(0!==(2048&(s=Qr).flags))switch(s.tag){case 0:case 11:case 15:tc(9,s,s.return)}var I=s.sibling;if(null!==I){I.return=s.return,Qr=I;break e}Qr=s.return}}var y=e.current;for(Qr=y;null!==Qr;){var R=(r=Qr).child;if(0!==(2064&r.subtreeFlags)&&null!==R)R.return=r,Qr=R;else e:for(r=y;null!==Qr;){if(0!==(2048&(c=Qr).flags))try{switch(c.tag){case 0:case 11:case 15:ic(9,c)}}catch(v){Go(c,c.return,v)}if(c===r){Qr=null;break e}var f=c.sibling;if(null!==f){f.return=c.return,Qr=f;break e}Qr=c.return}}if(Sc=a,Aa(),lt&&"function"===typeof lt.onPostCommitFiberRoot)try{lt.onPostCommitFiberRoot(at,e)}catch(v){}n=!0}return n}finally{yt=i,Xc.transition=t}}return!1}function Wo(e,t,i){e=xl(e,t=mr(0,t=or(i,t),1),1),t=$c(),null!==e&&(Zt(e,1,t),io(e,t))}function Go(e,t,i){if(3===e.tag)Wo(e,e,i);else for(;null!==t;){if(3===t.tag){Wo(t,e,i);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Bc||!Bc.has(n))){t=xl(t,e=br(t,e=or(i,e),1),1),e=$c(),null!==t&&(Zt(t,1,e),io(t,e));break}}t=t.return}}function Vo(e,t,i){var n=e.pingCache;null!==n&&n.delete(t),t=$c(),e.pingedLanes|=e.suspendedLanes&i,Cc===e&&(Ec&i)===i&&(4===kc||3===kc&&(130023424&Ec)===Ec&&500>Qe()-Jc?ho(e,0):Tc|=i),io(e,t)}function Xo(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var i=$c();null!==(e=Nl(e,t))&&(Zt(e,t,i),io(e,i))}function So(e){var t=e.memoizedState,i=0;null!==t&&(i=t.retryLane),Xo(e,i)}function Co(e,t){var i=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;null!==a&&(i=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(l(314))}null!==n&&n.delete(t),Xo(e,i)}function No(e,t){return Oe(e,t)}function Eo(e,t,i,n){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yo(e,t,i,n){return new Eo(e,t,i,n)}function Fo(e){return!(!(e=e.prototype)||!e.isReactComponent)}function ko(e,t){var i=e.alternate;return null===i?((i=Yo(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&e.flags,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function xo(e,t,i,n,a,s){var r=2;if(n=e,"function"===typeof e)Fo(e)&&(r=1);else if("string"===typeof e)r=5;else e:switch(e){case W:return wo(i.children,a,s,t);case G:r=8,a|=8;break;case V:return(e=Yo(12,i,t,2|a)).elementType=V,e.lanes=s,e;case N:return(e=Yo(13,i,t,a)).elementType=N,e.lanes=s,e;case E:return(e=Yo(19,i,t,a)).elementType=E,e.lanes=s,e;case k:return Lo(i,a,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case X:r=10;break e;case S:r=9;break e;case C:r=11;break e;case Y:r=14;break e;case F:r=16,n=null;break e}throw Error(l(130,null==e?e:typeof e,""))}return(t=Yo(r,i,t,a)).elementType=e,t.type=n,t.lanes=s,t}function wo(e,t,i,n){return(e=Yo(7,e,n,t)).lanes=i,e}function Lo(e,t,i,n){return(e=Yo(22,e,n,t)).elementType=k,e.lanes=i,e.stateNode={isHidden:!1},e}function To(e,t,i){return(e=Yo(6,e,null,t)).lanes=i,e}function Uo(e,t,i){return(t=Yo(4,null!==e.children?e.children:[],e.key,t)).lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ko(e,t,i,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Jo(e,t,i,n,a,l,s,r,c){return e=new Ko(e,t,i,r,c),1===t?(t=1,!0===l&&(t|=8)):t=0,l=Yo(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yl(l),e}function Ho(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:v,key:null==n?null:""+n,children:e,containerInfo:t,implementation:i}}function Ao(e){if(!e)return Sa;e:{if(Ae(e=e._reactInternals)!==e||1!==e.tag)throw Error(l(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Fa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(l(171))}if(1===e.tag){var i=e.type;if(Fa(i))return wa(e,i,t)}return t}function Mo(e,t,i,n,a,l,s,r,c){return(e=Jo(i,n,!0,e,0,l,0,r,c)).context=Ao(null),i=e.current,(l=kl(n=$c(),a=eo(i))).callback=void 0!==t&&null!==t?t:null,xl(i,l,a),e.current.lanes=a,Zt(e,a,n),io(e,n),e}function Po(e,t,i,n){var a=t.current,l=$c(),s=eo(a);return i=Ao(i),null===t.context?t.context=i:t.pendingContext=i,(t=kl(l,s)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=xl(a,t,s))&&(to(e,a,s,l),wl(e,a,s)),s}function Bo(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function zo(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var i=e.retryLane;e.retryLane=0!==i&&i<t?i:t}}function Oo(e,t){zo(e,t),(e=e.alternate)&&zo(e,t)}vc=function(e,t,i){if(null!==e)if(e.memoizedProps!==t.pendingProps||Na.current)yr=!0;else{if(0===(e.lanes&i)&&0===(128&t.flags))return yr=!1,function(e,t,i){switch(t.tag){case 3:Nr(t),ml();break;case 5:ls(t);break;case 1:Fa(t.type)&&La(t);break;case 4:ns(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Xa(Zl,n._currentValue),n._currentValue=a;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Xa(rs,1&rs.current),t.flags|=128,null):0!==(i&t.child.childLanes)?Lr(e,t,i):(Xa(rs,1&rs.current),null!==(e=Mr(e,t,i))?e.sibling:null);Xa(rs,1&rs.current);break;case 19:if(n=0!==(i&t.childLanes),0!==(128&e.flags)){if(n)return Hr(e,t,i);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Xa(rs,rs.current),n)break;return null;case 22:case 23:return t.lanes=0,Gr(e,t,i)}return Mr(e,t,i)}(e,t,i);yr=0!==(131072&e.flags)}else yr=!1,al&&0!==(1048576&t.flags)&&$a(t,za,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ar(e,t),e=t.pendingProps;var a=Ya(t,Ca.current);Gl(t,i),a=Ws(null,t,n,e,a,i);var s=Gs();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Fa(n)?(s=!0,La(t)):s=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Yl(t),a.updater=Hl,t.stateNode=a,a._reactInternals=t,Bl(t,n,e,i),t=Cr(null,t,n,!0,s,i)):(t.tag=0,al&&s&&el(t),Rr(null,t,a,i),t=t.child),t;case 16:n=t.elementType;e:{switch(Ar(e,t),e=t.pendingProps,n=(a=n._init)(n._payload),t.type=n,a=t.tag=function(e){if("function"===typeof e)return Fo(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===Y)return 14}return 2}(n),e=gl(n,e),a){case 0:t=Xr(null,t,n,e,i);break e;case 1:t=Sr(null,t,n,e,i);break e;case 11:t=fr(null,t,n,e,i);break e;case 14:t=vr(null,t,n,gl(n.type,e),i);break e}throw Error(l(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,Xr(e,t,n,a=t.elementType===n?a:gl(n,a),i);case 1:return n=t.type,a=t.pendingProps,Sr(e,t,n,a=t.elementType===n?a:gl(n,a),i);case 3:e:{if(Nr(t),null===e)throw Error(l(387));n=t.pendingProps,a=(s=t.memoizedState).element,Fl(e,t),Tl(t,n,null,i);var r=t.memoizedState;if(n=r.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:r.cache,pendingSuspenseBoundaries:r.pendingSuspenseBoundaries,transitions:r.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Er(e,t,n,i,a=or(Error(l(423)),t));break e}if(n!==a){t=Er(e,t,n,i,a=or(Error(l(424)),t));break e}for(nl=oa(t.stateNode.containerInfo.firstChild),il=t,al=!0,ll=null,i=Ql(t,null,n,i),t.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(ml(),n===a){t=Mr(e,t,i);break e}Rr(e,t,n,i)}t=t.child}return t;case 5:return ls(t),null===e&&ol(t),n=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,r=a.children,ia(n,a)?r=null:null!==s&&ia(n,s)&&(t.flags|=32),Vr(e,t),Rr(e,t,r,i),t.child;case 6:return null===e&&ol(t),null;case 13:return Lr(e,t,i);case 4:return ns(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=jl(t,null,n,i):Rr(e,t,n,i),t.child;case 11:return n=t.type,a=t.pendingProps,fr(e,t,n,a=t.elementType===n?a:gl(n,a),i);case 7:return Rr(e,t,t.pendingProps,i),t.child;case 8:case 12:return Rr(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,r=a.value,Xa(Zl,n._currentValue),n._currentValue=r,null!==s)if(rn(s.value,r)){if(s.children===a.children&&!Na.current){t=Mr(e,t,i);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var c=s.dependencies;if(null!==c){r=s.child;for(var o=c.firstContext;null!==o;){if(o.context===n){if(1===s.tag){(o=kl(-1,i&-i)).tag=2;var d=s.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?o.next=o:(o.next=u.next,u.next=o),d.pending=o}}s.lanes|=i,null!==(o=s.alternate)&&(o.lanes|=i),Wl(s.return,i,t),c.lanes|=i;break}o=o.next}}else if(10===s.tag)r=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(r=s.return))throw Error(l(341));r.lanes|=i,null!==(c=r.alternate)&&(c.lanes|=i),Wl(r,i,t),r=s.sibling}else r=s.child;if(null!==r)r.return=s;else for(r=s;null!==r;){if(r===t){r=null;break}if(null!==(s=r.sibling)){s.return=r.return,r=s;break}r=r.return}s=r}Rr(e,t,a.children,i),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Gl(t,i),n=n(a=Vl(a)),t.flags|=1,Rr(e,t,n,i),t.child;case 14:return a=gl(n=t.type,t.pendingProps),vr(e,t,n,a=gl(n.type,a),i);case 15:return Wr(e,t,t.type,t.pendingProps,i);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:gl(n,a),Ar(e,t),t.tag=1,Fa(n)?(e=!0,La(t)):e=!1,Gl(t,i),Ml(t,n,a),Bl(t,n,a,i),Cr(null,t,n,!0,e,i);case 19:return Hr(e,t,i);case 22:return Gr(e,t,i)}throw Error(l(156,t.tag))};var Do="function"===typeof reportError?reportError:function(e){console.error(e)};function _o(e){this._internalRoot=e}function jo(e){this._internalRoot=e}function Qo(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function qo(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $o(){}function ed(e,t,i,n,a){var l=i._reactRootContainer;if(l){var s=l;if("function"===typeof a){var r=a;a=function(){var e=Bo(s);r.call(e)}}Po(t,s,e,a)}else s=function(e,t,i,n,a){if(a){if("function"===typeof n){var l=n;n=function(){var e=Bo(s);l.call(e)}}var s=Mo(t,n,e,0,null,!1,0,"",$o);return e._reactRootContainer=s,e[ba]=s.current,An(8===e.nodeType?e.parentNode:e),oo(),s}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof n){var r=n;n=function(){var e=Bo(c);r.call(e)}}var c=Jo(e,0,!1,null,0,!1,0,"",$o);return e._reactRootContainer=c,e[ba]=c.current,An(8===e.nodeType?e.parentNode:e),oo((function(){Po(t,c,i,n)})),c}(i,t,e,a,n);return Bo(s)}jo.prototype.render=_o.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(l(409));Po(e,t,null,null)},jo.prototype.unmount=_o.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;oo((function(){Po(null,e,null,null)})),t[ba]=null}},jo.prototype.unstable_scheduleHydration=function(e){if(e){var t=Gt();e={blockedOn:null,target:e,priority:t};for(var i=0;i<kt.length&&0!==t&&t<kt[i].priority;i++);kt.splice(i,0,e),0===i&&Tt(e)}},ft=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=ut(t.pendingLanes);0!==i&&(It(t,1|i),io(t,Qe()),0===(6&Sc)&&(Hc=Qe()+500,Aa()))}break;case 13:oo((function(){var t=Nl(e,1);if(null!==t){var i=$c();to(t,e,1,i)}})),Oo(e,1)}},vt=function(e){if(13===e.tag){var t=Nl(e,134217728);if(null!==t)to(t,e,134217728,$c());Oo(e,134217728)}},Wt=function(e){if(13===e.tag){var t=eo(e),i=Nl(e,t);if(null!==i)to(i,e,t,$c());Oo(e,t)}},Gt=function(){return yt},Vt=function(e,t){var i=yt;try{return yt=e,t()}finally{yt=i}},ve=function(e,t,i){switch(t){case"input":if(q(e,i),t=i.name,"radio"===i.type&&null!=t){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var n=i[t];if(n!==e&&n.form===e.form){var a=fa(n);if(!a)throw Error(l(90));O(n),q(n,a)}}}break;case"textarea":le(e,i);break;case"select":null!=(t=i.value)&&ie(e,!!i.multiple,t,!1)}},Ce=co,Ne=oo;var td={usingClientEntryPoint:!1,Events:[ya,Ra,fa,Xe,Se,co]},id={findFiberByHostInstance:Ia,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nd={bundleType:id.bundleType,version:id.version,rendererPackageName:id.rendererPackageName,rendererConfig:id.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Be(e))?null:e.stateNode},findFiberByHostInstance:id.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ad=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ad.isDisabled&&ad.supportsFiber)try{at=ad.inject(nd),lt=ad}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=td,t.createPortal=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qo(t))throw Error(l(200));return Ho(e,t,null,i)},t.createRoot=function(e,t){if(!Qo(e))throw Error(l(299));var i=!1,n="",a=Do;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(i=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Jo(e,1,!1,null,0,i,0,n,a),e[ba]=t.current,An(8===e.nodeType?e.parentNode:e),new _o(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(l(188));throw e=Object.keys(e).join(","),Error(l(268,e))}return e=null===(e=Be(t))?null:e.stateNode},t.flushSync=function(e){return oo(e)},t.hydrate=function(e,t,i){if(!qo(t))throw Error(l(200));return ed(null,e,t,!0,i)},t.hydrateRoot=function(e,t,i){if(!Qo(e))throw Error(l(405));var n=null!=i&&i.hydratedSources||null,a=!1,s="",r=Do;if(null!==i&&void 0!==i&&(!0===i.unstable_strictMode&&(a=!0),void 0!==i.identifierPrefix&&(s=i.identifierPrefix),void 0!==i.onRecoverableError&&(r=i.onRecoverableError)),t=Mo(t,null,e,1,null!=i?i:null,a,0,s,r),e[ba]=t.current,An(e),n)for(e=0;e<n.length;e++)a=(a=(i=n[e])._getVersion)(i._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[i,a]:t.mutableSourceEagerHydrationData.push(i,a);return new jo(t)},t.render=function(e,t,i){if(!qo(t))throw Error(l(200));return ed(null,e,t,!1,i)},t.unmountComponentAtNode=function(e){if(!qo(e))throw Error(l(40));return!!e._reactRootContainer&&(oo((function(){ed(null,null,e,!1,(function(){e._reactRootContainer=null,e[ba]=null}))})),!0)},t.unstable_batchedUpdates=co,t.unstable_renderSubtreeIntoContainer=function(e,t,i,n){if(!qo(i))throw Error(l(200));if(null==e||void 0===e._reactInternals)throw Error(l(38));return ed(e,t,i,!1,n)},t.version="18.2.0-next-9e3b772b8-20220608"},781:function(e,t,i){var n=i(412);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},412:function(e,t,i){!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=i(166)},853:function(e,t,i){var n=i(381),a=Symbol.for("react.element"),l=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function o(e,t,i){var n,l={},o=null,d=null;for(n in void 0!==i&&(o=""+i),void 0!==t.key&&(o=""+t.key),void 0!==t.ref&&(d=t.ref),t)s.call(t,n)&&!c.hasOwnProperty(n)&&(l[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===l[n]&&(l[n]=t[n]);return{$$typeof:a,type:e,key:o,ref:d,props:l,_owner:r.current}}t.jsx=o},113:function(e,t){var i=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),r=Symbol.for("react.provider"),c=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function Z(e,t,i){this.props=e,this.context=t,this.refs=g,this.updater=i||b}function I(){}function y(e,t,i){this.props=e,this.context=t,this.refs=g,this.updater=i||b}Z.prototype.isReactComponent={},Z.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},Z.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},I.prototype=Z.prototype;var R=y.prototype=new I;R.constructor=y,p(R,Z.prototype),R.isPureReactComponent=!0;var f=Array.isArray,v=Object.prototype.hasOwnProperty,W={current:null},G={key:!0,ref:!0,__self:!0,__source:!0};function V(e,t,n){var a,l={},s=null,r=null;if(null!=t)for(a in void 0!==t.ref&&(r=t.ref),void 0!==t.key&&(s=""+t.key),t)v.call(t,a)&&!G.hasOwnProperty(a)&&(l[a]=t[a]);var c=arguments.length-2;if(1===c)l.children=n;else if(1<c){for(var o=Array(c),d=0;d<c;d++)o[d]=arguments[d+2];l.children=o}if(e&&e.defaultProps)for(a in c=e.defaultProps)void 0===l[a]&&(l[a]=c[a]);return{$$typeof:i,type:e,key:s,ref:r,props:l,_owner:W.current}}function X(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}var S=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,a,l,s){var r=typeof e;"undefined"!==r&&"boolean"!==r||(e=null);var c=!1;if(null===e)c=!0;else switch(r){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case i:case n:c=!0}}if(c)return s=s(c=e),e=""===l?"."+C(c,0):l,f(s)?(a="",null!=e&&(a=e.replace(S,"$&/")+"/"),N(s,t,a,"",(function(e){return e}))):null!=s&&(X(s)&&(s=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,a+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(S,"$&/")+"/")+e)),t.push(s)),1;if(c=0,l=""===l?".":l+":",f(e))for(var o=0;o<e.length;o++){var d=l+C(r=e[o],o);c+=N(r,t,a,d,s)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=m&&e[m]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),o=0;!(r=e.next()).done;)c+=N(r=r.value,t,a,d=l+C(r,o++),s);else if("object"===r)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function E(e,t,i){if(null==e)return e;var n=[],a=0;return N(e,n,"","",(function(e){return t.call(i,e,a++)})),n}function Y(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var F={current:null},k={transition:null},x={ReactCurrentDispatcher:F,ReactCurrentBatchConfig:k,ReactCurrentOwner:W};t.Children={map:E,forEach:function(e,t,i){E(e,(function(){t.apply(this,arguments)}),i)},count:function(e){var t=0;return E(e,(function(){t++})),t},toArray:function(e){return E(e,(function(e){return e}))||[]},only:function(e){if(!X(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=Z,t.Fragment=a,t.Profiler=s,t.PureComponent=y,t.StrictMode=l,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=x,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=p({},e.props),l=e.key,s=e.ref,r=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,r=W.current),void 0!==t.key&&(l=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(o in t)v.call(t,o)&&!G.hasOwnProperty(o)&&(a[o]=void 0===t[o]&&void 0!==c?c[o]:t[o])}var o=arguments.length-2;if(1===o)a.children=n;else if(1<o){c=Array(o);for(var d=0;d<o;d++)c[d]=arguments[d+2];a.children=c}return{$$typeof:i,type:e.type,key:l,ref:s,props:a,_owner:r}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:r,_context:e},e.Consumer=e},t.createElement=V,t.createFactory=function(e){var t=V.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:o,render:e}},t.isValidElement=X,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:Y}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=k.transition;k.transition={};try{e()}finally{k.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return F.current.useCallback(e,t)},t.useContext=function(e){return F.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return F.current.useDeferredValue(e)},t.useEffect=function(e,t){return F.current.useEffect(e,t)},t.useId=function(){return F.current.useId()},t.useImperativeHandle=function(e,t,i){return F.current.useImperativeHandle(e,t,i)},t.useInsertionEffect=function(e,t){return F.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return F.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return F.current.useMemo(e,t)},t.useReducer=function(e,t,i){return F.current.useReducer(e,t,i)},t.useRef=function(e){return F.current.useRef(e)},t.useState=function(e){return F.current.useState(e)},t.useSyncExternalStore=function(e,t,i){return F.current.useSyncExternalStore(e,t,i)},t.useTransition=function(){return F.current.useTransition()},t.version="18.2.0"},381:function(e,t,i){e.exports=i(113)},343:function(e,t,i){e.exports=i(853)},22:function(e,t){function i(e,t){var i=e.length;e.push(t);e:for(;0<i;){var n=i-1>>>1,a=e[n];if(!(0<l(a,t)))break e;e[n]=t,e[i]=a,i=n}}function n(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],i=e.pop();if(i!==t){e[0]=i;e:for(var n=0,a=e.length,s=a>>>1;n<s;){var r=2*(n+1)-1,c=e[r],o=r+1,d=e[o];if(0>l(c,i))o<a&&0>l(d,c)?(e[n]=d,e[o]=i,n=o):(e[n]=c,e[r]=i,n=r);else{if(!(o<a&&0>l(d,i)))break e;e[n]=d,e[o]=i,n=o}}}return t}function l(e,t){var i=e.sortIndex-t.sortIndex;return 0!==i?i:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var r=Date,c=r.now();t.unstable_now=function(){return r.now()-c}}var o=[],d=[],u=1,h=null,m=3,b=!1,p=!1,g=!1,Z="function"===typeof setTimeout?setTimeout:null,I="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function R(e){for(var t=n(d);null!==t;){if(null===t.callback)a(d);else{if(!(t.startTime<=e))break;a(d),t.sortIndex=t.expirationTime,i(o,t)}t=n(d)}}function f(e){if(g=!1,R(e),!p)if(null!==n(o))p=!0,k(v);else{var t=n(d);null!==t&&x(f,t.startTime-e)}}function v(e,i){p=!1,g&&(g=!1,I(X),X=-1),b=!0;var l=m;try{for(R(i),h=n(o);null!==h&&(!(h.expirationTime>i)||e&&!N());){var s=h.callback;if("function"===typeof s){h.callback=null,m=h.priorityLevel;var r=s(h.expirationTime<=i);i=t.unstable_now(),"function"===typeof r?h.callback=r:h===n(o)&&a(o),R(i)}else a(o);h=n(o)}if(null!==h)var c=!0;else{var u=n(d);null!==u&&x(f,u.startTime-i),c=!1}return c}finally{h=null,m=l,b=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var W,G=!1,V=null,X=-1,S=5,C=-1;function N(){return!(t.unstable_now()-C<S)}function E(){if(null!==V){var e=t.unstable_now();C=e;var i=!0;try{i=V(!0,e)}finally{i?W():(G=!1,V=null)}}else G=!1}if("function"===typeof y)W=function(){y(E)};else if("undefined"!==typeof MessageChannel){var Y=new MessageChannel,F=Y.port2;Y.port1.onmessage=E,W=function(){F.postMessage(null)}}else W=function(){Z(E,0)};function k(e){V=e,G||(G=!0,W())}function x(e,i){X=Z((function(){e(t.unstable_now())}),i)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||b||(p=!0,k(v))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(o)},t.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var i=m;m=t;try{return e()}finally{m=i}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=m;m=e;try{return t()}finally{m=i}},t.unstable_scheduleCallback=function(e,a,l){var s=t.unstable_now();switch("object"===typeof l&&null!==l?l="number"===typeof(l=l.delay)&&0<l?s+l:s:l=s,e){case 1:var r=-1;break;case 2:r=250;break;case 5:r=1073741823;break;case 4:r=1e4;break;default:r=5e3}return e={id:u++,callback:a,priorityLevel:e,startTime:l,expirationTime:r=l+r,sortIndex:-1},l>s?(e.sortIndex=l,i(d,e),null===n(o)&&e===n(d)&&(g?(I(X),X=-1):g=!0,x(f,l-s))):(e.sortIndex=r,i(o,e),p||b||(p=!0,k(v))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=m;return function(){var i=m;m=t;try{return e.apply(this,arguments)}finally{m=i}}}},46:function(e,t,i){e.exports=i(22)}},t={};function i(n){var a=t[n];if(void 0!==a)return a.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,i),l.exports}!function(){var e=i(381),t=i(781);function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function a(e,t){if(e){if("string"===typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,a,l=[],s=!0,r=!1;try{for(i=i.call(e);!(s=(n=i.next()).done)&&(l.push(n.value),!t||l.length!==t);s=!0);}catch(c){r=!0,a=c}finally{try{s||null==i.return||i.return()}finally{if(r)throw a}}return l}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s,r=i(343),c=(0,e.createContext)({}),o=function(t){var i=t.children,n=l((0,e.useState)("SelphId"),2),a=n[0],s=n[1];return(0,r.jsx)(c.Provider,{value:{activeView:a,setActiveView:s},children:i})};function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function u(){u=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",l=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function r(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{r({},"")}catch(C){r=function(e,t,i){return e[t]=i}}function c(e,t,i,n){var a=t&&t.prototype instanceof m?t:m,l=Object.create(a.prototype),s=new V(n||[]);return l._invoke=function(e,t,i){var n="suspendedStart";return function(a,l){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw l;return S()}for(i.method=a,i.arg=l;;){var s=i.delegate;if(s){var r=v(s,i);if(r){if(r===h)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===n)throw n="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n="executing";var c=o(e,t,i);if("normal"===c.type){if(n=i.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n="completed",i.method="throw",i.arg=c.arg)}}}(e,i,s),l}function o(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(C){return{type:"throw",arg:C}}}e.wrap=c;var h={};function m(){}function b(){}function p(){}var g={};r(g,a,(function(){return this}));var Z=Object.getPrototypeOf,I=Z&&Z(Z(X([])));I&&I!==t&&i.call(I,a)&&(g=I);var y=p.prototype=m.prototype=Object.create(g);function R(e){["next","throw","return"].forEach((function(t){r(e,t,(function(e){return this._invoke(t,e)}))}))}function f(e,t){function n(a,l,s,r){var c=o(e[a],e,l);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==d(h)&&i.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,r)}),(function(e){n("throw",e,s,r)})):t.resolve(h).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,r)}))}r(c.arg)}var a;this._invoke=function(e,i){function l(){return new t((function(t,a){n(e,i,t,a)}))}return a=a?a.then(l,l):l()}}function v(e,t){var i=e.iterator[t.method];if(void 0===i){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,v(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=o(i,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function W(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function G(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function V(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(W,this),this.reset(!0)}function X(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,l=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return l.next=l}}return{next:S}}function S(){return{value:void 0,done:!0}}return b.prototype=p,r(y,"constructor",p),r(p,"constructor",b),b.displayName=r(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,r(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},R(f.prototype),r(f.prototype,l,(function(){return this})),e.AsyncIterator=f,e.async=function(t,i,n,a,l){void 0===l&&(l=Promise);var s=new f(c(t,i,n,a),l);return e.isGeneratorFunction(i)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},R(y),r(y,s,"Generator"),r(y,a,(function(){return this})),r(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function i(){for(;t.length;){var n=t.pop();if(n in e)return i.value=n,i.done=!1,i}return i.done=!0,i}},e.values=X,V.prototype={constructor:V,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(G),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(i,n){return s.type="throw",s.arg=e,t.next=i,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var l=this.tryEntries[a],s=l.completion;if("root"===l.tryLoc)return n("end");if(l.tryLoc<=this.prev){var r=i.call(l,"catchLoc"),c=i.call(l,"finallyLoc");if(r&&c){if(this.prev<l.catchLoc)return n(l.catchLoc,!0);if(this.prev<l.finallyLoc)return n(l.finallyLoc)}else if(r){if(this.prev<l.catchLoc)return n(l.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<l.finallyLoc)return n(l.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&i.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var l=a;break}}l&&("break"===e||"continue"===e)&&l.tryLoc<=t&&t<=l.finallyLoc&&(l=null);var s=l?l.completion:{};return s.type=e,s.arg=t,l?(this.method="next",this.next=l.finallyLoc,h):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),G(i),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var n=i.completion;if("throw"===n.type){var a=n.arg;G(i)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:X(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),h}},e}function h(e,t,i,n,a,l,s){try{var r=e[l](s),c=r.value}catch(o){return void i(o)}r.done?t(c):Promise.resolve(c).then(n,a)}function m(e){return function(){var t=this,i=arguments;return new Promise((function(n,a){var l=e.apply(t,i);function s(e){h(l,n,a,s,r,"next",e)}function r(e){h(l,n,a,s,r,"throw",e)}s(void 0)}))}}function b(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function p(e,t){var i="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=a(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,l=function(){};return{s:l,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,c=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return r=e.done,e},e:function(e){c=!0,s=e},f:function(){try{r||null==i.return||i.return()}finally{if(c)throw s}}}}function g(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e){return Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Z(e)}function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}function y(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(N){return!1}}function R(e,t,i){return R=y()?Reflect.construct.bind():function(e,t,i){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return i&&I(a,i.prototype),a},R.apply(null,arguments)}function f(e){var t="function"===typeof Map?new Map:void 0;return f=function(e){if(null===e||(i=e,-1===Function.toString.call(i).indexOf("[native code]")))return e;var i;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return R(e,arguments,Z(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),I(n,e)},f(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}function G(e,t){if(t&&("object"===d(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function V(e){var t=y();return function(){var i,n=Z(e);if(t){var a=Z(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return G(this,i)}}function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e,t,i){return t&&S(e.prototype,t),i&&S(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}var N={871:function(e,t,i){i.d(t,{k:function(){return n}}),e=i.hmd(e);var n=function(){function e(t,i,n){X(this,e),this.graphUrl=t,this.graphReadyEvent=i,this.graphNewStateEvent=n,this.xmlHttpWidget=new XMLHttpRequest,this.xmlHttpWidget.onreadystatechange=this.readyEvent.bind(this),this.xmlHttpWidget.open("GET",this.graphUrl),this.xmlHttpWidget.send(null)}return C(e,[{key:"readyEvent",value:function(e){if(4==e.target.readyState&&200==e.target.status){var t=new DOMParser;this.xmlDoc=t.parseFromString(e.target.responseText,"text/xml"),this.graphReadyEvent()}}},{key:"setInitialState",value:function(e){null!=this.xmlDoc.querySelector("[name='"+e+"']")&&(this.state=e,this.graphNewStateEvent(this.state))}},{key:"sendMessage",value:function(e){var t=this.xmlDoc.querySelector("[name='"+this.state+"']");if(null!=t){var i=t.querySelector("[message='"+e+"']");if(null!=i||(e=e.split("//")[0],null!=(i=t.querySelector("[message='"+e+"']")))){var n=i.getAttribute("to");this.state=n,this.graphNewStateEvent(this.state)}}}}]),e}();!function(t){"object"==typeof exports?e.exports=t():"function"==typeof define&&i.amdO?define([],t):("undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:this).Animated_GIF=t()}((function(){return function e(t,i,n){function a(s,r){if(!i[s]){if(!t[s]){if(l)return l(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var o=i[s]={exports:{}};t[s][0].call(o.exports,(function(e){return a(t[s][1][e]||e)}),o,o.exports,e,t,i,n)}return i[s].exports}for(var l=void 0,s=0;s<n.length;s++)a(n[s]);return a}({1:[function(e,t,i){function n(e,t,i,n){for(var a=e[t++],l=1<<a,s=l+1,r=s+1,c=a+1,o=(1<<c)-1,d=0,u=0,h=0,m=e[t++],b=new Int32Array(4096),p=null;;){for(;d<16&&0!==m;)u|=e[t++]<<d,d+=8,1===m?m=e[t++]:--m;if(d<c)break;var g=u&o;if(u>>=c,d-=c,g!==l){if(g===s)break;for(var Z=g<r?g:p,I=0,y=Z;y>l;)y=b[y]>>8,++I;var R=y;if(h+I+(Z!==g?1:0)>n)return void console.log("Warning, gif stream longer than expected.");i[h++]=R;var f=h+=I;for(Z!==g&&(i[h++]=R),y=Z;I--;)y=b[y],i[--f]=255&y,y>>=8;null!==p&&r<4096&&(b[r++]=p<<8|R,r>=o+1&&c<12&&(++c,o=o<<1|1)),p=g}else r=s+1,o=(1<<(c=a+1))-1,p=null}return h!==n&&console.log("Warning, gif stream shorter than expected."),i}try{i.GifWriter=function(e,t,i,n){function a(e){var t=e.length;if(t<2||t>256||t&t-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return t}var l=0,s=void 0===(n=void 0===n?{}:n).loop?null:n.loop,r=void 0===n.palette?null:n.palette;if(t<=0||i<=0||t>65535||i>65535)throw"Width/Height invalid.";e[l++]=71,e[l++]=73,e[l++]=70,e[l++]=56,e[l++]=57,e[l++]=97;var c=0,o=0;if(null!==r){for(var d=a(r);d>>=1;)++c;if(d=1<<c,--c,void 0!==n.background){if((o=n.background)>=d)throw"Background index out of range.";if(0===o)throw"Background index explicitly passed as 0."}}if(e[l++]=255&t,e[l++]=t>>8&255,e[l++]=255&i,e[l++]=i>>8&255,e[l++]=(null!==r?128:0)|c,e[l++]=o,e[l++]=0,null!==r)for(var u=0,h=r.length;u<h;++u){var m=r[u];e[l++]=m>>16&255,e[l++]=m>>8&255,e[l++]=255&m}if(null!==s){if(s<0||s>65535)throw"Loop count invalid.";e[l++]=33,e[l++]=255,e[l++]=11,e[l++]=78,e[l++]=69,e[l++]=84,e[l++]=83,e[l++]=67,e[l++]=65,e[l++]=80,e[l++]=69,e[l++]=50,e[l++]=46,e[l++]=48,e[l++]=3,e[l++]=1,e[l++]=255&s,e[l++]=s>>8&255,e[l++]=0}var b=!1;this.addFrame=function(t,i,n,s,c,o){if(!0===b&&(--l,b=!1),o=void 0===o?{}:o,t<0||i<0||t>65535||i>65535)throw"x/y invalid.";if(n<=0||s<=0||n>65535||s>65535)throw"Width/Height invalid.";if(c.length<n*s)throw"Not enough pixels for the frame size.";var d=!0,u=o.palette;if(null!=u||(d=!1,u=r),null==u)throw"Must supply either a local or global palette.";for(var h=a(u),m=0;h>>=1;)++m;h=1<<m;var p=void 0===o.delay?0:o.delay,g=void 0===o.disposal?0:o.disposal;if(g<0||g>3)throw"Disposal out of range.";var Z=!1,I=0;if(void 0!==o.transparent&&null!==o.transparent&&(Z=!0,(I=o.transparent)<0||I>=h))throw"Transparent color index.";if((0!==g||Z||0!==p)&&(e[l++]=33,e[l++]=249,e[l++]=4,e[l++]=g<<2|(!0===Z?1:0),e[l++]=255&p,e[l++]=p>>8&255,e[l++]=I,e[l++]=0),e[l++]=44,e[l++]=255&t,e[l++]=t>>8&255,e[l++]=255&i,e[l++]=i>>8&255,e[l++]=255&n,e[l++]=n>>8&255,e[l++]=255&s,e[l++]=s>>8&255,e[l++]=!0===d?128|m-1:0,!0===d)for(var y=0,R=u.length;y<R;++y){var f=u[y];e[l++]=f>>16&255,e[l++]=f>>8&255,e[l++]=255&f}l=function(e,t,i,n){function a(i){for(;h>=i;)e[t++]=255&m,m>>=8,h-=8,t===s+256&&(e[s]=255,s=t++)}function l(e){m|=e<<h,h+=u,a(8)}e[t++]=i;var s=t++,r=1<<i,c=r-1,o=r+1,d=o+1,u=i+1,h=0,m=0,b=n[0]&c,p={};l(r);for(var g=1,Z=n.length;g<Z;++g){var I=n[g]&c,y=b<<8|I,R=p[y];if(void 0===R){for(m|=b<<h,h+=u;h>=8;)e[t++]=255&m,m>>=8,h-=8,t===s+256&&(e[s]=255,s=t++);4096===d?(l(r),d=o+1,u=i+1,p={}):(d>=1<<u&&++u,p[y]=d++),b=I}else b=R}return l(b),l(o),a(1),s+1===t?e[s]=0:(e[s]=t-s-1,e[t++]=0),t}(e,l,m<2?2:m,c)},this.end=function(){return!1===b&&(e[l++]=59,b=!0),l}},i.GifReader=function(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw"Invalid GIF 87a/89a header.";var i=e[t++]|e[t++]<<8,a=e[t++]|e[t++]<<8,l=e[t++],s=l>>7,r=1<<1+(7&l);e[t++],e[t++];var c=null;s&&(c=t,t+=3*r);var o=!0,d=[],u=0,h=null,m=0,b=null;for(this.width=i,this.height=a;o&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,b=e[t++]|e[t++]<<8,t++;else for(t+=12;0!==(V=e[t++]);)t+=V;break;case 249:if(4!==e[t++]||0!==e[t+4])throw"Invalid graphics extension block.";var p=e[t++];u=e[t++]|e[t++]<<8,h=e[t++],0==(1&p)&&(h=null),m=p>>2&7,t++;break;case 254:for(;0!==(V=e[t++]);)t+=V;break;default:throw"Unknown graphic control label: 0x"+e[t-1].toString(16)}break;case 44:var g=e[t++]|e[t++]<<8,Z=e[t++]|e[t++]<<8,I=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,R=e[t++],f=R>>6&1,v=c,W=!1;R>>7&&(W=!0,v=t,t+=3*(1<<1+(7&R)));var G=t;for(t++;;){var V;if(0===(V=e[t++]))break;t+=V}d.push({x:g,y:Z,width:I,height:y,has_local_palette:W,palette_offset:v,data_offset:G,data_length:t-G,transparent_index:h,interlaced:!!f,delay:u,disposal:m});break;case 59:o=!1;break;default:throw"Unknown gif block: 0x"+e[t-1].toString(16)}this.numFrames=function(){return d.length},this.loopCount=function(){return b},this.frameInfo=function(e){if(e<0||e>=d.length)throw"Frame index out of range.";return d[e]},this.decodeAndBlitFrameBGRA=function(t,a){var l=this.frameInfo(t),s=l.width*l.height,r=new Uint8Array(s);n(e,l.data_offset,r,s);var c=l.palette_offset,o=l.transparent_index;null===o&&(o=256);var d=l.width,u=i-d,h=d,m=4*(l.y*i+l.x),b=4*((l.y+l.height)*i+l.x),p=m,g=4*u;!0===l.interlaced&&(g+=4*i*7);for(var Z=8,I=0,y=r.length;I<y;++I){var R=r[I];if(0===h&&(h=d,(p+=g)>=b&&(g=4*u+4*i*(Z-1),p=m+(d+u)*(Z<<1),Z>>=1)),R===o)p+=4;else{var f=e[c+3*R],v=e[c+3*R+1],W=e[c+3*R+2];a[p++]=W,a[p++]=v,a[p++]=f,a[p++]=255}--h}},this.decodeAndBlitFrameRGBA=function(t,a){var l=this.frameInfo(t),s=l.width*l.height,r=new Uint8Array(s);n(e,l.data_offset,r,s);var c=l.palette_offset,o=l.transparent_index;null===o&&(o=256);var d=l.width,u=i-d,h=d,m=4*(l.y*i+l.x),b=4*((l.y+l.height)*i+l.x),p=m,g=4*u;!0===l.interlaced&&(g+=4*i*7);for(var Z=8,I=0,y=r.length;I<y;++I){var R=r[I];if(0===h&&(h=d,(p+=g)>=b&&(g=4*u+4*i*(Z-1),p=m+(d+u)*(Z<<1),Z>>=1)),R===o)p+=4;else{var f=e[c+3*R],v=e[c+3*R+1],W=e[c+3*R+2];a[p++]=f,a[p++]=v,a[p++]=W,a[p++]=255}--h}}}}catch(e){}},{}],2:[function(e,t,i){t.exports=function(t){function i(e){I.length,R=e;for(var t=0;t<c&&t<I.length;t++)n(t)}function n(e){var t,i;return(t=I[e]).beingProcessed||t.done?(console.error("Frame already being processed or done!",t.position),void l()):(t.sampleInterval=r,t.beingProcessed=!0,(i=function(){if(0===W.length)throw"No workers left!";return W.pop()}()).onmessage=function(e){var n=e.data;delete t.data,t.pixels=Array.prototype.slice.call(n.pixels),t.palette=Array.prototype.slice.call(n.palette),t.done=!0,t.beingProcessed=!1,function(e){W.push(e)}(i),l()},void i.postMessage(t))}function a(){for(var e=-1,t=0;t<I.length;t++){var i=I[t];if(!i.done&&!i.beingProcessed){e=t;break}}e>=0&&n(e)}function l(){var e=I.every((function(e){return!e.beingProcessed&&e.done}));y++,f(.75*y/I.length),e?G||function(e,t){var i,n=[],a={loop:g};null!==h&&null!==m&&(i=m,a.palette=i);var l=new o(n,d,u,a);G=!0,e.forEach((function(t,n){var a;i||(a=t.palette),f(.75+.25*t.position*1/e.length),l.addFrame(0,0,d,u,t.pixels,{palette:a,delay:Z})})),l.end(),f(1),e=[],G=!1,t(n)}(I,R):setTimeout(a,1)}function s(e){return 0!==e&&0==(e&e-1)}t=t||{};var r,c,o=e("omggif").GifWriter,d=t.width||160,u=t.height||120,h=t.dithering||null,m=t.palette||null,b=null,p=null,g=0,Z=250,I=[],y=0,R=function(){},f=function(){},v=[],W=[],G=!1;if(m){if(!(m instanceof Array))throw m;if(m.length<2||m.length>256){for(console.error("Palette must hold only between 2 and 256 colours");m.length<2;)m.push(0);m.length>256&&(m=m.slice(0,256))}if(!s(m.length))for(console.error("Palette must have a power of two number of colours");!s(m.length);)m.splice(m.length-1,1)}r=(t=t||{}).sampleInterval||10,c=t.numWorkers||2;for(var V=0;V<c;V++){var X=new Worker(window.URL.createObjectURL(new Blob(['(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module \'"+o+"\'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\nfunction colorClamp(value) {\n\tif(value < 0) return 0;\n\telse if(value > 255) return 255;\n\n\treturn value;\n}\n\nvar bayerMatrix8x8 = [\n\t[  1, 49, 13, 61,  4, 52, 16, 64 ],\n\t[ 33, 17, 45, 29, 36, 20, 48, 32 ],\n\t[  9, 57,  5, 53, 12, 60,  8, 56 ],\n\t[ 41, 25, 37, 21, 44, 28, 40, 24 ],\n\t[  3, 51, 15, 63,  2, 50, 14, 62 ],\n\t[ 35, 19, 47, 31, 34, 18, 46, 30 ],\n\t[ 11, 59,  7, 55, 10, 58,  6, 54 ],\n\t[ 43, 27, 39, 23, 42, 26, 38, 22 ]\n\t];\n\n\t// int r, int g, int b, int[][] palette, int paletteLength\n\tfunction getClosestPaletteColorIndex(r, g, b, palette, paletteLength) {\n\t\tvar minDistance = 195076;\n\t\tvar diffR, diffG, diffB;\n\t\tvar distanceSquared;\n\t\tvar bestIndex = 0;\n\t\tvar paletteChannels;\n\n\t\tfor(var i = 0; i < paletteLength; i++) {\n\n\t\t\tpaletteChannels = palette[i];\n\t\t\tdiffR = r - paletteChannels[0];\n\t\t\tdiffG = g - paletteChannels[1];\n\t\t\tdiffB = b - paletteChannels[2];\n\n\t\t\tdistanceSquared = diffR*diffR + diffG*diffG + diffB*diffB;\n\n\t\t\tif(distanceSquared < minDistance) {\n\t\t\t\tbestIndex = i;\n\t\t\t\tminDistance = distanceSquared;\n\t\t\t}\n\n\t\t}\n\n\t\treturn bestIndex;\n\t}\n\n// TODO: inPixels -> inComponents or inColors or something more accurate\nfunction BayerDithering(inPixels, width, height, palette) {\n\tvar offset = 0;\n\tvar indexedOffset = 0;\n\tvar r, g, b;\n\tvar pixel, threshold, index;\n\tvar paletteLength = palette.length;\n\tvar matrix = bayerMatrix8x8;\n\tvar indexedPixels = new Uint8Array( width * height );\n\n\tvar modI = 8;\n\tvar modJ = 8;\n\n\tfor(var j = 0; j < height; j++) {\n\t\tvar modj = j % modJ;\n\n\t\tfor(var i = 0; i < width; i++) {\n\n\t\t\tthreshold = matrix[i % modI][modj];\n\n\t\t\tr = colorClamp( inPixels[offset++] + threshold );\n\t\t\tg = colorClamp( inPixels[offset++] + threshold );\n\t\t\tb = colorClamp( inPixels[offset++] + threshold );\n\n\t\t\tindex = getClosestPaletteColorIndex(r, g, b, palette, paletteLength);\n\t\t\tindexedPixels[indexedOffset++] = index;\n\n\t\t}\n\t}\n\n\treturn indexedPixels;\n}\n\n\nfunction ClosestDithering(inPixels, width, height, palette) {\n\n\tvar offset = 0;\n\tvar indexedOffset = 0;\n\tvar r, g, b;\n\tvar index;\n\tvar paletteLength = palette.length;\n\tvar matrix = bayerMatrix8x8;\n\tvar numPixels = width * height;\n\tvar indexedPixels = new Uint8Array( numPixels );\n\n\tfor(var i = 0; i < numPixels; i++) {\n\n\t\tr = inPixels[offset++];\n\t\tg = inPixels[offset++];\n\t\tb = inPixels[offset++];\n\n\t\tindexedPixels[i] = getClosestPaletteColorIndex(r, g, b, palette, paletteLength);\n\n\t}\n\n\treturn indexedPixels;\n\n}\n\n\nfunction FloydSteinberg(inPixels, width, height, palette) {\n\tvar paletteLength = palette.length;\n\tvar offset = 0;\n\tvar indexedOffset = 0;\n\tvar r, g, b;\n\tvar widthLimit = width - 1;\n\tvar heightLimit = height - 1;\n\tvar offsetNextI, offsetNextJ;\n\tvar offsetPrevINextJ;\n\tvar channels, nextChannels;\n\tvar indexedPixels = new Uint8Array( width * height );\n\n\tfor(var j = 0; j < height; j++) {\n\t\tfor(var i = 0; i < width; i++) {\n\n\t\t\tr = colorClamp(inPixels[offset++]);\n\t\t\tg = colorClamp(inPixels[offset++]);\n\t\t\tb = colorClamp(inPixels[offset++]);\n\n\t\t\tvar colorIndex = getClosestPaletteColorIndex(r, g, b, palette, paletteLength);\n\t\t\tvar paletteColor = palette[colorIndex];\n\t\t\tvar closestColor = paletteColor[3];\n\n\t\t\t// We are done with finding the best value for this pixel\n\t\t\tindexedPixels[indexedOffset] = colorIndex;\n\n\t\t\t// Now find difference between assigned value and original color\n\t\t\t// and propagate that error forward\n\t\t\tvar errorR = r - paletteColor[0];\n\t\t\tvar errorG = g - paletteColor[1];\n\t\t\tvar errorB = b - paletteColor[2];\n\n\t\t\tif(i < widthLimit) {\n\n\t\t\t\toffsetNextI = offset + 1;\n\n\t\t\t\tinPixels[offsetNextI++] += (errorR * 7) >> 4;\n\t\t\t\tinPixels[offsetNextI++] += (errorG * 7) >> 4;\n\t\t\t\tinPixels[offsetNextI++] += (errorB * 7) >> 4;\n\n\t\t\t}\n\n\n\t\t\tif(j < heightLimit) {\n\n\t\t\t\tif(i > 0) {\n\n\t\t\t\t\toffsetPrevINextJ = offset - 1 + width;\n\n\t\t\t\t\tinPixels[offsetPrevINextJ++] += (errorR * 3) >> 4;\n\t\t\t\t\tinPixels[offsetPrevINextJ++] += (errorG * 3) >> 4;\n\t\t\t\t\tinPixels[offsetPrevINextJ++] += (errorB * 3) >> 4;\n\n\t\t\t\t}\n\n\t\t\t\toffsetNextJ = offset + width;\n\n\t\t\t\tinPixels[offsetNextJ++] += (errorR * 5) >> 4;\n\t\t\t\tinPixels[offsetNextJ++] += (errorG * 5) >> 4;\n\t\t\t\tinPixels[offsetNextJ++] += (errorB * 5) >> 4;\n\n\n\t\t\t\tif(i < widthLimit) {\n\n\t\t\t\t\tinPixels[offsetNextJ++] += errorR >> 4;\n\t\t\t\t\tinPixels[offsetNextJ++] += errorG >> 4;\n\t\t\t\t\tinPixels[offsetNextJ++] += errorB >> 4;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tindexedOffset++;\n\t\t}\n\t}\n\n\treturn indexedPixels;\n}\n\nmodule.exports = {\n\tBayer: BayerDithering,\n\tClosest: ClosestDithering,\n\tFloydSteinberg: FloydSteinberg\n};\n\n\n},{}],2:[function(require,module,exports){\nvar NeuQuant = require(\'./lib/NeuQuant\');\nvar Dithering = require(\'node-dithering\');\n\nfunction channelizePalette( palette ) {\n    var channelizedPalette = [];\n\n    for(var i = 0; i < palette.length; i++) {\n        var color = palette[i];\n\n        var r = (color & 0xFF0000) >> 16;\n        var g = (color & 0x00FF00) >>  8;\n        var b = (color & 0x0000FF);\n\n        channelizedPalette.push([ r, g, b, color ]);\n    }\n\n    return channelizedPalette;\n\n}\n\n\nfunction dataToRGB( data, width, height ) {\n    var i = 0;\n    var length = width * height * 4;\n    var rgb = [];\n\n    while(i < length) {\n        rgb.push( data[i++] );\n        rgb.push( data[i++] );\n        rgb.push( data[i++] );\n        i++; // for the alpha channel which we don\'t care about\n    }\n\n    return rgb;\n}\n\n\nfunction componentizedPaletteToArray(paletteRGB) {\n\n    var paletteArray = [];\n\n    for(var i = 0; i < paletteRGB.length; i += 3) {\n        var r = paletteRGB[ i ];\n        var g = paletteRGB[ i + 1 ];\n        var b = paletteRGB[ i + 2 ];\n        paletteArray.push(r << 16 | g << 8 | b);\n    }\n\n    return paletteArray;\n}\n\n\n// This is the "traditional" Animated_GIF style of going from RGBA to indexed color frames\nfunction processFrameWithQuantizer(imageData, width, height, sampleInterval) {\n\n    var rgbComponents = dataToRGB( imageData, width, height );\n    var nq = new NeuQuant(rgbComponents, rgbComponents.length, sampleInterval);\n    var paletteRGB = nq.process();\n    var paletteArray = new Uint32Array(componentizedPaletteToArray(paletteRGB));\n\n    var numberPixels = width * height;\n    var indexedPixels = new Uint8Array(numberPixels);\n\n    var k = 0;\n    for(var i = 0; i < numberPixels; i++) {\n        r = rgbComponents[k++];\n        g = rgbComponents[k++];\n        b = rgbComponents[k++];\n        indexedPixels[i] = nq.map(r, g, b);\n    }\n\n    return {\n        pixels: indexedPixels,\n        palette: paletteArray\n    };\n\n}\n\n\n// And this is a version that uses dithering against of quantizing\n// It can also use a custom palette if provided, or will build one otherwise\nfunction processFrameWithDithering(imageData, width, height, ditheringType, palette) {\n\n    // Extract component values from data\n    var rgbComponents = dataToRGB( imageData, width, height );\n\n\n    // Build palette if none provided\n    if(palette === null) {\n\n        var nq = new NeuQuant(rgbComponents, rgbComponents.length, 16);\n        var paletteRGB = nq.process();\n        palette = componentizedPaletteToArray(paletteRGB);\n\n    }\n\n    var paletteArray = new Uint32Array( palette );\n    var paletteChannels = channelizePalette( palette );\n\n    // Convert RGB image to indexed image\n    var ditheringFunction;\n\n    if(ditheringType === \'closest\') {\n        ditheringFunction = Dithering.Closest;\n    } else if(ditheringType === \'floyd\') {\n        ditheringFunction = Dithering.FloydSteinberg;\n    } else {\n        ditheringFunction = Dithering.Bayer;\n    }\n\n    pixels = ditheringFunction(rgbComponents, width, height, paletteChannels);\n\n    return ({\n        pixels: pixels,\n        palette: paletteArray\n    });\n\n}\n\n\n// ~~~\n\nfunction run(frame) {\n    var width = frame.width;\n    var height = frame.height;\n    var imageData = frame.data;\n    var dithering = frame.dithering;\n    var palette = frame.palette;\n    var sampleInterval = frame.sampleInterval;\n\n    if(dithering) {\n        return processFrameWithDithering(imageData, width, height, dithering, palette);\n    } else {\n        return processFrameWithQuantizer(imageData, width, height, sampleInterval);\n    }\n\n}\n\n\nself.onmessage = function(ev) {\n    var data = ev.data;\n    var response = run(data);\n    postMessage(response);\n};\n\n},{"./lib/NeuQuant":3,"node-dithering":1}],3:[function(require,module,exports){\n/*\n* NeuQuant Neural-Net Quantization Algorithm\n* ------------------------------------------\n*\n* Copyright (c) 1994 Anthony Dekker\n*\n* NEUQUANT Neural-Net quantization algorithm by Anthony Dekker, 1994. See\n* "Kohonen neural networks for optimal colour quantization" in "Network:\n* Computation in Neural Systems" Vol. 5 (1994) pp 351-367. for a discussion of\n* the algorithm.\n*\n* Any party obtaining a copy of these files from the author, directly or\n* indirectly, is granted, free of charge, a full and unrestricted irrevocable,\n* world-wide, paid up, royalty-free, nonexclusive right and license to deal in\n* this software and documentation files (the "Software"), including without\n* limitation the rights to use, copy, modify, merge, publish, distribute,\n* sublicense, and/or sell copies of the Software, and to permit persons who\n* receive copies from any such party to do so, with the only requirement being\n* that this copyright notice remain intact.\n*/\n\n/*\n* This class handles Neural-Net quantization algorithm\n* @author Kevin Weiner (original Java version - kweiner@fmsware.com)\n* @author Thibault Imbert (AS3 version - bytearray.org)\n* @version 0.1 AS3 implementation\n* @version 0.2 JS->AS3 "translation" by antimatter15\n* @version 0.3 JS clean up + using modern JS idioms by sole - http://soledadpenades.com\n* Also implement fix in color conversion described at http://stackoverflow.com/questions/16371712/neuquant-js-javascript-color-quantization-hidden-bug-in-js-conversion\n*/\n\nmodule.exports = function NeuQuant() {\n\n    var netsize = 256; // number of colours used\n\n    // four primes near 500 - assume no image has a length so large\n    // that it is divisible by all four primes\n    var prime1 = 499;\n    var prime2 = 491;\n    var prime3 = 487;\n    var prime4 = 503;\n\n    // minimum size for input image\n    var minpicturebytes = (3 * prime4);\n\n    // Network Definitions\n\n    var maxnetpos = (netsize - 1);\n    var netbiasshift = 4; // bias for colour values\n    var ncycles = 100; // no. of learning cycles\n\n    // defs for freq and bias\n    var intbiasshift = 16; // bias for fractions\n    var intbias = (1 << intbiasshift);\n    var gammashift = 10; // gamma = 1024\n    var gamma = (1 << gammashift);\n    var betashift = 10;\n    var beta = (intbias >> betashift); // beta = 1/1024\n    var betagamma = (intbias << (gammashift - betashift));\n\n    // defs for decreasing radius factor\n    // For 256 colors, radius starts at 32.0 biased by 6 bits\n    // and decreases by a factor of 1/30 each cycle\n    var initrad = (netsize >> 3);\n    var radiusbiasshift = 6;\n    var radiusbias = (1 << radiusbiasshift);\n    var initradius = (initrad * radiusbias);\n    var radiusdec = 30;\n\n    // defs for decreasing alpha factor\n    // Alpha starts at 1.0 biased by 10 bits\n    var alphabiasshift = 10;\n    var initalpha = (1 << alphabiasshift);\n    var alphadec;\n\n    // radbias and alpharadbias used for radpower calculation\n    var radbiasshift = 8;\n    var radbias = (1 << radbiasshift);\n    var alpharadbshift = (alphabiasshift + radbiasshift);\n    var alpharadbias = (1 << alpharadbshift);\n\n\n    // Input image\n    var thepicture;\n    // Height * Width * 3\n    var lengthcount;\n    // Sampling factor 1..30\n    var samplefac;\n\n    // The network itself\n    var network;\n    var netindex = [];\n\n    // for network lookup - really 256\n    var bias = [];\n\n    // bias and freq arrays for learning\n    var freq = [];\n    var radpower = [];\n\n    function NeuQuantConstructor(thepic, len, sample) {\n\n        var i;\n        var p;\n\n        thepicture = thepic;\n        lengthcount = len;\n        samplefac = sample;\n\n        network = new Array(netsize);\n\n        for (i = 0; i < netsize; i++) {\n            network[i] = new Array(4);\n            p = network[i];\n            p[0] = p[1] = p[2] = ((i << (netbiasshift + 8)) / netsize) | 0;\n            freq[i] = (intbias / netsize) | 0; // 1 / netsize\n            bias[i] = 0;\n        }\n\n    }\n\n    function colorMap() {\n        var map = [];\n        var index = new Array(netsize);\n        for (var i = 0; i < netsize; i++)\n            index[network[i][3]] = i;\n        var k = 0;\n        for (var l = 0; l < netsize; l++) {\n            var j = index[l];\n            map[k++] = (network[j][0]);\n            map[k++] = (network[j][1]);\n            map[k++] = (network[j][2]);\n        }\n        return map;\n    }\n\n    // Insertion sort of network and building of netindex[0..255]\n    // (to do after unbias)\n    function inxbuild() {\n        var i;\n        var j;\n        var smallpos;\n        var smallval;\n        var p;\n        var q;\n        var previouscol;\n        var startpos;\n\n        previouscol = 0;\n        startpos = 0;\n\n        for (i = 0; i < netsize; i++)\n        {\n\n            p = network[i];\n            smallpos = i;\n            smallval = p[1]; // index on g\n            // find smallest in i..netsize-1\n            for (j = i + 1; j < netsize; j++) {\n\n                q = network[j];\n\n                if (q[1] < smallval) { // index on g\n                    smallpos = j;\n                    smallval = q[1]; // index on g\n                }\n            }\n\n            q = network[smallpos];\n\n            // swap p (i) and q (smallpos) entries\n            if (i != smallpos) {\n                j = q[0];\n                q[0] = p[0];\n                p[0] = j;\n                j = q[1];\n                q[1] = p[1];\n                p[1] = j;\n                j = q[2];\n                q[2] = p[2];\n                p[2] = j;\n                j = q[3];\n                q[3] = p[3];\n                p[3] = j;\n            }\n\n            // smallval entry is now in position i\n            if (smallval != previouscol) {\n\n                netindex[previouscol] = (startpos + i) >> 1;\n\n                for (j = previouscol + 1; j < smallval; j++) {\n                    netindex[j] = i;\n                }\n\n                previouscol = smallval;\n                startpos = i;\n\n            }\n\n        }\n\n        netindex[previouscol] = (startpos + maxnetpos) >> 1;\n        for (j = previouscol + 1; j < 256; j++) {\n            netindex[j] = maxnetpos; // really 256\n        }\n\n    }\n\n\n    // Main Learning Loop\n\n    function learn() {\n        var i;\n        var j;\n        var b;\n        var g;\n        var r;\n        var radius;\n        var rad;\n        var alpha;\n        var step;\n        var delta;\n        var samplepixels;\n        var p;\n        var pix;\n        var lim;\n\n        if (lengthcount < minpicturebytes) {\n            samplefac = 1;\n        }\n\n        alphadec = 30 + ((samplefac - 1) / 3);\n        p = thepicture;\n        pix = 0;\n        lim = lengthcount;\n        samplepixels = lengthcount / (3 * samplefac);\n        delta = (samplepixels / ncycles) | 0;\n        alpha = initalpha;\n        radius = initradius;\n\n        rad = radius >> radiusbiasshift;\n        if (rad <= 1) {\n            rad = 0;\n        }\n\n        for (i = 0; i < rad; i++) {\n            radpower[i] = alpha * (((rad * rad - i * i) * radbias) / (rad * rad));\n        }\n\n\n        if (lengthcount < minpicturebytes) {\n            step = 3;\n        } else if ((lengthcount % prime1) !== 0) {\n            step = 3 * prime1;\n        } else {\n\n            if ((lengthcount % prime2) !== 0) {\n                step = 3 * prime2;\n            } else {\n                if ((lengthcount % prime3) !== 0) {\n                    step = 3 * prime3;\n                } else {\n                    step = 3 * prime4;\n                }\n            }\n\n        }\n\n        i = 0;\n\n        while (i < samplepixels) {\n\n            b = (p[pix + 0] & 0xff) << netbiasshift;\n            g = (p[pix + 1] & 0xff) << netbiasshift;\n            r = (p[pix + 2] & 0xff) << netbiasshift;\n            j = contest(b, g, r);\n\n            altersingle(alpha, j, b, g, r);\n\n            if (rad !== 0) {\n                // Alter neighbours\n                alterneigh(rad, j, b, g, r);\n            }\n\n            pix += step;\n\n            if (pix >= lim) {\n                pix -= lengthcount;\n            }\n\n            i++;\n\n            if (delta === 0) {\n                delta = 1;\n            }\n\n            if (i % delta === 0) {\n                alpha -= alpha / alphadec;\n                radius -= radius / radiusdec;\n                rad = radius >> radiusbiasshift;\n\n                if (rad <= 1) {\n                    rad = 0;\n                }\n\n                for (j = 0; j < rad; j++) {\n                    radpower[j] = alpha * (((rad * rad - j * j) * radbias) / (rad * rad));\n                }\n\n            }\n\n        }\n\n    }\n\n    // Search for BGR values 0..255 (after net is unbiased) and return colour index\n    function map(b, g, r) {\n        var i;\n        var j;\n        var dist;\n        var a;\n        var bestd;\n        var p;\n        var best;\n\n        // Biggest possible distance is 256 * 3\n        bestd = 1000;\n        best = -1;\n        i = netindex[g]; // index on g\n        j = i - 1; // start at netindex[g] and work outwards\n\n        while ((i < netsize) || (j >= 0)) {\n\n            if (i < netsize) {\n\n                p = network[i];\n\n                dist = p[1] - g; // inx key\n\n                if (dist >= bestd) {\n                    i = netsize; // stop iter\n                } else {\n\n                    i++;\n\n                    if (dist < 0) {\n                        dist = -dist;\n                    }\n\n                    a = p[0] - b;\n\n                    if (a < 0) {\n                        a = -a;\n                    }\n\n                    dist += a;\n\n                    if (dist < bestd) {\n                        a = p[2] - r;\n\n                        if (a < 0) {\n                            a = -a;\n                        }\n\n                        dist += a;\n\n                        if (dist < bestd) {\n                            bestd = dist;\n                            best = p[3];\n                        }\n                    }\n\n                }\n\n            }\n\n            if (j >= 0) {\n\n                p = network[j];\n\n                dist = g - p[1]; // inx key - reverse dif\n\n                if (dist >= bestd) {\n                    j = -1; // stop iter\n                } else {\n\n                    j--;\n                    if (dist < 0) {\n                        dist = -dist;\n                    }\n                    a = p[0] - b;\n                    if (a < 0) {\n                        a = -a;\n                    }\n                    dist += a;\n\n                    if (dist < bestd) {\n                        a = p[2] - r;\n                        if (a < 0) {\n                            a = -a;\n                        }\n                        dist += a;\n                        if (dist < bestd) {\n                            bestd = dist;\n                            best = p[3];\n                        }\n                    }\n\n                }\n\n            }\n\n        }\n\n        return (best);\n\n    }\n\n    function process() {\n        learn();\n        unbiasnet();\n        inxbuild();\n        return colorMap();\n    }\n\n    // Unbias network to give byte values 0..255 and record position i\n    // to prepare for sort\n    function unbiasnet() {\n        var i;\n        var j;\n\n        for (i = 0; i < netsize; i++) {\n            network[i][0] >>= netbiasshift;\n            network[i][1] >>= netbiasshift;\n            network[i][2] >>= netbiasshift;\n            network[i][3] = i; // record colour no\n        }\n    }\n\n    // Move adjacent neurons by precomputed alpha*(1-((i-j)^2/[r]^2))\n    // in radpower[|i-j|]\n    function alterneigh(rad, i, b, g, r) {\n\n        var j;\n        var k;\n        var lo;\n        var hi;\n        var a;\n        var m;\n\n        var p;\n\n        lo = i - rad;\n        if (lo < -1) {\n            lo = -1;\n        }\n\n        hi = i + rad;\n\n        if (hi > netsize) {\n            hi = netsize;\n        }\n\n        j = i + 1;\n        k = i - 1;\n        m = 1;\n\n        while ((j < hi) || (k > lo)) {\n\n            a = radpower[m++];\n\n            if (j < hi) {\n\n                p = network[j++];\n\n                try {\n\n                    p[0] -= ((a * (p[0] - b)) / alpharadbias) | 0;\n                    p[1] -= ((a * (p[1] - g)) / alpharadbias) | 0;\n                    p[2] -= ((a * (p[2] - r)) / alpharadbias) | 0;\n\n                } catch (e) {}\n\n            }\n\n            if (k > lo) {\n\n                p = network[k--];\n\n                try {\n\n                    p[0] -= ((a * (p[0] - b)) / alpharadbias) | 0;\n                    p[1] -= ((a * (p[1] - g)) / alpharadbias) | 0;\n                    p[2] -= ((a * (p[2] - r)) / alpharadbias) | 0;\n\n                } catch (e) {}\n\n            }\n\n        }\n\n    }\n\n\n    // Move neuron i towards biased (b,g,r) by factor alpha\n    function altersingle(alpha, i, b, g, r) {\n\n        // alter hit neuron\n        var n = network[i];\n        var alphaMult = alpha / initalpha;\n        n[0] -= ((alphaMult * (n[0] - b))) | 0;\n        n[1] -= ((alphaMult * (n[1] - g))) | 0;\n        n[2] -= ((alphaMult * (n[2] - r))) | 0;\n\n    }\n\n    // Search for biased BGR values\n    function contest(b, g, r) {\n\n        // finds closest neuron (min dist) and updates freq\n        // finds best neuron (min dist-bias) and returns position\n        // for frequently chosen neurons, freq[i] is high and bias[i] is negative\n        // bias[i] = gamma*((1/netsize)-freq[i])\n\n        var i;\n        var dist;\n        var a;\n        var biasdist;\n        var betafreq;\n        var bestpos;\n        var bestbiaspos;\n        var bestd;\n        var bestbiasd;\n        var n;\n\n        bestd = ~(1 << 31);\n        bestbiasd = bestd;\n        bestpos = -1;\n        bestbiaspos = bestpos;\n\n        for (i = 0; i < netsize; i++) {\n\n            n = network[i];\n            dist = n[0] - b;\n\n            if (dist < 0) {\n                dist = -dist;\n            }\n\n            a = n[1] - g;\n\n            if (a < 0) {\n                a = -a;\n            }\n\n            dist += a;\n\n            a = n[2] - r;\n\n            if (a < 0) {\n                a = -a;\n            }\n\n            dist += a;\n\n            if (dist < bestd) {\n                bestd = dist;\n                bestpos = i;\n            }\n\n            biasdist = dist - ((bias[i]) >> (intbiasshift - netbiasshift));\n\n            if (biasdist < bestbiasd) {\n                bestbiasd = biasdist;\n                bestbiaspos = i;\n            }\n\n            betafreq = (freq[i] >> betashift);\n            freq[i] -= betafreq;\n            bias[i] += (betafreq << gammashift);\n\n        }\n\n        freq[bestpos] += beta;\n        bias[bestpos] -= betagamma;\n        return (bestbiaspos);\n\n    }\n\n    NeuQuantConstructor.apply(this, arguments);\n\n    var exports = {};\n    exports.map = map;\n    exports.process = process;\n\n    return exports;\n}\n\n},{}]},{},[2])'],{type:"text/javascript"})));v.push(X),W.push(X)}var S=function(){for(var e=[],t=0;t<256;t++)e[t]=String.fromCharCode(t);return function(t){for(var i=t.length,n="",a=0;a<i;a++)n+=e[t[a]];return n}}();this.setSize=function(e,t){d=e,u=t,(b=document.createElement("canvas")).width=e,b.height=t,p=b.getContext("2d")},this.setDelay=function(e){Z=.1*e},this.setRepeat=function(e){g=e},this.addFrame=function(e){null===p&&this.setSize(d,u),p.drawImage(e,0,0,d,u);var t=p.getImageData(0,0,d,u);this.addFrameImageData(t)},this.addFrameImageData=function(e){var t=(e.length,new Uint8Array(e.data));I.push({data:t,width:e.width,height:e.height,palette:m,dithering:h,done:!1,beingProcessed:!1,position:I.length})},this.onRenderProgress=function(e){f=e},this.isRendering=function(){return G},this.getBase64GIF=function(e){i((function(t){var i=S(t),n="data:image/gif;base64,"+btoa(i);e(n)}))},this.getBlobGIF=function(e){i((function(t){var i=new Uint8Array(t),n=new Blob([i],{type:"image/gif"});e(n)}))},this.destroy=function(){v.forEach((function(e){e.terminate()}))}}},{omggif:1}]},{},[2])(2)}))}},E={};function Y(e){var t=E[e];if(void 0!==t)return t.exports;var i=E[e]={id:e,loaded:!1,exports:{}};return N[e](i,i.exports,Y),i.loaded=!0,i.exports}Y.amdO={},Y.d=function(e,t){for(var i in t)Y.o(t,i)&&!Y.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},Y.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(N){if("object"==typeof window)return window}}(),Y.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},Y.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var F={};!function(){Y.d(F,{l:function(){return Ke}});var e={Mode:{Front:0,Back:1,Full:2},CaptureMode:{SingleSide:0,DoubleSide:1},TrackStatus:{ChangeState:0,Tap:1,DocumentBorder:2,AccessibilityData:3,Diagnostic:4},ModeStr:["Front","Back","Full"],CaptureSensibilityStr:["Low","Normal","High","Auto"],SimpleModeStates:{InfoFront:0,PreviewFront:1,InfoBack:2,PreviewBack:3},DocumentType:{IDCard:0,Passport:1,DriversLicense:2,ForeignCard:3,CreditCard:4,Custom:5},ScanMode:{Generic:0,Specific:1,Search:2},SimpleModeStatesStr:["InfoFront","PreviewFront","InfoBack","PreviewBack"],Version:"4.1.1"},t=Y(871),i=function(){function e(t,i,n,a,l,s,r){X(this,e);var c="";this.status=0,this.logDebug=!1,this.eventStatus=a,this.caller=n,this.baseURL=t,i.length>0&&(c=i+"."),this.widgetLoaded=0,this.languageCustomLoaded=0,this.languageDefaultLoaded=0,this.urlWidget=t+"/widget.xml",this.urlLanguageCustom=t+"/strings/strings."+c+"xml",this.resourceDict={},this.dpiList=l,this.browserDpi=s,this.scaleFactor=r;for(var o=163*s*r,d=this.dpiList.length-1,u=0;u<this.dpiList.length;u++)if(this.dpiList[u]>o){d=u;break}this.dpi=this.dpiList[d],this.imageScale=163/this.dpi,this.xmlHttpWidget=new XMLHttpRequest,this.xmlHttpWidget.rm=this,this.xmlHttpWidget.onreadystatechange=function(e){if(4==e.target.readyState&&200==e.target.status){var t=new DOMParser;e.target.rm.widgetLoaded=1,e.target.rm.xmlDoc=t.parseFromString(e.target.responseText,"text/xml")}else 4==e.target.readyState&&200!=e.target.status&&(e.target.rm.widgetLoaded=-1);e.target.rm.readyEvent(e)},this.xmlHttpWidget.open("GET",this.urlWidget),this.xmlHttpWidget.send(null),this.xmlHttpLanguageCustom=new XMLHttpRequest,this.xmlHttpLanguageCustom.rm=this,this.xmlHttpLanguageCustom.onreadystatechange=function(e){4==e.target.readyState&&200==e.target.status?e.target.rm.languageCustomLoaded=1:4==e.target.readyState&&200!=e.target.status&&(e.target.rm.languageCustomLoaded=-1),e.target.rm.readyEvent(e)},this.xmlHttpLanguageCustom.open("GET",this.urlLanguageCustom),this.xmlHttpLanguageCustom.send(null)}return C(e,[{key:"readyEvent",value:function(e){if(0!==e.target.rm.widgetLoaded&&(0!==e.target.rm.languageCustomLoaded||0!==e.target.rm.languageDefaultLoaded)){if(-1==e.target.rm.widgetLoaded)e.target.rm.status=-1;else if(1==e.target.rm.languageCustomLoaded){var t=e.target.rm.xmlHttpLanguageCustom.responseText,i=new DOMParser;e.target.rm.xmlLang=i.parseFromString(t,"text/xml"),e.target.rm.status=1}else 1==e.target.rm.languageDefaultLoaded?(t=e.target.rm.xmlHttpLanguageDefault.responseText,i=new DOMParser,e.target.rm.xmlLang=i.parseFromString(t,"text/xml"),e.target.rm.status=1):e.target.rm.status=-1;if(1==e.target.rm.status){for(var n,a={},l=e.target.rm.xmlDoc.querySelectorAll("[font]"),s=0;s<l.length;s++)(n=l[s].getAttribute("font")).length>0&&(a[n]=n);if(e.target.rm.fontRequestVector=[],null==document.getElementById("FPhi_Widget_style")){var r,c=document.createElement("style");for(r in c.id="FPhi_Widget_style",a){var o=e.target.rm.getResourceUrlBase(a[r]),d=a[r],u=new XMLHttpRequest;u.open("GET",o,!1),u.send(),200==u.status&&c.appendChild(document.createTextNode("@font-face { font-family: '"+d+"'; src: url('"+o+"'); }"))}document.head.appendChild(c)}e.target.rm.eventStatus(e.target.rm.caller,!0)}else e.target.rm.eventStatus(e.target.rm.caller,!1)}}},{key:"getElement",value:function(e,t,i){if("facephi-widget-conf"==e)return this.xmlDoc.getElementsByTagName("facephi-widget-conf")[0];var n="_portrait";i&&(n="_landscape");var a=this.xmlDoc.querySelector("[id="+e+n+"]");if(null!=a&&null!=a||(a=this.xmlDoc.querySelector("[id="+e+"]")),this.logDebug&&console.log(a),null!=a){var l=a.querySelector("[id="+t+"]");return this.logDebug&&console.log(l),null==l?void console.log("ResourceManager::getElement Error. elementId="+t+" undefined. Please verify resource's bundle."):l}console.log("ResourceManager::getElement Error. viewId="+e+" undefined. Please verify resource's bundle.")}},{key:"getElements",value:function(e,t){var i="_portrait";t&&(i="_landscape");var n=this.xmlDoc.querySelector("[id="+e+i+"]");null!=n&&null!=n||(n=this.xmlDoc.querySelector("[id="+e+"]"));var a=[];if(n)for(var l=0;l<n.childNodes.length;l++)if(n.childNodes[l].nodeType==Node.ELEMENT_NODE){var s=null;void 0!==n.childNodes[l].attributes.mode&&(s=n.childNodes[l].attributes.mode.value),a.push({type:n.childNodes[l].nodeName,id:n.childNodes[l].attributes.id.value,mode:s})}return 0==a.length&&console.log("FPhi.ResourceManager: No elements for view="+e),a}},{key:"isAttributeAvailable",value:function(e,t,i,n){var a=null;if("facephi-widget-conf"==e)a=this.xmlDoc.getElementsByTagName("facephi-widget-conf")[0];else{var l="_portrait";i&&(l="_landscape");var s=this.xmlDoc.querySelector("[id="+e+l+"]");if(null!=s&&null!=s||(s=this.xmlDoc.querySelector("[id="+e+"]")),null!=s){var r=s.querySelector("[id="+t+"]");null!=r&&(a=r)}}if(null==a||null==a)return!1;var c=a.getAttribute(n);return null!=c&&null!=c}},{key:"getSetupColor",value:function(e,t,i,n){var a=this.getElement(e,t,i);if(null==a||null==a)return null;var l,s,r,c,o=a.getAttribute(n);return null==o||null==o?null:(9==o.length&&(l=parseInt(o.substring(1,3),16),s=parseInt(o.substring(3,5),16),r=parseInt(o.substring(5,7),16),c=parseInt(o.substring(7,9),16),o="rgba("+l+", "+s+", "+r+", "+(c/=255).toFixed(3)+")"),o)}},{key:"getSetupColorWithAlpha",value:function(e,t,i,n,a){var l=this.getElement(e,t,i).getAttribute(n);return"rgba("+parseInt(l.substring(1,3),16)+", "+parseInt(l.substring(3,5),16)+", "+parseInt(l.substring(5,7),16)+", "+a.toFixed(3)+")"}},{key:"getSetupFloat",value:function(e,t,i,n){var a=this.getElement(e,t,i).getAttribute(n);return parseFloat(a)}},{key:"getSetupAlign",value:function(e,t,i,n){return this.getElement(e,t,i).getAttribute(n)}},{key:"getSetupResourceId",value:function(e,t,i,n){var a=this.getElement(e,t,i).getAttribute(n),l=a.split(",");return l&&l.length>1?l[Math.floor(Math.random()*l.length)].trim():a}},{key:"getSetupTextId",value:function(e,t,i,n){return this.getElement(e,t,i).getAttribute(n)}},{key:"getSetupNodeType",value:function(e,t,i){return this.getElement(e,t,i).getAttribute("content_type")}},{key:"getResourceUrl",value:function(e){return this.baseURL+"/resources/"+this.dpi+"dpi/"+e}},{key:"getResourceUrlBase",value:function(e){return this.baseURL+"/resources/"+this.dpiList[0]+"dpi/"+e}},{key:"getImageScale",value:function(){return this.imageScale}},{key:"getImage",value:function(e){if(!(e in this.resourceDict)){var t=this.getResourceUrl(e),i=document.createElement("img");i.src=t,this.resourceDict[e]=i}return this.resourceDict[e]}},{key:"translate",value:function(e){var t=e,i=this.xmlLang.querySelector("[id="+e+"]");return this.logDebug&&console.log(i),null!=i&&(t=i.textContent),t}}],[{key:"httpGet",value:function(e,t){var i=new XMLHttpRequest;return i.onreadystatechange=t,i.open("GET",e),i.send(null),200!=i.status?"":i.responseText}}]),e}();if(!n)var n={};n.SelphID=e;var a=function(e){W(i,e);var t=V(i);function i(e){var n;return X(this,i),(n=t.call(this,e)).mode=e.mode,n.preview=e.preview,n.canvasSizeFactor=1,n.fontSizeFactor=1,n.enableButtonCamera=e.enableButtonCamera,n.documentAspectRatio=e.documentAspectRatio,n.documentRect={x:0,y:0,width:100*n.documentAspectRatio,height:100},n.searchingTextMode=1,n.searchingTextModeTime=0,n.cameraCount=0,n}return C(i,[{key:"setCanvasSize",value:function(e,t){this.width=e,this.height=t,this.landscape=this.width>=this.height,this.statusHeight=50,this.rm.isAttributeAvailable("facephi-widget-conf","facephi-widget-conf",this.landscape,"status_height")&&(this.statusHeight=this.rm.getSetupFloat("facephi-widget-conf","facephi-widget-conf",this.landscape,"status_height")),this.documentPadding=30,this.buttonWidth=216,this.buttonHeight=55}},{key:"fromScreenToCamera",value:function(e,t,i,n,a,l,s){var r=this.getCameraRect(e,t,i,n,a),c=s.x-r.x,o=s.y-r.y,d=s.width,u=s.height,h={x:c/r.width*t,y:o/r.height*i,width:d/r.width*t,height:u/r.height*i};return 1==l&&(h.x=t-h.x-h.width),h}},{key:"getCameraRect",value:function(e,t,i,n,a,l){var s=this.scaleRect({width:t,height:i},{x:0,y:0,width:n,height:a});return s.visible=!0,"UCTutorial1"!=l&&"UCTutorial2"!=l&&"UCTutorial3"!=l&&"UCPreview"!=l&&"Error"!=l||(s.visible=!1),s}},{key:"getDocRectScreenSpace",value:function(e,t,i){var n={x:this.documentPadding,y:this.statusHeight+this.documentPadding,width:e-2*this.documentPadding,height:t-this.statusHeight-2*this.documentPadding},a=this.scaleRect(this.documentRect,n,"inner");return this.cameraCount>1&&a.x+a.width>e-60&&a.y+a.height>t-60&&(n={x:this.documentPadding,y:this.statusHeight+this.documentPadding,width:e-60-this.documentPadding,height:t-this.statusHeight-2*this.documentPadding},a=this.scaleRect(this.documentRect,n,"inner")),i&&(a.x+=i,a.y+=i,a.width-=2*i,a.height-=2*i),a}},{key:"getDocRect",value:function(e,t,i,n,a,l,s){var r=this.getDocRectScreenSpace(n,a,s);return this.fromScreenToCamera(e,t,i,n,a,l,r)}},{key:"getResourceIdForState",value:function(e){return"UCWaitingFaceStart"==e?"StartExtractor":"UCCapture"==e||"UCCaptureCameraSwitch"==e||"UCCaptureTip"==e?"UCCapture":"UCCaptureStatus"==e?"UCCaptureStatus":"UCPreview"==e?"UCPreview":"UCTimeoutPreview"==e?"UCTimeoutPreview":"UCFlip"==e?"UCFlip":"UCTutorial1"==e?"UCTutorial1":"UCTutorial2"==e?"UCTutorial2":"UCTutorial3"==e?"UCTutorial3":"UCWaitRecording"==e?"WaitRecording":"UCError"==e?"Error":"InfoFront"==e||"PreviewFront"==e||"InfoBack"==e||"PreviewBack"==e?e:null}},{key:"onMouseMove",value:function(e,t,i,n,a){e.style.cursor="button"==a||"buttonImage"==a?"pointer":"default"}},{key:"draw",value:function(e,t,i,n,a,l,s,r,c){if(e.imageSmoothingEnabled=!0,"background"==a)this.drawBackground(e,t,i,n);else if("clearRect"==a)this.clearRect(e,t,i,n);else if("imageProc"==a)this.drawImageProc(e,t,i,n,l,s,r,c);else if("button"==a)this.drawButton(e,t,i,n);else if("buttonGradient"==a)this.drawButtonGradient(e,t,i,n);else if("buttonImage"==a)this.drawButtonImage(e,t,i,n,l,s,r,c);else if("image"==a)this.drawImage(e,t,i,n,l,s,r,c);else if("text"==a)this.drawText(e,t,i,n,l,s,r,c);else if("documentBorder"==a)this.drawDocumentBorder(e,t,i,n,l,s,r,c);else if("documentFlipper"==a)this.drawDocumentFlipper(e,t,i,n,l,s,r,c);else if("video"==a)null!=c.player&&e.drawImage(c.player,t.x,t.y,t.width,t.height);else if("animation"==a){var o=0;"UCLivenessMoveDetecting"==c.state&&(o=c.livenessMoveDirection),this.drawAnimation(e,t,i,n,l,s,r,c,o)}else if("initialTip"==a)this.drawInitialTip(e,t,i,n,l,s,r,c);else if("progressRecord"==n){e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"background_color"),e.fillRect(t.x,t.y,t.width,t.height),e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"progress_color");var d=.2*t.width,u=s%2/1.6,h=t.width*u-d,m=h+d;h<0&&(h=0),h>t.width&&(h=t.width),m>t.width&&(m=t.width),e.fillRect(t.x+h,t.y,m-h,t.height)}else"rectangle"==a&&(e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"color"),e.fillRect(t.x,t.y,t.width,t.height))}},{key:"getLayout",value:function(e,t,i,n,a,l,s,r){if("document"==i)return{x:0,y:0,width:this.width,height:this.height};if("documentFlipper"==i)return{x:0,y:0,width:this.width,height:this.height};if("logo"==i){var c=this.rm.getSetupResourceId(t,i,this.landscape,"value"),o=this.rm.getImage(c),d=this.canvasSizeFactor*this.rm.getImageScale(),u=o.width*d,h=o.height*d;return{x:this.width/2-u/2,y:this.height-h-16,width:u,height:h}}if("background"==i)return{x:0,y:0,width:this.width,height:this.height};if("preview"==i||"previewFail"==i){var m,b=0;if("UCPreview"==r.state||"PreviewFront"==r.state||"PreviewBack"==r.state){this.landscape&&(b=64);var p={x:this.documentPadding,y:this.statusHeight+this.documentPadding,width:this.width-2*this.documentPadding,height:this.height-this.statusHeight-2*this.documentPadding-b};m=this.scaleRect(this.documentRect,p,"inner")}else m=this.getDocRectScreenSpace(this.width,this.height,0);if(("UCPreview"==r.state||"PreviewFront"==r.state||"PreviewBack"==r.state)&&0==this.landscape){var g=this.height-50-100-39-12;m.y=50+g/2-m.height/2}return m}if("button_ok"==i){if(this.landscape){var Z=300;return this.width/2<364&&(Z=this.width/2-16-16),{x:this.width-Z-16,y:this.height-14-50,width:Z,height:50}}var I={x:this.documentPadding,y:this.statusHeight+this.documentPadding,width:this.width-2*this.documentPadding,height:this.height-this.statusHeight-2*this.documentPadding},y=this.scaleRect(this.documentRect,I,"inner"),R=this.height-50-100-39-12;return y.y=50+R/2-y.height/2,y.y,y.height,{x:this.documentPadding,y:this.height-14-50,width:this.width-2*this.documentPadding,height:50}}if("button_repeat"==i){if(this.landscape)return Z=300,this.width/2<364&&(Z=this.width/2-16-16),{x:16,y:this.height-14-50,width:Z,height:50};var f={x:this.documentPadding,y:this.statusHeight+this.documentPadding,width:this.width-2*this.documentPadding,height:this.height-this.statusHeight-2*this.documentPadding},v=this.scaleRect(this.documentRect,f,"inner"),W=this.height-50-100-39-12;return v.y=50+W/2-v.height/2,v.y,v.height,{x:this.documentPadding,y:this.height-28-100,width:this.width-2*this.documentPadding,height:50}}if("button_start"==i){if("InfoFront"==r.state||"InfoBack"==r.state)return{x:this.width/2-134,y:this.height-66-58,width:268,height:66};if(this.landscape)return{x:this.width/2-75,y:this.height/2-25,width:150,height:50};var G={x:this.documentPadding,y:this.statusHeight+this.documentPadding,width:this.width-2*this.documentPadding,height:this.height-this.statusHeight-2*this.documentPadding},V=this.scaleRect(this.documentRect,G,"inner"),X=this.height-50-100-39-12;V.y=50+X/2-V.height/2;var S=V.y+V.height+20;return{x:this.documentPadding,y:S,width:this.width-2*this.documentPadding,height:50}}if("text"==i){if(this.landscape){if("UCCaptureStatus"==r.state){var C=0,N={x:this.documentPadding,y:this.statusHeight+this.documentPadding,width:this.width-2*this.documentPadding,height:this.height-this.statusHeight-2*this.documentPadding-C};return{x:(E=this.scaleRect(this.documentRect,N,"inner")).x+.4*E.width,y:E.y,width:.6*E.width,height:E.height}}return"UCWaitRecording"==r.state?{x:0,y:.6*this.height,width:this.width,height:50}:"InfoFront"==r.state?{x:0,y:374*this.height/640,width:this.width,height:50}:"UCTimeoutPreview"==r.state?{x:0,y:0,width:this.width,height:70}:{x:0,y:0,width:this.width,height:50}}return"UCCapture"==r.state?{x:0,y:(E=this.getDocRectScreenSpace(this.width,this.height,0)).y-35,width:this.width,height:E.y}:"UCCaptureStatus"==r.state?(C=0,N={x:this.documentPadding,y:this.statusHeight+this.documentPadding,width:this.width-2*this.documentPadding,height:this.height-this.statusHeight-2*this.documentPadding-C},{x:(E=this.scaleRect(this.documentRect,N,"inner")).x+.4*E.width,y:E.y,width:.6*E.width,height:E.height}):"UCWaitRecording"==r.state?{x:0,y:.6*this.height,width:this.width,height:50}:"InfoFront"==r.state?{x:0,y:374*this.height/640,width:this.width,height:50}:"UCTimeoutPreview"==r.state?{x:0,y:0,width:this.width,height:70}:{x:0,y:0,width:this.width,height:50}}if("diagnostic"==i)return{x:0,y:0,width:this.width,height:this.height};if("text_detail"==i){if("UCTimeoutPreview"==r.state)return this.landscape?{x:this.width/2,y:330*this.height/640,width:this.width/2,height:50}:{x:0,y:374*this.height/640,width:this.width,height:50};if(0==this.landscape)return{x:0,y:(E=this.getDocRectScreenSpace(this.width,this.height,0)).y+E.height+15+7,width:this.width,height:this.height}}else{if("text_detail2"==i)return this.landscape?{x:this.width/2,y:280*this.height/640,width:this.width/2,height:50}:{x:0,y:320*this.height/640,width:this.width,height:50};if("previewImgOk"==i||"previewImgFail"==i){C=0,"UCPreview"==r.state&&this.landscape&&(C=64),N={x:this.documentPadding,y:this.statusHeight+this.documentPadding,width:this.width-2*this.documentPadding,height:this.height-this.statusHeight-2*this.documentPadding-C};var E=this.scaleRect(this.documentRect,N,"inner");if("UCPreview"==r.state&&0==this.landscape){var Y=this.height-50-100-39-12;E.y=50+Y/2-E.height/2}return c=this.rm.getSetupResourceId(t,i,this.landscape,"value"),o=this.rm.getImage(c),d=this.canvasSizeFactor*this.rm.getImageScale(),u=o.width*d,h=o.height*d,{x:E.x+E.width/3.5-u/2,y:E.y+E.height/2-h/2,width:u,height:h}}if("tip"==i)return this.landscape?{x:0,y:30,width:this.width,height:200}:{x:0,y:50,width:this.width,height:200};if("tip_detail"==i)return this.landscape?{x:this.width/2,y:0,width:this.width/2,height:this.height}:{x:0,y:this.height/2-60,width:this.width,height:this.height-this.documentPadding-15-2*this.buttonHeight-(this.height/2-60-95)};if("background"==i)return{x:0,y:0,width:this.width,height:this.height};if("button_skip"==i){if(this.landscape){var F=this.buttonWidth;return this.width<800&&((w=(this.width-600)/200)<0&&(w=0),F-=F/2*(w=1-w)),{x:this.documentPadding,y:this.height-this.documentPadding-this.buttonHeight,width:F,height:this.buttonHeight}}var k=this.width-2*this.documentPadding;return k>262&&(k=262),{x:this.width/2-k/2,y:this.height-this.documentPadding-this.buttonHeight,width:k,height:this.buttonHeight}}if("button_next"==i){if(this.landscape)return F=this.buttonWidth,this.width<800&&((w=(this.width-600)/200)<0&&(w=0),F-=F/2*(w=1-w)),{x:this.width-this.documentPadding-F,y:this.height-this.documentPadding-this.buttonHeight,width:F,height:this.buttonHeight};var x=this.width-2*this.documentPadding;return x>262&&(x=262),{x:this.width/2-x/2,y:this.height-this.documentPadding-15-2*this.buttonHeight,width:x,height:this.buttonHeight}}if("button_finish"==i){var w;if(this.landscape)return F=this.buttonWidth,this.width<800&&((w=(this.width-600)/200)<0&&(w=0),F-=F/2*(w=1-w)),{x:this.width-this.documentPadding-F,y:this.height-this.documentPadding-this.buttonHeight,width:F,height:this.buttonHeight};var L=this.width-2*this.documentPadding;return L>262&&(L=262),{x:this.width/2-L/2,y:this.height-this.documentPadding-15-2*this.buttonHeight,width:L,height:this.buttonHeight}}if("button_back"==i){var T=this.width-2*this.documentPadding;return T>262&&(T=262),{x:5,y:0,width:T,height:this.buttonHeight}}if("video"==i)return this.landscape?(N={x:this.documentPadding,y:60,width:this.width/2-2*this.documentPadding,height:this.height-this.buttonHeight-2*this.documentPadding-50},this.scaleRect(this.documentRect,N,"inner")):(N={x:this.documentPadding,y:95,width:this.width-2*this.documentPadding,height:this.height/2-60},this.scaleRect(this.documentRect,N,"inner"));if("initial_tip"==i){if("UCCaptureTip"==r.state)return{x:0,y:0,width:this.width,height:this.height}}else if("button_initial_tip"==i){if("UCCaptureTip"==r.state)return{x:this.width/2-113,y:this.height/2-79+92,width:226,height:45}}else{if("progressRecord"==i)return{x:.146*this.width,y:.52*this.height,width:.7*this.width,height:18};if("imageFront"==i||"imageBack"==i)return"UCTimeoutPreview"==r.state?this.landscape?(Z=this.height-70-70,{x:0,y:75,width:this.width/2,height:Z}):(Z=220*this.height/640,{x:this.width/2-Z/2,y:75,width:Z,height:Z}):(Z=177*this.height/640,{x:this.width/2-Z/2,y:103*this.height/640,width:Z,height:Z});if("titleBox"==i)return{x:0,y:0,width:this.width,height:70};if("tip_video"==i)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius};if("video_success"==i)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius};if("extraction_video"==i)return{x:this.width/2-.1*this.width,y:.73*this.height,width:.2*this.width,height:.2*this.width};if("button_finish"==i)return{x:.55*this.width,y:this.height-this.buttonHeight,width:.4*this.width,height:this.buttonHeight};if("button_exit"==i)return c=this.rm.getSetupResourceId(t,i,this.landscape,"value"),o=this.rm.getImage(c),d=this.canvasSizeFactor*this.rm.getImageScale(),u=o.width*d,h=o.height*d,"UCTimeoutPreview"==r.state?{x:this.width-u-30,y:0,width:u+30,height:70}:{x:this.width-u-30,y:0,width:u+30,height:50};if("button_info"==i)return c=this.rm.getSetupResourceId(t,i,this.landscape,"value"),o=this.rm.getImage(c),d=this.canvasSizeFactor*this.rm.getImageScale(),u=o.width*d,h=o.height*d,{x:0,y:0,width:u+30,height:50};if("button_camera"==i)return this.cameraCount<2?null:this.enableButtonCamera?(c=this.rm.getSetupResourceId(t,i,this.landscape,"value"),o=this.rm.getImage(c),d=this.canvasSizeFactor*this.rm.getImageScale(),u=o.width*d,h=o.height*d,{x:this.width-u-16,y:this.height-h-12,width:u+16,height:h+12}):null;if("button_rotate"==i)return c=this.rm.getSetupResourceId(t,i,this.landscape,"value"),o=this.rm.getImage(c),d=this.canvasSizeFactor*this.rm.getImageScale(),u=o.width*d,h=o.height*d,E=this.getDocRectScreenSpace(this.width,this.height,0),"UCPreview"!=r.state&&"PreviewFront"!=r.state&&"PreviewBack"!=r.state||(N={x:this.documentPadding,y:this.statusHeight+this.documentPadding,width:this.width-2*this.documentPadding,height:this.height-this.statusHeight-2*this.documentPadding-C},E=this.scaleRect(this.documentRect,N,"inner"),0==this.landscape&&(Y=this.height-50-100-39-12,E.y=50+Y/2-E.height/2)),{x:E.x,y:30,width:u+16,height:h+12};if("warning"==i)return{x:0,y:.91*this.height,width:this.width,height:.1*this.height};if("warningTooFar"==i)return{x:0,y:.89*this.height,width:this.width,height:.1*this.height};if("camera"==n)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius};if("results"==n)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius};if("liveness_move_text"==i)return"UCLivenessMoveStabilizing"==r.state||"UCLivenessMoveStabilized"==r.state||"UCLivenessMoveDetecting"==r.state?{x:0,y:.89*this.height,width:this.width,height:.1*this.height}:null;if("liveness_move_tip_text"==i)return 800==this.width?null:{x:this.circleX-this.circleRadius,y:this.circleY-.39*this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius};if("liveness_move_tip_text_challenge"==i)return 800!=this.width?null:{x:this.circleX-this.circleRadius,y:this.circleY-.39*this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius};if("livenessInfo_text"==i)return{x:0,y:.89*this.height,width:this.width,height:.1*this.height};if("liveness_move_left"==i||"liveness_move_right"==i||"liveness_move_top"==i||"liveness_move_bottom"==i){if(-1==r.livenessMoveDirection)return null;if("UCLivenessMoveDetecting"==r.state&&l>=.25&&l<1.75){if(0==r.livenessMoveDirection&&"liveness_move_top"!=i)return null;if(2==r.livenessMoveDirection&&"liveness_move_bottom"!=i)return null;if(1==r.livenessMoveDirection&&"liveness_move_right"!=i)return null;if(3==r.livenessMoveDirection&&"liveness_move_left"!=i)return null;var U=!1;return this.rm.isAttributeAvailable(t,i,"fullscreen")&&"true"==this.rm.getSetupResourceId(t,i,this.landscape,"fullscreen")&&(U=!0),U?{x:0,y:0,width:this.width,height:this.height}:{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius}}return null}if("face_searcher"==i)return{x:0,y:0,width:this.width,height:this.height};if("livenessMoveGlasses"==i){if(2==r.livenessMoveFailReason)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius}}else if("livenessMoveSunGlasses"==i){if(0==r.livenessMoveFailReason)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius}}else if("livenessMoveInfo"==i){if(1==r.livenessMoveFailReason)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius}}else{if("animation"==n)return i!=r.state?null:(U=!1,this.rm.isAttributeAvailable(t,i,"fullscreen")&&"true"==this.rm.getSetupResourceId(t,i,this.landscape,"fullscreen")&&(U=!0),U?{x:0,y:0,width:this.width,height:this.height}:{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius});if(("liveness_ok"==i||"liveness_nok"==i)&&"UCLivenessMoveStabilizing"==r.state)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius}}}}return null}},{key:"drawBackground",value:function(e,t,i,n){e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"color"),e.fillRect(t.x,t.y,t.width,t.height)}},{key:"clearRect",value:function(e,t,i,n){e.clearRect(t.x,t.y,t.width,t.height)}},{key:"drawPoint",value:function(e,t,i,n,a){e.fillStyle=a,e.beginPath(),e.arc(t,i,n,0,2*Math.PI),e.fill()}},{key:"drawLine",value:function(e,t,i,n,a,l){e.lineWidth=1,e.strokeStyle=l,e.beginPath(),e.moveTo(t,i),e.lineTo(n,a),e.stroke()}},{key:"drawButtonImage",value:function(e,t,i,n,a,l,s,r){var c=this.rm.getSetupResourceId(i,n,this.landscape,"value"),o=this.rm.getImage(c),d=this.canvasSizeFactor*this.rm.getImageScale(),u=o.width*d,h=o.height*d;e.drawImage(o,t.x+t.width/2-u/2,t.y+t.height/2-h/2,u,h)}},{key:"drawButton",value:function(e,t,i,n){var a=0;this.rm.isAttributeAvailable(i,n,this.landscape,"radius")&&(a=this.rm.getSetupFloat(i,n,this.landscape,"radius"));var l=this.rm.getSetupColor(i,n,this.landscape,"background");this.fillRoundedRect(e,t,a,1,1,l);var s=this.rm.getSetupColor(i,n,this.landscape,"decorator");this.drawRoundedRectProgressive(e,t,a,1,1,s,1);var r=this.rm.getSetupAlign(i,n,this.landscape,"align"),c=this.rm.getSetupNodeType(i,n,this.landscape),o=10*this.canvasSizeFactor;if("TEXT_ID"==c){var d=this.rm.getSetupTextId(i,n,this.landscape,"content"),u=this.rm.translate(d),h=this.rm.getSetupFloat(i,n,this.landscape,"font_size");h=Math.round(h*this.fontSizeFactor);var m=this.rm.getSetupResourceId(i,n,this.landscape,"font");e.font=h+"px '"+m+"'",e.textBaseline="alphabetic",e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"foreground");var b=e.measureText(u);"LEFT"==r?e.fillText(u,t.x+o,t.y+t.height/2+h/2):"RIGHT"==r?e.fillText(u,t.x+t.width-b.width-o,t.y+t.height/2+h/2):e.fillText(u,t.x+t.width/2-b.width/2,t.y+t.height/2+h/2)}else{d=this.rm.getSetupResourceId(i,n,this.landscape,"content");var p=this.rm.getImage(d),g=this.canvasSizeFactor*this.rm.getImageScale();"LEFT"==r?e.drawImage(p,t.x+o,t.y+t.height/2-p.height*g/2,p.width*g,p.height*g):"RIGHT"==r?e.drawImage(p,t.x+t.width-p.width*g-o,t.y+t.height/2-p.height*g/2,p.width*g,p.height*g):e.drawImage(p,t.x+t.width/2-p.width*g/2,t.y+t.height/2-p.height*g/2,p.width*g,p.height*g)}}},{key:"drawButtonGradient",value:function(e,t,i,n){var a=0;this.rm.isAttributeAvailable(i,n,this.landscape,"radius")&&(a=this.rm.getSetupFloat(i,n,this.landscape,"radius"));var l=this.rm.getSetupColor(i,n,this.landscape,"colorFrom"),s=this.rm.getSetupColor(i,n,this.landscape,"colorTo");this.fillRoundedRectGradient(e,t,a,1,1,l,s);var r=this.rm.getSetupColor(i,n,this.landscape,"decorator");this.drawRoundedRectProgressive(e,t,a,1,1,r,1);var c=this.rm.getSetupAlign(i,n,this.landscape,"align"),o=this.rm.getSetupNodeType(i,n,this.landscape),d=10*this.canvasSizeFactor;if("TEXT_ID"==o){var u=this.rm.getSetupTextId(i,n,this.landscape,"content"),h=this.rm.translate(u),m=this.rm.getSetupFloat(i,n,this.landscape,"font_size");m=Math.round(m*this.fontSizeFactor);var b=this.rm.getSetupResourceId(i,n,this.landscape,"font");e.font=m+"px '"+b+"'",e.textBaseline="alphabetic",e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"foreground");var p=e.measureText(h);"LEFT"==c?e.fillText(h,t.x+d,t.y+t.height/2+m/2):"RIGHT"==c?e.fillText(h,t.x+t.width-p.width-d,t.y+t.height/2+m/2):e.fillText(h,t.x+t.width/2-p.width/2,t.y+t.height/2+m/2)}else{u=this.rm.getSetupResourceId(i,n,this.landscape,"content");var g=this.rm.getImage(u),Z=this.canvasSizeFactor*this.rm.getImageScale();"LEFT"==c?e.drawImage(g,t.x+d,t.y+t.height/2-g.height*Z/2,g.width*Z,g.height*Z):"RIGHT"==c?e.drawImage(g,t.x+t.width-g.width*Z-d,t.y+t.height/2-g.height*Z/2,g.width*Z,g.height*Z):e.drawImage(g,t.x+t.width/2-g.width*Z/2,t.y+t.height/2-g.height*Z/2,g.width*Z,g.height*Z)}}},{key:"drawImageProc",value:function(e,t,i,n,a,l,s,r){if(null!=r.previewImage){var c="#ffffff";this.rm.isAttributeAvailable(i,n,this.landscape,"backgroundColor")&&(c=this.rm.getSetupColor(i,n,this.landscape,"backgroundColor")),e.fillStyle=c,e.fillRect(t.x,t.y,t.width,t.height);var o=r.previewImage,d=this.canvasSizeFactor*this.rm.getImageScale(),u={x:0,y:0,width:o.width*d,height:o.height*d},h=this.scaleRect(u,t,"inner");e.drawImage(o,h.x,h.y,h.width,h.height)}this.rm.isAttributeAvailable(i,n,this.landscape,"overlay")&&this.fillRoundedRect(e,t,6,1,1,this.rm.getSetupColor(i,n,this.landscape,"overlay"))}},{key:"drawImage",value:function(e,t,i,n,a,l,s,r){var c=this.rm.getSetupResourceId(i,n,this.landscape,"value"),o=this.rm.getImage(c),d=!1;if(this.rm.isAttributeAvailable(i,n,this.landscape,"scale")&&"CONTAINER"==this.rm.getSetupResourceId(i,n,this.landscape,"scale")&&(d=!0),d)e.drawImage(o,t.x,t.y,t.width,t.height);else{var u=this.canvasSizeFactor*this.rm.getImageScale(),h=o.width*u,m=o.height*u;e.drawImage(o,t.x+t.width/2-h/2,t.y+t.height/2-m/2,h,m)}}},{key:"drawImageWithClippingCircle",value:function(e,t,i,n,a,l){e.save(),e.beginPath(),e.arc(n,a,l,0,2*Math.PI,!1),e.clip(),e.drawImage(i,t.x,t.y,t.width,t.height),e.restore()}},{key:"cacheAnimation",value:function(e,t){for(var i=this.rm.getSetupResourceId(e,t,this.landscape,"name"),n=this.rm.getSetupResourceId(e,t,this.landscape,"ext"),a=parseInt(this.rm.getSetupResourceId(e,t,this.landscape,"start")),l=parseInt(this.rm.getSetupResourceId(e,t,this.landscape,"end")),s=a;s<=l;s++){var r=i+("0"+s).slice(-2)+"."+n;this.rm.getImage(r)}}},{key:"drawAnimation",value:function(e,t,i,n,a,l,s,r,c){var o=.1;this.rm.isAttributeAvailable(i,n,"rate")&&(o=1/parseFloat(this.rm.getSetupResourceId(i,n,this.landscape,"rate")));var d="FINISH";this.rm.isAttributeAvailable(i,n,this.landscape,"animMode")&&(d=this.rm.getSetupResourceId(i,n,this.landscape,"animMode"));var u,h=this.rm.getSetupResourceId(i,n,this.landscape,"name"),m=this.rm.getSetupResourceId(i,n,this.landscape,"ext"),b=parseInt(this.rm.getSetupResourceId(i,n,this.landscape,"start")),p=parseInt(this.rm.getSetupResourceId(i,n,this.landscape,"end")),g=o*(p-b+1);if("FINISH"==d)(u=Math.floor(l/o+b))>p&&(u=p);else{var Z=l%g/g;u=Math.floor((p-b)*Z+b)}u<b&&(u=b),u>p&&(u=p);var I=h+("0"+u).slice(-2)+"."+m,y=this.rm.getImage(I);e.drawImage(y,t.x,t.y,t.width,t.height)}},{key:"drawInitialTip",value:function(e,t,i,n,a,l,s,r){e.fillStyle="rgba(0,0,0,0.7)",e.fillRect(t.x,t.y,t.width,t.height);var c=this.rm.getSetupColor(i,n,this.landscape,"backgroundColor"),o={x:this.width/2-160,y:this.height/2-79,width:320,height:158};this.fillRoundedRect(e,o,6,1,1,c);var d=this.rm.getSetupResourceId(i,n,this.landscape,"image"),u=this.rm.getImage(d),h=this.canvasSizeFactor*this.rm.getImageScale(),m=u.width*h,b=u.height*h;e.drawImage(u,o.x+16,o.y+31,m,b);var p=this.rm.getSetupFloat(i,n,this.landscape,"font_size"),g=p+1;this.rm.isAttributeAvailable(i,n,this.landscape,"line_height")&&(g=this.rm.getSetupFloat(i,n,this.landscape,"line_height"));var Z=this.rm.getSetupColor(i,n,this.landscape,"color"),I=this.rm.getSetupResourceId(i,n,this.landscape,"font"),y={x:o.x+50,y:o.y,width:o.width-35,height:92},R=this.rm.translate("capture_tip_text");this.drawStringMultiline(e,R,y,Z,I,p,g,"LEFT","CENTER")}},{key:"drawDocumentBorder",value:function(e,t,i,n,a,l,s,r){var c=this.rm.getSetupColor(i,n,this.landscape,"documentBorderColor"),o=this.rm.getSetupColor(i,n,this.landscape,"documentBorderDetectedColor"),d=0;"UCPreview"!=r.state&&"PreviewFront"!=r.state&&"PreviewBack"!=r.state||this.landscape&&(d=64);var u=this.rm.getSetupColor(i,n,this.landscape,"statusColor");0==r.cameraOverflow&&(u=this.rm.getSetupColor(i,n,this.landscape,"statusColorVariant")),e.fillStyle=u,e.fillRect(t.x,t.y,t.width,this.statusHeight);var h=this.getDocRectScreenSpace(t.width,t.height,0);if("UCPreview"==r.state||"PreviewFront"==r.state||"PreviewBack"==r.state){var m={x:t.x+this.documentPadding,y:t.y+this.statusHeight+this.documentPadding,width:t.width-2*this.documentPadding,height:t.height-this.statusHeight-2*this.documentPadding-d};if(h=this.scaleRect(this.documentRect,m,"inner"),0==this.landscape){var b=this.height-50-100-39-12;h.y=50+b/2-h.height/2}}e.save(),e.beginPath(),e.rect(t.x,t.y+this.statusHeight,t.width,t.height-this.statusHeight),e.rect(h.x,h.y,h.width,h.height),e.closePath(),e.clip("evenodd");var p=this.rm.getSetupColor(i,n,this.landscape,"backgroundColor");0==r.cameraOverflow&&(p=this.rm.getSetupColor(i,n,this.landscape,"backgroundColorVariant")),e.fillStyle=p,e.fillRect(t.x,t.y+this.statusHeight,t.width,t.height-this.statusHeight),e.restore();var g=this.rm.getSetupFloat(i,n,this.landscape,"documentBorder");if(this.drawRoundedRectProgressive(e,h,6,g,2*g,c,1),"UCCapture"==r.state){var Z=0;1==r.contour[0]&&Z++,1==r.contour[1]&&Z++,1==r.contour[2]&&Z++,1==r.contour[3]&&Z++,Z>=2?a-this.searchingTextModeTime>.5&&(this.searchingTextMode=2,this.searchingTextModeTime=a):a-this.searchingTextModeTime>.5&&(this.searchingTextMode=1,this.searchingTextModeTime=a);var I,y=this.rm.getSetupFloat(i,n,this.landscape,"font_size"),R=this.rm.getSetupColor(i,n,this.landscape,"font_color"),f=this.rm.getSetupResourceId(i,n,this.landscape,"font");I=1==this.searchingTextMode?this.rm.translate("searching1_text"):this.rm.translate("searching2_text"),this.drawStringMultiline(e,I,h,R,f,y,"CENTER","CENTER")}e.lineWidth=this.rm.getSetupFloat(i,n,this.landscape,"documentBorder");var v=.15*h.width,W=.15*h.height;1==r.contour[0]&&(e.beginPath(),e.strokeStyle=1==r.contour[0]?o:c,e.moveTo(h.x+v,h.y+6),e.lineTo(h.x+h.width-v,h.y+6),e.stroke()),1==r.contour[1]&&(e.beginPath(),e.strokeStyle=1==r.contour[1]?o:c,e.moveTo(h.x+h.width-6,h.y+W),e.lineTo(h.x+h.width-6,h.y+h.height-W),e.stroke()),1==r.contour[2]&&(e.beginPath(),e.strokeStyle=1==r.contour[2]?o:c,e.moveTo(h.x+h.width-v,h.y+h.height-6),e.lineTo(h.x+v,h.y+h.height-6),e.stroke()),1==r.contour[3]&&(e.beginPath(),e.strokeStyle=1==r.contour[3]?o:c,e.moveTo(h.x+6,h.y+h.height-W),e.lineTo(h.x+6,h.y+W),e.stroke())}},{key:"drawDocumentFlipper",value:function(e,t,i,n,a,l,s,r){var c=this.rm.getSetupColor(i,n,this.landscape,"documentBorderColor");this.rm.getSetupColor(i,n,this.landscape,"documentBorderDetectedColor");var o=this.rm.getSetupColor(i,n,this.landscape,"statusColor");0==r.cameraOverflow&&(o=this.rm.getSetupColor(i,n,this.landscape,"statusColorVariant")),e.fillStyle=o,e.fillRect(t.x,t.y,t.width,this.statusHeight);var d,u=this.getDocRectScreenSpace(this.width,this.height,0),h=u.x+u.width/2,m=.5;l<m?(d=1-(1-(d=1-l/m))*(1-d)*(1-d),u.width=u.width*d,u.x=h-u.width/2):(d=1-(1-(d=(l-m)/m))*(1-d)*(1-d),u.width=u.width*d,u.x=h-u.width/2),e.save(),e.beginPath(),e.rect(t.x,t.y+this.statusHeight,t.width,t.height-this.statusHeight),e.rect(u.x,u.y,u.width,u.height),e.closePath(),e.clip("evenodd");var b=this.rm.getSetupColor(i,n,this.landscape,"backgroundColor");if(0==r.cameraOverflow&&(b=this.rm.getSetupColor(i,n,this.landscape,"backgroundColorVariant")),e.fillStyle=b,e.fillRect(t.x,t.y+this.statusHeight,t.width,t.height-this.statusHeight),e.restore(),e.lineWidth=this.rm.getSetupFloat(i,n,this.landscape,"documentBorder"),e.strokeStyle=c,e.strokeRect(u.x,u.y,u.width,u.height),l<m){var p=r.previewImage;e.drawImage(p,u.x,u.y,u.width,u.height)}}},{key:"drawText",value:function(e,t,i,a,l,s,r,c){var o=this.rm.getSetupFloat(i,a,this.landscape,"font_size"),d=o+1;this.rm.isAttributeAvailable(i,a,this.landscape,"line_height")&&(d=this.rm.getSetupFloat(i,a,this.landscape,"line_height"));var u=this.rm.getSetupColor(i,a,this.landscape,"color"),h=this.rm.getSetupResourceId(i,a,this.landscape,"font"),m="CENTER";this.rm.isAttributeAvailable(i,a,this.landscape,"align")&&(m=this.rm.getSetupAlign(i,a,this.landscape,"align"));var b="TOP";this.rm.isAttributeAvailable(i,a,this.landscape,"valign")&&(b=this.rm.getSetupAlign(i,a,this.landscape,"valign"));var p="";this.rm.isAttributeAvailable(i,a,this.landscape,"fontWeight")&&(p=this.rm.getSetupTextId(i,a,this.landscape,"fontWeight")),l<.1&&(u="#00000000");var g="";if("text"==a)"UCCapture"==i?g=c.status==n.SelphID.Mode.Front?this.rm.translate("capture_front_text"):this.rm.translate("capture_back_text"):"UCCaptureStatus"==i?g=c.status==n.SelphID.Mode.Front?"Warning"==r?this.rm.translate("capture_status_front_fail"):this.rm.translate("capture_status_front_ok"):"Warning"==r?this.rm.translate("capture_status_back_fail"):this.rm.translate("capture_status_back_ok"):"UCPreview"==i?g=c.status==n.SelphID.Mode.Front?this.rm.translate("preview_front_text"):this.rm.translate("preview_back_text"):"UCFlip"==i?g=this.rm.translate("flip_document"):"WaitRecording"==i?g=this.rm.translate("waitRecording"):"InfoFront"==i?g=this.rm.translate("infoFront"):"InfoBack"==i?g=this.rm.translate("infoBack"):"PreviewFront"==i||"PreviewBack"==i?g=this.rm.translate("infoQuality"):"UCTimeoutPreview"==i&&(g=this.rm.translate("infoTimeoutTitle"));else if("text_detail"==a)g="UCTimeoutPreview"==i?this.rm.translate("infoTimeout"):this.rm.translate("capture_detail_text");else if("text_detail2"==a)g=this.rm.translate("infoTimeout2");else if("tip"==a){if("UCTutorial1"==i?g=this.rm.translate("tutorial1_tip"):"UCTutorial2"==i?g=this.rm.translate("tutorial2_tip"):"UCTutorial3"==i&&(g=this.rm.translate("tutorial3_tip")),this.landscape&&this.width<800){var Z=(this.width-600)/200;Z<0&&(Z=0),o-=o/2*(Z=1-Z)}}else if("tip_detail"==a)"UCTutorial1"==i?g=this.rm.translate("tutorial1_tip_detail"):"UCTutorial2"==i?g=this.rm.translate("tutorial2_tip_detail"):"UCTutorial3"==i&&(g=this.rm.translate("tutorial3_tip_detail"));else if("warning"==a)g="Fallo al cargar el modelo!!";else if("diagnostic"==a)switch(c.diagnostic){case 2:g=this.rm.translate("documentDiagnostic_2");break;case 3:g=this.rm.translate("documentDiagnostic_3");break;case 4:g=this.rm.translate("documentDiagnostic_4");break;case 5:g=this.rm.translate("documentDiagnostic_5");break;case 6:g=this.rm.translate("documentDiagnostic_6");break;case 11:g=this.rm.translate("documentDiagnostic_11");break;case 12:g=this.rm.translate("documentDiagnostic_12");break;case 13:g=this.rm.translate("documentDiagnostic_13");break;case 17:g=this.rm.translate("documentDiagnostic_17");break;case 18:g=this.rm.translate("documentDiagnostic_18");break;case 20:g=this.rm.translate("documentDiagnostic_20")}this.drawStringMultiline(e,g,t,u,h,o,d,m,b,p)}},{key:"drawStringMultiline",value:function(e,t,i,n,a,l,s,r,c,o){var d=t.split("\n");e.imageSmoothingEnabled=!1,l=Math.round(l*this.fontSizeFactor),e.font=o+" "+l+"px '"+a+"'",e.fillStyle=n,e.textBaseline="middle";var u=i.y;if("CENTER"==c){var h=d.length*s;u=i.y+i.height/2-h/2+l/2}else"BOTTOM"==c&&(h=d.length*s,u=i.y+i.height-h);for(var m=0;m<d.length;m++){var b=e.measureText(d[m]),p=i.width/2-b.width/2;"LEFT"==r?p=0:"RIGHT"==r&&(p=i.width-b.width),e.fillText(d[m],i.x+p,u+m*s)}}},{key:"scaleRect",value:function(e,t,i){var n=t.x+t.width/2,a=t.y+t.height/2,l=t.width/e.width,s=t.height/e.height,r=e.width*l,c=e.height*l;return null==i?c<t.height&&(r=e.width*s,c=e.height*s):c>=t.height&&(r=e.width*s,c=e.height*s),{x:n-r/2,y:a-c/2,width:r,height:c}}},{key:"getRoundedRectPerimeter",value:function(e,t,i){return 2*Math.PI*i+2*(e-2*i)+2*(t-2*i)}},{key:"rotatePoint",value:function(e,t){return{x:e*Math.cos(t),y:e*Math.sin(t)}}},{key:"drawRoundedRectProgressive",value:function(e,t,i,n,a,l,s){var r,c=this.getRoundedRectPerimeter(t.width,t.height,i)*s,o=0;if(e.lineWidth=n,e.strokeStyle=l,e.fillStyle=l,e.beginPath(),e.moveTo(t.x,t.y+t.height/2),(c-=o=(t.height-2*i)/2)<0){var d=(c+o)/o,u=t.x,h=t.y+t.height/2-o*d;return e.lineTo(u,h),void e.stroke()}return e.lineTo(t.x,t.y+i),(c-=o=Math.PI/2*i)<0?(d=(c+o)/o,u=t.x+i,h=t.y+i,e.arc(u,h,i,Math.PI,Math.PI+Math.PI/2*d),e.stroke(),u+=(r=this.rotatePoint(i,Math.PI+Math.PI/2*d)).x,void(h+=r.y)):(e.arc(t.x+i,t.y+i,i,Math.PI,Math.PI+Math.PI/2),(c-=o=t.width-2*i)<0?(d=(c+o)/o,u=t.x+i+o*d,h=t.y,e.lineTo(u,h),void e.stroke()):(e.lineTo(t.x+t.width-i,t.y),(c-=o=Math.PI/2*i)<0?(d=(c+o)/o,u=t.x+t.width-i,h=t.y+i,e.arc(u,h,i,Math.PI+Math.PI/2,Math.PI+Math.PI/2+Math.PI/2*d),e.stroke(),u+=(r=this.rotatePoint(i,Math.PI+Math.PI/2+Math.PI/2*d)).x,void(h+=r.y)):(e.arc(t.x+t.width-i,t.y+i,i,Math.PI+Math.PI/2,0),(c-=o=t.height-2*i)<0?(d=(c+o)/o,u=t.x+t.width,h=t.y+i+o*d,e.lineTo(u,h),void e.stroke()):(e.lineTo(t.x+t.width,t.y+t.height-i),(c-=o=Math.PI/2*i)<0?(d=(c+o)/o,u=t.x+t.width-i,h=t.y+t.height-i,e.arc(u,h,i,0,Math.PI/2*d),e.stroke(),u+=(r=this.rotatePoint(i,Math.PI/2*d)).x,void(h+=r.y)):(e.arc(t.x+t.width-i,t.y+t.height-i,i,0,Math.PI/2),(c-=o=t.width-2*i)<0?(d=(c+o)/o,u=t.x+t.width-i-o*d,h=t.y+t.height,e.lineTo(u,h),void e.stroke()):(e.lineTo(t.x+i,t.y+t.height),(c-=o=Math.PI/2*i)<0?(d=(c+o)/o,u=t.x+i,h=t.y+t.height-i,e.arc(u,h,i,Math.PI/2,Math.PI/2+Math.PI/2*d),e.stroke(),u+=(r=this.rotatePoint(i,Math.PI/2+Math.PI/2*d)).x,void(h+=r.y)):(e.arc(t.x+i,t.y+t.height-i,i,Math.PI/2,Math.PI),(c-=o=(t.height-2*i)/2)<0?(d=(c+o)/o,u=t.x,h=t.y+t.height-i-o*d,e.lineTo(u,h),void e.stroke()):(u=t.x,h=t.y+t.height/2,e.lineTo(u,h),void e.stroke()))))))))}},{key:"fillRoundedRect",value:function(e,t,i,n,a,l){e.lineWidth=n,e.strokeStyle=l,e.fillStyle=l,e.beginPath(),e.moveTo(t.x,t.y+t.height/2),e.lineTo(t.x,t.y+i),e.arc(t.x+i,t.y+i,i,Math.PI,Math.PI+Math.PI/2),e.lineTo(t.x+t.width-i,t.y),e.arc(t.x+t.width-i,t.y+i,i,Math.PI+Math.PI/2,0),e.lineTo(t.x+t.width,t.y+t.height-i),e.arc(t.x+t.width-i,t.y+t.height-i,i,0,Math.PI/2),e.lineTo(t.x+i,t.y+t.height),e.arc(t.x+i,t.y+t.height-i,i,Math.PI/2,Math.PI);var s=t.x,r=t.y+t.height/2;e.lineTo(s,r),e.fill()}},{key:"fillRoundedRectGradient",value:function(e,t,i,n,a,l,s){var r=e.createLinearGradient(t.x,t.y,t.x+t.width,t.y+t.height);r.addColorStop(0,l),r.addColorStop(1,s),e.lineWidth=n,e.strokeStyle=r,e.fillStyle=r,e.beginPath(),e.moveTo(t.x,t.y+t.height/2),e.lineTo(t.x,t.y+i),e.arc(t.x+i,t.y+i,i,Math.PI,Math.PI+Math.PI/2),e.lineTo(t.x+t.width-i,t.y),e.arc(t.x+t.width-i,t.y+i,i,Math.PI+Math.PI/2,0),e.lineTo(t.x+t.width,t.y+t.height-i),e.arc(t.x+t.width-i,t.y+t.height-i,i,0,Math.PI/2),e.lineTo(t.x+i,t.y+t.height),e.arc(t.x+i,t.y+t.height-i,i,Math.PI/2,Math.PI);var c=t.x,o=t.y+t.height/2;e.lineTo(c,o),e.fill()}}]),i}(function(){function e(t){X(this,e),this.width=0,this.height=0,this.landscape=!1}return C(e,[{key:"cacheResources",value:function(){}},{key:"setCanvasSize",value:function(e,t){this.width=e,this.height=t,this.landscape=this.width>=this.height}},{key:"getCameraRect",value:function(e,t,i,n){this.setCanvasSize(e.canvas.clientWidth,e.canvas.clientHeight);var a=this.scaleRect({width:t,height:i},{x:0,y:0,width:this.width,height:this.height});return a.visible=!0,a}},{key:"getResourceIdForState",value:function(e){throw new Error("FPhi.Widget.drawer.abstract.js: Can't instantiate abstract class")}},{key:"onMouseMove",value:function(e,t,i,n,a){e.style.cursor="button"==a||"buttonImage"==a?"pointer":"default"}},{key:"draw",value:function(e,t,i,n,a,l,s,r,c){throw new Error("Can't instantiate abstract class")}},{key:"getLayout",value:function(e,t,i,n,a,l,s){throw new Error("Can't instantiate abstract class")}},{key:"cacheAnimation",value:function(e,t){if(this.rm.isAttributeAvailable(e,t,this.landscape,"id"))for(var i=this.rm.getSetupResourceId(e,t,this.landscape,"name"),n=this.rm.getSetupResourceId(e,t,this.landscape,"ext"),a=parseInt(this.rm.getSetupResourceId(e,t,this.landscape,"start")),l=parseInt(this.rm.getSetupResourceId(e,t,this.landscape,"end")),s=a;s<=l;s++){var r=i+("0"+s).slice(-2)+"."+n;this.rm.getImage(r)}}},{key:"scaleRect",value:function(e,t,i){var n=t.x+t.width/2,a=t.y+t.height/2,l=t.width/e.width,s=t.height/e.height,r=e.width*l,c=e.height*l;return null==i?c<t.height&&(r=e.width*s,c=e.height*s):c>=t.height&&(r=e.width*s,c=e.height*s),{x:n-r/2,y:a-c/2,width:r,height:c}}},{key:"drawButtonImage",value:function(e,t,i,n,a,l,s,r){var c=this.rm.getSetupResourceId(i,n,this.landscape,"value"),o=this.rm.getImage(c),d=this.canvasSizeFactor*this.rm.getImageScale(),u=o.width*d,h=o.height*d;e.drawImage(o,t.x+t.width/2-u/2,t.y+t.height/2-h/2,u,h)}},{key:"fillRoundRect",value:function(e,t,i,n,a,l){n<2*l&&(l=n/2),a<2*l&&(l=a/2),e.beginPath(),e.moveTo(t+l,i),e.arcTo(t+n,i,t+n,i+a,l),e.arcTo(t+n,i+a,t,i+a,l),e.arcTo(t,i+a,t,i,l),e.arcTo(t,i,t+n,i,l),e.closePath(),e.fill()}},{key:"drawButton",value:function(e,t,i,n){if(this.rm.isAttributeAvailable(i,n,this.landscape,"radius")){var a=this.rm.getSetupFloat(i,n,this.landscape,"radius");e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"decorator"),this.fillRoundRect(e,t.x,t.y+4,t.width,t.height-4,a),e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"background"),this.fillRoundRect(e,t.x,t.y,t.width,t.height-4,a)}else e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"decorator"),e.fillRect(t.x,t.y+4,t.width,t.height-4),e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"background"),e.fillRect(t.x,t.y,t.width,t.height-4);var l=this.rm.getSetupAlign(i,n,this.landscape,"align"),s=this.rm.getSetupNodeType(i,n),r=10*this.canvasSizeFactor;if("TEXT_ID"==s){var c=this.rm.getSetupTextId(i,n,this.landscape,"content"),o=this.rm.translate(c),d=this.rm.getSetupFloat(i,n,this.landscape,"font_size");d=Math.round(d*this.fontSizeFactor);var u=this.rm.getSetupResourceId(i,n,this.landscape,"font");e.font=d+"px '"+u+"'",e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"foreground");var h=e.measureText(o);"LEFT"==l?e.fillText(o,t.x+r,t.y+t.height/2):"RIGHT"==l?e.fillText(o,t.x+t.width-h.width-r,t.y+t.height/2):e.fillText(o,t.x+t.width/2-h.width/2,t.y+t.height/2)}else{c=this.rm.getSetupResourceId(i,n,this.landscape,"content");var m=this.rm.getImage(c),b=this.canvasSizeFactor*this.rm.getImageScale();"LEFT"==l?e.drawImage(m,t.x+r,t.y+t.height/2-m.height*b/2,m.width*b,m.height*b):"RIGHT"==l?e.drawImage(m,t.x+t.width-m.width*b-r,t.y+t.height/2-m.height*b/2,m.width*b,m.height*b):e.drawImage(m,t.x+t.width/2-m.width*b/2,t.y+t.height/2-m.height*b/2,m.width*b,m.height*b)}}},{key:"drawImage",value:function(e,t,i,n,a,l,s,r){var c=this.rm.getSetupResourceId(i,n,this.landscape,"value"),o=this.rm.getImage(c),d=!1;if(this.rm.isAttributeAvailable(i,n,this.landscape,"scale")&&"CONTAINER"==this.rm.getSetupResourceId(i,n,this.landscape,"scale")&&(d=!0),d)e.drawImage(o,t.x,t.y,t.width,t.height);else{var u=this.canvasSizeFactor*this.rm.getImageScale(),h=o.width*u,m=o.height*u;e.drawImage(o,t.x+t.width/2-h/2,t.y+t.height/2-m/2,h,m)}}},{key:"drawImageWithClippingCircle",value:function(e,t,i,n,a,l){e.save(),e.beginPath(),e.arc(n,a,l,0,2*Math.PI,!1),e.clip(),e.drawImage(i,t.x,t.y,t.width,t.height),e.restore()}},{key:"drawStringMultiline",value:function(e,t,i,n,a,l,s,r,c){var o=t.split("\n");e.imageSmoothingEnabled=!1,l=Math.round(l*this.fontSizeFactor),e.font=l+"px '"+a+"'",e.fillStyle=n,e.textBaseline="middle";var d=i.y;if("CENTER"==c){var u=o.length*s;d=i.y+i.height/2-u/2+l/2}else"BOTTOM"==c&&(u=o.length*s,d=i.y+i.height-u);for(var h=0;h<o.length;h++){var m=e.measureText(o[h]),b=i.width/2-m.width/2;"LEFT"==r?b=0:"RIGHT"==r&&(b=i.width-m.width),e.fillText(o[h],i.x+b,d+h*s)}}}]),e}());if(!r)var r={};r.SelphID=e;var c=function(){function e(t,i,n,a){X(this,e),this.width=t,this.height=i,this.rate=n,this.rateInv=1/this.rate,this.lastFrame=performance.now()}return C(e,[{key:"frameReady",value:function(){var e=performance.now();return(e-this.lastFrame)/1e3>this.rateInv&&(this.lastFrame=e,!0)}},{key:"addFrame",value:function(e){throw new Error("Method addFrame must be implemented.")}},{key:"generateVideo",value:function(){throw new Error("Method generateVideo must be implemented.")}},{key:"isReady",value:function(){throw new Error("Method isReady must be implemented")}}]),e}(),o=function(e){W(i,e);var t=V(i);function i(e,n,a,l){var s;return X(this,i),(s=t.call(this,e,n,a,l)).ag=new Animated_GIF,s.ag.setSize(e,n),s.ag.setDelay(s.rateInv),s.processing=!1,s}return C(i,[{key:"addFrame",value:function(e){this.frameReady()&&this.ag.addFrameImageData(e)}},{key:"generateVideo",value:function(){this.processing=!0;var e=this;return new Promise((function(t,i){e.ag.getBase64GIF((function(e){t(e)}))}))}},{key:"isReady",value:function(){return!this.processing}}]),i}(c),d=null,h=function(e){W(i,e);var t=V(i);function i(e,n,a,l){var s;return X(this,i),(s=t.call(this,e,n,a)).processing=!1,s.ready=!1,s.socketError=!1,s.worker=new Worker((null===d&&(d=URL.createObjectURL(new Blob([atob("c2VsZi53c1JlYWR5PSExLHNlbGYud3M9bmV3IFdlYlNvY2tldCgid3NzOi8vd3MtZGV2LmlkY2FwdHVyZS5lcyIpLHNlbGYud3Mub25vcGVuPWZ1bmN0aW9uKCl7cG9zdE1lc3NhZ2Uoe2NtZDoicmVhZHkifSl9LHNlbGYud3Mub25tZXNzYWdlPWZ1bmN0aW9uKGUpe3Bvc3RNZXNzYWdlKHtjbWQ6Im1lc3NhZ2UiLGRhdGE6ZS5kYXRhfSl9LHNlbGYud3Mub25lcnJvcj1mdW5jdGlvbihlKXtjb25zb2xlLmxvZyhlKSxwb3N0TWVzc2FnZSh7Y21kOiJ3c19vbmVycm9yIn0pfSxzZWxmLm9ubWVzc2FnZT1mdW5jdGlvbihlKXtpZigiYWRkRnJhbWUiPT1lLmRhdGEuY21kKXNlbGYud3Muc2VuZCgneyJ0eXBlIjoiVklERU9fRlJBTUUiLCJkYXRhVVJMIjoiJytlLmRhdGEuZGF0YSsnIn0nKTtlbHNlIGlmKCJnZW5lcmF0ZVZpZGVvIj09ZS5kYXRhLmNtZCl7bGV0IHM9J3sidHlwZSI6Ik1BS0VfVklERU8iLCJGUiI6JytlLmRhdGEuZnIrIn0iO3NlbGYud3Muc2VuZChzKX1lbHNlIHBvc3RNZXNzYWdlKHtjbWQ6InVua25vd25NZXNzYWdlIn0pfTs=")],{type:"text/javascript"}))),d)),s.worker.onmessage=s.onMessage.bind(v(s)),s.canvas=document.createElement("canvas"),s.canvas.width=e,s.canvas.height=n,s.promise=null,s.resolve=null,s.reject=null,s}return C(i,[{key:"onMessage",value:function(e){if("ready"==e.data.cmd)this.ready=!0;else if("message"==e.data.cmd){var t=JSON.parse(e.data.data);"SAVED_FRAME"==t.type?this.ready=!0:this.resolve(t.video)}else"ws_onerror"==e.data.cmd&&(this.socketError=!0)}},{key:"addFrame",value:function(e){if(this.frameReady()){this.canvas.getContext("2d").putImageData(e,0,0);var t=this.canvas.toDataURL("image/jpeg");this.worker.postMessage({cmd:"addFrame",data:t})}}},{key:"generateVideo",value:function(){console.log("generateVideo"),this.processing=!0;var e=this;return this.promise=new Promise((function(t,i){e.resolve=t,e.reject=i,e.socketError?e.reject():e.worker.postMessage({cmd:"generateVideo",fr:e.rate})})),this.promise}},{key:"isReady",value:function(){return!this.processing&&!!this.ready}}]),i}(c);if(!Z)var Z={};Z.SelphID=e;var I=function(e){W(n,e);var i=V(n);function n(){var e;return X(this,n),(e=i.call(this)).__widgetContainer=e.attachShadow({mode:"closed"}),e.__widgetStyles=document.createElement("style"),e.__widgetStyles.innerText="\n            :host { display: block; position: relative; margin: 0; padding: 0; width: 100%; height: 100%; background-color: #181a1b; }\n            #accessibilityContainer { position: absolute; z-index: 999; width: 100%; height: 100% }\n            #cameraContainer { width: 100%; height: 100% }\n        ",e.__widgetContainer.append(e.__widgetStyles),e.__config=new Z.SelphID.ConfigurationManager,e.__config.setContainer(e.__widgetContainer),e.__externalCamera=null,e.__elementMounted=!1,e.__accessibilityHasEnabled=!1,e.__waintingMounts=[],e}return C(n,[{key:"connectedCallback",value:function(){var e=this;queueMicrotask((function(){return e.__createUserControl(e.__config).__startUserControl().then((function(){e.__elementMounted=!0,e.__waintingMounts.forEach((function(e){return e()}))}))}))}},{key:"disconnectedCallback",value:function(){var e=this;queueMicrotask((function(){return e.__stopUserControl().then((function(){return e.__elementMounted=!1}))}))}},{key:"reconnectedCallback",value:function(){var e=this;queueMicrotask((function(){return e.__restartUserControl(e.__config)}))}},{key:"attributeChangedCallback",value:function(e,t,i){this.__setNativeConfiguration(e,i)&&this.reconnectedCallback()}},{key:"addWidgetEventListener",value:function(e,t){this.addEventListener(e,t,!0)}},{key:"addEventListener",value:function(e,t,i){var a=e.toLowerCase().replace("-",""),l=n.attributes[a];"event"===l.type&&this.__widgetContainer.addEventListener(l.property,t,i)}},{key:"routeClick",value:function(e,t){this.__fphiWidget.routeClick(e,t)}},{key:"mountExternalCamera",value:function(e){var t=this;"true"===this.getAttribute("externalcamera")?(this.__externalCamera=e,this.__elementMounted?this.reconnectedCallback():this.__waintingMounts.push((function(){return t.reconnectedCallback()}))):console.warn("FPhi.Widget.Component: An external camera has been tried to be inserted, but we weren't expecting it, so it will be ignored....")}},{key:"__createUserControl",value:function(e){return this.__fphiWidgetConfig=e,this.__fphiWidget=new Z.SelphID.Widget(e),(null!==this.getAttribute("debugMode")&&void 0!==this.getAttribute("debugMode")||null!==this.getAttribute("debugmode")&&void 0!==this.getAttribute("debugmode"))&&(this.__fphiWidget.debug=n.__tryParsePrimitive(this.getAttribute("debugMode"))),this}},{key:"__startUserControl",value:function(){var e=m(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.__fphiWidget,!e.t0){e.next=14;break}if(!this.__fphiWidgetConfig.startSimpleMode){e.next=7;break}return e.next=5,this.__fphiWidget.StartManual();case 5:case 10:e.next=14;break;case 7:if(null===this.__externalCamera){e.next=12;break}return e.next=10,this.__fphiWidget.Start(this.__externalCamera);case 12:return e.next=14,this.__fphiWidget.Start();case 14:return e.abrupt("return",this);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"__stopUserControl",value:function(){var e=m(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.__fphiWidget&&(this.__fphiWidget.Stop(),this.__fphiWidget=null),this));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"__restartUserControl",value:function(){var e=m(u().mark((function e(t){var i,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.__fphiWidget){e.next=8;break}return i=new Z.SelphID.Widget(t),n=this.__fphiWidget,this.__cleanWidgetContainer(),this.__fphiWidget=i,e.next=7,this.__startUserControl();case 7:n.Stop();case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"__cleanWidgetContainer",value:function(){this.__widgetContainer.innerHTML="",this.__widgetContainer.append(this.__widgetStyles)}},{key:"__setNativeConfiguration",value:function(e,t){var i=!1;if(void 0!==n.attributes[e]&&null!==n.attributes[e]){var a=n.attributes[e].property,l=n.attributes[e].type,s=t,r=Reflect.get(this.__config,a);if(null!=t&&s!==r){var c=null;switch(l){case"event":c=n.__tryParseFunction(t);break;case"base64":c=JSON.stringify(window.atob(t)).replaceAll('\\"','"').replaceAll('"{',"{").replaceAll('}"',"}");break;default:c=n.__tryParsePrimitive(t)}if("debugMode"===a)void 0!==this.__fphiWidget&&null!==this.__fphiWidget&&"function"!=typeof c&&(this.__fphiWidget.debug=c,i=i||!1);else{if("accessibility"!==a||!0!==c||this.__accessibilityHasEnabled||(this.accessibilityRoot=document.createElement("div"),this.accessibilityRoot.id="accessibilityContainer",this.__widgetContainer.append(this.accessibilityRoot),this.__accessibilityHasEnabled=!0),"function"==typeof c&&"event"===l)this.__widgetContainer.addEventListener(a,c,!0);else{var o=n.__getSetterAttr(a,this.__config);(this.__config?o.bind(this.__config):o)(c)}i=this.__elementMounted}}}return i}}],[{key:"attributes",get:function(){return{bundlepath:{type:"string",property:"bundlePath"},resourcespath:{type:"string",property:"resourcesPath"},graphpath:{type:"string",property:"graphPath"},accessibility:{type:"boolean",property:"accessibility"},accessibleelements:{type:"array",property:"accessibleElements"},language:{type:"string",property:"language"},dpilist:{type:"array",property:"dpiList"},canvashd:{type:"boolean",property:"canvasHD"},initialtip:{type:"boolean",property:"initialTip"},forcelandscape:{type:"boolean",property:"forceLandscape"},startsimplemode:{type:"boolean",property:"startSimpleMode"},asksimplemode:{type:"boolean",property:"askSimpleMode"},licensekey:{type:"string",property:"license"},camerawidth:{type:"number",property:"cameraWidth"},cameraheight:{type:"number",property:"cameraHeight"},cameraid:{type:"string",property:"cameraId"},cropfactor:{type:"number",property:"cropFactor"},documentmode:{type:"number",property:"captureMode"},previewcapture:{type:"boolean",property:"previewCapture"},cameraoverflow:{type:"boolean",property:"cameraOverflow"},blurredthreshold:{type:"number",property:"blurredThreshold"},externalcamera:{type:"boolean",property:"externalCamera"},cameramirror:{type:"boolean",property:"cameraMirror"},documenttype:{type:"number",property:"documentType"},scanmode:{type:"number",property:"scanMode"},specificdata:{type:"string",property:"specificData"},capturetimeout:{type:"number",property:"captureTimeout"},captureretries:{type:"number",property:"captureRetries"},imageformat:{type:"string",property:"imageFormat"},imagequality:{type:"number",property:"imageQuality"},videorecord:{type:"boolean",property:"videoRecord"},videorecordrate:{type:"number",property:"videoRecordRate"},videorecordscale:{type:"number",property:"videoRecordScale"},videorecordtype:{type:"number",property:"videoRecordType"},showlog:{type:"boolean",property:"showLog"},debugmode:{type:"boolean",property:"debugMode"},onextractionfinished:{type:"event",property:"FPhi.SelphID.Finish.event"},onusercancelled:{type:"event",property:"FPhi.SelphID.UserCancel.event"},onextractiontimeout:{type:"event",property:"FPhi.SelphID.ExtractionTimeout.event"},onexceptioncaptured:{type:"event",property:"FPhi.SelphID.ExceptionCaptured.event"},onmoduleloaded:{type:"event",property:"FPhi.SelphID.ModuleLoaded.event"},ontrackstatus:{type:"event",property:"FPhi.SelphID.TrackStatus.event"}}}},{key:"observedAttributes",get:function(){return Object.getOwnPropertyNames(this.attributes)}},{key:"checkCapabilities",value:function(){var e=m(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Z.SelphID.CheckCapabilities());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"__getSetterAttr",value:function(e,t){return t["set"+e.charAt(0).toUpperCase()+e.slice(1)]}},{key:"__tryParsePrimitive",value:function(e){try{return JSON.parse(e)}catch(t){return e.toString()}}},{key:"__tryParseFunction",value:function(e){try{return new Function("event",e)}catch(t){return e.toString()}}}]),n}(f(HTMLElement)),y={0:"OK",1:"NOT_EVALUATED",2:"BAD_ANGLE",3:"TOO_FAR",4:"TOO_CLOSE",5:"OUT_OF_BOUNDS",6:"BAD_ASPECT_RATIO",7:"DOCUMENT_NOT_FOUND",8:"FACE_NOT_FOUND",9:"MRZ_NOT_FOUND",10:"ATTRIBUTES_NOT_FOUND",11:"UNDEREXPOSED",12:"OVEREXPOSED",13:"BLURRED",14:"INSUFFICIENT_SAMPLES",15:"INSUFFICIENT_TIME",16:"TOO_DELAYED",17:"TOO_MOVEMENT",18:"FREEZED_DOCUMENT",19:"TOO_MUCH_ROLL",20:"TOO_SMALL"},R=null,G=function(e){try{return e()}catch(e){return null}},S=function(){function e(t){X(this,e),this.__licenseKey="",this.__engineLocation="",this.__imageFormat="",this.__imageQuality="",this.__detectsCount=0,this.__detectsNeeded=10,this.__blurredThreshold=0,this.__mapperToRealConfig(t),this.__frontDocument=null,this.__backDocument=null,this.__faceImage=null,this.__mrzRawString="",this.__worker=new Worker((null===R&&(R=URL.createObjectURL(new Blob([atob("dmFyIF9fd2VicGFja19leHBvcnRzX18gPSB7fTsKCjsvLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuLi9idWlsZC90ZW1wL2VuZ2luZXMvZmFjZXBoaS93b3JrZXIvRlBoaS5Xb3JrZXIuVXRpbHMuanMKLyoqCiAqIE1ldGhvZCB0byBjYWxjdWxhdGUgdGhlIGRpZmZlcmVuY2Ugb2YgdGltZXMgaW4gbWlsbGlzZWNvbmRzCiAqIEBwYXJhbSB7bnVtYmVyfSB0aW1lIFRoZSB0aW1lc3RhbXAKICogQHJldHVybnMgVGhlIGRpZmZlcmVuY2Ugb2YgdGltZXMKICovCmNvbnN0IGRpZmZUaW1lID0gKHRpbWUpID0+IChEYXRlLm5vdygpIC0gdGltZSkgLyAxMDAwOwoKLyoqCiAqIEF1eGlsaWFyIG1ldGhvZCB0byBkZWxldGUgYSBXZWJBc3NlbWJseSBTaWRlIFZhcmlhYmxlcwogKgogKiBAcGFyYW0ge2FycmF5fSBhcnJheSBUaGUgYXJyYXkgd2l0aCBuIGVsZW1lbnRzCiAqLwpjb25zdCBkZWxldGVXYXNtVmFyID0gKC4uLmFycmF5KSA9PiB7CiAgYXJyYXkuZm9yRWFjaCgob2JqKSA9PiB7CiAgICB0cnkgewogICAgICBpZiAob2JqICE9PSBudWxsICYmIHR5cGVvZiBvYmouZGVsZXRlICE9PSAidW5kZWZpbmVkIikgewogICAgICAgIG9iai5kZWxldGUoKTsKICAgICAgfQogICAgfSBjYXRjaChlKSB7CiAgICAgIC8vIE5vdGhpbmcgdG8gZG8KICAgIH0KCiAgfSk7Cn07Cgpjb25zdCBjaGVja1JhdGlvcyA9IChsb2NhdGlvbikgPT4gewogIGxldCBsaW1pdFVwID0gMS4wNTsKICBsZXQgbGltaXREb3duID0gMC45NTsKICBsZXQgV2lkdGhVcCA9IE1hdGguYWJzKGxvY2F0aW9uLnRvcFJpZ2h0LnggLSBsb2NhdGlvbi50b3BMZWZ0LngpOwogIGxldCBXaWR0aERvd24gPSBNYXRoLmFicyhsb2NhdGlvbi5ib3R0b21SaWdodC54IC0gbG9jYXRpb24uYm90dG9tTGVmdC54KTsKICBsZXQgaGVpZ2h0TGVmdCA9IE1hdGguYWJzKGxvY2F0aW9uLmJvdHRvbUxlZnQueSAtIGxvY2F0aW9uLnRvcExlZnQueSk7CiAgbGV0IGhlaWdodFJpZ2h0ID0gTWF0aC5hYnMobG9jYXRpb24uYm90dG9tUmlnaHQueSAtIGxvY2F0aW9uLnRvcFJpZ2h0LnkpOwogIGxldCByYXRpb1dpZHRoID0gV2lkdGhVcCAvIFdpZHRoRG93bjsKICBsZXQgcmF0aW9IZWlnaHQgPSBoZWlnaHRMZWZ0IC8gaGVpZ2h0UmlnaHQ7CgogIHJldHVybiAhIShsaW1pdERvd24gPCByYXRpb1dpZHRoICYmCiAgICByYXRpb1dpZHRoIDwgbGltaXRVcCAmJgogICAgbGltaXREb3duIDwgcmF0aW9IZWlnaHQgJiYKICAgIHJhdGlvSGVpZ2h0IDwgbGltaXRVcCk7Cn07CgoKCjsvLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuLi9idWlsZC90ZW1wL2VuZ2luZXMvZmFjZXBoaS93b3JrZXIvRlBoaS5Xb3JrZXIuTG9nZ2VyLmpzCi8qKgogKiBTZW5kIGRlYnVnIG1lc3NhZ2UgaW50byBEZXYgV2ViIENvbnNvbGUuCiAqIAogKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBUaGUgZGVzaXJlZCBtZXNzYWdlIHRvIHNlbmQuIAogKi8KLy9jb25zdCBkZWJ1Z01lc3NhZ2UgPSBhc3luYyAobWVzc2FnZSkgPT4gc2VsZi5wb3N0TWVzc2FnZSh7IGNtZDogImRlYnVnTWVzc2FnZSIsIG1lc3NhZ2U6IG1lc3NhZ2UudG9TdHJpbmcoKSB9KTsKY29uc3QgZGVidWdNZXNzYWdlID0gYXN5bmMgKG1lc3NhZ2UpID0+IGNvbnNvbGUuZGVidWcobWVzc2FnZSk7CgovKioKICogU2VuZCBpbmZvIG1lc3NhZ2UgaW50byBEZXYgV2ViIENvbnNvbGUuCiAqIAogKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBUaGUgZGVzaXJlZCBtZXNzYWdlIHRvIHNlbmQuIAogKi8KLy9jb25zdCBpbmZvTWVzc2FnZSA9IGFzeW5jIChtZXNzYWdlKSA9PiBzZWxmLnBvc3RNZXNzYWdlKHsgY21kOiAiaW5mb01lc3NhZ2UiLCBtZXNzYWdlOiBtZXNzYWdlLnRvU3RyaW5nKCkgfSk7CmNvbnN0IGluZm9NZXNzYWdlID0gYXN5bmMgKG1lc3NhZ2UpID0+IGNvbnNvbGUubG9nKG1lc3NhZ2UpOwoKLyoqCiAqIFNlbmQgd2FybmluZyBtZXNzYWdlIGludG8gRGV2IFdlYiBDb25zb2xlLgogKiAKICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2UgVGhlIGRlc2lyZWQgbWVzc2FnZSB0byBzZW5kLiAKICovCi8vY29uc3Qgd2FybmluZ01lc3NhZ2UgPSBhc3luYyAobWVzc2FnZSkgPT4gc2VsZi5wb3N0TWVzc2FnZSh7IGNtZDogIndhcm5pbmdNZXNzYWdlIiwgbWVzc2FnZTogbWVzc2FnZS50b1N0cmluZygpIH0pOwpjb25zdCB3YXJuaW5nTWVzc2FnZSA9IGFzeW5jIChtZXNzYWdlKSA9PiBjb25zb2xlLndhcm4obWVzc2FnZSk7Ci8vY29uc3Qgd2FybmluZ01lc3NhZ2UgPSBhc3luYyAobWVzc2FnZSkgPT4gbnVsbAoKLyoqCiAqIFNlbmQgZXJyb3IgbWVzc2FnZSBpbnRvIERldiBXZWIgQ29uc29sZS4KICogCiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlIFRoZSBkZXNpcmVkIG1lc3NhZ2UgdG8gc2VuZC4gCiAqLwovL2NvbnN0IGVycm9yTWVzc2FnZSA9IGFzeW5jIChtZXNzYWdlKSA9PiBzZWxmLnBvc3RNZXNzYWdlKHsgY21kOiAiZXJyb3JNZXNzYWdlIiwgbWVzc2FnZTogbWVzc2FnZS50b1N0cmluZygpIH0pOwpjb25zdCBlcnJvck1lc3NhZ2UgPSBhc3luYyAobWVzc2FnZSkgPT4gY29uc29sZS5lcnJvcihtZXNzYWdlKTsKLy9jb25zdCBlcnJvck1lc3NhZ2UgPSBhc3luYyAobWVzc2FnZSkgPT4gbnVsbAoKCjsvLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuLi9idWlsZC90ZW1wL2VuZ2luZXMvZmFjZXBoaS93b3JrZXIvRlBoaS5Xb3JrZXIuUnVudGltZS5qcwoKdmFyIE1vZHVsZSA9IChmdW5jdGlvbigpIHsKICB2YXIgX3NjcmlwdERpciA9IHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgZG9jdW1lbnQuY3VycmVudFNjcmlwdCA/IGRvY3VtZW50LmN1cnJlbnRTY3JpcHQuc3JjIDogdW5kZWZpbmVkOwogIAogIHJldHVybiAoCmZ1bmN0aW9uKE1vZHVsZSkgewogIE1vZHVsZSA9IE1vZHVsZSB8fCB7fTsKCnZhciBNb2R1bGU9dHlwZW9mIE1vZHVsZSE9PSJ1bmRlZmluZWQiP01vZHVsZTp7fTt2YXIgcmVhZHlQcm9taXNlUmVzb2x2ZSxyZWFkeVByb21pc2VSZWplY3Q7TW9kdWxlWyJyZWFkeSJdPW5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUscmVqZWN0KXtyZWFkeVByb21pc2VSZXNvbHZlPXJlc29sdmU7cmVhZHlQcm9taXNlUmVqZWN0PXJlamVjdH0pO3ZhciBtb2R1bGVPdmVycmlkZXM9e307dmFyIGtleTtmb3Ioa2V5IGluIE1vZHVsZSl7aWYoTW9kdWxlLmhhc093blByb3BlcnR5KGtleSkpe21vZHVsZU92ZXJyaWRlc1trZXldPU1vZHVsZVtrZXldfX12YXIgYXJndW1lbnRzXz1bXTt2YXIgdGhpc1Byb2dyYW09Ii4vdGhpcy5wcm9ncmFtIjt2YXIgcXVpdF89ZnVuY3Rpb24oc3RhdHVzLHRvVGhyb3cpe3Rocm93IHRvVGhyb3d9O3ZhciBFTlZJUk9OTUVOVF9JU19XRUI9dHJ1ZTt2YXIgRU5WSVJPTk1FTlRfSVNfV09SS0VSPWZhbHNlO3ZhciBzY3JpcHREaXJlY3Rvcnk9IiI7ZnVuY3Rpb24gbG9jYXRlRmlsZShwYXRoKXtpZihNb2R1bGVbImxvY2F0ZUZpbGUiXSl7cmV0dXJuIE1vZHVsZVsibG9jYXRlRmlsZSJdKHBhdGgsc2NyaXB0RGlyZWN0b3J5KX1yZXR1cm4gc2NyaXB0RGlyZWN0b3J5K3BhdGh9dmFyIHJlYWRfLHJlYWRBc3luYyxyZWFkQmluYXJ5LHNldFdpbmRvd1RpdGxlO2lmKEVOVklST05NRU5UX0lTX1dFQnx8RU5WSVJPTk1FTlRfSVNfV09SS0VSKXtpZihFTlZJUk9OTUVOVF9JU19XT1JLRVIpe3NjcmlwdERpcmVjdG9yeT1zZWxmLmxvY2F0aW9uLmhyZWZ9ZWxzZSBpZih0eXBlb2YgZG9jdW1lbnQhPT0idW5kZWZpbmVkIiYmZG9jdW1lbnQuY3VycmVudFNjcmlwdCl7c2NyaXB0RGlyZWN0b3J5PWRvY3VtZW50LmN1cnJlbnRTY3JpcHQuc3JjfWlmKF9zY3JpcHREaXIpe3NjcmlwdERpcmVjdG9yeT1fc2NyaXB0RGlyfWlmKHNjcmlwdERpcmVjdG9yeS5pbmRleE9mKCJibG9iOiIpIT09MCl7c2NyaXB0RGlyZWN0b3J5PXNjcmlwdERpcmVjdG9yeS5zdWJzdHIoMCxzY3JpcHREaXJlY3RvcnkubGFzdEluZGV4T2YoIi8iKSsxKX1lbHNle3NjcmlwdERpcmVjdG9yeT0iIn17cmVhZF89ZnVuY3Rpb24odXJsKXt2YXIgeGhyPW5ldyBYTUxIdHRwUmVxdWVzdDt4aHIub3BlbigiR0VUIix1cmwsZmFsc2UpO3hoci5zZW5kKG51bGwpO3JldHVybiB4aHIucmVzcG9uc2VUZXh0fTtpZihFTlZJUk9OTUVOVF9JU19XT1JLRVIpe3JlYWRCaW5hcnk9ZnVuY3Rpb24odXJsKXt2YXIgeGhyPW5ldyBYTUxIdHRwUmVxdWVzdDt4aHIub3BlbigiR0VUIix1cmwsZmFsc2UpO3hoci5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIjt4aHIuc2VuZChudWxsKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoeGhyLnJlc3BvbnNlKX19cmVhZEFzeW5jPWZ1bmN0aW9uKHVybCxvbmxvYWQsb25lcnJvcil7dmFyIHhocj1uZXcgWE1MSHR0cFJlcXVlc3Q7eGhyLm9wZW4oIkdFVCIsdXJsLHRydWUpO3hoci5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIjt4aHIub25sb2FkPWZ1bmN0aW9uKCl7aWYoeGhyLnN0YXR1cz09MjAwfHx4aHIuc3RhdHVzPT0wJiZ4aHIucmVzcG9uc2Upe29ubG9hZCh4aHIucmVzcG9uc2UpO3JldHVybn1vbmVycm9yKCl9O3hoci5vbmVycm9yPW9uZXJyb3I7eGhyLnNlbmQobnVsbCl9fXNldFdpbmRvd1RpdGxlPWZ1bmN0aW9uKHRpdGxlKXtkb2N1bWVudC50aXRsZT10aXRsZX19ZWxzZXt9dmFyIG91dD1Nb2R1bGVbInByaW50Il18fGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSk7dmFyIGVycj1Nb2R1bGVbInByaW50RXJyIl18fGNvbnNvbGUud2Fybi5iaW5kKGNvbnNvbGUpO2ZvcihrZXkgaW4gbW9kdWxlT3ZlcnJpZGVzKXtpZihtb2R1bGVPdmVycmlkZXMuaGFzT3duUHJvcGVydHkoa2V5KSl7TW9kdWxlW2tleV09bW9kdWxlT3ZlcnJpZGVzW2tleV19fW1vZHVsZU92ZXJyaWRlcz1udWxsO2lmKE1vZHVsZVsiYXJndW1lbnRzIl0pYXJndW1lbnRzXz1Nb2R1bGVbImFyZ3VtZW50cyJdO2lmKE1vZHVsZVsidGhpc1Byb2dyYW0iXSl0aGlzUHJvZ3JhbT1Nb2R1bGVbInRoaXNQcm9ncmFtIl07aWYoTW9kdWxlWyJxdWl0Il0pcXVpdF89TW9kdWxlWyJxdWl0Il07dmFyIHRlbXBSZXQwPTA7dmFyIHNldFRlbXBSZXQwPWZ1bmN0aW9uKHZhbHVlKXt0ZW1wUmV0MD12YWx1ZX07dmFyIHdhc21CaW5hcnk7aWYoTW9kdWxlWyJ3YXNtQmluYXJ5Il0pd2FzbUJpbmFyeT1Nb2R1bGVbIndhc21CaW5hcnkiXTt2YXIgbm9FeGl0UnVudGltZT1Nb2R1bGVbIm5vRXhpdFJ1bnRpbWUiXXx8dHJ1ZTtpZih0eXBlb2YgV2ViQXNzZW1ibHkhPT0ib2JqZWN0Iil7YWJvcnQoIm5vIG5hdGl2ZSB3YXNtIHN1cHBvcnQgZGV0ZWN0ZWQiKX12YXIgd2FzbU1lbW9yeTt2YXIgQUJPUlQ9ZmFsc2U7dmFyIEVYSVRTVEFUVVM7ZnVuY3Rpb24gYXNzZXJ0KGNvbmRpdGlvbix0ZXh0KXtpZighY29uZGl0aW9uKXthYm9ydCgiQXNzZXJ0aW9uIGZhaWxlZDogIit0ZXh0KX19dmFyIFVURjhEZWNvZGVyPXR5cGVvZiBUZXh0RGVjb2RlciE9PSJ1bmRlZmluZWQiP25ldyBUZXh0RGVjb2RlcigidXRmOCIpOnVuZGVmaW5lZDtmdW5jdGlvbiBVVEY4QXJyYXlUb1N0cmluZyhoZWFwLGlkeCxtYXhCeXRlc1RvUmVhZCl7dmFyIGVuZElkeD1pZHgrbWF4Qnl0ZXNUb1JlYWQ7dmFyIGVuZFB0cj1pZHg7d2hpbGUoaGVhcFtlbmRQdHJdJiYhKGVuZFB0cj49ZW5kSWR4KSkrK2VuZFB0cjtpZihlbmRQdHItaWR4PjE2JiZoZWFwLnN1YmFycmF5JiZVVEY4RGVjb2Rlcil7cmV0dXJuIFVURjhEZWNvZGVyLmRlY29kZShoZWFwLnN1YmFycmF5KGlkeCxlbmRQdHIpKX1lbHNle3ZhciBzdHI9IiI7d2hpbGUoaWR4PGVuZFB0cil7dmFyIHUwPWhlYXBbaWR4KytdO2lmKCEodTAmMTI4KSl7c3RyKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHUwKTtjb250aW51ZX12YXIgdTE9aGVhcFtpZHgrK10mNjM7aWYoKHUwJjIyNCk9PTE5Mil7c3RyKz1TdHJpbmcuZnJvbUNoYXJDb2RlKCh1MCYzMSk8PDZ8dTEpO2NvbnRpbnVlfXZhciB1Mj1oZWFwW2lkeCsrXSY2MztpZigodTAmMjQwKT09MjI0KXt1MD0odTAmMTUpPDwxMnx1MTw8Nnx1Mn1lbHNle3UwPSh1MCY3KTw8MTh8dTE8PDEyfHUyPDw2fGhlYXBbaWR4KytdJjYzfWlmKHUwPDY1NTM2KXtzdHIrPVN0cmluZy5mcm9tQ2hhckNvZGUodTApfWVsc2V7dmFyIGNoPXUwLTY1NTM2O3N0cis9U3RyaW5nLmZyb21DaGFyQ29kZSg1NTI5NnxjaD4+MTAsNTYzMjB8Y2gmMTAyMyl9fX1yZXR1cm4gc3RyfWZ1bmN0aW9uIFVURjhUb1N0cmluZyhwdHIsbWF4Qnl0ZXNUb1JlYWQpe3JldHVybiBwdHI/VVRGOEFycmF5VG9TdHJpbmcoSEVBUFU4LHB0cixtYXhCeXRlc1RvUmVhZCk6IiJ9ZnVuY3Rpb24gc3RyaW5nVG9VVEY4QXJyYXkoc3RyLGhlYXAsb3V0SWR4LG1heEJ5dGVzVG9Xcml0ZSl7aWYoIShtYXhCeXRlc1RvV3JpdGU+MCkpcmV0dXJuIDA7dmFyIHN0YXJ0SWR4PW91dElkeDt2YXIgZW5kSWR4PW91dElkeCttYXhCeXRlc1RvV3JpdGUtMTtmb3IodmFyIGk9MDtpPHN0ci5sZW5ndGg7KytpKXt2YXIgdT1zdHIuY2hhckNvZGVBdChpKTtpZih1Pj01NTI5NiYmdTw9NTczNDMpe3ZhciB1MT1zdHIuY2hhckNvZGVBdCgrK2kpO3U9NjU1MzYrKCh1JjEwMjMpPDwxMCl8dTEmMTAyM31pZih1PD0xMjcpe2lmKG91dElkeD49ZW5kSWR4KWJyZWFrO2hlYXBbb3V0SWR4KytdPXV9ZWxzZSBpZih1PD0yMDQ3KXtpZihvdXRJZHgrMT49ZW5kSWR4KWJyZWFrO2hlYXBbb3V0SWR4KytdPTE5Mnx1Pj42O2hlYXBbb3V0SWR4KytdPTEyOHx1JjYzfWVsc2UgaWYodTw9NjU1MzUpe2lmKG91dElkeCsyPj1lbmRJZHgpYnJlYWs7aGVhcFtvdXRJZHgrK109MjI0fHU+PjEyO2hlYXBbb3V0SWR4KytdPTEyOHx1Pj42JjYzO2hlYXBbb3V0SWR4KytdPTEyOHx1JjYzfWVsc2V7aWYob3V0SWR4KzM+PWVuZElkeClicmVhaztoZWFwW291dElkeCsrXT0yNDB8dT4+MTg7aGVhcFtvdXRJZHgrK109MTI4fHU+PjEyJjYzO2hlYXBbb3V0SWR4KytdPTEyOHx1Pj42JjYzO2hlYXBbb3V0SWR4KytdPTEyOHx1JjYzfX1oZWFwW291dElkeF09MDtyZXR1cm4gb3V0SWR4LXN0YXJ0SWR4fWZ1bmN0aW9uIHN0cmluZ1RvVVRGOChzdHIsb3V0UHRyLG1heEJ5dGVzVG9Xcml0ZSl7cmV0dXJuIHN0cmluZ1RvVVRGOEFycmF5KHN0cixIRUFQVTgsb3V0UHRyLG1heEJ5dGVzVG9Xcml0ZSl9ZnVuY3Rpb24gbGVuZ3RoQnl0ZXNVVEY4KHN0cil7dmFyIGxlbj0wO2Zvcih2YXIgaT0wO2k8c3RyLmxlbmd0aDsrK2kpe3ZhciB1PXN0ci5jaGFyQ29kZUF0KGkpO2lmKHU+PTU1Mjk2JiZ1PD01NzM0Myl1PTY1NTM2KygodSYxMDIzKTw8MTApfHN0ci5jaGFyQ29kZUF0KCsraSkmMTAyMztpZih1PD0xMjcpKytsZW47ZWxzZSBpZih1PD0yMDQ3KWxlbis9MjtlbHNlIGlmKHU8PTY1NTM1KWxlbis9MztlbHNlIGxlbis9NH1yZXR1cm4gbGVufXZhciBVVEYxNkRlY29kZXI9dHlwZW9mIFRleHREZWNvZGVyIT09InVuZGVmaW5lZCI/bmV3IFRleHREZWNvZGVyKCJ1dGYtMTZsZSIpOnVuZGVmaW5lZDtmdW5jdGlvbiBVVEYxNlRvU3RyaW5nKHB0cixtYXhCeXRlc1RvUmVhZCl7dmFyIGVuZFB0cj1wdHI7dmFyIGlkeD1lbmRQdHI+PjE7dmFyIG1heElkeD1pZHgrbWF4Qnl0ZXNUb1JlYWQvMjt3aGlsZSghKGlkeD49bWF4SWR4KSYmSEVBUFUxNltpZHhdKSsraWR4O2VuZFB0cj1pZHg8PDE7aWYoZW5kUHRyLXB0cj4zMiYmVVRGMTZEZWNvZGVyKXtyZXR1cm4gVVRGMTZEZWNvZGVyLmRlY29kZShIRUFQVTguc3ViYXJyYXkocHRyLGVuZFB0cikpfWVsc2V7dmFyIHN0cj0iIjtmb3IodmFyIGk9MDshKGk+PW1heEJ5dGVzVG9SZWFkLzIpOysraSl7dmFyIGNvZGVVbml0PUhFQVAxNltwdHIraSoyPj4xXTtpZihjb2RlVW5pdD09MClicmVhaztzdHIrPVN0cmluZy5mcm9tQ2hhckNvZGUoY29kZVVuaXQpfXJldHVybiBzdHJ9fWZ1bmN0aW9uIHN0cmluZ1RvVVRGMTYoc3RyLG91dFB0cixtYXhCeXRlc1RvV3JpdGUpe2lmKG1heEJ5dGVzVG9Xcml0ZT09PXVuZGVmaW5lZCl7bWF4Qnl0ZXNUb1dyaXRlPTIxNDc0ODM2NDd9aWYobWF4Qnl0ZXNUb1dyaXRlPDIpcmV0dXJuIDA7bWF4Qnl0ZXNUb1dyaXRlLT0yO3ZhciBzdGFydFB0cj1vdXRQdHI7dmFyIG51bUNoYXJzVG9Xcml0ZT1tYXhCeXRlc1RvV3JpdGU8c3RyLmxlbmd0aCoyP21heEJ5dGVzVG9Xcml0ZS8yOnN0ci5sZW5ndGg7Zm9yKHZhciBpPTA7aTxudW1DaGFyc1RvV3JpdGU7KytpKXt2YXIgY29kZVVuaXQ9c3RyLmNoYXJDb2RlQXQoaSk7SEVBUDE2W291dFB0cj4+MV09Y29kZVVuaXQ7b3V0UHRyKz0yfUhFQVAxNltvdXRQdHI+PjFdPTA7cmV0dXJuIG91dFB0ci1zdGFydFB0cn1mdW5jdGlvbiBsZW5ndGhCeXRlc1VURjE2KHN0cil7cmV0dXJuIHN0ci5sZW5ndGgqMn1mdW5jdGlvbiBVVEYzMlRvU3RyaW5nKHB0cixtYXhCeXRlc1RvUmVhZCl7dmFyIGk9MDt2YXIgc3RyPSIiO3doaWxlKCEoaT49bWF4Qnl0ZXNUb1JlYWQvNCkpe3ZhciB1dGYzMj1IRUFQMzJbcHRyK2kqND4+Ml07aWYodXRmMzI9PTApYnJlYWs7KytpO2lmKHV0ZjMyPj02NTUzNil7dmFyIGNoPXV0ZjMyLTY1NTM2O3N0cis9U3RyaW5nLmZyb21DaGFyQ29kZSg1NTI5NnxjaD4+MTAsNTYzMjB8Y2gmMTAyMyl9ZWxzZXtzdHIrPVN0cmluZy5mcm9tQ2hhckNvZGUodXRmMzIpfX1yZXR1cm4gc3RyfWZ1bmN0aW9uIHN0cmluZ1RvVVRGMzIoc3RyLG91dFB0cixtYXhCeXRlc1RvV3JpdGUpe2lmKG1heEJ5dGVzVG9Xcml0ZT09PXVuZGVmaW5lZCl7bWF4Qnl0ZXNUb1dyaXRlPTIxNDc0ODM2NDd9aWYobWF4Qnl0ZXNUb1dyaXRlPDQpcmV0dXJuIDA7dmFyIHN0YXJ0UHRyPW91dFB0cjt2YXIgZW5kUHRyPXN0YXJ0UHRyK21heEJ5dGVzVG9Xcml0ZS00O2Zvcih2YXIgaT0wO2k8c3RyLmxlbmd0aDsrK2kpe3ZhciBjb2RlVW5pdD1zdHIuY2hhckNvZGVBdChpKTtpZihjb2RlVW5pdD49NTUyOTYmJmNvZGVVbml0PD01NzM0Myl7dmFyIHRyYWlsU3Vycm9nYXRlPXN0ci5jaGFyQ29kZUF0KCsraSk7Y29kZVVuaXQ9NjU1MzYrKChjb2RlVW5pdCYxMDIzKTw8MTApfHRyYWlsU3Vycm9nYXRlJjEwMjN9SEVBUDMyW291dFB0cj4+Ml09Y29kZVVuaXQ7b3V0UHRyKz00O2lmKG91dFB0cis0PmVuZFB0cilicmVha31IRUFQMzJbb3V0UHRyPj4yXT0wO3JldHVybiBvdXRQdHItc3RhcnRQdHJ9ZnVuY3Rpb24gbGVuZ3RoQnl0ZXNVVEYzMihzdHIpe3ZhciBsZW49MDtmb3IodmFyIGk9MDtpPHN0ci5sZW5ndGg7KytpKXt2YXIgY29kZVVuaXQ9c3RyLmNoYXJDb2RlQXQoaSk7aWYoY29kZVVuaXQ+PTU1Mjk2JiZjb2RlVW5pdDw9NTczNDMpKytpO2xlbis9NH1yZXR1cm4gbGVufWZ1bmN0aW9uIGFsbG9jYXRlVVRGOChzdHIpe3ZhciBzaXplPWxlbmd0aEJ5dGVzVVRGOChzdHIpKzE7dmFyIHJldD1fbWFsbG9jKHNpemUpO2lmKHJldClzdHJpbmdUb1VURjhBcnJheShzdHIsSEVBUDgscmV0LHNpemUpO3JldHVybiByZXR9ZnVuY3Rpb24gd3JpdGVBcnJheVRvTWVtb3J5KGFycmF5LGJ1ZmZlcil7SEVBUDguc2V0KGFycmF5LGJ1ZmZlcil9ZnVuY3Rpb24gd3JpdGVBc2NpaVRvTWVtb3J5KHN0cixidWZmZXIsZG9udEFkZE51bGwpe2Zvcih2YXIgaT0wO2k8c3RyLmxlbmd0aDsrK2kpe0hFQVA4W2J1ZmZlcisrPj4wXT1zdHIuY2hhckNvZGVBdChpKX1pZighZG9udEFkZE51bGwpSEVBUDhbYnVmZmVyPj4wXT0wfWZ1bmN0aW9uIGFsaWduVXAoeCxtdWx0aXBsZSl7aWYoeCVtdWx0aXBsZT4wKXt4Kz1tdWx0aXBsZS14JW11bHRpcGxlfXJldHVybiB4fXZhciBidWZmZXIsSEVBUDgsSEVBUFU4LEhFQVAxNixIRUFQVTE2LEhFQVAzMixIRUFQVTMyLEhFQVBGMzIsSEVBUEY2NDtmdW5jdGlvbiB1cGRhdGVHbG9iYWxCdWZmZXJBbmRWaWV3cyhidWYpe2J1ZmZlcj1idWY7TW9kdWxlWyJIRUFQOCJdPUhFQVA4PW5ldyBJbnQ4QXJyYXkoYnVmKTtNb2R1bGVbIkhFQVAxNiJdPUhFQVAxNj1uZXcgSW50MTZBcnJheShidWYpO01vZHVsZVsiSEVBUDMyIl09SEVBUDMyPW5ldyBJbnQzMkFycmF5KGJ1Zik7TW9kdWxlWyJIRUFQVTgiXT1IRUFQVTg9bmV3IFVpbnQ4QXJyYXkoYnVmKTtNb2R1bGVbIkhFQVBVMTYiXT1IRUFQVTE2PW5ldyBVaW50MTZBcnJheShidWYpO01vZHVsZVsiSEVBUFUzMiJdPUhFQVBVMzI9bmV3IFVpbnQzMkFycmF5KGJ1Zik7TW9kdWxlWyJIRUFQRjMyIl09SEVBUEYzMj1uZXcgRmxvYXQzMkFycmF5KGJ1Zik7TW9kdWxlWyJIRUFQRjY0Il09SEVBUEY2ND1uZXcgRmxvYXQ2NEFycmF5KGJ1Zil9dmFyIElOSVRJQUxfTUVNT1JZPU1vZHVsZVsiSU5JVElBTF9NRU1PUlkiXXx8MjY4NDM1NDU2O3ZhciB3YXNtVGFibGU7dmFyIF9fQVRQUkVSVU5fXz1bXTt2YXIgX19BVElOSVRfXz1bXTt2YXIgX19BVE1BSU5fXz1bXTt2YXIgX19BVFBPU1RSVU5fXz1bXTt2YXIgcnVudGltZUluaXRpYWxpemVkPWZhbHNlO19fQVRJTklUX18ucHVzaCh7ZnVuYzpmdW5jdGlvbigpe19fX3dhc21fY2FsbF9jdG9ycygpfX0pO2Z1bmN0aW9uIHByZVJ1bigpe2lmKE1vZHVsZVsicHJlUnVuIl0pe2lmKHR5cGVvZiBNb2R1bGVbInByZVJ1biJdPT0iZnVuY3Rpb24iKU1vZHVsZVsicHJlUnVuIl09W01vZHVsZVsicHJlUnVuIl1dO3doaWxlKE1vZHVsZVsicHJlUnVuIl0ubGVuZ3RoKXthZGRPblByZVJ1bihNb2R1bGVbInByZVJ1biJdLnNoaWZ0KCkpfX1jYWxsUnVudGltZUNhbGxiYWNrcyhfX0FUUFJFUlVOX18pfWZ1bmN0aW9uIGluaXRSdW50aW1lKCl7cnVudGltZUluaXRpYWxpemVkPXRydWU7Y2FsbFJ1bnRpbWVDYWxsYmFja3MoX19BVElOSVRfXyl9ZnVuY3Rpb24gcHJlTWFpbigpe2NhbGxSdW50aW1lQ2FsbGJhY2tzKF9fQVRNQUlOX18pfWZ1bmN0aW9uIHBvc3RSdW4oKXtpZihNb2R1bGVbInBvc3RSdW4iXSl7aWYodHlwZW9mIE1vZHVsZVsicG9zdFJ1biJdPT0iZnVuY3Rpb24iKU1vZHVsZVsicG9zdFJ1biJdPVtNb2R1bGVbInBvc3RSdW4iXV07d2hpbGUoTW9kdWxlWyJwb3N0UnVuIl0ubGVuZ3RoKXthZGRPblBvc3RSdW4oTW9kdWxlWyJwb3N0UnVuIl0uc2hpZnQoKSl9fWNhbGxSdW50aW1lQ2FsbGJhY2tzKF9fQVRQT1NUUlVOX18pfWZ1bmN0aW9uIGFkZE9uUHJlUnVuKGNiKXtfX0FUUFJFUlVOX18udW5zaGlmdChjYil9ZnVuY3Rpb24gYWRkT25Qb3N0UnVuKGNiKXtfX0FUUE9TVFJVTl9fLnVuc2hpZnQoY2IpfXZhciBydW5EZXBlbmRlbmNpZXM9MDt2YXIgcnVuRGVwZW5kZW5jeVdhdGNoZXI9bnVsbDt2YXIgZGVwZW5kZW5jaWVzRnVsZmlsbGVkPW51bGw7ZnVuY3Rpb24gYWRkUnVuRGVwZW5kZW5jeShpZCl7cnVuRGVwZW5kZW5jaWVzKys7aWYoTW9kdWxlWyJtb25pdG9yUnVuRGVwZW5kZW5jaWVzIl0pe01vZHVsZVsibW9uaXRvclJ1bkRlcGVuZGVuY2llcyJdKHJ1bkRlcGVuZGVuY2llcyl9fWZ1bmN0aW9uIHJlbW92ZVJ1bkRlcGVuZGVuY3koaWQpe3J1bkRlcGVuZGVuY2llcy0tO2lmKE1vZHVsZVsibW9uaXRvclJ1bkRlcGVuZGVuY2llcyJdKXtNb2R1bGVbIm1vbml0b3JSdW5EZXBlbmRlbmNpZXMiXShydW5EZXBlbmRlbmNpZXMpfWlmKHJ1bkRlcGVuZGVuY2llcz09MCl7aWYocnVuRGVwZW5kZW5jeVdhdGNoZXIhPT1udWxsKXtjbGVhckludGVydmFsKHJ1bkRlcGVuZGVuY3lXYXRjaGVyKTtydW5EZXBlbmRlbmN5V2F0Y2hlcj1udWxsfWlmKGRlcGVuZGVuY2llc0Z1bGZpbGxlZCl7dmFyIGNhbGxiYWNrPWRlcGVuZGVuY2llc0Z1bGZpbGxlZDtkZXBlbmRlbmNpZXNGdWxmaWxsZWQ9bnVsbDtjYWxsYmFjaygpfX19TW9kdWxlWyJwcmVsb2FkZWRJbWFnZXMiXT17fTtNb2R1bGVbInByZWxvYWRlZEF1ZGlvcyJdPXt9O2Z1bmN0aW9uIGFib3J0KHdoYXQpe2lmKE1vZHVsZVsib25BYm9ydCJdKXtNb2R1bGVbIm9uQWJvcnQiXSh3aGF0KX13aGF0Kz0iIjtlcnIod2hhdCk7QUJPUlQ9dHJ1ZTtFWElUU1RBVFVTPTE7d2hhdD0iYWJvcnQoIit3aGF0KyIpLiBCdWlsZCB3aXRoIC1zIEFTU0VSVElPTlM9MSBmb3IgbW9yZSBpbmZvLiI7dmFyIGU9bmV3IFdlYkFzc2VtYmx5LlJ1bnRpbWVFcnJvcih3aGF0KTtyZWFkeVByb21pc2VSZWplY3QoZSk7dGhyb3cgZX1mdW5jdGlvbiBoYXNQcmVmaXgoc3RyLHByZWZpeCl7cmV0dXJuIFN0cmluZy5wcm90b3R5cGUuc3RhcnRzV2l0aD9zdHIuc3RhcnRzV2l0aChwcmVmaXgpOnN0ci5pbmRleE9mKHByZWZpeCk9PT0wfXZhciBkYXRhVVJJUHJlZml4PSJkYXRhOmFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbTtiYXNlNjQsIjtmdW5jdGlvbiBpc0RhdGFVUkkoZmlsZW5hbWUpe3JldHVybiBoYXNQcmVmaXgoZmlsZW5hbWUsZGF0YVVSSVByZWZpeCl9dmFyIHdhc21CaW5hcnlGaWxlPSJGUEJSZWNvZ25pdGlvbi53YXNtIjtpZighaXNEYXRhVVJJKHdhc21CaW5hcnlGaWxlKSl7d2FzbUJpbmFyeUZpbGU9bG9jYXRlRmlsZSh3YXNtQmluYXJ5RmlsZSl9ZnVuY3Rpb24gZ2V0QmluYXJ5KGZpbGUpe3RyeXtpZihmaWxlPT13YXNtQmluYXJ5RmlsZSYmd2FzbUJpbmFyeSl7cmV0dXJuIG5ldyBVaW50OEFycmF5KHdhc21CaW5hcnkpfWlmKHJlYWRCaW5hcnkpe3JldHVybiByZWFkQmluYXJ5KGZpbGUpfWVsc2V7dGhyb3cic3luYyBmZXRjaGluZyBvZiB0aGUgd2FzbSBmYWlsZWQ6IHlvdSBjYW4gcHJlbG9hZCBpdCB0byBNb2R1bGVbJ3dhc21CaW5hcnknXSBtYW51YWxseSwgb3IgZW1jYy5weSB3aWxsIGRvIHRoYXQgZm9yIHlvdSB3aGVuIGdlbmVyYXRpbmcgSFRNTCAoYnV0IG5vdCBKUykifX1jYXRjaChlcnIpe2Fib3J0KGVycil9fWZ1bmN0aW9uIGluc3RhbnRpYXRlU3luYyhmaWxlLGluZm8pe3ZhciBpbnN0YW5jZTt2YXIgbW9kdWxlO3ZhciBiaW5hcnk7dHJ5e2JpbmFyeT1nZXRCaW5hcnkoZmlsZSk7bW9kdWxlPW5ldyBXZWJBc3NlbWJseS5Nb2R1bGUoYmluYXJ5KTtpbnN0YW5jZT1uZXcgV2ViQXNzZW1ibHkuSW5zdGFuY2UobW9kdWxlLGluZm8pfWNhdGNoKGUpe3ZhciBzdHI9ZS50b1N0cmluZygpO2VycigiZmFpbGVkIHRvIGNvbXBpbGUgd2FzbSBtb2R1bGU6ICIrc3RyKTtpZihzdHIuaW5kZXhPZigiaW1wb3J0ZWQgTWVtb3J5Iik+PTB8fHN0ci5pbmRleE9mKCJtZW1vcnkgaW1wb3J0Iik+PTApe2VycigiTWVtb3J5IHNpemUgaW5jb21wYXRpYmlsaXR5IGlzc3VlcyBtYXkgYmUgZHVlIHRvIGNoYW5naW5nIElOSVRJQUxfTUVNT1JZIGF0IHJ1bnRpbWUgdG8gc29tZXRoaW5nIHRvbyBsYXJnZS4gVXNlIEFMTE9XX01FTU9SWV9HUk9XVEggdG8gYWxsb3cgYW55IHNpemUgbWVtb3J5IChhbmQgYWxzbyBtYWtlIHN1cmUgbm90IHRvIHNldCBJTklUSUFMX01FTU9SWSBhdCBydW50aW1lIHRvIHNvbWV0aGluZyBzbWFsbGVyIHRoYW4gaXQgd2FzIGF0IGNvbXBpbGUgdGltZSkuIil9dGhyb3cgZX1yZXR1cm5baW5zdGFuY2UsbW9kdWxlXX1mdW5jdGlvbiBjcmVhdGVXYXNtKCl7dmFyIGluZm89eyJhIjphc21MaWJyYXJ5QXJnfTtmdW5jdGlvbiByZWNlaXZlSW5zdGFuY2UoaW5zdGFuY2UsbW9kdWxlKXt2YXIgZXhwb3J0cz1pbnN0YW5jZS5leHBvcnRzO01vZHVsZVsiYXNtIl09ZXhwb3J0czt3YXNtTWVtb3J5PU1vZHVsZVsiYXNtIl1bImJhIl07dXBkYXRlR2xvYmFsQnVmZmVyQW5kVmlld3Mod2FzbU1lbW9yeS5idWZmZXIpO3dhc21UYWJsZT1Nb2R1bGVbImFzbSJdWyJlYSJdO3JlbW92ZVJ1bkRlcGVuZGVuY3koIndhc20taW5zdGFudGlhdGUiKX1hZGRSdW5EZXBlbmRlbmN5KCJ3YXNtLWluc3RhbnRpYXRlIik7aWYoTW9kdWxlWyJpbnN0YW50aWF0ZVdhc20iXSl7dHJ5e3ZhciBleHBvcnRzPU1vZHVsZVsiaW5zdGFudGlhdGVXYXNtIl0oaW5mbyxyZWNlaXZlSW5zdGFuY2UpO3JldHVybiBleHBvcnRzfWNhdGNoKGUpe2VycigiTW9kdWxlLmluc3RhbnRpYXRlV2FzbSBjYWxsYmFjayBmYWlsZWQgd2l0aCBlcnJvcjogIitlKTtyZXR1cm4gZmFsc2V9fXZhciByZXN1bHQ9aW5zdGFudGlhdGVTeW5jKHdhc21CaW5hcnlGaWxlLGluZm8pO3JlY2VpdmVJbnN0YW5jZShyZXN1bHRbMF0scmVzdWx0WzFdKTtyZXR1cm4gTW9kdWxlWyJhc20iXX1mdW5jdGlvbiBjYWxsUnVudGltZUNhbGxiYWNrcyhjYWxsYmFja3Mpe3doaWxlKGNhbGxiYWNrcy5sZW5ndGg+MCl7dmFyIGNhbGxiYWNrPWNhbGxiYWNrcy5zaGlmdCgpO2lmKHR5cGVvZiBjYWxsYmFjaz09ImZ1bmN0aW9uIil7Y2FsbGJhY2soTW9kdWxlKTtjb250aW51ZX12YXIgZnVuYz1jYWxsYmFjay5mdW5jO2lmKHR5cGVvZiBmdW5jPT09Im51bWJlciIpe2lmKGNhbGxiYWNrLmFyZz09PXVuZGVmaW5lZCl7d2FzbVRhYmxlLmdldChmdW5jKSgpfWVsc2V7d2FzbVRhYmxlLmdldChmdW5jKShjYWxsYmFjay5hcmcpfX1lbHNle2Z1bmMoY2FsbGJhY2suYXJnPT09dW5kZWZpbmVkP251bGw6Y2FsbGJhY2suYXJnKX19fXZhciBFeGNlcHRpb25JbmZvQXR0cnM9e0RFU1RSVUNUT1JfT0ZGU0VUOjAsUkVGQ09VTlRfT0ZGU0VUOjQsVFlQRV9PRkZTRVQ6OCxDQVVHSFRfT0ZGU0VUOjEyLFJFVEhST1dOX09GRlNFVDoxMyxTSVpFOjE2fTtmdW5jdGlvbiBfX19jeGFfYWxsb2NhdGVfZXhjZXB0aW9uKHNpemUpe3JldHVybiBfbWFsbG9jKHNpemUrRXhjZXB0aW9uSW5mb0F0dHJzLlNJWkUpK0V4Y2VwdGlvbkluZm9BdHRycy5TSVpFfXZhciBleGNlcHRpb25DYXVnaHQ9W107dmFyIGV4Y2VwdGlvbkxhc3Q9MDt2YXIgdW5jYXVnaHRFeGNlcHRpb25Db3VudD0wO2Z1bmN0aW9uIF9fX2N4YV9yZXRocm93KCl7dmFyIGNhdGNoSW5mbz1leGNlcHRpb25DYXVnaHQucG9wKCk7aWYoIWNhdGNoSW5mbyl7YWJvcnQoIm5vIGV4Y2VwdGlvbiB0byB0aHJvdyIpfXZhciBpbmZvPWNhdGNoSW5mby5nZXRfZXhjZXB0aW9uX2luZm8oKTt2YXIgcHRyPWNhdGNoSW5mby5nZXRfYmFzZV9wdHIoKTtpZighaW5mby5nZXRfcmV0aHJvd24oKSl7ZXhjZXB0aW9uQ2F1Z2h0LnB1c2goY2F0Y2hJbmZvKTtpbmZvLnNldF9yZXRocm93bih0cnVlKTtpbmZvLnNldF9jYXVnaHQoZmFsc2UpO3VuY2F1Z2h0RXhjZXB0aW9uQ291bnQrK31lbHNle2NhdGNoSW5mby5mcmVlKCl9ZXhjZXB0aW9uTGFzdD1wdHI7dGhyb3cgcHRyfWZ1bmN0aW9uIEV4Y2VwdGlvbkluZm8oZXhjUHRyKXt0aGlzLmV4Y1B0cj1leGNQdHI7dGhpcy5wdHI9ZXhjUHRyLUV4Y2VwdGlvbkluZm9BdHRycy5TSVpFO3RoaXMuc2V0X3R5cGU9ZnVuY3Rpb24odHlwZSl7SEVBUDMyW3RoaXMucHRyK0V4Y2VwdGlvbkluZm9BdHRycy5UWVBFX09GRlNFVD4+Ml09dHlwZX07dGhpcy5nZXRfdHlwZT1mdW5jdGlvbigpe3JldHVybiBIRUFQMzJbdGhpcy5wdHIrRXhjZXB0aW9uSW5mb0F0dHJzLlRZUEVfT0ZGU0VUPj4yXX07dGhpcy5zZXRfZGVzdHJ1Y3Rvcj1mdW5jdGlvbihkZXN0cnVjdG9yKXtIRUFQMzJbdGhpcy5wdHIrRXhjZXB0aW9uSW5mb0F0dHJzLkRFU1RSVUNUT1JfT0ZGU0VUPj4yXT1kZXN0cnVjdG9yfTt0aGlzLmdldF9kZXN0cnVjdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIEhFQVAzMlt0aGlzLnB0citFeGNlcHRpb25JbmZvQXR0cnMuREVTVFJVQ1RPUl9PRkZTRVQ+PjJdfTt0aGlzLnNldF9yZWZjb3VudD1mdW5jdGlvbihyZWZjb3VudCl7SEVBUDMyW3RoaXMucHRyK0V4Y2VwdGlvbkluZm9BdHRycy5SRUZDT1VOVF9PRkZTRVQ+PjJdPXJlZmNvdW50fTt0aGlzLnNldF9jYXVnaHQ9ZnVuY3Rpb24oY2F1Z2h0KXtjYXVnaHQ9Y2F1Z2h0PzE6MDtIRUFQOFt0aGlzLnB0citFeGNlcHRpb25JbmZvQXR0cnMuQ0FVR0hUX09GRlNFVD4+MF09Y2F1Z2h0fTt0aGlzLmdldF9jYXVnaHQ9ZnVuY3Rpb24oKXtyZXR1cm4gSEVBUDhbdGhpcy5wdHIrRXhjZXB0aW9uSW5mb0F0dHJzLkNBVUdIVF9PRkZTRVQ+PjBdIT0wfTt0aGlzLnNldF9yZXRocm93bj1mdW5jdGlvbihyZXRocm93bil7cmV0aHJvd249cmV0aHJvd24/MTowO0hFQVA4W3RoaXMucHRyK0V4Y2VwdGlvbkluZm9BdHRycy5SRVRIUk9XTl9PRkZTRVQ+PjBdPXJldGhyb3dufTt0aGlzLmdldF9yZXRocm93bj1mdW5jdGlvbigpe3JldHVybiBIRUFQOFt0aGlzLnB0citFeGNlcHRpb25JbmZvQXR0cnMuUkVUSFJPV05fT0ZGU0VUPj4wXSE9MH07dGhpcy5pbml0PWZ1bmN0aW9uKHR5cGUsZGVzdHJ1Y3Rvcil7dGhpcy5zZXRfdHlwZSh0eXBlKTt0aGlzLnNldF9kZXN0cnVjdG9yKGRlc3RydWN0b3IpO3RoaXMuc2V0X3JlZmNvdW50KDApO3RoaXMuc2V0X2NhdWdodChmYWxzZSk7dGhpcy5zZXRfcmV0aHJvd24oZmFsc2UpfTt0aGlzLmFkZF9yZWY9ZnVuY3Rpb24oKXt2YXIgdmFsdWU9SEVBUDMyW3RoaXMucHRyK0V4Y2VwdGlvbkluZm9BdHRycy5SRUZDT1VOVF9PRkZTRVQ+PjJdO0hFQVAzMlt0aGlzLnB0citFeGNlcHRpb25JbmZvQXR0cnMuUkVGQ09VTlRfT0ZGU0VUPj4yXT12YWx1ZSsxfTt0aGlzLnJlbGVhc2VfcmVmPWZ1bmN0aW9uKCl7dmFyIHByZXY9SEVBUDMyW3RoaXMucHRyK0V4Y2VwdGlvbkluZm9BdHRycy5SRUZDT1VOVF9PRkZTRVQ+PjJdO0hFQVAzMlt0aGlzLnB0citFeGNlcHRpb25JbmZvQXR0cnMuUkVGQ09VTlRfT0ZGU0VUPj4yXT1wcmV2LTE7cmV0dXJuIHByZXY9PT0xfX1mdW5jdGlvbiBfX19jeGFfdGhyb3cocHRyLHR5cGUsZGVzdHJ1Y3Rvcil7dmFyIGluZm89bmV3IEV4Y2VwdGlvbkluZm8ocHRyKTtpbmZvLmluaXQodHlwZSxkZXN0cnVjdG9yKTtleGNlcHRpb25MYXN0PXB0cjt1bmNhdWdodEV4Y2VwdGlvbkNvdW50Kys7dGhyb3cgcHRyfWZ1bmN0aW9uIHNldEVyck5vKHZhbHVlKXtIRUFQMzJbX19fZXJybm9fbG9jYXRpb24oKT4+Ml09dmFsdWU7cmV0dXJuIHZhbHVlfXZhciBTWVNDQUxMUz17bWFwcGluZ3M6e30sYnVmZmVyczpbbnVsbCxbXSxbXV0scHJpbnRDaGFyOmZ1bmN0aW9uKHN0cmVhbSxjdXJyKXt2YXIgYnVmZmVyPVNZU0NBTExTLmJ1ZmZlcnNbc3RyZWFtXTtpZihjdXJyPT09MHx8Y3Vycj09PTEwKXsoc3RyZWFtPT09MT9vdXQ6ZXJyKShVVEY4QXJyYXlUb1N0cmluZyhidWZmZXIsMCkpO2J1ZmZlci5sZW5ndGg9MH1lbHNle2J1ZmZlci5wdXNoKGN1cnIpfX0sdmFyYXJnczp1bmRlZmluZWQsZ2V0OmZ1bmN0aW9uKCl7U1lTQ0FMTFMudmFyYXJncys9NDt2YXIgcmV0PUhFQVAzMltTWVNDQUxMUy52YXJhcmdzLTQ+PjJdO3JldHVybiByZXR9LGdldFN0cjpmdW5jdGlvbihwdHIpe3ZhciByZXQ9VVRGOFRvU3RyaW5nKHB0cik7cmV0dXJuIHJldH0sZ2V0NjQ6ZnVuY3Rpb24obG93LGhpZ2gpe3JldHVybiBsb3d9fTtmdW5jdGlvbiBfX19zeXNfZmNudGw2NChmZCxjbWQsdmFyYXJncyl7U1lTQ0FMTFMudmFyYXJncz12YXJhcmdzO3JldHVybiAwfWZ1bmN0aW9uIF9fX3N5c19nZXRwaWQoKXtyZXR1cm4gNDJ9ZnVuY3Rpb24gX19fc3lzX2lvY3RsKGZkLG9wLHZhcmFyZ3Mpe1NZU0NBTExTLnZhcmFyZ3M9dmFyYXJncztyZXR1cm4gMH1mdW5jdGlvbiBfX19zeXNfb3BlbihwYXRoLGZsYWdzLHZhcmFyZ3Mpe1NZU0NBTExTLnZhcmFyZ3M9dmFyYXJnc31mdW5jdGlvbiBnZXRTaGlmdEZyb21TaXplKHNpemUpe3N3aXRjaChzaXplKXtjYXNlIDE6cmV0dXJuIDA7Y2FzZSAyOnJldHVybiAxO2Nhc2UgNDpyZXR1cm4gMjtjYXNlIDg6cmV0dXJuIDM7ZGVmYXVsdDp0aHJvdyBuZXcgVHlwZUVycm9yKCJVbmtub3duIHR5cGUgc2l6ZTogIitzaXplKX19ZnVuY3Rpb24gZW1iaW5kX2luaXRfY2hhckNvZGVzKCl7dmFyIGNvZGVzPW5ldyBBcnJheSgyNTYpO2Zvcih2YXIgaT0wO2k8MjU2OysraSl7Y29kZXNbaV09U3RyaW5nLmZyb21DaGFyQ29kZShpKX1lbWJpbmRfY2hhckNvZGVzPWNvZGVzfXZhciBlbWJpbmRfY2hhckNvZGVzPXVuZGVmaW5lZDtmdW5jdGlvbiByZWFkTGF0aW4xU3RyaW5nKHB0cil7dmFyIHJldD0iIjt2YXIgYz1wdHI7d2hpbGUoSEVBUFU4W2NdKXtyZXQrPWVtYmluZF9jaGFyQ29kZXNbSEVBUFU4W2MrK11dfXJldHVybiByZXR9dmFyIGF3YWl0aW5nRGVwZW5kZW5jaWVzPXt9O3ZhciByZWdpc3RlcmVkVHlwZXM9e307dmFyIHR5cGVEZXBlbmRlbmNpZXM9e307dmFyIGNoYXJfMD00ODt2YXIgY2hhcl85PTU3O2Z1bmN0aW9uIG1ha2VMZWdhbEZ1bmN0aW9uTmFtZShuYW1lKXtpZih1bmRlZmluZWQ9PT1uYW1lKXtyZXR1cm4iX3Vua25vd24ifW5hbWU9bmFtZS5yZXBsYWNlKC9bXmEtekEtWjAtOV9dL2csIiQiKTt2YXIgZj1uYW1lLmNoYXJDb2RlQXQoMCk7aWYoZj49Y2hhcl8wJiZmPD1jaGFyXzkpe3JldHVybiJfIituYW1lfWVsc2V7cmV0dXJuIG5hbWV9fWZ1bmN0aW9uIGNyZWF0ZU5hbWVkRnVuY3Rpb24obmFtZSxib2R5KXtuYW1lPW1ha2VMZWdhbEZ1bmN0aW9uTmFtZShuYW1lKTtyZXR1cm4gbmV3IEZ1bmN0aW9uKCJib2R5IiwicmV0dXJuIGZ1bmN0aW9uICIrbmFtZSsiKCkge1xuIisnICAgICJ1c2Ugc3RyaWN0IjsnKyIgICAgcmV0dXJuIGJvZHkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiIrIn07XG4iKShib2R5KX1mdW5jdGlvbiBleHRlbmRFcnJvcihiYXNlRXJyb3JUeXBlLGVycm9yTmFtZSl7dmFyIGVycm9yQ2xhc3M9Y3JlYXRlTmFtZWRGdW5jdGlvbihlcnJvck5hbWUsZnVuY3Rpb24obWVzc2FnZSl7dGhpcy5uYW1lPWVycm9yTmFtZTt0aGlzLm1lc3NhZ2U9bWVzc2FnZTt2YXIgc3RhY2s9bmV3IEVycm9yKG1lc3NhZ2UpLnN0YWNrO2lmKHN0YWNrIT09dW5kZWZpbmVkKXt0aGlzLnN0YWNrPXRoaXMudG9TdHJpbmcoKSsiXG4iK3N0YWNrLnJlcGxhY2UoL15FcnJvcig6W15cbl0qKT9cbi8sIiIpfX0pO2Vycm9yQ2xhc3MucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYmFzZUVycm9yVHlwZS5wcm90b3R5cGUpO2Vycm9yQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yPWVycm9yQ2xhc3M7ZXJyb3JDbGFzcy5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtpZih0aGlzLm1lc3NhZ2U9PT11bmRlZmluZWQpe3JldHVybiB0aGlzLm5hbWV9ZWxzZXtyZXR1cm4gdGhpcy5uYW1lKyI6ICIrdGhpcy5tZXNzYWdlfX07cmV0dXJuIGVycm9yQ2xhc3N9dmFyIEJpbmRpbmdFcnJvcj11bmRlZmluZWQ7ZnVuY3Rpb24gdGhyb3dCaW5kaW5nRXJyb3IobWVzc2FnZSl7dGhyb3cgbmV3IEJpbmRpbmdFcnJvcihtZXNzYWdlKX12YXIgSW50ZXJuYWxFcnJvcj11bmRlZmluZWQ7ZnVuY3Rpb24gdGhyb3dJbnRlcm5hbEVycm9yKG1lc3NhZ2Upe3Rocm93IG5ldyBJbnRlcm5hbEVycm9yKG1lc3NhZ2UpfWZ1bmN0aW9uIHdoZW5EZXBlbmRlbnRUeXBlc0FyZVJlc29sdmVkKG15VHlwZXMsZGVwZW5kZW50VHlwZXMsZ2V0VHlwZUNvbnZlcnRlcnMpe215VHlwZXMuZm9yRWFjaChmdW5jdGlvbih0eXBlKXt0eXBlRGVwZW5kZW5jaWVzW3R5cGVdPWRlcGVuZGVudFR5cGVzfSk7ZnVuY3Rpb24gb25Db21wbGV0ZSh0eXBlQ29udmVydGVycyl7dmFyIG15VHlwZUNvbnZlcnRlcnM9Z2V0VHlwZUNvbnZlcnRlcnModHlwZUNvbnZlcnRlcnMpO2lmKG15VHlwZUNvbnZlcnRlcnMubGVuZ3RoIT09bXlUeXBlcy5sZW5ndGgpe3Rocm93SW50ZXJuYWxFcnJvcigiTWlzbWF0Y2hlZCB0eXBlIGNvbnZlcnRlciBjb3VudCIpfWZvcih2YXIgaT0wO2k8bXlUeXBlcy5sZW5ndGg7KytpKXtyZWdpc3RlclR5cGUobXlUeXBlc1tpXSxteVR5cGVDb252ZXJ0ZXJzW2ldKX19dmFyIHR5cGVDb252ZXJ0ZXJzPW5ldyBBcnJheShkZXBlbmRlbnRUeXBlcy5sZW5ndGgpO3ZhciB1bnJlZ2lzdGVyZWRUeXBlcz1bXTt2YXIgcmVnaXN0ZXJlZD0wO2RlcGVuZGVudFR5cGVzLmZvckVhY2goZnVuY3Rpb24oZHQsaSl7aWYocmVnaXN0ZXJlZFR5cGVzLmhhc093blByb3BlcnR5KGR0KSl7dHlwZUNvbnZlcnRlcnNbaV09cmVnaXN0ZXJlZFR5cGVzW2R0XX1lbHNle3VucmVnaXN0ZXJlZFR5cGVzLnB1c2goZHQpO2lmKCFhd2FpdGluZ0RlcGVuZGVuY2llcy5oYXNPd25Qcm9wZXJ0eShkdCkpe2F3YWl0aW5nRGVwZW5kZW5jaWVzW2R0XT1bXX1hd2FpdGluZ0RlcGVuZGVuY2llc1tkdF0ucHVzaChmdW5jdGlvbigpe3R5cGVDb252ZXJ0ZXJzW2ldPXJlZ2lzdGVyZWRUeXBlc1tkdF07KytyZWdpc3RlcmVkO2lmKHJlZ2lzdGVyZWQ9PT11bnJlZ2lzdGVyZWRUeXBlcy5sZW5ndGgpe29uQ29tcGxldGUodHlwZUNvbnZlcnRlcnMpfX0pfX0pO2lmKDA9PT11bnJlZ2lzdGVyZWRUeXBlcy5sZW5ndGgpe29uQ29tcGxldGUodHlwZUNvbnZlcnRlcnMpfX1mdW5jdGlvbiByZWdpc3RlclR5cGUocmF3VHlwZSxyZWdpc3RlcmVkSW5zdGFuY2Usb3B0aW9ucyl7b3B0aW9ucz1vcHRpb25zfHx7fTtpZighKCJhcmdQYWNrQWR2YW5jZSJpbiByZWdpc3RlcmVkSW5zdGFuY2UpKXt0aHJvdyBuZXcgVHlwZUVycm9yKCJyZWdpc3RlclR5cGUgcmVnaXN0ZXJlZEluc3RhbmNlIHJlcXVpcmVzIGFyZ1BhY2tBZHZhbmNlIil9dmFyIG5hbWU9cmVnaXN0ZXJlZEluc3RhbmNlLm5hbWU7aWYoIXJhd1R5cGUpe3Rocm93QmluZGluZ0Vycm9yKCd0eXBlICInK25hbWUrJyIgbXVzdCBoYXZlIGEgcG9zaXRpdmUgaW50ZWdlciB0eXBlaWQgcG9pbnRlcicpfWlmKHJlZ2lzdGVyZWRUeXBlcy5oYXNPd25Qcm9wZXJ0eShyYXdUeXBlKSl7aWYob3B0aW9ucy5pZ25vcmVEdXBsaWNhdGVSZWdpc3RyYXRpb25zKXtyZXR1cm59ZWxzZXt0aHJvd0JpbmRpbmdFcnJvcigiQ2Fubm90IHJlZ2lzdGVyIHR5cGUgJyIrbmFtZSsiJyB0d2ljZSIpfX1yZWdpc3RlcmVkVHlwZXNbcmF3VHlwZV09cmVnaXN0ZXJlZEluc3RhbmNlO2RlbGV0ZSB0eXBlRGVwZW5kZW5jaWVzW3Jhd1R5cGVdO2lmKGF3YWl0aW5nRGVwZW5kZW5jaWVzLmhhc093blByb3BlcnR5KHJhd1R5cGUpKXt2YXIgY2FsbGJhY2tzPWF3YWl0aW5nRGVwZW5kZW5jaWVzW3Jhd1R5cGVdO2RlbGV0ZSBhd2FpdGluZ0RlcGVuZGVuY2llc1tyYXdUeXBlXTtjYWxsYmFja3MuZm9yRWFjaChmdW5jdGlvbihjYil7Y2IoKX0pfX1mdW5jdGlvbiBfX2VtYmluZF9yZWdpc3Rlcl9ib29sKHJhd1R5cGUsbmFtZSxzaXplLHRydWVWYWx1ZSxmYWxzZVZhbHVlKXt2YXIgc2hpZnQ9Z2V0U2hpZnRGcm9tU2l6ZShzaXplKTtuYW1lPXJlYWRMYXRpbjFTdHJpbmcobmFtZSk7cmVnaXN0ZXJUeXBlKHJhd1R5cGUse25hbWU6bmFtZSwiZnJvbVdpcmVUeXBlIjpmdW5jdGlvbih3dCl7cmV0dXJuISF3dH0sInRvV2lyZVR5cGUiOmZ1bmN0aW9uKGRlc3RydWN0b3JzLG8pe3JldHVybiBvP3RydWVWYWx1ZTpmYWxzZVZhbHVlfSwiYXJnUGFja0FkdmFuY2UiOjgsInJlYWRWYWx1ZUZyb21Qb2ludGVyIjpmdW5jdGlvbihwb2ludGVyKXt2YXIgaGVhcDtpZihzaXplPT09MSl7aGVhcD1IRUFQOH1lbHNlIGlmKHNpemU9PT0yKXtoZWFwPUhFQVAxNn1lbHNlIGlmKHNpemU9PT00KXtoZWFwPUhFQVAzMn1lbHNle3Rocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gYm9vbGVhbiB0eXBlIHNpemU6ICIrbmFtZSl9cmV0dXJuIHRoaXNbImZyb21XaXJlVHlwZSJdKGhlYXBbcG9pbnRlcj4+c2hpZnRdKX0sZGVzdHJ1Y3RvckZ1bmN0aW9uOm51bGx9KX1mdW5jdGlvbiBDbGFzc0hhbmRsZV9pc0FsaWFzT2Yob3RoZXIpe2lmKCEodGhpcyBpbnN0YW5jZW9mIENsYXNzSGFuZGxlKSl7cmV0dXJuIGZhbHNlfWlmKCEob3RoZXIgaW5zdGFuY2VvZiBDbGFzc0hhbmRsZSkpe3JldHVybiBmYWxzZX12YXIgbGVmdENsYXNzPXRoaXMuJCQucHRyVHlwZS5yZWdpc3RlcmVkQ2xhc3M7dmFyIGxlZnQ9dGhpcy4kJC5wdHI7dmFyIHJpZ2h0Q2xhc3M9b3RoZXIuJCQucHRyVHlwZS5yZWdpc3RlcmVkQ2xhc3M7dmFyIHJpZ2h0PW90aGVyLiQkLnB0cjt3aGlsZShsZWZ0Q2xhc3MuYmFzZUNsYXNzKXtsZWZ0PWxlZnRDbGFzcy51cGNhc3QobGVmdCk7bGVmdENsYXNzPWxlZnRDbGFzcy5iYXNlQ2xhc3N9d2hpbGUocmlnaHRDbGFzcy5iYXNlQ2xhc3Mpe3JpZ2h0PXJpZ2h0Q2xhc3MudXBjYXN0KHJpZ2h0KTtyaWdodENsYXNzPXJpZ2h0Q2xhc3MuYmFzZUNsYXNzfXJldHVybiBsZWZ0Q2xhc3M9PT1yaWdodENsYXNzJiZsZWZ0PT09cmlnaHR9ZnVuY3Rpb24gc2hhbGxvd0NvcHlJbnRlcm5hbFBvaW50ZXIobyl7cmV0dXJue2NvdW50Om8uY291bnQsZGVsZXRlU2NoZWR1bGVkOm8uZGVsZXRlU2NoZWR1bGVkLHByZXNlcnZlUG9pbnRlck9uRGVsZXRlOm8ucHJlc2VydmVQb2ludGVyT25EZWxldGUscHRyOm8ucHRyLHB0clR5cGU6by5wdHJUeXBlLHNtYXJ0UHRyOm8uc21hcnRQdHIsc21hcnRQdHJUeXBlOm8uc21hcnRQdHJUeXBlfX1mdW5jdGlvbiB0aHJvd0luc3RhbmNlQWxyZWFkeURlbGV0ZWQob2JqKXtmdW5jdGlvbiBnZXRJbnN0YW5jZVR5cGVOYW1lKGhhbmRsZSl7cmV0dXJuIGhhbmRsZS4kJC5wdHJUeXBlLnJlZ2lzdGVyZWRDbGFzcy5uYW1lfXRocm93QmluZGluZ0Vycm9yKGdldEluc3RhbmNlVHlwZU5hbWUob2JqKSsiIGluc3RhbmNlIGFscmVhZHkgZGVsZXRlZCIpfXZhciBmaW5hbGl6YXRpb25Hcm91cD1mYWxzZTtmdW5jdGlvbiBkZXRhY2hGaW5hbGl6ZXIoaGFuZGxlKXt9ZnVuY3Rpb24gcnVuRGVzdHJ1Y3RvcigkJCl7aWYoJCQuc21hcnRQdHIpeyQkLnNtYXJ0UHRyVHlwZS5yYXdEZXN0cnVjdG9yKCQkLnNtYXJ0UHRyKX1lbHNleyQkLnB0clR5cGUucmVnaXN0ZXJlZENsYXNzLnJhd0Rlc3RydWN0b3IoJCQucHRyKX19ZnVuY3Rpb24gcmVsZWFzZUNsYXNzSGFuZGxlKCQkKXskJC5jb3VudC52YWx1ZS09MTt2YXIgdG9EZWxldGU9MD09PSQkLmNvdW50LnZhbHVlO2lmKHRvRGVsZXRlKXtydW5EZXN0cnVjdG9yKCQkKX19ZnVuY3Rpb24gYXR0YWNoRmluYWxpemVyKGhhbmRsZSl7aWYoInVuZGVmaW5lZCI9PT10eXBlb2YgRmluYWxpemF0aW9uR3JvdXApe2F0dGFjaEZpbmFsaXplcj1mdW5jdGlvbihoYW5kbGUpe3JldHVybiBoYW5kbGV9O3JldHVybiBoYW5kbGV9ZmluYWxpemF0aW9uR3JvdXA9bmV3IEZpbmFsaXphdGlvbkdyb3VwKGZ1bmN0aW9uKGl0ZXIpe2Zvcih2YXIgcmVzdWx0PWl0ZXIubmV4dCgpOyFyZXN1bHQuZG9uZTtyZXN1bHQ9aXRlci5uZXh0KCkpe3ZhciAkJD1yZXN1bHQudmFsdWU7aWYoISQkLnB0cil7Y29uc29sZS53YXJuKCJvYmplY3QgYWxyZWFkeSBkZWxldGVkOiAiKyQkLnB0cil9ZWxzZXtyZWxlYXNlQ2xhc3NIYW5kbGUoJCQpfX19KTthdHRhY2hGaW5hbGl6ZXI9ZnVuY3Rpb24oaGFuZGxlKXtmaW5hbGl6YXRpb25Hcm91cC5yZWdpc3RlcihoYW5kbGUsaGFuZGxlLiQkLGhhbmRsZS4kJCk7cmV0dXJuIGhhbmRsZX07ZGV0YWNoRmluYWxpemVyPWZ1bmN0aW9uKGhhbmRsZSl7ZmluYWxpemF0aW9uR3JvdXAudW5yZWdpc3RlcihoYW5kbGUuJCQpfTtyZXR1cm4gYXR0YWNoRmluYWxpemVyKGhhbmRsZSl9ZnVuY3Rpb24gQ2xhc3NIYW5kbGVfY2xvbmUoKXtpZighdGhpcy4kJC5wdHIpe3Rocm93SW5zdGFuY2VBbHJlYWR5RGVsZXRlZCh0aGlzKX1pZih0aGlzLiQkLnByZXNlcnZlUG9pbnRlck9uRGVsZXRlKXt0aGlzLiQkLmNvdW50LnZhbHVlKz0xO3JldHVybiB0aGlzfWVsc2V7dmFyIGNsb25lPWF0dGFjaEZpbmFsaXplcihPYmplY3QuY3JlYXRlKE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKSx7JCQ6e3ZhbHVlOnNoYWxsb3dDb3B5SW50ZXJuYWxQb2ludGVyKHRoaXMuJCQpfX0pKTtjbG9uZS4kJC5jb3VudC52YWx1ZSs9MTtjbG9uZS4kJC5kZWxldGVTY2hlZHVsZWQ9ZmFsc2U7cmV0dXJuIGNsb25lfX1mdW5jdGlvbiBDbGFzc0hhbmRsZV9kZWxldGUoKXtpZighdGhpcy4kJC5wdHIpe3Rocm93SW5zdGFuY2VBbHJlYWR5RGVsZXRlZCh0aGlzKX1pZih0aGlzLiQkLmRlbGV0ZVNjaGVkdWxlZCYmIXRoaXMuJCQucHJlc2VydmVQb2ludGVyT25EZWxldGUpe3Rocm93QmluZGluZ0Vycm9yKCJPYmplY3QgYWxyZWFkeSBzY2hlZHVsZWQgZm9yIGRlbGV0aW9uIil9ZGV0YWNoRmluYWxpemVyKHRoaXMpO3JlbGVhc2VDbGFzc0hhbmRsZSh0aGlzLiQkKTtpZighdGhpcy4kJC5wcmVzZXJ2ZVBvaW50ZXJPbkRlbGV0ZSl7dGhpcy4kJC5zbWFydFB0cj11bmRlZmluZWQ7dGhpcy4kJC5wdHI9dW5kZWZpbmVkfX1mdW5jdGlvbiBDbGFzc0hhbmRsZV9pc0RlbGV0ZWQoKXtyZXR1cm4hdGhpcy4kJC5wdHJ9dmFyIGRlbGF5RnVuY3Rpb249dW5kZWZpbmVkO3ZhciBkZWxldGlvblF1ZXVlPVtdO2Z1bmN0aW9uIGZsdXNoUGVuZGluZ0RlbGV0ZXMoKXt3aGlsZShkZWxldGlvblF1ZXVlLmxlbmd0aCl7dmFyIG9iaj1kZWxldGlvblF1ZXVlLnBvcCgpO29iai4kJC5kZWxldGVTY2hlZHVsZWQ9ZmFsc2U7b2JqWyJkZWxldGUiXSgpfX1mdW5jdGlvbiBDbGFzc0hhbmRsZV9kZWxldGVMYXRlcigpe2lmKCF0aGlzLiQkLnB0cil7dGhyb3dJbnN0YW5jZUFscmVhZHlEZWxldGVkKHRoaXMpfWlmKHRoaXMuJCQuZGVsZXRlU2NoZWR1bGVkJiYhdGhpcy4kJC5wcmVzZXJ2ZVBvaW50ZXJPbkRlbGV0ZSl7dGhyb3dCaW5kaW5nRXJyb3IoIk9iamVjdCBhbHJlYWR5IHNjaGVkdWxlZCBmb3IgZGVsZXRpb24iKX1kZWxldGlvblF1ZXVlLnB1c2godGhpcyk7aWYoZGVsZXRpb25RdWV1ZS5sZW5ndGg9PT0xJiZkZWxheUZ1bmN0aW9uKXtkZWxheUZ1bmN0aW9uKGZsdXNoUGVuZGluZ0RlbGV0ZXMpfXRoaXMuJCQuZGVsZXRlU2NoZWR1bGVkPXRydWU7cmV0dXJuIHRoaXN9ZnVuY3Rpb24gaW5pdF9DbGFzc0hhbmRsZSgpe0NsYXNzSGFuZGxlLnByb3RvdHlwZVsiaXNBbGlhc09mIl09Q2xhc3NIYW5kbGVfaXNBbGlhc09mO0NsYXNzSGFuZGxlLnByb3RvdHlwZVsiY2xvbmUiXT1DbGFzc0hhbmRsZV9jbG9uZTtDbGFzc0hhbmRsZS5wcm90b3R5cGVbImRlbGV0ZSJdPUNsYXNzSGFuZGxlX2RlbGV0ZTtDbGFzc0hhbmRsZS5wcm90b3R5cGVbImlzRGVsZXRlZCJdPUNsYXNzSGFuZGxlX2lzRGVsZXRlZDtDbGFzc0hhbmRsZS5wcm90b3R5cGVbImRlbGV0ZUxhdGVyIl09Q2xhc3NIYW5kbGVfZGVsZXRlTGF0ZXJ9ZnVuY3Rpb24gQ2xhc3NIYW5kbGUoKXt9dmFyIHJlZ2lzdGVyZWRQb2ludGVycz17fTtmdW5jdGlvbiBlbnN1cmVPdmVybG9hZFRhYmxlKHByb3RvLG1ldGhvZE5hbWUsaHVtYW5OYW1lKXtpZih1bmRlZmluZWQ9PT1wcm90b1ttZXRob2ROYW1lXS5vdmVybG9hZFRhYmxlKXt2YXIgcHJldkZ1bmM9cHJvdG9bbWV0aG9kTmFtZV07cHJvdG9bbWV0aG9kTmFtZV09ZnVuY3Rpb24oKXtpZighcHJvdG9bbWV0aG9kTmFtZV0ub3ZlcmxvYWRUYWJsZS5oYXNPd25Qcm9wZXJ0eShhcmd1bWVudHMubGVuZ3RoKSl7dGhyb3dCaW5kaW5nRXJyb3IoIkZ1bmN0aW9uICciK2h1bWFuTmFtZSsiJyBjYWxsZWQgd2l0aCBhbiBpbnZhbGlkIG51bWJlciBvZiBhcmd1bWVudHMgKCIrYXJndW1lbnRzLmxlbmd0aCsiKSAtIGV4cGVjdHMgb25lIG9mICgiK3Byb3RvW21ldGhvZE5hbWVdLm92ZXJsb2FkVGFibGUrIikhIil9cmV0dXJuIHByb3RvW21ldGhvZE5hbWVdLm92ZXJsb2FkVGFibGVbYXJndW1lbnRzLmxlbmd0aF0uYXBwbHkodGhpcyxhcmd1bWVudHMpfTtwcm90b1ttZXRob2ROYW1lXS5vdmVybG9hZFRhYmxlPVtdO3Byb3RvW21ldGhvZE5hbWVdLm92ZXJsb2FkVGFibGVbcHJldkZ1bmMuYXJnQ291bnRdPXByZXZGdW5jfX1mdW5jdGlvbiBleHBvc2VQdWJsaWNTeW1ib2wobmFtZSx2YWx1ZSxudW1Bcmd1bWVudHMpe2lmKE1vZHVsZS5oYXNPd25Qcm9wZXJ0eShuYW1lKSl7aWYodW5kZWZpbmVkPT09bnVtQXJndW1lbnRzfHx1bmRlZmluZWQhPT1Nb2R1bGVbbmFtZV0ub3ZlcmxvYWRUYWJsZSYmdW5kZWZpbmVkIT09TW9kdWxlW25hbWVdLm92ZXJsb2FkVGFibGVbbnVtQXJndW1lbnRzXSl7dGhyb3dCaW5kaW5nRXJyb3IoIkNhbm5vdCByZWdpc3RlciBwdWJsaWMgbmFtZSAnIituYW1lKyInIHR3aWNlIil9ZW5zdXJlT3ZlcmxvYWRUYWJsZShNb2R1bGUsbmFtZSxuYW1lKTtpZihNb2R1bGUuaGFzT3duUHJvcGVydHkobnVtQXJndW1lbnRzKSl7dGhyb3dCaW5kaW5nRXJyb3IoIkNhbm5vdCByZWdpc3RlciBtdWx0aXBsZSBvdmVybG9hZHMgb2YgYSBmdW5jdGlvbiB3aXRoIHRoZSBzYW1lIG51bWJlciBvZiBhcmd1bWVudHMgKCIrbnVtQXJndW1lbnRzKyIpISIpfU1vZHVsZVtuYW1lXS5vdmVybG9hZFRhYmxlW251bUFyZ3VtZW50c109dmFsdWV9ZWxzZXtNb2R1bGVbbmFtZV09dmFsdWU7aWYodW5kZWZpbmVkIT09bnVtQXJndW1lbnRzKXtNb2R1bGVbbmFtZV0ubnVtQXJndW1lbnRzPW51bUFyZ3VtZW50c319fWZ1bmN0aW9uIFJlZ2lzdGVyZWRDbGFzcyhuYW1lLGNvbnN0cnVjdG9yLGluc3RhbmNlUHJvdG90eXBlLHJhd0Rlc3RydWN0b3IsYmFzZUNsYXNzLGdldEFjdHVhbFR5cGUsdXBjYXN0LGRvd25jYXN0KXt0aGlzLm5hbWU9bmFtZTt0aGlzLmNvbnN0cnVjdG9yPWNvbnN0cnVjdG9yO3RoaXMuaW5zdGFuY2VQcm90b3R5cGU9aW5zdGFuY2VQcm90b3R5cGU7dGhpcy5yYXdEZXN0cnVjdG9yPXJhd0Rlc3RydWN0b3I7dGhpcy5iYXNlQ2xhc3M9YmFzZUNsYXNzO3RoaXMuZ2V0QWN0dWFsVHlwZT1nZXRBY3R1YWxUeXBlO3RoaXMudXBjYXN0PXVwY2FzdDt0aGlzLmRvd25jYXN0PWRvd25jYXN0O3RoaXMucHVyZVZpcnR1YWxGdW5jdGlvbnM9W119ZnVuY3Rpb24gdXBjYXN0UG9pbnRlcihwdHIscHRyQ2xhc3MsZGVzaXJlZENsYXNzKXt3aGlsZShwdHJDbGFzcyE9PWRlc2lyZWRDbGFzcyl7aWYoIXB0ckNsYXNzLnVwY2FzdCl7dGhyb3dCaW5kaW5nRXJyb3IoIkV4cGVjdGVkIG51bGwgb3IgaW5zdGFuY2Ugb2YgIitkZXNpcmVkQ2xhc3MubmFtZSsiLCBnb3QgYW4gaW5zdGFuY2Ugb2YgIitwdHJDbGFzcy5uYW1lKX1wdHI9cHRyQ2xhc3MudXBjYXN0KHB0cik7cHRyQ2xhc3M9cHRyQ2xhc3MuYmFzZUNsYXNzfXJldHVybiBwdHJ9ZnVuY3Rpb24gY29uc3ROb1NtYXJ0UHRyUmF3UG9pbnRlclRvV2lyZVR5cGUoZGVzdHJ1Y3RvcnMsaGFuZGxlKXtpZihoYW5kbGU9PT1udWxsKXtpZih0aGlzLmlzUmVmZXJlbmNlKXt0aHJvd0JpbmRpbmdFcnJvcigibnVsbCBpcyBub3QgYSB2YWxpZCAiK3RoaXMubmFtZSl9cmV0dXJuIDB9aWYoIWhhbmRsZS4kJCl7dGhyb3dCaW5kaW5nRXJyb3IoJ0Nhbm5vdCBwYXNzICInK19lbWJpbmRfcmVwcihoYW5kbGUpKyciIGFzIGEgJyt0aGlzLm5hbWUpfWlmKCFoYW5kbGUuJCQucHRyKXt0aHJvd0JpbmRpbmdFcnJvcigiQ2Fubm90IHBhc3MgZGVsZXRlZCBvYmplY3QgYXMgYSBwb2ludGVyIG9mIHR5cGUgIit0aGlzLm5hbWUpfXZhciBoYW5kbGVDbGFzcz1oYW5kbGUuJCQucHRyVHlwZS5yZWdpc3RlcmVkQ2xhc3M7dmFyIHB0cj11cGNhc3RQb2ludGVyKGhhbmRsZS4kJC5wdHIsaGFuZGxlQ2xhc3MsdGhpcy5yZWdpc3RlcmVkQ2xhc3MpO3JldHVybiBwdHJ9ZnVuY3Rpb24gZ2VuZXJpY1BvaW50ZXJUb1dpcmVUeXBlKGRlc3RydWN0b3JzLGhhbmRsZSl7dmFyIHB0cjtpZihoYW5kbGU9PT1udWxsKXtpZih0aGlzLmlzUmVmZXJlbmNlKXt0aHJvd0JpbmRpbmdFcnJvcigibnVsbCBpcyBub3QgYSB2YWxpZCAiK3RoaXMubmFtZSl9aWYodGhpcy5pc1NtYXJ0UG9pbnRlcil7cHRyPXRoaXMucmF3Q29uc3RydWN0b3IoKTtpZihkZXN0cnVjdG9ycyE9PW51bGwpe2Rlc3RydWN0b3JzLnB1c2godGhpcy5yYXdEZXN0cnVjdG9yLHB0cil9cmV0dXJuIHB0cn1lbHNle3JldHVybiAwfX1pZighaGFuZGxlLiQkKXt0aHJvd0JpbmRpbmdFcnJvcignQ2Fubm90IHBhc3MgIicrX2VtYmluZF9yZXByKGhhbmRsZSkrJyIgYXMgYSAnK3RoaXMubmFtZSl9aWYoIWhhbmRsZS4kJC5wdHIpe3Rocm93QmluZGluZ0Vycm9yKCJDYW5ub3QgcGFzcyBkZWxldGVkIG9iamVjdCBhcyBhIHBvaW50ZXIgb2YgdHlwZSAiK3RoaXMubmFtZSl9aWYoIXRoaXMuaXNDb25zdCYmaGFuZGxlLiQkLnB0clR5cGUuaXNDb25zdCl7dGhyb3dCaW5kaW5nRXJyb3IoIkNhbm5vdCBjb252ZXJ0IGFyZ3VtZW50IG9mIHR5cGUgIisoaGFuZGxlLiQkLnNtYXJ0UHRyVHlwZT9oYW5kbGUuJCQuc21hcnRQdHJUeXBlLm5hbWU6aGFuZGxlLiQkLnB0clR5cGUubmFtZSkrIiB0byBwYXJhbWV0ZXIgdHlwZSAiK3RoaXMubmFtZSl9dmFyIGhhbmRsZUNsYXNzPWhhbmRsZS4kJC5wdHJUeXBlLnJlZ2lzdGVyZWRDbGFzcztwdHI9dXBjYXN0UG9pbnRlcihoYW5kbGUuJCQucHRyLGhhbmRsZUNsYXNzLHRoaXMucmVnaXN0ZXJlZENsYXNzKTtpZih0aGlzLmlzU21hcnRQb2ludGVyKXtpZih1bmRlZmluZWQ9PT1oYW5kbGUuJCQuc21hcnRQdHIpe3Rocm93QmluZGluZ0Vycm9yKCJQYXNzaW5nIHJhdyBwb2ludGVyIHRvIHNtYXJ0IHBvaW50ZXIgaXMgaWxsZWdhbCIpfXN3aXRjaCh0aGlzLnNoYXJpbmdQb2xpY3kpe2Nhc2UgMDppZihoYW5kbGUuJCQuc21hcnRQdHJUeXBlPT09dGhpcyl7cHRyPWhhbmRsZS4kJC5zbWFydFB0cn1lbHNle3Rocm93QmluZGluZ0Vycm9yKCJDYW5ub3QgY29udmVydCBhcmd1bWVudCBvZiB0eXBlICIrKGhhbmRsZS4kJC5zbWFydFB0clR5cGU/aGFuZGxlLiQkLnNtYXJ0UHRyVHlwZS5uYW1lOmhhbmRsZS4kJC5wdHJUeXBlLm5hbWUpKyIgdG8gcGFyYW1ldGVyIHR5cGUgIit0aGlzLm5hbWUpfWJyZWFrO2Nhc2UgMTpwdHI9aGFuZGxlLiQkLnNtYXJ0UHRyO2JyZWFrO2Nhc2UgMjppZihoYW5kbGUuJCQuc21hcnRQdHJUeXBlPT09dGhpcyl7cHRyPWhhbmRsZS4kJC5zbWFydFB0cn1lbHNle3ZhciBjbG9uZWRIYW5kbGU9aGFuZGxlWyJjbG9uZSJdKCk7cHRyPXRoaXMucmF3U2hhcmUocHRyLF9fZW12YWxfcmVnaXN0ZXIoZnVuY3Rpb24oKXtjbG9uZWRIYW5kbGVbImRlbGV0ZSJdKCl9KSk7aWYoZGVzdHJ1Y3RvcnMhPT1udWxsKXtkZXN0cnVjdG9ycy5wdXNoKHRoaXMucmF3RGVzdHJ1Y3RvcixwdHIpfX1icmVhaztkZWZhdWx0OnRocm93QmluZGluZ0Vycm9yKCJVbnN1cHBvcnRpbmcgc2hhcmluZyBwb2xpY3kiKX19cmV0dXJuIHB0cn1mdW5jdGlvbiBub25Db25zdE5vU21hcnRQdHJSYXdQb2ludGVyVG9XaXJlVHlwZShkZXN0cnVjdG9ycyxoYW5kbGUpe2lmKGhhbmRsZT09PW51bGwpe2lmKHRoaXMuaXNSZWZlcmVuY2Upe3Rocm93QmluZGluZ0Vycm9yKCJudWxsIGlzIG5vdCBhIHZhbGlkICIrdGhpcy5uYW1lKX1yZXR1cm4gMH1pZighaGFuZGxlLiQkKXt0aHJvd0JpbmRpbmdFcnJvcignQ2Fubm90IHBhc3MgIicrX2VtYmluZF9yZXByKGhhbmRsZSkrJyIgYXMgYSAnK3RoaXMubmFtZSl9aWYoIWhhbmRsZS4kJC5wdHIpe3Rocm93QmluZGluZ0Vycm9yKCJDYW5ub3QgcGFzcyBkZWxldGVkIG9iamVjdCBhcyBhIHBvaW50ZXIgb2YgdHlwZSAiK3RoaXMubmFtZSl9aWYoaGFuZGxlLiQkLnB0clR5cGUuaXNDb25zdCl7dGhyb3dCaW5kaW5nRXJyb3IoIkNhbm5vdCBjb252ZXJ0IGFyZ3VtZW50IG9mIHR5cGUgIitoYW5kbGUuJCQucHRyVHlwZS5uYW1lKyIgdG8gcGFyYW1ldGVyIHR5cGUgIit0aGlzLm5hbWUpfXZhciBoYW5kbGVDbGFzcz1oYW5kbGUuJCQucHRyVHlwZS5yZWdpc3RlcmVkQ2xhc3M7dmFyIHB0cj11cGNhc3RQb2ludGVyKGhhbmRsZS4kJC5wdHIsaGFuZGxlQ2xhc3MsdGhpcy5yZWdpc3RlcmVkQ2xhc3MpO3JldHVybiBwdHJ9ZnVuY3Rpb24gc2ltcGxlUmVhZFZhbHVlRnJvbVBvaW50ZXIocG9pbnRlcil7cmV0dXJuIHRoaXNbImZyb21XaXJlVHlwZSJdKEhFQVBVMzJbcG9pbnRlcj4+Ml0pfWZ1bmN0aW9uIFJlZ2lzdGVyZWRQb2ludGVyX2dldFBvaW50ZWUocHRyKXtpZih0aGlzLnJhd0dldFBvaW50ZWUpe3B0cj10aGlzLnJhd0dldFBvaW50ZWUocHRyKX1yZXR1cm4gcHRyfWZ1bmN0aW9uIFJlZ2lzdGVyZWRQb2ludGVyX2Rlc3RydWN0b3IocHRyKXtpZih0aGlzLnJhd0Rlc3RydWN0b3Ipe3RoaXMucmF3RGVzdHJ1Y3RvcihwdHIpfX1mdW5jdGlvbiBSZWdpc3RlcmVkUG9pbnRlcl9kZWxldGVPYmplY3QoaGFuZGxlKXtpZihoYW5kbGUhPT1udWxsKXtoYW5kbGVbImRlbGV0ZSJdKCl9fWZ1bmN0aW9uIGRvd25jYXN0UG9pbnRlcihwdHIscHRyQ2xhc3MsZGVzaXJlZENsYXNzKXtpZihwdHJDbGFzcz09PWRlc2lyZWRDbGFzcyl7cmV0dXJuIHB0cn1pZih1bmRlZmluZWQ9PT1kZXNpcmVkQ2xhc3MuYmFzZUNsYXNzKXtyZXR1cm4gbnVsbH12YXIgcnY9ZG93bmNhc3RQb2ludGVyKHB0cixwdHJDbGFzcyxkZXNpcmVkQ2xhc3MuYmFzZUNsYXNzKTtpZihydj09PW51bGwpe3JldHVybiBudWxsfXJldHVybiBkZXNpcmVkQ2xhc3MuZG93bmNhc3QocnYpfWZ1bmN0aW9uIGdldEluaGVyaXRlZEluc3RhbmNlQ291bnQoKXtyZXR1cm4gT2JqZWN0LmtleXMocmVnaXN0ZXJlZEluc3RhbmNlcykubGVuZ3RofWZ1bmN0aW9uIGdldExpdmVJbmhlcml0ZWRJbnN0YW5jZXMoKXt2YXIgcnY9W107Zm9yKHZhciBrIGluIHJlZ2lzdGVyZWRJbnN0YW5jZXMpe2lmKHJlZ2lzdGVyZWRJbnN0YW5jZXMuaGFzT3duUHJvcGVydHkoaykpe3J2LnB1c2gocmVnaXN0ZXJlZEluc3RhbmNlc1trXSl9fXJldHVybiBydn1mdW5jdGlvbiBzZXREZWxheUZ1bmN0aW9uKGZuKXtkZWxheUZ1bmN0aW9uPWZuO2lmKGRlbGV0aW9uUXVldWUubGVuZ3RoJiZkZWxheUZ1bmN0aW9uKXtkZWxheUZ1bmN0aW9uKGZsdXNoUGVuZGluZ0RlbGV0ZXMpfX1mdW5jdGlvbiBpbml0X2VtYmluZCgpe01vZHVsZVsiZ2V0SW5oZXJpdGVkSW5zdGFuY2VDb3VudCJdPWdldEluaGVyaXRlZEluc3RhbmNlQ291bnQ7TW9kdWxlWyJnZXRMaXZlSW5oZXJpdGVkSW5zdGFuY2VzIl09Z2V0TGl2ZUluaGVyaXRlZEluc3RhbmNlcztNb2R1bGVbImZsdXNoUGVuZGluZ0RlbGV0ZXMiXT1mbHVzaFBlbmRpbmdEZWxldGVzO01vZHVsZVsic2V0RGVsYXlGdW5jdGlvbiJdPXNldERlbGF5RnVuY3Rpb259dmFyIHJlZ2lzdGVyZWRJbnN0YW5jZXM9e307ZnVuY3Rpb24gZ2V0QmFzZXN0UG9pbnRlcihjbGFzc18scHRyKXtpZihwdHI9PT11bmRlZmluZWQpe3Rocm93QmluZGluZ0Vycm9yKCJwdHIgc2hvdWxkIG5vdCBiZSB1bmRlZmluZWQiKX13aGlsZShjbGFzc18uYmFzZUNsYXNzKXtwdHI9Y2xhc3NfLnVwY2FzdChwdHIpO2NsYXNzXz1jbGFzc18uYmFzZUNsYXNzfXJldHVybiBwdHJ9ZnVuY3Rpb24gZ2V0SW5oZXJpdGVkSW5zdGFuY2UoY2xhc3NfLHB0cil7cHRyPWdldEJhc2VzdFBvaW50ZXIoY2xhc3NfLHB0cik7cmV0dXJuIHJlZ2lzdGVyZWRJbnN0YW5jZXNbcHRyXX1mdW5jdGlvbiBtYWtlQ2xhc3NIYW5kbGUocHJvdG90eXBlLHJlY29yZCl7aWYoIXJlY29yZC5wdHJUeXBlfHwhcmVjb3JkLnB0cil7dGhyb3dJbnRlcm5hbEVycm9yKCJtYWtlQ2xhc3NIYW5kbGUgcmVxdWlyZXMgcHRyIGFuZCBwdHJUeXBlIil9dmFyIGhhc1NtYXJ0UHRyVHlwZT0hIXJlY29yZC5zbWFydFB0clR5cGU7dmFyIGhhc1NtYXJ0UHRyPSEhcmVjb3JkLnNtYXJ0UHRyO2lmKGhhc1NtYXJ0UHRyVHlwZSE9PWhhc1NtYXJ0UHRyKXt0aHJvd0ludGVybmFsRXJyb3IoIkJvdGggc21hcnRQdHJUeXBlIGFuZCBzbWFydFB0ciBtdXN0IGJlIHNwZWNpZmllZCIpfXJlY29yZC5jb3VudD17dmFsdWU6MX07cmV0dXJuIGF0dGFjaEZpbmFsaXplcihPYmplY3QuY3JlYXRlKHByb3RvdHlwZSx7JCQ6e3ZhbHVlOnJlY29yZH19KSl9ZnVuY3Rpb24gUmVnaXN0ZXJlZFBvaW50ZXJfZnJvbVdpcmVUeXBlKHB0cil7dmFyIHJhd1BvaW50ZXI9dGhpcy5nZXRQb2ludGVlKHB0cik7aWYoIXJhd1BvaW50ZXIpe3RoaXMuZGVzdHJ1Y3RvcihwdHIpO3JldHVybiBudWxsfXZhciByZWdpc3RlcmVkSW5zdGFuY2U9Z2V0SW5oZXJpdGVkSW5zdGFuY2UodGhpcy5yZWdpc3RlcmVkQ2xhc3MscmF3UG9pbnRlcik7aWYodW5kZWZpbmVkIT09cmVnaXN0ZXJlZEluc3RhbmNlKXtpZigwPT09cmVnaXN0ZXJlZEluc3RhbmNlLiQkLmNvdW50LnZhbHVlKXtyZWdpc3RlcmVkSW5zdGFuY2UuJCQucHRyPXJhd1BvaW50ZXI7cmVnaXN0ZXJlZEluc3RhbmNlLiQkLnNtYXJ0UHRyPXB0cjtyZXR1cm4gcmVnaXN0ZXJlZEluc3RhbmNlWyJjbG9uZSJdKCl9ZWxzZXt2YXIgcnY9cmVnaXN0ZXJlZEluc3RhbmNlWyJjbG9uZSJdKCk7dGhpcy5kZXN0cnVjdG9yKHB0cik7cmV0dXJuIHJ2fX1mdW5jdGlvbiBtYWtlRGVmYXVsdEhhbmRsZSgpe2lmKHRoaXMuaXNTbWFydFBvaW50ZXIpe3JldHVybiBtYWtlQ2xhc3NIYW5kbGUodGhpcy5yZWdpc3RlcmVkQ2xhc3MuaW5zdGFuY2VQcm90b3R5cGUse3B0clR5cGU6dGhpcy5wb2ludGVlVHlwZSxwdHI6cmF3UG9pbnRlcixzbWFydFB0clR5cGU6dGhpcyxzbWFydFB0cjpwdHJ9KX1lbHNle3JldHVybiBtYWtlQ2xhc3NIYW5kbGUodGhpcy5yZWdpc3RlcmVkQ2xhc3MuaW5zdGFuY2VQcm90b3R5cGUse3B0clR5cGU6dGhpcyxwdHI6cHRyfSl9fXZhciBhY3R1YWxUeXBlPXRoaXMucmVnaXN0ZXJlZENsYXNzLmdldEFjdHVhbFR5cGUocmF3UG9pbnRlcik7dmFyIHJlZ2lzdGVyZWRQb2ludGVyUmVjb3JkPXJlZ2lzdGVyZWRQb2ludGVyc1thY3R1YWxUeXBlXTtpZighcmVnaXN0ZXJlZFBvaW50ZXJSZWNvcmQpe3JldHVybiBtYWtlRGVmYXVsdEhhbmRsZS5jYWxsKHRoaXMpfXZhciB0b1R5cGU7aWYodGhpcy5pc0NvbnN0KXt0b1R5cGU9cmVnaXN0ZXJlZFBvaW50ZXJSZWNvcmQuY29uc3RQb2ludGVyVHlwZX1lbHNle3RvVHlwZT1yZWdpc3RlcmVkUG9pbnRlclJlY29yZC5wb2ludGVyVHlwZX12YXIgZHA9ZG93bmNhc3RQb2ludGVyKHJhd1BvaW50ZXIsdGhpcy5yZWdpc3RlcmVkQ2xhc3MsdG9UeXBlLnJlZ2lzdGVyZWRDbGFzcyk7aWYoZHA9PT1udWxsKXtyZXR1cm4gbWFrZURlZmF1bHRIYW5kbGUuY2FsbCh0aGlzKX1pZih0aGlzLmlzU21hcnRQb2ludGVyKXtyZXR1cm4gbWFrZUNsYXNzSGFuZGxlKHRvVHlwZS5yZWdpc3RlcmVkQ2xhc3MuaW5zdGFuY2VQcm90b3R5cGUse3B0clR5cGU6dG9UeXBlLHB0cjpkcCxzbWFydFB0clR5cGU6dGhpcyxzbWFydFB0cjpwdHJ9KX1lbHNle3JldHVybiBtYWtlQ2xhc3NIYW5kbGUodG9UeXBlLnJlZ2lzdGVyZWRDbGFzcy5pbnN0YW5jZVByb3RvdHlwZSx7cHRyVHlwZTp0b1R5cGUscHRyOmRwfSl9fWZ1bmN0aW9uIGluaXRfUmVnaXN0ZXJlZFBvaW50ZXIoKXtSZWdpc3RlcmVkUG9pbnRlci5wcm90b3R5cGUuZ2V0UG9pbnRlZT1SZWdpc3RlcmVkUG9pbnRlcl9nZXRQb2ludGVlO1JlZ2lzdGVyZWRQb2ludGVyLnByb3RvdHlwZS5kZXN0cnVjdG9yPVJlZ2lzdGVyZWRQb2ludGVyX2Rlc3RydWN0b3I7UmVnaXN0ZXJlZFBvaW50ZXIucHJvdG90eXBlWyJhcmdQYWNrQWR2YW5jZSJdPTg7UmVnaXN0ZXJlZFBvaW50ZXIucHJvdG90eXBlWyJyZWFkVmFsdWVGcm9tUG9pbnRlciJdPXNpbXBsZVJlYWRWYWx1ZUZyb21Qb2ludGVyO1JlZ2lzdGVyZWRQb2ludGVyLnByb3RvdHlwZVsiZGVsZXRlT2JqZWN0Il09UmVnaXN0ZXJlZFBvaW50ZXJfZGVsZXRlT2JqZWN0O1JlZ2lzdGVyZWRQb2ludGVyLnByb3RvdHlwZVsiZnJvbVdpcmVUeXBlIl09UmVnaXN0ZXJlZFBvaW50ZXJfZnJvbVdpcmVUeXBlfWZ1bmN0aW9uIFJlZ2lzdGVyZWRQb2ludGVyKG5hbWUscmVnaXN0ZXJlZENsYXNzLGlzUmVmZXJlbmNlLGlzQ29uc3QsaXNTbWFydFBvaW50ZXIscG9pbnRlZVR5cGUsc2hhcmluZ1BvbGljeSxyYXdHZXRQb2ludGVlLHJhd0NvbnN0cnVjdG9yLHJhd1NoYXJlLHJhd0Rlc3RydWN0b3Ipe3RoaXMubmFtZT1uYW1lO3RoaXMucmVnaXN0ZXJlZENsYXNzPXJlZ2lzdGVyZWRDbGFzczt0aGlzLmlzUmVmZXJlbmNlPWlzUmVmZXJlbmNlO3RoaXMuaXNDb25zdD1pc0NvbnN0O3RoaXMuaXNTbWFydFBvaW50ZXI9aXNTbWFydFBvaW50ZXI7dGhpcy5wb2ludGVlVHlwZT1wb2ludGVlVHlwZTt0aGlzLnNoYXJpbmdQb2xpY3k9c2hhcmluZ1BvbGljeTt0aGlzLnJhd0dldFBvaW50ZWU9cmF3R2V0UG9pbnRlZTt0aGlzLnJhd0NvbnN0cnVjdG9yPXJhd0NvbnN0cnVjdG9yO3RoaXMucmF3U2hhcmU9cmF3U2hhcmU7dGhpcy5yYXdEZXN0cnVjdG9yPXJhd0Rlc3RydWN0b3I7aWYoIWlzU21hcnRQb2ludGVyJiZyZWdpc3RlcmVkQ2xhc3MuYmFzZUNsYXNzPT09dW5kZWZpbmVkKXtpZihpc0NvbnN0KXt0aGlzWyJ0b1dpcmVUeXBlIl09Y29uc3ROb1NtYXJ0UHRyUmF3UG9pbnRlclRvV2lyZVR5cGU7dGhpcy5kZXN0cnVjdG9yRnVuY3Rpb249bnVsbH1lbHNle3RoaXNbInRvV2lyZVR5cGUiXT1ub25Db25zdE5vU21hcnRQdHJSYXdQb2ludGVyVG9XaXJlVHlwZTt0aGlzLmRlc3RydWN0b3JGdW5jdGlvbj1udWxsfX1lbHNle3RoaXNbInRvV2lyZVR5cGUiXT1nZW5lcmljUG9pbnRlclRvV2lyZVR5cGV9fWZ1bmN0aW9uIHJlcGxhY2VQdWJsaWNTeW1ib2wobmFtZSx2YWx1ZSxudW1Bcmd1bWVudHMpe2lmKCFNb2R1bGUuaGFzT3duUHJvcGVydHkobmFtZSkpe3Rocm93SW50ZXJuYWxFcnJvcigiUmVwbGFjaW5nIG5vbmV4aXN0YW50IHB1YmxpYyBzeW1ib2wiKX1pZih1bmRlZmluZWQhPT1Nb2R1bGVbbmFtZV0ub3ZlcmxvYWRUYWJsZSYmdW5kZWZpbmVkIT09bnVtQXJndW1lbnRzKXtNb2R1bGVbbmFtZV0ub3ZlcmxvYWRUYWJsZVtudW1Bcmd1bWVudHNdPXZhbHVlfWVsc2V7TW9kdWxlW25hbWVdPXZhbHVlO01vZHVsZVtuYW1lXS5hcmdDb3VudD1udW1Bcmd1bWVudHN9fWZ1bmN0aW9uIGR5bkNhbGxMZWdhY3koc2lnLHB0cixhcmdzKXt2YXIgZj1Nb2R1bGVbImR5bkNhbGxfIitzaWddO3JldHVybiBhcmdzJiZhcmdzLmxlbmd0aD9mLmFwcGx5KG51bGwsW3B0cl0uY29uY2F0KGFyZ3MpKTpmLmNhbGwobnVsbCxwdHIpfWZ1bmN0aW9uIGR5bkNhbGwoc2lnLHB0cixhcmdzKXtpZihzaWcuaW5kZXhPZigiaiIpIT0tMSl7cmV0dXJuIGR5bkNhbGxMZWdhY3koc2lnLHB0cixhcmdzKX1yZXR1cm4gd2FzbVRhYmxlLmdldChwdHIpLmFwcGx5KG51bGwsYXJncyl9ZnVuY3Rpb24gZ2V0RHluQ2FsbGVyKHNpZyxwdHIpe3ZhciBhcmdDYWNoZT1bXTtyZXR1cm4gZnVuY3Rpb24oKXthcmdDYWNoZS5sZW5ndGg9YXJndW1lbnRzLmxlbmd0aDtmb3IodmFyIGk9MDtpPGFyZ3VtZW50cy5sZW5ndGg7aSsrKXthcmdDYWNoZVtpXT1hcmd1bWVudHNbaV19cmV0dXJuIGR5bkNhbGwoc2lnLHB0cixhcmdDYWNoZSl9fWZ1bmN0aW9uIGVtYmluZF9fcmVxdWlyZUZ1bmN0aW9uKHNpZ25hdHVyZSxyYXdGdW5jdGlvbil7c2lnbmF0dXJlPXJlYWRMYXRpbjFTdHJpbmcoc2lnbmF0dXJlKTtmdW5jdGlvbiBtYWtlRHluQ2FsbGVyKCl7aWYoc2lnbmF0dXJlLmluZGV4T2YoImoiKSE9LTEpe3JldHVybiBnZXREeW5DYWxsZXIoc2lnbmF0dXJlLHJhd0Z1bmN0aW9uKX1yZXR1cm4gd2FzbVRhYmxlLmdldChyYXdGdW5jdGlvbil9dmFyIGZwPW1ha2VEeW5DYWxsZXIoKTtpZih0eXBlb2YgZnAhPT0iZnVuY3Rpb24iKXt0aHJvd0JpbmRpbmdFcnJvcigidW5rbm93biBmdW5jdGlvbiBwb2ludGVyIHdpdGggc2lnbmF0dXJlICIrc2lnbmF0dXJlKyI6ICIrcmF3RnVuY3Rpb24pfXJldHVybiBmcH12YXIgVW5ib3VuZFR5cGVFcnJvcj11bmRlZmluZWQ7ZnVuY3Rpb24gZ2V0VHlwZU5hbWUodHlwZSl7dmFyIHB0cj1fX19nZXRUeXBlTmFtZSh0eXBlKTt2YXIgcnY9cmVhZExhdGluMVN0cmluZyhwdHIpO19mcmVlKHB0cik7cmV0dXJuIHJ2fWZ1bmN0aW9uIHRocm93VW5ib3VuZFR5cGVFcnJvcihtZXNzYWdlLHR5cGVzKXt2YXIgdW5ib3VuZFR5cGVzPVtdO3ZhciBzZWVuPXt9O2Z1bmN0aW9uIHZpc2l0KHR5cGUpe2lmKHNlZW5bdHlwZV0pe3JldHVybn1pZihyZWdpc3RlcmVkVHlwZXNbdHlwZV0pe3JldHVybn1pZih0eXBlRGVwZW5kZW5jaWVzW3R5cGVdKXt0eXBlRGVwZW5kZW5jaWVzW3R5cGVdLmZvckVhY2godmlzaXQpO3JldHVybn11bmJvdW5kVHlwZXMucHVzaCh0eXBlKTtzZWVuW3R5cGVdPXRydWV9dHlwZXMuZm9yRWFjaCh2aXNpdCk7dGhyb3cgbmV3IFVuYm91bmRUeXBlRXJyb3IobWVzc2FnZSsiOiAiK3VuYm91bmRUeXBlcy5tYXAoZ2V0VHlwZU5hbWUpLmpvaW4oWyIsICJdKSl9ZnVuY3Rpb24gX19lbWJpbmRfcmVnaXN0ZXJfY2xhc3MocmF3VHlwZSxyYXdQb2ludGVyVHlwZSxyYXdDb25zdFBvaW50ZXJUeXBlLGJhc2VDbGFzc1Jhd1R5cGUsZ2V0QWN0dWFsVHlwZVNpZ25hdHVyZSxnZXRBY3R1YWxUeXBlLHVwY2FzdFNpZ25hdHVyZSx1cGNhc3QsZG93bmNhc3RTaWduYXR1cmUsZG93bmNhc3QsbmFtZSxkZXN0cnVjdG9yU2lnbmF0dXJlLHJhd0Rlc3RydWN0b3Ipe25hbWU9cmVhZExhdGluMVN0cmluZyhuYW1lKTtnZXRBY3R1YWxUeXBlPWVtYmluZF9fcmVxdWlyZUZ1bmN0aW9uKGdldEFjdHVhbFR5cGVTaWduYXR1cmUsZ2V0QWN0dWFsVHlwZSk7aWYodXBjYXN0KXt1cGNhc3Q9ZW1iaW5kX19yZXF1aXJlRnVuY3Rpb24odXBjYXN0U2lnbmF0dXJlLHVwY2FzdCl9aWYoZG93bmNhc3Qpe2Rvd25jYXN0PWVtYmluZF9fcmVxdWlyZUZ1bmN0aW9uKGRvd25jYXN0U2lnbmF0dXJlLGRvd25jYXN0KX1yYXdEZXN0cnVjdG9yPWVtYmluZF9fcmVxdWlyZUZ1bmN0aW9uKGRlc3RydWN0b3JTaWduYXR1cmUscmF3RGVzdHJ1Y3Rvcik7dmFyIGxlZ2FsRnVuY3Rpb25OYW1lPW1ha2VMZWdhbEZ1bmN0aW9uTmFtZShuYW1lKTtleHBvc2VQdWJsaWNTeW1ib2wobGVnYWxGdW5jdGlvbk5hbWUsZnVuY3Rpb24oKXt0aHJvd1VuYm91bmRUeXBlRXJyb3IoIkNhbm5vdCBjb25zdHJ1Y3QgIituYW1lKyIgZHVlIHRvIHVuYm91bmQgdHlwZXMiLFtiYXNlQ2xhc3NSYXdUeXBlXSl9KTt3aGVuRGVwZW5kZW50VHlwZXNBcmVSZXNvbHZlZChbcmF3VHlwZSxyYXdQb2ludGVyVHlwZSxyYXdDb25zdFBvaW50ZXJUeXBlXSxiYXNlQ2xhc3NSYXdUeXBlP1tiYXNlQ2xhc3NSYXdUeXBlXTpbXSxmdW5jdGlvbihiYXNlKXtiYXNlPWJhc2VbMF07dmFyIGJhc2VDbGFzczt2YXIgYmFzZVByb3RvdHlwZTtpZihiYXNlQ2xhc3NSYXdUeXBlKXtiYXNlQ2xhc3M9YmFzZS5yZWdpc3RlcmVkQ2xhc3M7YmFzZVByb3RvdHlwZT1iYXNlQ2xhc3MuaW5zdGFuY2VQcm90b3R5cGV9ZWxzZXtiYXNlUHJvdG90eXBlPUNsYXNzSGFuZGxlLnByb3RvdHlwZX12YXIgY29uc3RydWN0b3I9Y3JlYXRlTmFtZWRGdW5jdGlvbihsZWdhbEZ1bmN0aW9uTmFtZSxmdW5jdGlvbigpe2lmKE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKSE9PWluc3RhbmNlUHJvdG90eXBlKXt0aHJvdyBuZXcgQmluZGluZ0Vycm9yKCJVc2UgJ25ldycgdG8gY29uc3RydWN0ICIrbmFtZSl9aWYodW5kZWZpbmVkPT09cmVnaXN0ZXJlZENsYXNzLmNvbnN0cnVjdG9yX2JvZHkpe3Rocm93IG5ldyBCaW5kaW5nRXJyb3IobmFtZSsiIGhhcyBubyBhY2Nlc3NpYmxlIGNvbnN0cnVjdG9yIil9dmFyIGJvZHk9cmVnaXN0ZXJlZENsYXNzLmNvbnN0cnVjdG9yX2JvZHlbYXJndW1lbnRzLmxlbmd0aF07aWYodW5kZWZpbmVkPT09Ym9keSl7dGhyb3cgbmV3IEJpbmRpbmdFcnJvcigiVHJpZWQgdG8gaW52b2tlIGN0b3Igb2YgIituYW1lKyIgd2l0aCBpbnZhbGlkIG51bWJlciBvZiBwYXJhbWV0ZXJzICgiK2FyZ3VtZW50cy5sZW5ndGgrIikgLSBleHBlY3RlZCAoIitPYmplY3Qua2V5cyhyZWdpc3RlcmVkQ2xhc3MuY29uc3RydWN0b3JfYm9keSkudG9TdHJpbmcoKSsiKSBwYXJhbWV0ZXJzIGluc3RlYWQhIil9cmV0dXJuIGJvZHkuYXBwbHkodGhpcyxhcmd1bWVudHMpfSk7dmFyIGluc3RhbmNlUHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYmFzZVByb3RvdHlwZSx7Y29uc3RydWN0b3I6e3ZhbHVlOmNvbnN0cnVjdG9yfX0pO2NvbnN0cnVjdG9yLnByb3RvdHlwZT1pbnN0YW5jZVByb3RvdHlwZTt2YXIgcmVnaXN0ZXJlZENsYXNzPW5ldyBSZWdpc3RlcmVkQ2xhc3MobmFtZSxjb25zdHJ1Y3RvcixpbnN0YW5jZVByb3RvdHlwZSxyYXdEZXN0cnVjdG9yLGJhc2VDbGFzcyxnZXRBY3R1YWxUeXBlLHVwY2FzdCxkb3duY2FzdCk7dmFyIHJlZmVyZW5jZUNvbnZlcnRlcj1uZXcgUmVnaXN0ZXJlZFBvaW50ZXIobmFtZSxyZWdpc3RlcmVkQ2xhc3MsdHJ1ZSxmYWxzZSxmYWxzZSk7dmFyIHBvaW50ZXJDb252ZXJ0ZXI9bmV3IFJlZ2lzdGVyZWRQb2ludGVyKG5hbWUrIioiLHJlZ2lzdGVyZWRDbGFzcyxmYWxzZSxmYWxzZSxmYWxzZSk7dmFyIGNvbnN0UG9pbnRlckNvbnZlcnRlcj1uZXcgUmVnaXN0ZXJlZFBvaW50ZXIobmFtZSsiIGNvbnN0KiIscmVnaXN0ZXJlZENsYXNzLGZhbHNlLHRydWUsZmFsc2UpO3JlZ2lzdGVyZWRQb2ludGVyc1tyYXdUeXBlXT17cG9pbnRlclR5cGU6cG9pbnRlckNvbnZlcnRlcixjb25zdFBvaW50ZXJUeXBlOmNvbnN0UG9pbnRlckNvbnZlcnRlcn07cmVwbGFjZVB1YmxpY1N5bWJvbChsZWdhbEZ1bmN0aW9uTmFtZSxjb25zdHJ1Y3Rvcik7cmV0dXJuW3JlZmVyZW5jZUNvbnZlcnRlcixwb2ludGVyQ29udmVydGVyLGNvbnN0UG9pbnRlckNvbnZlcnRlcl19KX1mdW5jdGlvbiBuZXdfKGNvbnN0cnVjdG9yLGFyZ3VtZW50TGlzdCl7aWYoIShjb25zdHJ1Y3RvciBpbnN0YW5jZW9mIEZ1bmN0aW9uKSl7dGhyb3cgbmV3IFR5cGVFcnJvcigibmV3XyBjYWxsZWQgd2l0aCBjb25zdHJ1Y3RvciB0eXBlICIrdHlwZW9mIGNvbnN0cnVjdG9yKyIgd2hpY2ggaXMgbm90IGEgZnVuY3Rpb24iKX12YXIgZHVtbXk9Y3JlYXRlTmFtZWRGdW5jdGlvbihjb25zdHJ1Y3Rvci5uYW1lfHwidW5rbm93bkZ1bmN0aW9uTmFtZSIsZnVuY3Rpb24oKXt9KTtkdW1teS5wcm90b3R5cGU9Y29uc3RydWN0b3IucHJvdG90eXBlO3ZhciBvYmo9bmV3IGR1bW15O3ZhciByPWNvbnN0cnVjdG9yLmFwcGx5KG9iaixhcmd1bWVudExpc3QpO3JldHVybiByIGluc3RhbmNlb2YgT2JqZWN0P3I6b2JqfWZ1bmN0aW9uIHJ1bkRlc3RydWN0b3JzKGRlc3RydWN0b3JzKXt3aGlsZShkZXN0cnVjdG9ycy5sZW5ndGgpe3ZhciBwdHI9ZGVzdHJ1Y3RvcnMucG9wKCk7dmFyIGRlbD1kZXN0cnVjdG9ycy5wb3AoKTtkZWwocHRyKX19ZnVuY3Rpb24gY3JhZnRJbnZva2VyRnVuY3Rpb24oaHVtYW5OYW1lLGFyZ1R5cGVzLGNsYXNzVHlwZSxjcHBJbnZva2VyRnVuYyxjcHBUYXJnZXRGdW5jKXt2YXIgYXJnQ291bnQ9YXJnVHlwZXMubGVuZ3RoO2lmKGFyZ0NvdW50PDIpe3Rocm93QmluZGluZ0Vycm9yKCJhcmdUeXBlcyBhcnJheSBzaXplIG1pc21hdGNoISBNdXN0IGF0IGxlYXN0IGdldCByZXR1cm4gdmFsdWUgYW5kICd0aGlzJyB0eXBlcyEiKX12YXIgaXNDbGFzc01ldGhvZEZ1bmM9YXJnVHlwZXNbMV0hPT1udWxsJiZjbGFzc1R5cGUhPT1udWxsO3ZhciBuZWVkc0Rlc3RydWN0b3JTdGFjaz1mYWxzZTtmb3IodmFyIGk9MTtpPGFyZ1R5cGVzLmxlbmd0aDsrK2kpe2lmKGFyZ1R5cGVzW2ldIT09bnVsbCYmYXJnVHlwZXNbaV0uZGVzdHJ1Y3RvckZ1bmN0aW9uPT09dW5kZWZpbmVkKXtuZWVkc0Rlc3RydWN0b3JTdGFjaz10cnVlO2JyZWFrfX12YXIgcmV0dXJucz1hcmdUeXBlc1swXS5uYW1lIT09InZvaWQiO3ZhciBhcmdzTGlzdD0iIjt2YXIgYXJnc0xpc3RXaXJlZD0iIjtmb3IodmFyIGk9MDtpPGFyZ0NvdW50LTI7KytpKXthcmdzTGlzdCs9KGkhPT0wPyIsICI6IiIpKyJhcmciK2k7YXJnc0xpc3RXaXJlZCs9KGkhPT0wPyIsICI6IiIpKyJhcmciK2krIldpcmVkIn12YXIgaW52b2tlckZuQm9keT0icmV0dXJuIGZ1bmN0aW9uICIrbWFrZUxlZ2FsRnVuY3Rpb25OYW1lKGh1bWFuTmFtZSkrIigiK2FyZ3NMaXN0KyIpIHtcbiIrImlmIChhcmd1bWVudHMubGVuZ3RoICE9PSAiKyhhcmdDb3VudC0yKSsiKSB7XG4iKyJ0aHJvd0JpbmRpbmdFcnJvcignZnVuY3Rpb24gIitodW1hbk5hbWUrIiBjYWxsZWQgd2l0aCAnICsgYXJndW1lbnRzLmxlbmd0aCArICcgYXJndW1lbnRzLCBleHBlY3RlZCAiKyhhcmdDb3VudC0yKSsiIGFyZ3MhJyk7XG4iKyJ9XG4iO2lmKG5lZWRzRGVzdHJ1Y3RvclN0YWNrKXtpbnZva2VyRm5Cb2R5Kz0idmFyIGRlc3RydWN0b3JzID0gW107XG4ifXZhciBkdG9yU3RhY2s9bmVlZHNEZXN0cnVjdG9yU3RhY2s/ImRlc3RydWN0b3JzIjoibnVsbCI7dmFyIGFyZ3MxPVsidGhyb3dCaW5kaW5nRXJyb3IiLCJpbnZva2VyIiwiZm4iLCJydW5EZXN0cnVjdG9ycyIsInJldFR5cGUiLCJjbGFzc1BhcmFtIl07dmFyIGFyZ3MyPVt0aHJvd0JpbmRpbmdFcnJvcixjcHBJbnZva2VyRnVuYyxjcHBUYXJnZXRGdW5jLHJ1bkRlc3RydWN0b3JzLGFyZ1R5cGVzWzBdLGFyZ1R5cGVzWzFdXTtpZihpc0NsYXNzTWV0aG9kRnVuYyl7aW52b2tlckZuQm9keSs9InZhciB0aGlzV2lyZWQgPSBjbGFzc1BhcmFtLnRvV2lyZVR5cGUoIitkdG9yU3RhY2srIiwgdGhpcyk7XG4ifWZvcih2YXIgaT0wO2k8YXJnQ291bnQtMjsrK2kpe2ludm9rZXJGbkJvZHkrPSJ2YXIgYXJnIitpKyJXaXJlZCA9IGFyZ1R5cGUiK2krIi50b1dpcmVUeXBlKCIrZHRvclN0YWNrKyIsIGFyZyIraSsiKTsgLy8gIithcmdUeXBlc1tpKzJdLm5hbWUrIlxuIjthcmdzMS5wdXNoKCJhcmdUeXBlIitpKTthcmdzMi5wdXNoKGFyZ1R5cGVzW2krMl0pfWlmKGlzQ2xhc3NNZXRob2RGdW5jKXthcmdzTGlzdFdpcmVkPSJ0aGlzV2lyZWQiKyhhcmdzTGlzdFdpcmVkLmxlbmd0aD4wPyIsICI6IiIpK2FyZ3NMaXN0V2lyZWR9aW52b2tlckZuQm9keSs9KHJldHVybnM/InZhciBydiA9ICI6IiIpKyJpbnZva2VyKGZuIisoYXJnc0xpc3RXaXJlZC5sZW5ndGg+MD8iLCAiOiIiKSthcmdzTGlzdFdpcmVkKyIpO1xuIjtpZihuZWVkc0Rlc3RydWN0b3JTdGFjayl7aW52b2tlckZuQm9keSs9InJ1bkRlc3RydWN0b3JzKGRlc3RydWN0b3JzKTtcbiJ9ZWxzZXtmb3IodmFyIGk9aXNDbGFzc01ldGhvZEZ1bmM/MToyO2k8YXJnVHlwZXMubGVuZ3RoOysraSl7dmFyIHBhcmFtTmFtZT1pPT09MT8idGhpc1dpcmVkIjoiYXJnIisoaS0yKSsiV2lyZWQiO2lmKGFyZ1R5cGVzW2ldLmRlc3RydWN0b3JGdW5jdGlvbiE9PW51bGwpe2ludm9rZXJGbkJvZHkrPXBhcmFtTmFtZSsiX2R0b3IoIitwYXJhbU5hbWUrIik7IC8vICIrYXJnVHlwZXNbaV0ubmFtZSsiXG4iO2FyZ3MxLnB1c2gocGFyYW1OYW1lKyJfZHRvciIpO2FyZ3MyLnB1c2goYXJnVHlwZXNbaV0uZGVzdHJ1Y3RvckZ1bmN0aW9uKX19fWlmKHJldHVybnMpe2ludm9rZXJGbkJvZHkrPSJ2YXIgcmV0ID0gcmV0VHlwZS5mcm9tV2lyZVR5cGUocnYpO1xuIisicmV0dXJuIHJldDtcbiJ9ZWxzZXt9aW52b2tlckZuQm9keSs9In1cbiI7YXJnczEucHVzaChpbnZva2VyRm5Cb2R5KTt2YXIgaW52b2tlckZ1bmN0aW9uPW5ld18oRnVuY3Rpb24sYXJnczEpLmFwcGx5KG51bGwsYXJnczIpO3JldHVybiBpbnZva2VyRnVuY3Rpb259ZnVuY3Rpb24gaGVhcDMyVmVjdG9yVG9BcnJheShjb3VudCxmaXJzdEVsZW1lbnQpe3ZhciBhcnJheT1bXTtmb3IodmFyIGk9MDtpPGNvdW50O2krKyl7YXJyYXkucHVzaChIRUFQMzJbKGZpcnN0RWxlbWVudD4+MikraV0pfXJldHVybiBhcnJheX1mdW5jdGlvbiBfX2VtYmluZF9yZWdpc3Rlcl9jbGFzc19jbGFzc19mdW5jdGlvbihyYXdDbGFzc1R5cGUsbWV0aG9kTmFtZSxhcmdDb3VudCxyYXdBcmdUeXBlc0FkZHIsaW52b2tlclNpZ25hdHVyZSxyYXdJbnZva2VyLGZuKXt2YXIgcmF3QXJnVHlwZXM9aGVhcDMyVmVjdG9yVG9BcnJheShhcmdDb3VudCxyYXdBcmdUeXBlc0FkZHIpO21ldGhvZE5hbWU9cmVhZExhdGluMVN0cmluZyhtZXRob2ROYW1lKTtyYXdJbnZva2VyPWVtYmluZF9fcmVxdWlyZUZ1bmN0aW9uKGludm9rZXJTaWduYXR1cmUscmF3SW52b2tlcik7d2hlbkRlcGVuZGVudFR5cGVzQXJlUmVzb2x2ZWQoW10sW3Jhd0NsYXNzVHlwZV0sZnVuY3Rpb24oY2xhc3NUeXBlKXtjbGFzc1R5cGU9Y2xhc3NUeXBlWzBdO3ZhciBodW1hbk5hbWU9Y2xhc3NUeXBlLm5hbWUrIi4iK21ldGhvZE5hbWU7ZnVuY3Rpb24gdW5ib3VuZFR5cGVzSGFuZGxlcigpe3Rocm93VW5ib3VuZFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgIitodW1hbk5hbWUrIiBkdWUgdG8gdW5ib3VuZCB0eXBlcyIscmF3QXJnVHlwZXMpfXZhciBwcm90bz1jbGFzc1R5cGUucmVnaXN0ZXJlZENsYXNzLmNvbnN0cnVjdG9yO2lmKHVuZGVmaW5lZD09PXByb3RvW21ldGhvZE5hbWVdKXt1bmJvdW5kVHlwZXNIYW5kbGVyLmFyZ0NvdW50PWFyZ0NvdW50LTE7cHJvdG9bbWV0aG9kTmFtZV09dW5ib3VuZFR5cGVzSGFuZGxlcn1lbHNle2Vuc3VyZU92ZXJsb2FkVGFibGUocHJvdG8sbWV0aG9kTmFtZSxodW1hbk5hbWUpO3Byb3RvW21ldGhvZE5hbWVdLm92ZXJsb2FkVGFibGVbYXJnQ291bnQtMV09dW5ib3VuZFR5cGVzSGFuZGxlcn13aGVuRGVwZW5kZW50VHlwZXNBcmVSZXNvbHZlZChbXSxyYXdBcmdUeXBlcyxmdW5jdGlvbihhcmdUeXBlcyl7dmFyIGludm9rZXJBcmdzQXJyYXk9W2FyZ1R5cGVzWzBdLG51bGxdLmNvbmNhdChhcmdUeXBlcy5zbGljZSgxKSk7dmFyIGZ1bmM9Y3JhZnRJbnZva2VyRnVuY3Rpb24oaHVtYW5OYW1lLGludm9rZXJBcmdzQXJyYXksbnVsbCxyYXdJbnZva2VyLGZuKTtpZih1bmRlZmluZWQ9PT1wcm90b1ttZXRob2ROYW1lXS5vdmVybG9hZFRhYmxlKXtmdW5jLmFyZ0NvdW50PWFyZ0NvdW50LTE7cHJvdG9bbWV0aG9kTmFtZV09ZnVuY31lbHNle3Byb3RvW21ldGhvZE5hbWVdLm92ZXJsb2FkVGFibGVbYXJnQ291bnQtMV09ZnVuY31yZXR1cm5bXX0pO3JldHVybltdfSl9ZnVuY3Rpb24gX19lbWJpbmRfcmVnaXN0ZXJfY2xhc3NfY29uc3RydWN0b3IocmF3Q2xhc3NUeXBlLGFyZ0NvdW50LHJhd0FyZ1R5cGVzQWRkcixpbnZva2VyU2lnbmF0dXJlLGludm9rZXIscmF3Q29uc3RydWN0b3Ipe2Fzc2VydChhcmdDb3VudD4wKTt2YXIgcmF3QXJnVHlwZXM9aGVhcDMyVmVjdG9yVG9BcnJheShhcmdDb3VudCxyYXdBcmdUeXBlc0FkZHIpO2ludm9rZXI9ZW1iaW5kX19yZXF1aXJlRnVuY3Rpb24oaW52b2tlclNpZ25hdHVyZSxpbnZva2VyKTt2YXIgYXJncz1bcmF3Q29uc3RydWN0b3JdO3ZhciBkZXN0cnVjdG9ycz1bXTt3aGVuRGVwZW5kZW50VHlwZXNBcmVSZXNvbHZlZChbXSxbcmF3Q2xhc3NUeXBlXSxmdW5jdGlvbihjbGFzc1R5cGUpe2NsYXNzVHlwZT1jbGFzc1R5cGVbMF07dmFyIGh1bWFuTmFtZT0iY29uc3RydWN0b3IgIitjbGFzc1R5cGUubmFtZTtpZih1bmRlZmluZWQ9PT1jbGFzc1R5cGUucmVnaXN0ZXJlZENsYXNzLmNvbnN0cnVjdG9yX2JvZHkpe2NsYXNzVHlwZS5yZWdpc3RlcmVkQ2xhc3MuY29uc3RydWN0b3JfYm9keT1bXX1pZih1bmRlZmluZWQhPT1jbGFzc1R5cGUucmVnaXN0ZXJlZENsYXNzLmNvbnN0cnVjdG9yX2JvZHlbYXJnQ291bnQtMV0pe3Rocm93IG5ldyBCaW5kaW5nRXJyb3IoIkNhbm5vdCByZWdpc3RlciBtdWx0aXBsZSBjb25zdHJ1Y3RvcnMgd2l0aCBpZGVudGljYWwgbnVtYmVyIG9mIHBhcmFtZXRlcnMgKCIrKGFyZ0NvdW50LTEpKyIpIGZvciBjbGFzcyAnIitjbGFzc1R5cGUubmFtZSsiJyEgT3ZlcmxvYWQgcmVzb2x1dGlvbiBpcyBjdXJyZW50bHkgb25seSBwZXJmb3JtZWQgdXNpbmcgdGhlIHBhcmFtZXRlciBjb3VudCwgbm90IGFjdHVhbCB0eXBlIGluZm8hIil9Y2xhc3NUeXBlLnJlZ2lzdGVyZWRDbGFzcy5jb25zdHJ1Y3Rvcl9ib2R5W2FyZ0NvdW50LTFdPWZ1bmN0aW9uIHVuYm91bmRUeXBlSGFuZGxlcigpe3Rocm93VW5ib3VuZFR5cGVFcnJvcigiQ2Fubm90IGNvbnN0cnVjdCAiK2NsYXNzVHlwZS5uYW1lKyIgZHVlIHRvIHVuYm91bmQgdHlwZXMiLHJhd0FyZ1R5cGVzKX07d2hlbkRlcGVuZGVudFR5cGVzQXJlUmVzb2x2ZWQoW10scmF3QXJnVHlwZXMsZnVuY3Rpb24oYXJnVHlwZXMpe2NsYXNzVHlwZS5yZWdpc3RlcmVkQ2xhc3MuY29uc3RydWN0b3JfYm9keVthcmdDb3VudC0xXT1mdW5jdGlvbiBjb25zdHJ1Y3Rvcl9ib2R5KCl7aWYoYXJndW1lbnRzLmxlbmd0aCE9PWFyZ0NvdW50LTEpe3Rocm93QmluZGluZ0Vycm9yKGh1bWFuTmFtZSsiIGNhbGxlZCB3aXRoICIrYXJndW1lbnRzLmxlbmd0aCsiIGFyZ3VtZW50cywgZXhwZWN0ZWQgIisoYXJnQ291bnQtMSkpfWRlc3RydWN0b3JzLmxlbmd0aD0wO2FyZ3MubGVuZ3RoPWFyZ0NvdW50O2Zvcih2YXIgaT0xO2k8YXJnQ291bnQ7KytpKXthcmdzW2ldPWFyZ1R5cGVzW2ldWyJ0b1dpcmVUeXBlIl0oZGVzdHJ1Y3RvcnMsYXJndW1lbnRzW2ktMV0pfXZhciBwdHI9aW52b2tlci5hcHBseShudWxsLGFyZ3MpO3J1bkRlc3RydWN0b3JzKGRlc3RydWN0b3JzKTtyZXR1cm4gYXJnVHlwZXNbMF1bImZyb21XaXJlVHlwZSJdKHB0cil9O3JldHVybltdfSk7cmV0dXJuW119KX1mdW5jdGlvbiBfX2VtYmluZF9yZWdpc3Rlcl9jbGFzc19mdW5jdGlvbihyYXdDbGFzc1R5cGUsbWV0aG9kTmFtZSxhcmdDb3VudCxyYXdBcmdUeXBlc0FkZHIsaW52b2tlclNpZ25hdHVyZSxyYXdJbnZva2VyLGNvbnRleHQsaXNQdXJlVmlydHVhbCl7dmFyIHJhd0FyZ1R5cGVzPWhlYXAzMlZlY3RvclRvQXJyYXkoYXJnQ291bnQscmF3QXJnVHlwZXNBZGRyKTttZXRob2ROYW1lPXJlYWRMYXRpbjFTdHJpbmcobWV0aG9kTmFtZSk7cmF3SW52b2tlcj1lbWJpbmRfX3JlcXVpcmVGdW5jdGlvbihpbnZva2VyU2lnbmF0dXJlLHJhd0ludm9rZXIpO3doZW5EZXBlbmRlbnRUeXBlc0FyZVJlc29sdmVkKFtdLFtyYXdDbGFzc1R5cGVdLGZ1bmN0aW9uKGNsYXNzVHlwZSl7Y2xhc3NUeXBlPWNsYXNzVHlwZVswXTt2YXIgaHVtYW5OYW1lPWNsYXNzVHlwZS5uYW1lKyIuIittZXRob2ROYW1lO2lmKGlzUHVyZVZpcnR1YWwpe2NsYXNzVHlwZS5yZWdpc3RlcmVkQ2xhc3MucHVyZVZpcnR1YWxGdW5jdGlvbnMucHVzaChtZXRob2ROYW1lKX1mdW5jdGlvbiB1bmJvdW5kVHlwZXNIYW5kbGVyKCl7dGhyb3dVbmJvdW5kVHlwZUVycm9yKCJDYW5ub3QgY2FsbCAiK2h1bWFuTmFtZSsiIGR1ZSB0byB1bmJvdW5kIHR5cGVzIixyYXdBcmdUeXBlcyl9dmFyIHByb3RvPWNsYXNzVHlwZS5yZWdpc3RlcmVkQ2xhc3MuaW5zdGFuY2VQcm90b3R5cGU7dmFyIG1ldGhvZD1wcm90b1ttZXRob2ROYW1lXTtpZih1bmRlZmluZWQ9PT1tZXRob2R8fHVuZGVmaW5lZD09PW1ldGhvZC5vdmVybG9hZFRhYmxlJiZtZXRob2QuY2xhc3NOYW1lIT09Y2xhc3NUeXBlLm5hbWUmJm1ldGhvZC5hcmdDb3VudD09PWFyZ0NvdW50LTIpe3VuYm91bmRUeXBlc0hhbmRsZXIuYXJnQ291bnQ9YXJnQ291bnQtMjt1bmJvdW5kVHlwZXNIYW5kbGVyLmNsYXNzTmFtZT1jbGFzc1R5cGUubmFtZTtwcm90b1ttZXRob2ROYW1lXT11bmJvdW5kVHlwZXNIYW5kbGVyfWVsc2V7ZW5zdXJlT3ZlcmxvYWRUYWJsZShwcm90byxtZXRob2ROYW1lLGh1bWFuTmFtZSk7cHJvdG9bbWV0aG9kTmFtZV0ub3ZlcmxvYWRUYWJsZVthcmdDb3VudC0yXT11bmJvdW5kVHlwZXNIYW5kbGVyfXdoZW5EZXBlbmRlbnRUeXBlc0FyZVJlc29sdmVkKFtdLHJhd0FyZ1R5cGVzLGZ1bmN0aW9uKGFyZ1R5cGVzKXt2YXIgbWVtYmVyRnVuY3Rpb249Y3JhZnRJbnZva2VyRnVuY3Rpb24oaHVtYW5OYW1lLGFyZ1R5cGVzLGNsYXNzVHlwZSxyYXdJbnZva2VyLGNvbnRleHQpO2lmKHVuZGVmaW5lZD09PXByb3RvW21ldGhvZE5hbWVdLm92ZXJsb2FkVGFibGUpe21lbWJlckZ1bmN0aW9uLmFyZ0NvdW50PWFyZ0NvdW50LTI7cHJvdG9bbWV0aG9kTmFtZV09bWVtYmVyRnVuY3Rpb259ZWxzZXtwcm90b1ttZXRob2ROYW1lXS5vdmVybG9hZFRhYmxlW2FyZ0NvdW50LTJdPW1lbWJlckZ1bmN0aW9ufXJldHVybltdfSk7cmV0dXJuW119KX1mdW5jdGlvbiB2YWxpZGF0ZVRoaXModGhpc18sY2xhc3NUeXBlLGh1bWFuTmFtZSl7aWYoISh0aGlzXyBpbnN0YW5jZW9mIE9iamVjdCkpe3Rocm93QmluZGluZ0Vycm9yKGh1bWFuTmFtZSsnIHdpdGggaW52YWxpZCAidGhpcyI6ICcrdGhpc18pfWlmKCEodGhpc18gaW5zdGFuY2VvZiBjbGFzc1R5cGUucmVnaXN0ZXJlZENsYXNzLmNvbnN0cnVjdG9yKSl7dGhyb3dCaW5kaW5nRXJyb3IoaHVtYW5OYW1lKycgaW5jb21wYXRpYmxlIHdpdGggInRoaXMiIG9mIHR5cGUgJyt0aGlzXy5jb25zdHJ1Y3Rvci5uYW1lKX1pZighdGhpc18uJCQucHRyKXt0aHJvd0JpbmRpbmdFcnJvcigiY2Fubm90IGNhbGwgZW1zY3JpcHRlbiBiaW5kaW5nIG1ldGhvZCAiK2h1bWFuTmFtZSsiIG9uIGRlbGV0ZWQgb2JqZWN0Iil9cmV0dXJuIHVwY2FzdFBvaW50ZXIodGhpc18uJCQucHRyLHRoaXNfLiQkLnB0clR5cGUucmVnaXN0ZXJlZENsYXNzLGNsYXNzVHlwZS5yZWdpc3RlcmVkQ2xhc3MpfWZ1bmN0aW9uIF9fZW1iaW5kX3JlZ2lzdGVyX2NsYXNzX3Byb3BlcnR5KGNsYXNzVHlwZSxmaWVsZE5hbWUsZ2V0dGVyUmV0dXJuVHlwZSxnZXR0ZXJTaWduYXR1cmUsZ2V0dGVyLGdldHRlckNvbnRleHQsc2V0dGVyQXJndW1lbnRUeXBlLHNldHRlclNpZ25hdHVyZSxzZXR0ZXIsc2V0dGVyQ29udGV4dCl7ZmllbGROYW1lPXJlYWRMYXRpbjFTdHJpbmcoZmllbGROYW1lKTtnZXR0ZXI9ZW1iaW5kX19yZXF1aXJlRnVuY3Rpb24oZ2V0dGVyU2lnbmF0dXJlLGdldHRlcik7d2hlbkRlcGVuZGVudFR5cGVzQXJlUmVzb2x2ZWQoW10sW2NsYXNzVHlwZV0sZnVuY3Rpb24oY2xhc3NUeXBlKXtjbGFzc1R5cGU9Y2xhc3NUeXBlWzBdO3ZhciBodW1hbk5hbWU9Y2xhc3NUeXBlLm5hbWUrIi4iK2ZpZWxkTmFtZTt2YXIgZGVzYz17Z2V0OmZ1bmN0aW9uKCl7dGhyb3dVbmJvdW5kVHlwZUVycm9yKCJDYW5ub3QgYWNjZXNzICIraHVtYW5OYW1lKyIgZHVlIHRvIHVuYm91bmQgdHlwZXMiLFtnZXR0ZXJSZXR1cm5UeXBlLHNldHRlckFyZ3VtZW50VHlwZV0pfSxlbnVtZXJhYmxlOnRydWUsY29uZmlndXJhYmxlOnRydWV9O2lmKHNldHRlcil7ZGVzYy5zZXQ9ZnVuY3Rpb24oKXt0aHJvd1VuYm91bmRUeXBlRXJyb3IoIkNhbm5vdCBhY2Nlc3MgIitodW1hbk5hbWUrIiBkdWUgdG8gdW5ib3VuZCB0eXBlcyIsW2dldHRlclJldHVyblR5cGUsc2V0dGVyQXJndW1lbnRUeXBlXSl9fWVsc2V7ZGVzYy5zZXQ9ZnVuY3Rpb24odil7dGhyb3dCaW5kaW5nRXJyb3IoaHVtYW5OYW1lKyIgaXMgYSByZWFkLW9ubHkgcHJvcGVydHkiKX19T2JqZWN0LmRlZmluZVByb3BlcnR5KGNsYXNzVHlwZS5yZWdpc3RlcmVkQ2xhc3MuaW5zdGFuY2VQcm90b3R5cGUsZmllbGROYW1lLGRlc2MpO3doZW5EZXBlbmRlbnRUeXBlc0FyZVJlc29sdmVkKFtdLHNldHRlcj9bZ2V0dGVyUmV0dXJuVHlwZSxzZXR0ZXJBcmd1bWVudFR5cGVdOltnZXR0ZXJSZXR1cm5UeXBlXSxmdW5jdGlvbih0eXBlcyl7dmFyIGdldHRlclJldHVyblR5cGU9dHlwZXNbMF07dmFyIGRlc2M9e2dldDpmdW5jdGlvbigpe3ZhciBwdHI9dmFsaWRhdGVUaGlzKHRoaXMsY2xhc3NUeXBlLGh1bWFuTmFtZSsiIGdldHRlciIpO3JldHVybiBnZXR0ZXJSZXR1cm5UeXBlWyJmcm9tV2lyZVR5cGUiXShnZXR0ZXIoZ2V0dGVyQ29udGV4dCxwdHIpKX0sZW51bWVyYWJsZTp0cnVlfTtpZihzZXR0ZXIpe3NldHRlcj1lbWJpbmRfX3JlcXVpcmVGdW5jdGlvbihzZXR0ZXJTaWduYXR1cmUsc2V0dGVyKTt2YXIgc2V0dGVyQXJndW1lbnRUeXBlPXR5cGVzWzFdO2Rlc2Muc2V0PWZ1bmN0aW9uKHYpe3ZhciBwdHI9dmFsaWRhdGVUaGlzKHRoaXMsY2xhc3NUeXBlLGh1bWFuTmFtZSsiIHNldHRlciIpO3ZhciBkZXN0cnVjdG9ycz1bXTtzZXR0ZXIoc2V0dGVyQ29udGV4dCxwdHIsc2V0dGVyQXJndW1lbnRUeXBlWyJ0b1dpcmVUeXBlIl0oZGVzdHJ1Y3RvcnMsdikpO3J1bkRlc3RydWN0b3JzKGRlc3RydWN0b3JzKX19T2JqZWN0LmRlZmluZVByb3BlcnR5KGNsYXNzVHlwZS5yZWdpc3RlcmVkQ2xhc3MuaW5zdGFuY2VQcm90b3R5cGUsZmllbGROYW1lLGRlc2MpO3JldHVybltdfSk7cmV0dXJuW119KX12YXIgZW12YWxfZnJlZV9saXN0PVtdO3ZhciBlbXZhbF9oYW5kbGVfYXJyYXk9W3t9LHt2YWx1ZTp1bmRlZmluZWR9LHt2YWx1ZTpudWxsfSx7dmFsdWU6dHJ1ZX0se3ZhbHVlOmZhbHNlfV07ZnVuY3Rpb24gX19lbXZhbF9kZWNyZWYoaGFuZGxlKXtpZihoYW5kbGU+NCYmMD09PS0tZW12YWxfaGFuZGxlX2FycmF5W2hhbmRsZV0ucmVmY291bnQpe2VtdmFsX2hhbmRsZV9hcnJheVtoYW5kbGVdPXVuZGVmaW5lZDtlbXZhbF9mcmVlX2xpc3QucHVzaChoYW5kbGUpfX1mdW5jdGlvbiBjb3VudF9lbXZhbF9oYW5kbGVzKCl7dmFyIGNvdW50PTA7Zm9yKHZhciBpPTU7aTxlbXZhbF9oYW5kbGVfYXJyYXkubGVuZ3RoOysraSl7aWYoZW12YWxfaGFuZGxlX2FycmF5W2ldIT09dW5kZWZpbmVkKXsrK2NvdW50fX1yZXR1cm4gY291bnR9ZnVuY3Rpb24gZ2V0X2ZpcnN0X2VtdmFsKCl7Zm9yKHZhciBpPTU7aTxlbXZhbF9oYW5kbGVfYXJyYXkubGVuZ3RoOysraSl7aWYoZW12YWxfaGFuZGxlX2FycmF5W2ldIT09dW5kZWZpbmVkKXtyZXR1cm4gZW12YWxfaGFuZGxlX2FycmF5W2ldfX1yZXR1cm4gbnVsbH1mdW5jdGlvbiBpbml0X2VtdmFsKCl7TW9kdWxlWyJjb3VudF9lbXZhbF9oYW5kbGVzIl09Y291bnRfZW12YWxfaGFuZGxlcztNb2R1bGVbImdldF9maXJzdF9lbXZhbCJdPWdldF9maXJzdF9lbXZhbH1mdW5jdGlvbiBfX2VtdmFsX3JlZ2lzdGVyKHZhbHVlKXtzd2l0Y2godmFsdWUpe2Nhc2UgdW5kZWZpbmVkOntyZXR1cm4gMX1jYXNlIG51bGw6e3JldHVybiAyfWNhc2UgdHJ1ZTp7cmV0dXJuIDN9Y2FzZSBmYWxzZTp7cmV0dXJuIDR9ZGVmYXVsdDp7dmFyIGhhbmRsZT1lbXZhbF9mcmVlX2xpc3QubGVuZ3RoP2VtdmFsX2ZyZWVfbGlzdC5wb3AoKTplbXZhbF9oYW5kbGVfYXJyYXkubGVuZ3RoO2VtdmFsX2hhbmRsZV9hcnJheVtoYW5kbGVdPXtyZWZjb3VudDoxLHZhbHVlOnZhbHVlfTtyZXR1cm4gaGFuZGxlfX19ZnVuY3Rpb24gX19lbWJpbmRfcmVnaXN0ZXJfZW12YWwocmF3VHlwZSxuYW1lKXtuYW1lPXJlYWRMYXRpbjFTdHJpbmcobmFtZSk7cmVnaXN0ZXJUeXBlKHJhd1R5cGUse25hbWU6bmFtZSwiZnJvbVdpcmVUeXBlIjpmdW5jdGlvbihoYW5kbGUpe3ZhciBydj1lbXZhbF9oYW5kbGVfYXJyYXlbaGFuZGxlXS52YWx1ZTtfX2VtdmFsX2RlY3JlZihoYW5kbGUpO3JldHVybiBydn0sInRvV2lyZVR5cGUiOmZ1bmN0aW9uKGRlc3RydWN0b3JzLHZhbHVlKXtyZXR1cm4gX19lbXZhbF9yZWdpc3Rlcih2YWx1ZSl9LCJhcmdQYWNrQWR2YW5jZSI6OCwicmVhZFZhbHVlRnJvbVBvaW50ZXIiOnNpbXBsZVJlYWRWYWx1ZUZyb21Qb2ludGVyLGRlc3RydWN0b3JGdW5jdGlvbjpudWxsfSl9ZnVuY3Rpb24gZW51bVJlYWRWYWx1ZUZyb21Qb2ludGVyKG5hbWUsc2hpZnQsc2lnbmVkKXtzd2l0Y2goc2hpZnQpe2Nhc2UgMDpyZXR1cm4gZnVuY3Rpb24ocG9pbnRlcil7dmFyIGhlYXA9c2lnbmVkP0hFQVA4OkhFQVBVODtyZXR1cm4gdGhpc1siZnJvbVdpcmVUeXBlIl0oaGVhcFtwb2ludGVyXSl9O2Nhc2UgMTpyZXR1cm4gZnVuY3Rpb24ocG9pbnRlcil7dmFyIGhlYXA9c2lnbmVkP0hFQVAxNjpIRUFQVTE2O3JldHVybiB0aGlzWyJmcm9tV2lyZVR5cGUiXShoZWFwW3BvaW50ZXI+PjFdKX07Y2FzZSAyOnJldHVybiBmdW5jdGlvbihwb2ludGVyKXt2YXIgaGVhcD1zaWduZWQ/SEVBUDMyOkhFQVBVMzI7cmV0dXJuIHRoaXNbImZyb21XaXJlVHlwZSJdKGhlYXBbcG9pbnRlcj4+Ml0pfTtkZWZhdWx0OnRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gaW50ZWdlciB0eXBlOiAiK25hbWUpfX1mdW5jdGlvbiBfX2VtYmluZF9yZWdpc3Rlcl9lbnVtKHJhd1R5cGUsbmFtZSxzaXplLGlzU2lnbmVkKXt2YXIgc2hpZnQ9Z2V0U2hpZnRGcm9tU2l6ZShzaXplKTtuYW1lPXJlYWRMYXRpbjFTdHJpbmcobmFtZSk7ZnVuY3Rpb24gY3Rvcigpe31jdG9yLnZhbHVlcz17fTtyZWdpc3RlclR5cGUocmF3VHlwZSx7bmFtZTpuYW1lLGNvbnN0cnVjdG9yOmN0b3IsImZyb21XaXJlVHlwZSI6ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuY29uc3RydWN0b3IudmFsdWVzW2NdfSwidG9XaXJlVHlwZSI6ZnVuY3Rpb24oZGVzdHJ1Y3RvcnMsYyl7cmV0dXJuIGMudmFsdWV9LCJhcmdQYWNrQWR2YW5jZSI6OCwicmVhZFZhbHVlRnJvbVBvaW50ZXIiOmVudW1SZWFkVmFsdWVGcm9tUG9pbnRlcihuYW1lLHNoaWZ0LGlzU2lnbmVkKSxkZXN0cnVjdG9yRnVuY3Rpb246bnVsbH0pO2V4cG9zZVB1YmxpY1N5bWJvbChuYW1lLGN0b3IpfWZ1bmN0aW9uIHJlcXVpcmVSZWdpc3RlcmVkVHlwZShyYXdUeXBlLGh1bWFuTmFtZSl7dmFyIGltcGw9cmVnaXN0ZXJlZFR5cGVzW3Jhd1R5cGVdO2lmKHVuZGVmaW5lZD09PWltcGwpe3Rocm93QmluZGluZ0Vycm9yKGh1bWFuTmFtZSsiIGhhcyB1bmtub3duIHR5cGUgIitnZXRUeXBlTmFtZShyYXdUeXBlKSl9cmV0dXJuIGltcGx9ZnVuY3Rpb24gX19lbWJpbmRfcmVnaXN0ZXJfZW51bV92YWx1ZShyYXdFbnVtVHlwZSxuYW1lLGVudW1WYWx1ZSl7dmFyIGVudW1UeXBlPXJlcXVpcmVSZWdpc3RlcmVkVHlwZShyYXdFbnVtVHlwZSwiZW51bSIpO25hbWU9cmVhZExhdGluMVN0cmluZyhuYW1lKTt2YXIgRW51bT1lbnVtVHlwZS5jb25zdHJ1Y3Rvcjt2YXIgVmFsdWU9T2JqZWN0LmNyZWF0ZShlbnVtVHlwZS5jb25zdHJ1Y3Rvci5wcm90b3R5cGUse3ZhbHVlOnt2YWx1ZTplbnVtVmFsdWV9LGNvbnN0cnVjdG9yOnt2YWx1ZTpjcmVhdGVOYW1lZEZ1bmN0aW9uKGVudW1UeXBlLm5hbWUrIl8iK25hbWUsZnVuY3Rpb24oKXt9KX19KTtFbnVtLnZhbHVlc1tlbnVtVmFsdWVdPVZhbHVlO0VudW1bbmFtZV09VmFsdWV9ZnVuY3Rpb24gX2VtYmluZF9yZXByKHYpe2lmKHY9PT1udWxsKXtyZXR1cm4ibnVsbCJ9dmFyIHQ9dHlwZW9mIHY7aWYodD09PSJvYmplY3QifHx0PT09ImFycmF5Inx8dD09PSJmdW5jdGlvbiIpe3JldHVybiB2LnRvU3RyaW5nKCl9ZWxzZXtyZXR1cm4iIit2fX1mdW5jdGlvbiBmbG9hdFJlYWRWYWx1ZUZyb21Qb2ludGVyKG5hbWUsc2hpZnQpe3N3aXRjaChzaGlmdCl7Y2FzZSAyOnJldHVybiBmdW5jdGlvbihwb2ludGVyKXtyZXR1cm4gdGhpc1siZnJvbVdpcmVUeXBlIl0oSEVBUEYzMltwb2ludGVyPj4yXSl9O2Nhc2UgMzpyZXR1cm4gZnVuY3Rpb24ocG9pbnRlcil7cmV0dXJuIHRoaXNbImZyb21XaXJlVHlwZSJdKEhFQVBGNjRbcG9pbnRlcj4+M10pfTtkZWZhdWx0OnRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gZmxvYXQgdHlwZTogIituYW1lKX19ZnVuY3Rpb24gX19lbWJpbmRfcmVnaXN0ZXJfZmxvYXQocmF3VHlwZSxuYW1lLHNpemUpe3ZhciBzaGlmdD1nZXRTaGlmdEZyb21TaXplKHNpemUpO25hbWU9cmVhZExhdGluMVN0cmluZyhuYW1lKTtyZWdpc3RlclR5cGUocmF3VHlwZSx7bmFtZTpuYW1lLCJmcm9tV2lyZVR5cGUiOmZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gdmFsdWV9LCJ0b1dpcmVUeXBlIjpmdW5jdGlvbihkZXN0cnVjdG9ycyx2YWx1ZSl7aWYodHlwZW9mIHZhbHVlIT09Im51bWJlciImJnR5cGVvZiB2YWx1ZSE9PSJib29sZWFuIil7dGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNvbnZlcnQgIicrX2VtYmluZF9yZXByKHZhbHVlKSsnIiB0byAnK3RoaXMubmFtZSl9cmV0dXJuIHZhbHVlfSwiYXJnUGFja0FkdmFuY2UiOjgsInJlYWRWYWx1ZUZyb21Qb2ludGVyIjpmbG9hdFJlYWRWYWx1ZUZyb21Qb2ludGVyKG5hbWUsc2hpZnQpLGRlc3RydWN0b3JGdW5jdGlvbjpudWxsfSl9ZnVuY3Rpb24gX19lbWJpbmRfcmVnaXN0ZXJfZnVuY3Rpb24obmFtZSxhcmdDb3VudCxyYXdBcmdUeXBlc0FkZHIsc2lnbmF0dXJlLHJhd0ludm9rZXIsZm4pe3ZhciBhcmdUeXBlcz1oZWFwMzJWZWN0b3JUb0FycmF5KGFyZ0NvdW50LHJhd0FyZ1R5cGVzQWRkcik7bmFtZT1yZWFkTGF0aW4xU3RyaW5nKG5hbWUpO3Jhd0ludm9rZXI9ZW1iaW5kX19yZXF1aXJlRnVuY3Rpb24oc2lnbmF0dXJlLHJhd0ludm9rZXIpO2V4cG9zZVB1YmxpY1N5bWJvbChuYW1lLGZ1bmN0aW9uKCl7dGhyb3dVbmJvdW5kVHlwZUVycm9yKCJDYW5ub3QgY2FsbCAiK25hbWUrIiBkdWUgdG8gdW5ib3VuZCB0eXBlcyIsYXJnVHlwZXMpfSxhcmdDb3VudC0xKTt3aGVuRGVwZW5kZW50VHlwZXNBcmVSZXNvbHZlZChbXSxhcmdUeXBlcyxmdW5jdGlvbihhcmdUeXBlcyl7dmFyIGludm9rZXJBcmdzQXJyYXk9W2FyZ1R5cGVzWzBdLG51bGxdLmNvbmNhdChhcmdUeXBlcy5zbGljZSgxKSk7cmVwbGFjZVB1YmxpY1N5bWJvbChuYW1lLGNyYWZ0SW52b2tlckZ1bmN0aW9uKG5hbWUsaW52b2tlckFyZ3NBcnJheSxudWxsLHJhd0ludm9rZXIsZm4pLGFyZ0NvdW50LTEpO3JldHVybltdfSl9ZnVuY3Rpb24gaW50ZWdlclJlYWRWYWx1ZUZyb21Qb2ludGVyKG5hbWUsc2hpZnQsc2lnbmVkKXtzd2l0Y2goc2hpZnQpe2Nhc2UgMDpyZXR1cm4gc2lnbmVkP2Z1bmN0aW9uIHJlYWRTOEZyb21Qb2ludGVyKHBvaW50ZXIpe3JldHVybiBIRUFQOFtwb2ludGVyXX06ZnVuY3Rpb24gcmVhZFU4RnJvbVBvaW50ZXIocG9pbnRlcil7cmV0dXJuIEhFQVBVOFtwb2ludGVyXX07Y2FzZSAxOnJldHVybiBzaWduZWQ/ZnVuY3Rpb24gcmVhZFMxNkZyb21Qb2ludGVyKHBvaW50ZXIpe3JldHVybiBIRUFQMTZbcG9pbnRlcj4+MV19OmZ1bmN0aW9uIHJlYWRVMTZGcm9tUG9pbnRlcihwb2ludGVyKXtyZXR1cm4gSEVBUFUxNltwb2ludGVyPj4xXX07Y2FzZSAyOnJldHVybiBzaWduZWQ/ZnVuY3Rpb24gcmVhZFMzMkZyb21Qb2ludGVyKHBvaW50ZXIpe3JldHVybiBIRUFQMzJbcG9pbnRlcj4+Ml19OmZ1bmN0aW9uIHJlYWRVMzJGcm9tUG9pbnRlcihwb2ludGVyKXtyZXR1cm4gSEVBUFUzMltwb2ludGVyPj4yXX07ZGVmYXVsdDp0aHJvdyBuZXcgVHlwZUVycm9yKCJVbmtub3duIGludGVnZXIgdHlwZTogIituYW1lKX19ZnVuY3Rpb24gX19lbWJpbmRfcmVnaXN0ZXJfaW50ZWdlcihwcmltaXRpdmVUeXBlLG5hbWUsc2l6ZSxtaW5SYW5nZSxtYXhSYW5nZSl7bmFtZT1yZWFkTGF0aW4xU3RyaW5nKG5hbWUpO2lmKG1heFJhbmdlPT09LTEpe21heFJhbmdlPTQyOTQ5NjcyOTV9dmFyIHNoaWZ0PWdldFNoaWZ0RnJvbVNpemUoc2l6ZSk7dmFyIGZyb21XaXJlVHlwZT1mdW5jdGlvbih2YWx1ZSl7cmV0dXJuIHZhbHVlfTtpZihtaW5SYW5nZT09PTApe3ZhciBiaXRzaGlmdD0zMi04KnNpemU7ZnJvbVdpcmVUeXBlPWZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gdmFsdWU8PGJpdHNoaWZ0Pj4+Yml0c2hpZnR9fXZhciBpc1Vuc2lnbmVkVHlwZT1uYW1lLmluZGV4T2YoInVuc2lnbmVkIikhPS0xO3JlZ2lzdGVyVHlwZShwcmltaXRpdmVUeXBlLHtuYW1lOm5hbWUsImZyb21XaXJlVHlwZSI6ZnJvbVdpcmVUeXBlLCJ0b1dpcmVUeXBlIjpmdW5jdGlvbihkZXN0cnVjdG9ycyx2YWx1ZSl7aWYodHlwZW9mIHZhbHVlIT09Im51bWJlciImJnR5cGVvZiB2YWx1ZSE9PSJib29sZWFuIil7dGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNvbnZlcnQgIicrX2VtYmluZF9yZXByKHZhbHVlKSsnIiB0byAnK3RoaXMubmFtZSl9aWYodmFsdWU8bWluUmFuZ2V8fHZhbHVlPm1heFJhbmdlKXt0aHJvdyBuZXcgVHlwZUVycm9yKCdQYXNzaW5nIGEgbnVtYmVyICInK19lbWJpbmRfcmVwcih2YWx1ZSkrJyIgZnJvbSBKUyBzaWRlIHRvIEMvQysrIHNpZGUgdG8gYW4gYXJndW1lbnQgb2YgdHlwZSAiJytuYW1lKyciLCB3aGljaCBpcyBvdXRzaWRlIHRoZSB2YWxpZCByYW5nZSBbJyttaW5SYW5nZSsiLCAiK21heFJhbmdlKyJdISIpfXJldHVybiBpc1Vuc2lnbmVkVHlwZT92YWx1ZT4+PjA6dmFsdWV8MH0sImFyZ1BhY2tBZHZhbmNlIjo4LCJyZWFkVmFsdWVGcm9tUG9pbnRlciI6aW50ZWdlclJlYWRWYWx1ZUZyb21Qb2ludGVyKG5hbWUsc2hpZnQsbWluUmFuZ2UhPT0wKSxkZXN0cnVjdG9yRnVuY3Rpb246bnVsbH0pfWZ1bmN0aW9uIF9fZW1iaW5kX3JlZ2lzdGVyX21lbW9yeV92aWV3KHJhd1R5cGUsZGF0YVR5cGVJbmRleCxuYW1lKXt2YXIgdHlwZU1hcHBpbmc9W0ludDhBcnJheSxVaW50OEFycmF5LEludDE2QXJyYXksVWludDE2QXJyYXksSW50MzJBcnJheSxVaW50MzJBcnJheSxGbG9hdDMyQXJyYXksRmxvYXQ2NEFycmF5XTt2YXIgVEE9dHlwZU1hcHBpbmdbZGF0YVR5cGVJbmRleF07ZnVuY3Rpb24gZGVjb2RlTWVtb3J5VmlldyhoYW5kbGUpe2hhbmRsZT1oYW5kbGU+PjI7dmFyIGhlYXA9SEVBUFUzMjt2YXIgc2l6ZT1oZWFwW2hhbmRsZV07dmFyIGRhdGE9aGVhcFtoYW5kbGUrMV07cmV0dXJuIG5ldyBUQShidWZmZXIsZGF0YSxzaXplKX1uYW1lPXJlYWRMYXRpbjFTdHJpbmcobmFtZSk7cmVnaXN0ZXJUeXBlKHJhd1R5cGUse25hbWU6bmFtZSwiZnJvbVdpcmVUeXBlIjpkZWNvZGVNZW1vcnlWaWV3LCJhcmdQYWNrQWR2YW5jZSI6OCwicmVhZFZhbHVlRnJvbVBvaW50ZXIiOmRlY29kZU1lbW9yeVZpZXd9LHtpZ25vcmVEdXBsaWNhdGVSZWdpc3RyYXRpb25zOnRydWV9KX1mdW5jdGlvbiBfX2VtYmluZF9yZWdpc3Rlcl9zdGRfc3RyaW5nKHJhd1R5cGUsbmFtZSl7bmFtZT1yZWFkTGF0aW4xU3RyaW5nKG5hbWUpO3ZhciBzdGRTdHJpbmdJc1VURjg9bmFtZT09PSJzdGQ6OnN0cmluZyI7cmVnaXN0ZXJUeXBlKHJhd1R5cGUse25hbWU6bmFtZSwiZnJvbVdpcmVUeXBlIjpmdW5jdGlvbih2YWx1ZSl7dmFyIGxlbmd0aD1IRUFQVTMyW3ZhbHVlPj4yXTt2YXIgc3RyO2lmKHN0ZFN0cmluZ0lzVVRGOCl7dmFyIGRlY29kZVN0YXJ0UHRyPXZhbHVlKzQ7Zm9yKHZhciBpPTA7aTw9bGVuZ3RoOysraSl7dmFyIGN1cnJlbnRCeXRlUHRyPXZhbHVlKzQraTtpZihpPT1sZW5ndGh8fEhFQVBVOFtjdXJyZW50Qnl0ZVB0cl09PTApe3ZhciBtYXhSZWFkPWN1cnJlbnRCeXRlUHRyLWRlY29kZVN0YXJ0UHRyO3ZhciBzdHJpbmdTZWdtZW50PVVURjhUb1N0cmluZyhkZWNvZGVTdGFydFB0cixtYXhSZWFkKTtpZihzdHI9PT11bmRlZmluZWQpe3N0cj1zdHJpbmdTZWdtZW50fWVsc2V7c3RyKz1TdHJpbmcuZnJvbUNoYXJDb2RlKDApO3N0cis9c3RyaW5nU2VnbWVudH1kZWNvZGVTdGFydFB0cj1jdXJyZW50Qnl0ZVB0cisxfX19ZWxzZXt2YXIgYT1uZXcgQXJyYXkobGVuZ3RoKTtmb3IodmFyIGk9MDtpPGxlbmd0aDsrK2kpe2FbaV09U3RyaW5nLmZyb21DaGFyQ29kZShIRUFQVThbdmFsdWUrNCtpXSl9c3RyPWEuam9pbigiIil9X2ZyZWUodmFsdWUpO3JldHVybiBzdHJ9LCJ0b1dpcmVUeXBlIjpmdW5jdGlvbihkZXN0cnVjdG9ycyx2YWx1ZSl7aWYodmFsdWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcil7dmFsdWU9bmV3IFVpbnQ4QXJyYXkodmFsdWUpfXZhciBnZXRMZW5ndGg7dmFyIHZhbHVlSXNPZlR5cGVTdHJpbmc9dHlwZW9mIHZhbHVlPT09InN0cmluZyI7aWYoISh2YWx1ZUlzT2ZUeXBlU3RyaW5nfHx2YWx1ZSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXl8fHZhbHVlIGluc3RhbmNlb2YgVWludDhDbGFtcGVkQXJyYXl8fHZhbHVlIGluc3RhbmNlb2YgSW50OEFycmF5KSl7dGhyb3dCaW5kaW5nRXJyb3IoIkNhbm5vdCBwYXNzIG5vbi1zdHJpbmcgdG8gc3RkOjpzdHJpbmciKX1pZihzdGRTdHJpbmdJc1VURjgmJnZhbHVlSXNPZlR5cGVTdHJpbmcpe2dldExlbmd0aD1mdW5jdGlvbigpe3JldHVybiBsZW5ndGhCeXRlc1VURjgodmFsdWUpfX1lbHNle2dldExlbmd0aD1mdW5jdGlvbigpe3JldHVybiB2YWx1ZS5sZW5ndGh9fXZhciBsZW5ndGg9Z2V0TGVuZ3RoKCk7dmFyIHB0cj1fbWFsbG9jKDQrbGVuZ3RoKzEpO0hFQVBVMzJbcHRyPj4yXT1sZW5ndGg7aWYoc3RkU3RyaW5nSXNVVEY4JiZ2YWx1ZUlzT2ZUeXBlU3RyaW5nKXtzdHJpbmdUb1VURjgodmFsdWUscHRyKzQsbGVuZ3RoKzEpfWVsc2V7aWYodmFsdWVJc09mVHlwZVN0cmluZyl7Zm9yKHZhciBpPTA7aTxsZW5ndGg7KytpKXt2YXIgY2hhckNvZGU9dmFsdWUuY2hhckNvZGVBdChpKTtpZihjaGFyQ29kZT4yNTUpe19mcmVlKHB0cik7dGhyb3dCaW5kaW5nRXJyb3IoIlN0cmluZyBoYXMgVVRGLTE2IGNvZGUgdW5pdHMgdGhhdCBkbyBub3QgZml0IGluIDggYml0cyIpfUhFQVBVOFtwdHIrNCtpXT1jaGFyQ29kZX19ZWxzZXtmb3IodmFyIGk9MDtpPGxlbmd0aDsrK2kpe0hFQVBVOFtwdHIrNCtpXT12YWx1ZVtpXX19fWlmKGRlc3RydWN0b3JzIT09bnVsbCl7ZGVzdHJ1Y3RvcnMucHVzaChfZnJlZSxwdHIpfXJldHVybiBwdHJ9LCJhcmdQYWNrQWR2YW5jZSI6OCwicmVhZFZhbHVlRnJvbVBvaW50ZXIiOnNpbXBsZVJlYWRWYWx1ZUZyb21Qb2ludGVyLGRlc3RydWN0b3JGdW5jdGlvbjpmdW5jdGlvbihwdHIpe19mcmVlKHB0cil9fSl9ZnVuY3Rpb24gX19lbWJpbmRfcmVnaXN0ZXJfc3RkX3dzdHJpbmcocmF3VHlwZSxjaGFyU2l6ZSxuYW1lKXtuYW1lPXJlYWRMYXRpbjFTdHJpbmcobmFtZSk7dmFyIGRlY29kZVN0cmluZyxlbmNvZGVTdHJpbmcsZ2V0SGVhcCxsZW5ndGhCeXRlc1VURixzaGlmdDtpZihjaGFyU2l6ZT09PTIpe2RlY29kZVN0cmluZz1VVEYxNlRvU3RyaW5nO2VuY29kZVN0cmluZz1zdHJpbmdUb1VURjE2O2xlbmd0aEJ5dGVzVVRGPWxlbmd0aEJ5dGVzVVRGMTY7Z2V0SGVhcD1mdW5jdGlvbigpe3JldHVybiBIRUFQVTE2fTtzaGlmdD0xfWVsc2UgaWYoY2hhclNpemU9PT00KXtkZWNvZGVTdHJpbmc9VVRGMzJUb1N0cmluZztlbmNvZGVTdHJpbmc9c3RyaW5nVG9VVEYzMjtsZW5ndGhCeXRlc1VURj1sZW5ndGhCeXRlc1VURjMyO2dldEhlYXA9ZnVuY3Rpb24oKXtyZXR1cm4gSEVBUFUzMn07c2hpZnQ9Mn1yZWdpc3RlclR5cGUocmF3VHlwZSx7bmFtZTpuYW1lLCJmcm9tV2lyZVR5cGUiOmZ1bmN0aW9uKHZhbHVlKXt2YXIgbGVuZ3RoPUhFQVBVMzJbdmFsdWU+PjJdO3ZhciBIRUFQPWdldEhlYXAoKTt2YXIgc3RyO3ZhciBkZWNvZGVTdGFydFB0cj12YWx1ZSs0O2Zvcih2YXIgaT0wO2k8PWxlbmd0aDsrK2kpe3ZhciBjdXJyZW50Qnl0ZVB0cj12YWx1ZSs0K2kqY2hhclNpemU7aWYoaT09bGVuZ3RofHxIRUFQW2N1cnJlbnRCeXRlUHRyPj5zaGlmdF09PTApe3ZhciBtYXhSZWFkQnl0ZXM9Y3VycmVudEJ5dGVQdHItZGVjb2RlU3RhcnRQdHI7dmFyIHN0cmluZ1NlZ21lbnQ9ZGVjb2RlU3RyaW5nKGRlY29kZVN0YXJ0UHRyLG1heFJlYWRCeXRlcyk7aWYoc3RyPT09dW5kZWZpbmVkKXtzdHI9c3RyaW5nU2VnbWVudH1lbHNle3N0cis9U3RyaW5nLmZyb21DaGFyQ29kZSgwKTtzdHIrPXN0cmluZ1NlZ21lbnR9ZGVjb2RlU3RhcnRQdHI9Y3VycmVudEJ5dGVQdHIrY2hhclNpemV9fV9mcmVlKHZhbHVlKTtyZXR1cm4gc3RyfSwidG9XaXJlVHlwZSI6ZnVuY3Rpb24oZGVzdHJ1Y3RvcnMsdmFsdWUpe2lmKCEodHlwZW9mIHZhbHVlPT09InN0cmluZyIpKXt0aHJvd0JpbmRpbmdFcnJvcigiQ2Fubm90IHBhc3Mgbm9uLXN0cmluZyB0byBDKysgc3RyaW5nIHR5cGUgIituYW1lKX12YXIgbGVuZ3RoPWxlbmd0aEJ5dGVzVVRGKHZhbHVlKTt2YXIgcHRyPV9tYWxsb2MoNCtsZW5ndGgrY2hhclNpemUpO0hFQVBVMzJbcHRyPj4yXT1sZW5ndGg+PnNoaWZ0O2VuY29kZVN0cmluZyh2YWx1ZSxwdHIrNCxsZW5ndGgrY2hhclNpemUpO2lmKGRlc3RydWN0b3JzIT09bnVsbCl7ZGVzdHJ1Y3RvcnMucHVzaChfZnJlZSxwdHIpfXJldHVybiBwdHJ9LCJhcmdQYWNrQWR2YW5jZSI6OCwicmVhZFZhbHVlRnJvbVBvaW50ZXIiOnNpbXBsZVJlYWRWYWx1ZUZyb21Qb2ludGVyLGRlc3RydWN0b3JGdW5jdGlvbjpmdW5jdGlvbihwdHIpe19mcmVlKHB0cil9fSl9ZnVuY3Rpb24gX19lbWJpbmRfcmVnaXN0ZXJfdm9pZChyYXdUeXBlLG5hbWUpe25hbWU9cmVhZExhdGluMVN0cmluZyhuYW1lKTtyZWdpc3RlclR5cGUocmF3VHlwZSx7aXNWb2lkOnRydWUsbmFtZTpuYW1lLCJhcmdQYWNrQWR2YW5jZSI6MCwiZnJvbVdpcmVUeXBlIjpmdW5jdGlvbigpe3JldHVybiB1bmRlZmluZWR9LCJ0b1dpcmVUeXBlIjpmdW5jdGlvbihkZXN0cnVjdG9ycyxvKXtyZXR1cm4gdW5kZWZpbmVkfX0pfWZ1bmN0aW9uIHJlcXVpcmVIYW5kbGUoaGFuZGxlKXtpZighaGFuZGxlKXt0aHJvd0JpbmRpbmdFcnJvcigiQ2Fubm90IHVzZSBkZWxldGVkIHZhbC4gaGFuZGxlID0gIitoYW5kbGUpfXJldHVybiBlbXZhbF9oYW5kbGVfYXJyYXlbaGFuZGxlXS52YWx1ZX1mdW5jdGlvbiBfX2VtdmFsX2FzKGhhbmRsZSxyZXR1cm5UeXBlLGRlc3RydWN0b3JzUmVmKXtoYW5kbGU9cmVxdWlyZUhhbmRsZShoYW5kbGUpO3JldHVyblR5cGU9cmVxdWlyZVJlZ2lzdGVyZWRUeXBlKHJldHVyblR5cGUsImVtdmFsOjphcyIpO3ZhciBkZXN0cnVjdG9ycz1bXTt2YXIgcmQ9X19lbXZhbF9yZWdpc3RlcihkZXN0cnVjdG9ycyk7SEVBUDMyW2Rlc3RydWN0b3JzUmVmPj4yXT1yZDtyZXR1cm4gcmV0dXJuVHlwZVsidG9XaXJlVHlwZSJdKGRlc3RydWN0b3JzLGhhbmRsZSl9dmFyIGVtdmFsX3N5bWJvbHM9e307ZnVuY3Rpb24gZ2V0U3RyaW5nT3JTeW1ib2woYWRkcmVzcyl7dmFyIHN5bWJvbD1lbXZhbF9zeW1ib2xzW2FkZHJlc3NdO2lmKHN5bWJvbD09PXVuZGVmaW5lZCl7cmV0dXJuIHJlYWRMYXRpbjFTdHJpbmcoYWRkcmVzcyl9ZWxzZXtyZXR1cm4gc3ltYm9sfX12YXIgZW12YWxfbWV0aG9kQ2FsbGVycz1bXTtmdW5jdGlvbiBfX2VtdmFsX2NhbGxfdm9pZF9tZXRob2QoY2FsbGVyLGhhbmRsZSxtZXRob2ROYW1lLGFyZ3Mpe2NhbGxlcj1lbXZhbF9tZXRob2RDYWxsZXJzW2NhbGxlcl07aGFuZGxlPXJlcXVpcmVIYW5kbGUoaGFuZGxlKTttZXRob2ROYW1lPWdldFN0cmluZ09yU3ltYm9sKG1ldGhvZE5hbWUpO2NhbGxlcihoYW5kbGUsbWV0aG9kTmFtZSxudWxsLGFyZ3MpfWZ1bmN0aW9uIF9fZW12YWxfYWRkTWV0aG9kQ2FsbGVyKGNhbGxlcil7dmFyIGlkPWVtdmFsX21ldGhvZENhbGxlcnMubGVuZ3RoO2VtdmFsX21ldGhvZENhbGxlcnMucHVzaChjYWxsZXIpO3JldHVybiBpZH1mdW5jdGlvbiBfX2VtdmFsX2xvb2t1cFR5cGVzKGFyZ0NvdW50LGFyZ1R5cGVzKXt2YXIgYT1uZXcgQXJyYXkoYXJnQ291bnQpO2Zvcih2YXIgaT0wO2k8YXJnQ291bnQ7KytpKXthW2ldPXJlcXVpcmVSZWdpc3RlcmVkVHlwZShIRUFQMzJbKGFyZ1R5cGVzPj4yKStpXSwicGFyYW1ldGVyICIraSl9cmV0dXJuIGF9ZnVuY3Rpb24gX19lbXZhbF9nZXRfbWV0aG9kX2NhbGxlcihhcmdDb3VudCxhcmdUeXBlcyl7dmFyIHR5cGVzPV9fZW12YWxfbG9va3VwVHlwZXMoYXJnQ291bnQsYXJnVHlwZXMpO3ZhciByZXRUeXBlPXR5cGVzWzBdO3ZhciBzaWduYXR1cmVOYW1lPXJldFR5cGUubmFtZSsiXyQiK3R5cGVzLnNsaWNlKDEpLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdC5uYW1lfSkuam9pbigiXyIpKyIkIjt2YXIgcGFyYW1zPVsicmV0VHlwZSJdO3ZhciBhcmdzPVtyZXRUeXBlXTt2YXIgYXJnc0xpc3Q9IiI7Zm9yKHZhciBpPTA7aTxhcmdDb3VudC0xOysraSl7YXJnc0xpc3QrPShpIT09MD8iLCAiOiIiKSsiYXJnIitpO3BhcmFtcy5wdXNoKCJhcmdUeXBlIitpKTthcmdzLnB1c2godHlwZXNbMStpXSl9dmFyIGZ1bmN0aW9uTmFtZT1tYWtlTGVnYWxGdW5jdGlvbk5hbWUoIm1ldGhvZENhbGxlcl8iK3NpZ25hdHVyZU5hbWUpO3ZhciBmdW5jdGlvbkJvZHk9InJldHVybiBmdW5jdGlvbiAiK2Z1bmN0aW9uTmFtZSsiKGhhbmRsZSwgbmFtZSwgZGVzdHJ1Y3RvcnMsIGFyZ3MpIHtcbiI7dmFyIG9mZnNldD0wO2Zvcih2YXIgaT0wO2k8YXJnQ291bnQtMTsrK2kpe2Z1bmN0aW9uQm9keSs9IiAgICB2YXIgYXJnIitpKyIgPSBhcmdUeXBlIitpKyIucmVhZFZhbHVlRnJvbVBvaW50ZXIoYXJncyIrKG9mZnNldD8iKyIrb2Zmc2V0OiIiKSsiKTtcbiI7b2Zmc2V0Kz10eXBlc1tpKzFdWyJhcmdQYWNrQWR2YW5jZSJdfWZ1bmN0aW9uQm9keSs9IiAgICB2YXIgcnYgPSBoYW5kbGVbbmFtZV0oIithcmdzTGlzdCsiKTtcbiI7Zm9yKHZhciBpPTA7aTxhcmdDb3VudC0xOysraSl7aWYodHlwZXNbaSsxXVsiZGVsZXRlT2JqZWN0Il0pe2Z1bmN0aW9uQm9keSs9IiAgICBhcmdUeXBlIitpKyIuZGVsZXRlT2JqZWN0KGFyZyIraSsiKTtcbiJ9fWlmKCFyZXRUeXBlLmlzVm9pZCl7ZnVuY3Rpb25Cb2R5Kz0iICAgIHJldHVybiByZXRUeXBlLnRvV2lyZVR5cGUoZGVzdHJ1Y3RvcnMsIHJ2KTtcbiJ9ZnVuY3Rpb25Cb2R5Kz0ifTtcbiI7cGFyYW1zLnB1c2goZnVuY3Rpb25Cb2R5KTt2YXIgaW52b2tlckZ1bmN0aW9uPW5ld18oRnVuY3Rpb24scGFyYW1zKS5hcHBseShudWxsLGFyZ3MpO3JldHVybiBfX2VtdmFsX2FkZE1ldGhvZENhbGxlcihpbnZva2VyRnVuY3Rpb24pfWZ1bmN0aW9uIF9fZW12YWxfZ2V0X3Byb3BlcnR5KGhhbmRsZSxrZXkpe2hhbmRsZT1yZXF1aXJlSGFuZGxlKGhhbmRsZSk7a2V5PXJlcXVpcmVIYW5kbGUoa2V5KTtyZXR1cm4gX19lbXZhbF9yZWdpc3RlcihoYW5kbGVba2V5XSl9ZnVuY3Rpb24gX19lbXZhbF9pbmNyZWYoaGFuZGxlKXtpZihoYW5kbGU+NCl7ZW12YWxfaGFuZGxlX2FycmF5W2hhbmRsZV0ucmVmY291bnQrPTF9fWZ1bmN0aW9uIF9fZW12YWxfbmV3X2FycmF5KCl7cmV0dXJuIF9fZW12YWxfcmVnaXN0ZXIoW10pfWZ1bmN0aW9uIF9fZW12YWxfbmV3X2NzdHJpbmcodil7cmV0dXJuIF9fZW12YWxfcmVnaXN0ZXIoZ2V0U3RyaW5nT3JTeW1ib2wodikpfWZ1bmN0aW9uIF9fZW12YWxfcnVuX2Rlc3RydWN0b3JzKGhhbmRsZSl7dmFyIGRlc3RydWN0b3JzPWVtdmFsX2hhbmRsZV9hcnJheVtoYW5kbGVdLnZhbHVlO3J1bkRlc3RydWN0b3JzKGRlc3RydWN0b3JzKTtfX2VtdmFsX2RlY3JlZihoYW5kbGUpfWZ1bmN0aW9uIF9fZW12YWxfdGFrZV92YWx1ZSh0eXBlLGFyZ3Ype3R5cGU9cmVxdWlyZVJlZ2lzdGVyZWRUeXBlKHR5cGUsIl9lbXZhbF90YWtlX3ZhbHVlIik7dmFyIHY9dHlwZVsicmVhZFZhbHVlRnJvbVBvaW50ZXIiXShhcmd2KTtyZXR1cm4gX19lbXZhbF9yZWdpc3Rlcih2KX1mdW5jdGlvbiBfYWJvcnQoKXthYm9ydCgpfXZhciBfZW1zY3JpcHRlbl9nZXRfbm93O19lbXNjcmlwdGVuX2dldF9ub3c9ZnVuY3Rpb24oKXtyZXR1cm4gcGVyZm9ybWFuY2Uubm93KCl9O3ZhciBfZW1zY3JpcHRlbl9nZXRfbm93X2lzX21vbm90b25pYz10cnVlO2Z1bmN0aW9uIF9jbG9ja19nZXR0aW1lKGNsa19pZCx0cCl7dmFyIG5vdztpZihjbGtfaWQ9PT0wKXtub3c9RGF0ZS5ub3coKX1lbHNlIGlmKChjbGtfaWQ9PT0xfHxjbGtfaWQ9PT00KSYmX2Vtc2NyaXB0ZW5fZ2V0X25vd19pc19tb25vdG9uaWMpe25vdz1fZW1zY3JpcHRlbl9nZXRfbm93KCl9ZWxzZXtzZXRFcnJObygyOCk7cmV0dXJuLTF9SEVBUDMyW3RwPj4yXT1ub3cvMWUzfDA7SEVBUDMyW3RwKzQ+PjJdPW5vdyUxZTMqMWUzKjFlM3wwO3JldHVybiAwfWZ1bmN0aW9uIF9kbG9wZW4oZmlsZW5hbWUsZmxhZyl7YWJvcnQoIlRvIHVzZSBkbG9wZW4sIHlvdSBuZWVkIHRvIHVzZSBFbXNjcmlwdGVuJ3MgbGlua2luZyBzdXBwb3J0LCBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2Vtc2NyaXB0ZW4tY29yZS9lbXNjcmlwdGVuL3dpa2kvTGlua2luZyIpfWZ1bmN0aW9uIF9kbHN5bShoYW5kbGUsc3ltYm9sKXthYm9ydCgiVG8gdXNlIGRsb3BlbiwgeW91IG5lZWQgdG8gdXNlIEVtc2NyaXB0ZW4ncyBsaW5raW5nIHN1cHBvcnQsIHNlZSBodHRwczovL2dpdGh1Yi5jb20vZW1zY3JpcHRlbi1jb3JlL2Vtc2NyaXB0ZW4vd2lraS9MaW5raW5nIil9ZnVuY3Rpb24gX2Vtc2NyaXB0ZW5fbWVtY3B5X2JpZyhkZXN0LHNyYyxudW0pe0hFQVBVOC5jb3B5V2l0aGluKGRlc3Qsc3JjLHNyYytudW0pfWZ1bmN0aW9uIF9lbXNjcmlwdGVuX2dldF9oZWFwX3NpemUoKXtyZXR1cm4gSEVBUFU4Lmxlbmd0aH1mdW5jdGlvbiBlbXNjcmlwdGVuX3JlYWxsb2NfYnVmZmVyKHNpemUpe3RyeXt3YXNtTWVtb3J5Lmdyb3coc2l6ZS1idWZmZXIuYnl0ZUxlbmd0aCs2NTUzNT4+PjE2KTt1cGRhdGVHbG9iYWxCdWZmZXJBbmRWaWV3cyh3YXNtTWVtb3J5LmJ1ZmZlcik7cmV0dXJuIDF9Y2F0Y2goZSl7fX1mdW5jdGlvbiBfZW1zY3JpcHRlbl9yZXNpemVfaGVhcChyZXF1ZXN0ZWRTaXplKXt2YXIgb2xkU2l6ZT1fZW1zY3JpcHRlbl9nZXRfaGVhcF9zaXplKCk7dmFyIG1heEhlYXBTaXplPTIxNDc0ODM2NDg7aWYocmVxdWVzdGVkU2l6ZT5tYXhIZWFwU2l6ZSl7cmV0dXJuIGZhbHNlfWZvcih2YXIgY3V0RG93bj0xO2N1dERvd248PTQ7Y3V0RG93bio9Mil7dmFyIG92ZXJHcm93bkhlYXBTaXplPW9sZFNpemUqKDErLjIvY3V0RG93bik7b3Zlckdyb3duSGVhcFNpemU9TWF0aC5taW4ob3Zlckdyb3duSGVhcFNpemUscmVxdWVzdGVkU2l6ZSsxMDA2NjMyOTYpO3ZhciBuZXdTaXplPU1hdGgubWluKG1heEhlYXBTaXplLGFsaWduVXAoTWF0aC5tYXgocmVxdWVzdGVkU2l6ZSxvdmVyR3Jvd25IZWFwU2l6ZSksNjU1MzYpKTt2YXIgcmVwbGFjZW1lbnQ9ZW1zY3JpcHRlbl9yZWFsbG9jX2J1ZmZlcihuZXdTaXplKTtpZihyZXBsYWNlbWVudCl7cmV0dXJuIHRydWV9fXJldHVybiBmYWxzZX1mdW5jdGlvbiBfZW1zY3JpcHRlbl90aHJlYWRfc2xlZXAobXNlY3Mpe3ZhciBzdGFydD1fZW1zY3JpcHRlbl9nZXRfbm93KCk7d2hpbGUoX2Vtc2NyaXB0ZW5fZ2V0X25vdygpLXN0YXJ0PG1zZWNzKXt9fXZhciBFTlY9e307ZnVuY3Rpb24gZ2V0RXhlY3V0YWJsZU5hbWUoKXtyZXR1cm4gdGhpc1Byb2dyYW18fCIuL3RoaXMucHJvZ3JhbSJ9ZnVuY3Rpb24gZ2V0RW52U3RyaW5ncygpe2lmKCFnZXRFbnZTdHJpbmdzLnN0cmluZ3Mpe3ZhciBsYW5nPSh0eXBlb2YgbmF2aWdhdG9yPT09Im9iamVjdCImJm5hdmlnYXRvci5sYW5ndWFnZXMmJm5hdmlnYXRvci5sYW5ndWFnZXNbMF18fCJDIikucmVwbGFjZSgiLSIsIl8iKSsiLlVURi04Ijt2YXIgZW52PXsiVVNFUiI6IndlYl91c2VyIiwiTE9HTkFNRSI6IndlYl91c2VyIiwiUEFUSCI6Ii8iLCJQV0QiOiIvIiwiSE9NRSI6Ii9ob21lL3dlYl91c2VyIiwiTEFORyI6bGFuZywiXyI6Z2V0RXhlY3V0YWJsZU5hbWUoKX07Zm9yKHZhciB4IGluIEVOVil7ZW52W3hdPUVOVlt4XX12YXIgc3RyaW5ncz1bXTtmb3IodmFyIHggaW4gZW52KXtzdHJpbmdzLnB1c2goeCsiPSIrZW52W3hdKX1nZXRFbnZTdHJpbmdzLnN0cmluZ3M9c3RyaW5nc31yZXR1cm4gZ2V0RW52U3RyaW5ncy5zdHJpbmdzfWZ1bmN0aW9uIF9lbnZpcm9uX2dldChfX2Vudmlyb24sZW52aXJvbl9idWYpe3ZhciBidWZTaXplPTA7Z2V0RW52U3RyaW5ncygpLmZvckVhY2goZnVuY3Rpb24oc3RyaW5nLGkpe3ZhciBwdHI9ZW52aXJvbl9idWYrYnVmU2l6ZTtIRUFQMzJbX19lbnZpcm9uK2kqND4+Ml09cHRyO3dyaXRlQXNjaWlUb01lbW9yeShzdHJpbmcscHRyKTtidWZTaXplKz1zdHJpbmcubGVuZ3RoKzF9KTtyZXR1cm4gMH1mdW5jdGlvbiBfZW52aXJvbl9zaXplc19nZXQocGVudmlyb25fY291bnQscGVudmlyb25fYnVmX3NpemUpe3ZhciBzdHJpbmdzPWdldEVudlN0cmluZ3MoKTtIRUFQMzJbcGVudmlyb25fY291bnQ+PjJdPXN0cmluZ3MubGVuZ3RoO3ZhciBidWZTaXplPTA7c3RyaW5ncy5mb3JFYWNoKGZ1bmN0aW9uKHN0cmluZyl7YnVmU2l6ZSs9c3RyaW5nLmxlbmd0aCsxfSk7SEVBUDMyW3BlbnZpcm9uX2J1Zl9zaXplPj4yXT1idWZTaXplO3JldHVybiAwfWZ1bmN0aW9uIF9mZF9jbG9zZShmZCl7cmV0dXJuIDB9ZnVuY3Rpb24gX2ZkX2Zkc3RhdF9nZXQoZmQscGJ1Zil7dmFyIHR5cGU9ZmQ9PTF8fGZkPT0yPzI6YWJvcnQoKTtIRUFQOFtwYnVmPj4wXT10eXBlO3JldHVybiAwfWZ1bmN0aW9uIF9mZF9yZWFkKGZkLGlvdixpb3ZjbnQscG51bSl7dmFyIHN0cmVhbT1TWVNDQUxMUy5nZXRTdHJlYW1Gcm9tRkQoZmQpO3ZhciBudW09U1lTQ0FMTFMuZG9SZWFkdihzdHJlYW0saW92LGlvdmNudCk7SEVBUDMyW3BudW0+PjJdPW51bTtyZXR1cm4gMH1mdW5jdGlvbiBfZmRfc2VlayhmZCxvZmZzZXRfbG93LG9mZnNldF9oaWdoLHdoZW5jZSxuZXdPZmZzZXQpe31mdW5jdGlvbiBfZmRfd3JpdGUoZmQsaW92LGlvdmNudCxwbnVtKXt2YXIgbnVtPTA7Zm9yKHZhciBpPTA7aTxpb3ZjbnQ7aSsrKXt2YXIgcHRyPUhFQVAzMltpb3YraSo4Pj4yXTt2YXIgbGVuPUhFQVAzMltpb3YrKGkqOCs0KT4+Ml07Zm9yKHZhciBqPTA7ajxsZW47aisrKXtTWVNDQUxMUy5wcmludENoYXIoZmQsSEVBUFU4W3B0citqXSl9bnVtKz1sZW59SEVBUDMyW3BudW0+PjJdPW51bTtyZXR1cm4gMH1mdW5jdGlvbiBfZ210aW1lX3IodGltZSx0bVB0cil7dmFyIGRhdGU9bmV3IERhdGUoSEVBUDMyW3RpbWU+PjJdKjFlMyk7SEVBUDMyW3RtUHRyPj4yXT1kYXRlLmdldFVUQ1NlY29uZHMoKTtIRUFQMzJbdG1QdHIrND4+Ml09ZGF0ZS5nZXRVVENNaW51dGVzKCk7SEVBUDMyW3RtUHRyKzg+PjJdPWRhdGUuZ2V0VVRDSG91cnMoKTtIRUFQMzJbdG1QdHIrMTI+PjJdPWRhdGUuZ2V0VVRDRGF0ZSgpO0hFQVAzMlt0bVB0cisxNj4+Ml09ZGF0ZS5nZXRVVENNb250aCgpO0hFQVAzMlt0bVB0cisyMD4+Ml09ZGF0ZS5nZXRVVENGdWxsWWVhcigpLTE5MDA7SEVBUDMyW3RtUHRyKzI0Pj4yXT1kYXRlLmdldFVUQ0RheSgpO0hFQVAzMlt0bVB0ciszNj4+Ml09MDtIRUFQMzJbdG1QdHIrMzI+PjJdPTA7dmFyIHN0YXJ0PURhdGUuVVRDKGRhdGUuZ2V0VVRDRnVsbFllYXIoKSwwLDEsMCwwLDAsMCk7dmFyIHlkYXk9KGRhdGUuZ2V0VGltZSgpLXN0YXJ0KS8oMWUzKjYwKjYwKjI0KXwwO0hFQVAzMlt0bVB0cisyOD4+Ml09eWRheTtpZighX2dtdGltZV9yLkdNVFN0cmluZylfZ210aW1lX3IuR01UU3RyaW5nPWFsbG9jYXRlVVRGOCgiR01UIik7SEVBUDMyW3RtUHRyKzQwPj4yXT1fZ210aW1lX3IuR01UU3RyaW5nO3JldHVybiB0bVB0cn1mdW5jdGlvbiBfdHpzZXQoKXtpZihfdHpzZXQuY2FsbGVkKXJldHVybjtfdHpzZXQuY2FsbGVkPXRydWU7dmFyIGN1cnJlbnRZZWFyPShuZXcgRGF0ZSkuZ2V0RnVsbFllYXIoKTt2YXIgd2ludGVyPW5ldyBEYXRlKGN1cnJlbnRZZWFyLDAsMSk7dmFyIHN1bW1lcj1uZXcgRGF0ZShjdXJyZW50WWVhciw2LDEpO3ZhciB3aW50ZXJPZmZzZXQ9d2ludGVyLmdldFRpbWV6b25lT2Zmc2V0KCk7dmFyIHN1bW1lck9mZnNldD1zdW1tZXIuZ2V0VGltZXpvbmVPZmZzZXQoKTt2YXIgc3RkVGltZXpvbmVPZmZzZXQ9TWF0aC5tYXgod2ludGVyT2Zmc2V0LHN1bW1lck9mZnNldCk7SEVBUDMyW19fZ2V0X3RpbWV6b25lKCk+PjJdPXN0ZFRpbWV6b25lT2Zmc2V0KjYwO0hFQVAzMltfX2dldF9kYXlsaWdodCgpPj4yXT1OdW1iZXIod2ludGVyT2Zmc2V0IT1zdW1tZXJPZmZzZXQpO2Z1bmN0aW9uIGV4dHJhY3Rab25lKGRhdGUpe3ZhciBtYXRjaD1kYXRlLnRvVGltZVN0cmluZygpLm1hdGNoKC9cKChbQS1aYS16IF0rKVwpJC8pO3JldHVybiBtYXRjaD9tYXRjaFsxXToiR01UIn12YXIgd2ludGVyTmFtZT1leHRyYWN0Wm9uZSh3aW50ZXIpO3ZhciBzdW1tZXJOYW1lPWV4dHJhY3Rab25lKHN1bW1lcik7dmFyIHdpbnRlck5hbWVQdHI9YWxsb2NhdGVVVEY4KHdpbnRlck5hbWUpO3ZhciBzdW1tZXJOYW1lUHRyPWFsbG9jYXRlVVRGOChzdW1tZXJOYW1lKTtpZihzdW1tZXJPZmZzZXQ8d2ludGVyT2Zmc2V0KXtIRUFQMzJbX19nZXRfdHpuYW1lKCk+PjJdPXdpbnRlck5hbWVQdHI7SEVBUDMyW19fZ2V0X3R6bmFtZSgpKzQ+PjJdPXN1bW1lck5hbWVQdHJ9ZWxzZXtIRUFQMzJbX19nZXRfdHpuYW1lKCk+PjJdPXN1bW1lck5hbWVQdHI7SEVBUDMyW19fZ2V0X3R6bmFtZSgpKzQ+PjJdPXdpbnRlck5hbWVQdHJ9fWZ1bmN0aW9uIF9sb2NhbHRpbWVfcih0aW1lLHRtUHRyKXtfdHpzZXQoKTt2YXIgZGF0ZT1uZXcgRGF0ZShIRUFQMzJbdGltZT4+Ml0qMWUzKTtIRUFQMzJbdG1QdHI+PjJdPWRhdGUuZ2V0U2Vjb25kcygpO0hFQVAzMlt0bVB0cis0Pj4yXT1kYXRlLmdldE1pbnV0ZXMoKTtIRUFQMzJbdG1QdHIrOD4+Ml09ZGF0ZS5nZXRIb3VycygpO0hFQVAzMlt0bVB0cisxMj4+Ml09ZGF0ZS5nZXREYXRlKCk7SEVBUDMyW3RtUHRyKzE2Pj4yXT1kYXRlLmdldE1vbnRoKCk7SEVBUDMyW3RtUHRyKzIwPj4yXT1kYXRlLmdldEZ1bGxZZWFyKCktMTkwMDtIRUFQMzJbdG1QdHIrMjQ+PjJdPWRhdGUuZ2V0RGF5KCk7dmFyIHN0YXJ0PW5ldyBEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSwwLDEpO3ZhciB5ZGF5PShkYXRlLmdldFRpbWUoKS1zdGFydC5nZXRUaW1lKCkpLygxZTMqNjAqNjAqMjQpfDA7SEVBUDMyW3RtUHRyKzI4Pj4yXT15ZGF5O0hFQVAzMlt0bVB0ciszNj4+Ml09LShkYXRlLmdldFRpbWV6b25lT2Zmc2V0KCkqNjApO3ZhciBzdW1tZXJPZmZzZXQ9bmV3IERhdGUoZGF0ZS5nZXRGdWxsWWVhcigpLDYsMSkuZ2V0VGltZXpvbmVPZmZzZXQoKTt2YXIgd2ludGVyT2Zmc2V0PXN0YXJ0LmdldFRpbWV6b25lT2Zmc2V0KCk7dmFyIGRzdD0oc3VtbWVyT2Zmc2V0IT13aW50ZXJPZmZzZXQmJmRhdGUuZ2V0VGltZXpvbmVPZmZzZXQoKT09TWF0aC5taW4od2ludGVyT2Zmc2V0LHN1bW1lck9mZnNldCkpfDA7SEVBUDMyW3RtUHRyKzMyPj4yXT1kc3Q7dmFyIHpvbmVQdHI9SEVBUDMyW19fZ2V0X3R6bmFtZSgpKyhkc3Q/NDowKT4+Ml07SEVBUDMyW3RtUHRyKzQwPj4yXT16b25lUHRyO3JldHVybiB0bVB0cn1mdW5jdGlvbiBfcHRocmVhZF9jcmVhdGUoKXtyZXR1cm4gNn1mdW5jdGlvbiBfcHRocmVhZF9qb2luKCl7cmV0dXJuIDI4fWZ1bmN0aW9uIF9zZXRUZW1wUmV0MCgkaSl7c2V0VGVtcFJldDAoJGl8MCl9ZnVuY3Rpb24gX19pc0xlYXBZZWFyKHllYXIpe3JldHVybiB5ZWFyJTQ9PT0wJiYoeWVhciUxMDAhPT0wfHx5ZWFyJTQwMD09PTApfWZ1bmN0aW9uIF9fYXJyYXlTdW0oYXJyYXksaW5kZXgpe3ZhciBzdW09MDtmb3IodmFyIGk9MDtpPD1pbmRleDtzdW0rPWFycmF5W2krK10pe31yZXR1cm4gc3VtfXZhciBfX01PTlRIX0RBWVNfTEVBUD1bMzEsMjksMzEsMzAsMzEsMzAsMzEsMzEsMzAsMzEsMzAsMzFdO3ZhciBfX01PTlRIX0RBWVNfUkVHVUxBUj1bMzEsMjgsMzEsMzAsMzEsMzAsMzEsMzEsMzAsMzEsMzAsMzFdO2Z1bmN0aW9uIF9fYWRkRGF5cyhkYXRlLGRheXMpe3ZhciBuZXdEYXRlPW5ldyBEYXRlKGRhdGUuZ2V0VGltZSgpKTt3aGlsZShkYXlzPjApe3ZhciBsZWFwPV9faXNMZWFwWWVhcihuZXdEYXRlLmdldEZ1bGxZZWFyKCkpO3ZhciBjdXJyZW50TW9udGg9bmV3RGF0ZS5nZXRNb250aCgpO3ZhciBkYXlzSW5DdXJyZW50TW9udGg9KGxlYXA/X19NT05USF9EQVlTX0xFQVA6X19NT05USF9EQVlTX1JFR1VMQVIpW2N1cnJlbnRNb250aF07aWYoZGF5cz5kYXlzSW5DdXJyZW50TW9udGgtbmV3RGF0ZS5nZXREYXRlKCkpe2RheXMtPWRheXNJbkN1cnJlbnRNb250aC1uZXdEYXRlLmdldERhdGUoKSsxO25ld0RhdGUuc2V0RGF0ZSgxKTtpZihjdXJyZW50TW9udGg8MTEpe25ld0RhdGUuc2V0TW9udGgoY3VycmVudE1vbnRoKzEpfWVsc2V7bmV3RGF0ZS5zZXRNb250aCgwKTtuZXdEYXRlLnNldEZ1bGxZZWFyKG5ld0RhdGUuZ2V0RnVsbFllYXIoKSsxKX19ZWxzZXtuZXdEYXRlLnNldERhdGUobmV3RGF0ZS5nZXREYXRlKCkrZGF5cyk7cmV0dXJuIG5ld0RhdGV9fXJldHVybiBuZXdEYXRlfWZ1bmN0aW9uIF9zdHJmdGltZShzLG1heHNpemUsZm9ybWF0LHRtKXt2YXIgdG1fem9uZT1IRUFQMzJbdG0rNDA+PjJdO3ZhciBkYXRlPXt0bV9zZWM6SEVBUDMyW3RtPj4yXSx0bV9taW46SEVBUDMyW3RtKzQ+PjJdLHRtX2hvdXI6SEVBUDMyW3RtKzg+PjJdLHRtX21kYXk6SEVBUDMyW3RtKzEyPj4yXSx0bV9tb246SEVBUDMyW3RtKzE2Pj4yXSx0bV95ZWFyOkhFQVAzMlt0bSsyMD4+Ml0sdG1fd2RheTpIRUFQMzJbdG0rMjQ+PjJdLHRtX3lkYXk6SEVBUDMyW3RtKzI4Pj4yXSx0bV9pc2RzdDpIRUFQMzJbdG0rMzI+PjJdLHRtX2dtdG9mZjpIRUFQMzJbdG0rMzY+PjJdLHRtX3pvbmU6dG1fem9uZT9VVEY4VG9TdHJpbmcodG1fem9uZSk6IiJ9O3ZhciBwYXR0ZXJuPVVURjhUb1N0cmluZyhmb3JtYXQpO3ZhciBFWFBBTlNJT05fUlVMRVNfMT17IiVjIjoiJWEgJWIgJWQgJUg6JU06JVMgJVkiLCIlRCI6IiVtLyVkLyV5IiwiJUYiOiIlWS0lbS0lZCIsIiVoIjoiJWIiLCIlciI6IiVJOiVNOiVTICVwIiwiJVIiOiIlSDolTSIsIiVUIjoiJUg6JU06JVMiLCIleCI6IiVtLyVkLyV5IiwiJVgiOiIlSDolTTolUyIsIiVFYyI6IiVjIiwiJUVDIjoiJUMiLCIlRXgiOiIlbS8lZC8leSIsIiVFWCI6IiVIOiVNOiVTIiwiJUV5IjoiJXkiLCIlRVkiOiIlWSIsIiVPZCI6IiVkIiwiJU9lIjoiJWUiLCIlT0giOiIlSCIsIiVPSSI6IiVJIiwiJU9tIjoiJW0iLCIlT00iOiIlTSIsIiVPUyI6IiVTIiwiJU91IjoiJXUiLCIlT1UiOiIlVSIsIiVPViI6IiVWIiwiJU93IjoiJXciLCIlT1ciOiIlVyIsIiVPeSI6IiV5In07Zm9yKHZhciBydWxlIGluIEVYUEFOU0lPTl9SVUxFU18xKXtwYXR0ZXJuPXBhdHRlcm4ucmVwbGFjZShuZXcgUmVnRXhwKHJ1bGUsImciKSxFWFBBTlNJT05fUlVMRVNfMVtydWxlXSl9dmFyIFdFRUtEQVlTPVsiU3VuZGF5IiwiTW9uZGF5IiwiVHVlc2RheSIsIldlZG5lc2RheSIsIlRodXJzZGF5IiwiRnJpZGF5IiwiU2F0dXJkYXkiXTt2YXIgTU9OVEhTPVsiSmFudWFyeSIsIkZlYnJ1YXJ5IiwiTWFyY2giLCJBcHJpbCIsIk1heSIsIkp1bmUiLCJKdWx5IiwiQXVndXN0IiwiU2VwdGVtYmVyIiwiT2N0b2JlciIsIk5vdmVtYmVyIiwiRGVjZW1iZXIiXTtmdW5jdGlvbiBsZWFkaW5nU29tZXRoaW5nKHZhbHVlLGRpZ2l0cyxjaGFyYWN0ZXIpe3ZhciBzdHI9dHlwZW9mIHZhbHVlPT09Im51bWJlciI/dmFsdWUudG9TdHJpbmcoKTp2YWx1ZXx8IiI7d2hpbGUoc3RyLmxlbmd0aDxkaWdpdHMpe3N0cj1jaGFyYWN0ZXJbMF0rc3RyfXJldHVybiBzdHJ9ZnVuY3Rpb24gbGVhZGluZ051bGxzKHZhbHVlLGRpZ2l0cyl7cmV0dXJuIGxlYWRpbmdTb21ldGhpbmcodmFsdWUsZGlnaXRzLCIwIil9ZnVuY3Rpb24gY29tcGFyZUJ5RGF5KGRhdGUxLGRhdGUyKXtmdW5jdGlvbiBzZ24odmFsdWUpe3JldHVybiB2YWx1ZTwwPy0xOnZhbHVlPjA/MTowfXZhciBjb21wYXJlO2lmKChjb21wYXJlPXNnbihkYXRlMS5nZXRGdWxsWWVhcigpLWRhdGUyLmdldEZ1bGxZZWFyKCkpKT09PTApe2lmKChjb21wYXJlPXNnbihkYXRlMS5nZXRNb250aCgpLWRhdGUyLmdldE1vbnRoKCkpKT09PTApe2NvbXBhcmU9c2duKGRhdGUxLmdldERhdGUoKS1kYXRlMi5nZXREYXRlKCkpfX1yZXR1cm4gY29tcGFyZX1mdW5jdGlvbiBnZXRGaXJzdFdlZWtTdGFydERhdGUoamFuRm91cnRoKXtzd2l0Y2goamFuRm91cnRoLmdldERheSgpKXtjYXNlIDA6cmV0dXJuIG5ldyBEYXRlKGphbkZvdXJ0aC5nZXRGdWxsWWVhcigpLTEsMTEsMjkpO2Nhc2UgMTpyZXR1cm4gamFuRm91cnRoO2Nhc2UgMjpyZXR1cm4gbmV3IERhdGUoamFuRm91cnRoLmdldEZ1bGxZZWFyKCksMCwzKTtjYXNlIDM6cmV0dXJuIG5ldyBEYXRlKGphbkZvdXJ0aC5nZXRGdWxsWWVhcigpLDAsMik7Y2FzZSA0OnJldHVybiBuZXcgRGF0ZShqYW5Gb3VydGguZ2V0RnVsbFllYXIoKSwwLDEpO2Nhc2UgNTpyZXR1cm4gbmV3IERhdGUoamFuRm91cnRoLmdldEZ1bGxZZWFyKCktMSwxMSwzMSk7Y2FzZSA2OnJldHVybiBuZXcgRGF0ZShqYW5Gb3VydGguZ2V0RnVsbFllYXIoKS0xLDExLDMwKX19ZnVuY3Rpb24gZ2V0V2Vla0Jhc2VkWWVhcihkYXRlKXt2YXIgdGhpc0RhdGU9X19hZGREYXlzKG5ldyBEYXRlKGRhdGUudG1feWVhcisxOTAwLDAsMSksZGF0ZS50bV95ZGF5KTt2YXIgamFuRm91cnRoVGhpc1llYXI9bmV3IERhdGUodGhpc0RhdGUuZ2V0RnVsbFllYXIoKSwwLDQpO3ZhciBqYW5Gb3VydGhOZXh0WWVhcj1uZXcgRGF0ZSh0aGlzRGF0ZS5nZXRGdWxsWWVhcigpKzEsMCw0KTt2YXIgZmlyc3RXZWVrU3RhcnRUaGlzWWVhcj1nZXRGaXJzdFdlZWtTdGFydERhdGUoamFuRm91cnRoVGhpc1llYXIpO3ZhciBmaXJzdFdlZWtTdGFydE5leHRZZWFyPWdldEZpcnN0V2Vla1N0YXJ0RGF0ZShqYW5Gb3VydGhOZXh0WWVhcik7aWYoY29tcGFyZUJ5RGF5KGZpcnN0V2Vla1N0YXJ0VGhpc1llYXIsdGhpc0RhdGUpPD0wKXtpZihjb21wYXJlQnlEYXkoZmlyc3RXZWVrU3RhcnROZXh0WWVhcix0aGlzRGF0ZSk8PTApe3JldHVybiB0aGlzRGF0ZS5nZXRGdWxsWWVhcigpKzF9ZWxzZXtyZXR1cm4gdGhpc0RhdGUuZ2V0RnVsbFllYXIoKX19ZWxzZXtyZXR1cm4gdGhpc0RhdGUuZ2V0RnVsbFllYXIoKS0xfX12YXIgRVhQQU5TSU9OX1JVTEVTXzI9eyIlYSI6ZnVuY3Rpb24oZGF0ZSl7cmV0dXJuIFdFRUtEQVlTW2RhdGUudG1fd2RheV0uc3Vic3RyaW5nKDAsMyl9LCIlQSI6ZnVuY3Rpb24oZGF0ZSl7cmV0dXJuIFdFRUtEQVlTW2RhdGUudG1fd2RheV19LCIlYiI6ZnVuY3Rpb24oZGF0ZSl7cmV0dXJuIE1PTlRIU1tkYXRlLnRtX21vbl0uc3Vic3RyaW5nKDAsMyl9LCIlQiI6ZnVuY3Rpb24oZGF0ZSl7cmV0dXJuIE1PTlRIU1tkYXRlLnRtX21vbl19LCIlQyI6ZnVuY3Rpb24oZGF0ZSl7dmFyIHllYXI9ZGF0ZS50bV95ZWFyKzE5MDA7cmV0dXJuIGxlYWRpbmdOdWxscyh5ZWFyLzEwMHwwLDIpfSwiJWQiOmZ1bmN0aW9uKGRhdGUpe3JldHVybiBsZWFkaW5nTnVsbHMoZGF0ZS50bV9tZGF5LDIpfSwiJWUiOmZ1bmN0aW9uKGRhdGUpe3JldHVybiBsZWFkaW5nU29tZXRoaW5nKGRhdGUudG1fbWRheSwyLCIgIil9LCIlZyI6ZnVuY3Rpb24oZGF0ZSl7cmV0dXJuIGdldFdlZWtCYXNlZFllYXIoZGF0ZSkudG9TdHJpbmcoKS5zdWJzdHJpbmcoMil9LCIlRyI6ZnVuY3Rpb24oZGF0ZSl7cmV0dXJuIGdldFdlZWtCYXNlZFllYXIoZGF0ZSl9LCIlSCI6ZnVuY3Rpb24oZGF0ZSl7cmV0dXJuIGxlYWRpbmdOdWxscyhkYXRlLnRtX2hvdXIsMil9LCIlSSI6ZnVuY3Rpb24oZGF0ZSl7dmFyIHR3ZWx2ZUhvdXI9ZGF0ZS50bV9ob3VyO2lmKHR3ZWx2ZUhvdXI9PTApdHdlbHZlSG91cj0xMjtlbHNlIGlmKHR3ZWx2ZUhvdXI+MTIpdHdlbHZlSG91ci09MTI7cmV0dXJuIGxlYWRpbmdOdWxscyh0d2VsdmVIb3VyLDIpfSwiJWoiOmZ1bmN0aW9uKGRhdGUpe3JldHVybiBsZWFkaW5nTnVsbHMoZGF0ZS50bV9tZGF5K19fYXJyYXlTdW0oX19pc0xlYXBZZWFyKGRhdGUudG1feWVhcisxOTAwKT9fX01PTlRIX0RBWVNfTEVBUDpfX01PTlRIX0RBWVNfUkVHVUxBUixkYXRlLnRtX21vbi0xKSwzKX0sIiVtIjpmdW5jdGlvbihkYXRlKXtyZXR1cm4gbGVhZGluZ051bGxzKGRhdGUudG1fbW9uKzEsMil9LCIlTSI6ZnVuY3Rpb24oZGF0ZSl7cmV0dXJuIGxlYWRpbmdOdWxscyhkYXRlLnRtX21pbiwyKX0sIiVuIjpmdW5jdGlvbigpe3JldHVybiJcbiJ9LCIlcCI6ZnVuY3Rpb24oZGF0ZSl7aWYoZGF0ZS50bV9ob3VyPj0wJiZkYXRlLnRtX2hvdXI8MTIpe3JldHVybiJBTSJ9ZWxzZXtyZXR1cm4iUE0ifX0sIiVTIjpmdW5jdGlvbihkYXRlKXtyZXR1cm4gbGVhZGluZ051bGxzKGRhdGUudG1fc2VjLDIpfSwiJXQiOmZ1bmN0aW9uKCl7cmV0dXJuIlx0In0sIiV1IjpmdW5jdGlvbihkYXRlKXtyZXR1cm4gZGF0ZS50bV93ZGF5fHw3fSwiJVUiOmZ1bmN0aW9uKGRhdGUpe3ZhciBqYW5GaXJzdD1uZXcgRGF0ZShkYXRlLnRtX3llYXIrMTkwMCwwLDEpO3ZhciBmaXJzdFN1bmRheT1qYW5GaXJzdC5nZXREYXkoKT09PTA/amFuRmlyc3Q6X19hZGREYXlzKGphbkZpcnN0LDctamFuRmlyc3QuZ2V0RGF5KCkpO3ZhciBlbmREYXRlPW5ldyBEYXRlKGRhdGUudG1feWVhcisxOTAwLGRhdGUudG1fbW9uLGRhdGUudG1fbWRheSk7aWYoY29tcGFyZUJ5RGF5KGZpcnN0U3VuZGF5LGVuZERhdGUpPDApe3ZhciBmZWJydWFyeUZpcnN0VW50aWxFbmRNb250aD1fX2FycmF5U3VtKF9faXNMZWFwWWVhcihlbmREYXRlLmdldEZ1bGxZZWFyKCkpP19fTU9OVEhfREFZU19MRUFQOl9fTU9OVEhfREFZU19SRUdVTEFSLGVuZERhdGUuZ2V0TW9udGgoKS0xKS0zMTt2YXIgZmlyc3RTdW5kYXlVbnRpbEVuZEphbnVhcnk9MzEtZmlyc3RTdW5kYXkuZ2V0RGF0ZSgpO3ZhciBkYXlzPWZpcnN0U3VuZGF5VW50aWxFbmRKYW51YXJ5K2ZlYnJ1YXJ5Rmlyc3RVbnRpbEVuZE1vbnRoK2VuZERhdGUuZ2V0RGF0ZSgpO3JldHVybiBsZWFkaW5nTnVsbHMoTWF0aC5jZWlsKGRheXMvNyksMil9cmV0dXJuIGNvbXBhcmVCeURheShmaXJzdFN1bmRheSxqYW5GaXJzdCk9PT0wPyIwMSI6IjAwIn0sIiVWIjpmdW5jdGlvbihkYXRlKXt2YXIgamFuRm91cnRoVGhpc1llYXI9bmV3IERhdGUoZGF0ZS50bV95ZWFyKzE5MDAsMCw0KTt2YXIgamFuRm91cnRoTmV4dFllYXI9bmV3IERhdGUoZGF0ZS50bV95ZWFyKzE5MDEsMCw0KTt2YXIgZmlyc3RXZWVrU3RhcnRUaGlzWWVhcj1nZXRGaXJzdFdlZWtTdGFydERhdGUoamFuRm91cnRoVGhpc1llYXIpO3ZhciBmaXJzdFdlZWtTdGFydE5leHRZZWFyPWdldEZpcnN0V2Vla1N0YXJ0RGF0ZShqYW5Gb3VydGhOZXh0WWVhcik7dmFyIGVuZERhdGU9X19hZGREYXlzKG5ldyBEYXRlKGRhdGUudG1feWVhcisxOTAwLDAsMSksZGF0ZS50bV95ZGF5KTtpZihjb21wYXJlQnlEYXkoZW5kRGF0ZSxmaXJzdFdlZWtTdGFydFRoaXNZZWFyKTwwKXtyZXR1cm4iNTMifWlmKGNvbXBhcmVCeURheShmaXJzdFdlZWtTdGFydE5leHRZZWFyLGVuZERhdGUpPD0wKXtyZXR1cm4iMDEifXZhciBkYXlzRGlmZmVyZW5jZTtpZihmaXJzdFdlZWtTdGFydFRoaXNZZWFyLmdldEZ1bGxZZWFyKCk8ZGF0ZS50bV95ZWFyKzE5MDApe2RheXNEaWZmZXJlbmNlPWRhdGUudG1feWRheSszMi1maXJzdFdlZWtTdGFydFRoaXNZZWFyLmdldERhdGUoKX1lbHNle2RheXNEaWZmZXJlbmNlPWRhdGUudG1feWRheSsxLWZpcnN0V2Vla1N0YXJ0VGhpc1llYXIuZ2V0RGF0ZSgpfXJldHVybiBsZWFkaW5nTnVsbHMoTWF0aC5jZWlsKGRheXNEaWZmZXJlbmNlLzcpLDIpfSwiJXciOmZ1bmN0aW9uKGRhdGUpe3JldHVybiBkYXRlLnRtX3dkYXl9LCIlVyI6ZnVuY3Rpb24oZGF0ZSl7dmFyIGphbkZpcnN0PW5ldyBEYXRlKGRhdGUudG1feWVhciwwLDEpO3ZhciBmaXJzdE1vbmRheT1qYW5GaXJzdC5nZXREYXkoKT09PTE/amFuRmlyc3Q6X19hZGREYXlzKGphbkZpcnN0LGphbkZpcnN0LmdldERheSgpPT09MD8xOjctamFuRmlyc3QuZ2V0RGF5KCkrMSk7dmFyIGVuZERhdGU9bmV3IERhdGUoZGF0ZS50bV95ZWFyKzE5MDAsZGF0ZS50bV9tb24sZGF0ZS50bV9tZGF5KTtpZihjb21wYXJlQnlEYXkoZmlyc3RNb25kYXksZW5kRGF0ZSk8MCl7dmFyIGZlYnJ1YXJ5Rmlyc3RVbnRpbEVuZE1vbnRoPV9fYXJyYXlTdW0oX19pc0xlYXBZZWFyKGVuZERhdGUuZ2V0RnVsbFllYXIoKSk/X19NT05USF9EQVlTX0xFQVA6X19NT05USF9EQVlTX1JFR1VMQVIsZW5kRGF0ZS5nZXRNb250aCgpLTEpLTMxO3ZhciBmaXJzdE1vbmRheVVudGlsRW5kSmFudWFyeT0zMS1maXJzdE1vbmRheS5nZXREYXRlKCk7dmFyIGRheXM9Zmlyc3RNb25kYXlVbnRpbEVuZEphbnVhcnkrZmVicnVhcnlGaXJzdFVudGlsRW5kTW9udGgrZW5kRGF0ZS5nZXREYXRlKCk7cmV0dXJuIGxlYWRpbmdOdWxscyhNYXRoLmNlaWwoZGF5cy83KSwyKX1yZXR1cm4gY29tcGFyZUJ5RGF5KGZpcnN0TW9uZGF5LGphbkZpcnN0KT09PTA/IjAxIjoiMDAifSwiJXkiOmZ1bmN0aW9uKGRhdGUpe3JldHVybihkYXRlLnRtX3llYXIrMTkwMCkudG9TdHJpbmcoKS5zdWJzdHJpbmcoMil9LCIlWSI6ZnVuY3Rpb24oZGF0ZSl7cmV0dXJuIGRhdGUudG1feWVhcisxOTAwfSwiJXoiOmZ1bmN0aW9uKGRhdGUpe3ZhciBvZmY9ZGF0ZS50bV9nbXRvZmY7dmFyIGFoZWFkPW9mZj49MDtvZmY9TWF0aC5hYnMob2ZmKS82MDtvZmY9b2ZmLzYwKjEwMCtvZmYlNjA7cmV0dXJuKGFoZWFkPyIrIjoiLSIpK1N0cmluZygiMDAwMCIrb2ZmKS5zbGljZSgtNCl9LCIlWiI6ZnVuY3Rpb24oZGF0ZSl7cmV0dXJuIGRhdGUudG1fem9uZX0sIiUlIjpmdW5jdGlvbigpe3JldHVybiIlIn19O2Zvcih2YXIgcnVsZSBpbiBFWFBBTlNJT05fUlVMRVNfMil7aWYocGF0dGVybi5pbmRleE9mKHJ1bGUpPj0wKXtwYXR0ZXJuPXBhdHRlcm4ucmVwbGFjZShuZXcgUmVnRXhwKHJ1bGUsImciKSxFWFBBTlNJT05fUlVMRVNfMltydWxlXShkYXRlKSl9fXZhciBieXRlcz1pbnRBcnJheUZyb21TdHJpbmcocGF0dGVybixmYWxzZSk7aWYoYnl0ZXMubGVuZ3RoPm1heHNpemUpe3JldHVybiAwfXdyaXRlQXJyYXlUb01lbW9yeShieXRlcyxzKTtyZXR1cm4gYnl0ZXMubGVuZ3RoLTF9ZnVuY3Rpb24gX3N0cmZ0aW1lX2wocyxtYXhzaXplLGZvcm1hdCx0bSl7cmV0dXJuIF9zdHJmdGltZShzLG1heHNpemUsZm9ybWF0LHRtKX1mdW5jdGlvbiBfc3lzY29uZihuYW1lKXtzd2l0Y2gobmFtZSl7Y2FzZSAzMDpyZXR1cm4gMTYzODQ7Y2FzZSA4NTp2YXIgbWF4SGVhcFNpemU9MjE0NzQ4MzY0ODtyZXR1cm4gbWF4SGVhcFNpemUvMTYzODQ7Y2FzZSAxMzI6Y2FzZSAxMzM6Y2FzZSAxMjpjYXNlIDEzNzpjYXNlIDEzODpjYXNlIDE1OmNhc2UgMjM1OmNhc2UgMTY6Y2FzZSAxNzpjYXNlIDE4OmNhc2UgMTk6Y2FzZSAyMDpjYXNlIDE0OTpjYXNlIDEzOmNhc2UgMTA6Y2FzZSAyMzY6Y2FzZSAxNTM6Y2FzZSA5OmNhc2UgMjE6Y2FzZSAyMjpjYXNlIDE1OTpjYXNlIDE1NDpjYXNlIDE0OmNhc2UgNzc6Y2FzZSA3ODpjYXNlIDEzOTpjYXNlIDgyOmNhc2UgNjg6Y2FzZSA2NzpjYXNlIDE2NDpjYXNlIDExOmNhc2UgMjk6Y2FzZSA0NzpjYXNlIDQ4OmNhc2UgOTU6Y2FzZSA1MjpjYXNlIDUxOmNhc2UgNDY6cmV0dXJuIDIwMDgwOTtjYXNlIDI3OmNhc2UgMjQ2OmNhc2UgMTI3OmNhc2UgMTI4OmNhc2UgMjM6Y2FzZSAyNDpjYXNlIDE2MDpjYXNlIDE2MTpjYXNlIDE4MTpjYXNlIDE4MjpjYXNlIDI0MjpjYXNlIDE4MzpjYXNlIDE4NDpjYXNlIDI0MzpjYXNlIDI0NDpjYXNlIDI0NTpjYXNlIDE2NTpjYXNlIDE3ODpjYXNlIDE3OTpjYXNlIDQ5OmNhc2UgNTA6Y2FzZSAxNjg6Y2FzZSAxNjk6Y2FzZSAxNzU6Y2FzZSAxNzA6Y2FzZSAxNzE6Y2FzZSAxNzI6Y2FzZSA5NzpjYXNlIDc2OmNhc2UgMzI6Y2FzZSAxNzM6Y2FzZSAzNTpjYXNlIDgwOmNhc2UgODE6Y2FzZSA3OTpyZXR1cm4tMTtjYXNlIDE3NjpjYXNlIDE3NzpjYXNlIDc6Y2FzZSAxNTU6Y2FzZSA4OmNhc2UgMTU3OmNhc2UgMTI1OmNhc2UgMTI2OmNhc2UgOTI6Y2FzZSA5MzpjYXNlIDEyOTpjYXNlIDEzMDpjYXNlIDEzMTpjYXNlIDk0OmNhc2UgOTE6cmV0dXJuIDE7Y2FzZSA3NDpjYXNlIDYwOmNhc2UgNjk6Y2FzZSA3MDpjYXNlIDQ6cmV0dXJuIDEwMjQ7Y2FzZSAzMTpjYXNlIDQyOmNhc2UgNzI6cmV0dXJuIDMyO2Nhc2UgODc6Y2FzZSAyNjpjYXNlIDMzOnJldHVybiAyMTQ3NDgzNjQ3O2Nhc2UgMzQ6Y2FzZSAxOnJldHVybiA0NzgzOTtjYXNlIDM4OmNhc2UgMzY6cmV0dXJuIDk5O2Nhc2UgNDM6Y2FzZSAzNzpyZXR1cm4gMjA0ODtjYXNlIDA6cmV0dXJuIDIwOTcxNTI7Y2FzZSAzOnJldHVybiA2NTUzNjtjYXNlIDI4OnJldHVybiAzMjc2ODtjYXNlIDQ0OnJldHVybiAzMjc2NztjYXNlIDc1OnJldHVybiAxNjM4NDtjYXNlIDM5OnJldHVybiAxZTM7Y2FzZSA4OTpyZXR1cm4gNzAwO2Nhc2UgNzE6cmV0dXJuIDI1NjtjYXNlIDQwOnJldHVybiAyNTU7Y2FzZSAyOnJldHVybiAxMDA7Y2FzZSAxODA6cmV0dXJuIDY0O2Nhc2UgMjU6cmV0dXJuIDIwO2Nhc2UgNTpyZXR1cm4gMTY7Y2FzZSA2OnJldHVybiA2O2Nhc2UgNzM6cmV0dXJuIDQ7Y2FzZSA4NDp7aWYodHlwZW9mIG5hdmlnYXRvcj09PSJvYmplY3QiKXJldHVybiBuYXZpZ2F0b3JbImhhcmR3YXJlQ29uY3VycmVuY3kiXXx8MTtyZXR1cm4gMX19c2V0RXJyTm8oMjgpO3JldHVybi0xfWZ1bmN0aW9uIF90aW1lKHB0cil7dmFyIHJldD1EYXRlLm5vdygpLzFlM3wwO2lmKHB0cil7SEVBUDMyW3B0cj4+Ml09cmV0fXJldHVybiByZXR9ZW1iaW5kX2luaXRfY2hhckNvZGVzKCk7QmluZGluZ0Vycm9yPU1vZHVsZVsiQmluZGluZ0Vycm9yIl09ZXh0ZW5kRXJyb3IoRXJyb3IsIkJpbmRpbmdFcnJvciIpO0ludGVybmFsRXJyb3I9TW9kdWxlWyJJbnRlcm5hbEVycm9yIl09ZXh0ZW5kRXJyb3IoRXJyb3IsIkludGVybmFsRXJyb3IiKTtpbml0X0NsYXNzSGFuZGxlKCk7aW5pdF9SZWdpc3RlcmVkUG9pbnRlcigpO2luaXRfZW1iaW5kKCk7VW5ib3VuZFR5cGVFcnJvcj1Nb2R1bGVbIlVuYm91bmRUeXBlRXJyb3IiXT1leHRlbmRFcnJvcihFcnJvciwiVW5ib3VuZFR5cGVFcnJvciIpO2luaXRfZW12YWwoKTtmdW5jdGlvbiBpbnRBcnJheUZyb21TdHJpbmcoc3RyaW5neSxkb250QWRkTnVsbCxsZW5ndGgpe3ZhciBsZW49bGVuZ3RoPjA/bGVuZ3RoOmxlbmd0aEJ5dGVzVVRGOChzdHJpbmd5KSsxO3ZhciB1OGFycmF5PW5ldyBBcnJheShsZW4pO3ZhciBudW1CeXRlc1dyaXR0ZW49c3RyaW5nVG9VVEY4QXJyYXkoc3RyaW5neSx1OGFycmF5LDAsdThhcnJheS5sZW5ndGgpO2lmKGRvbnRBZGROdWxsKXU4YXJyYXkubGVuZ3RoPW51bUJ5dGVzV3JpdHRlbjtyZXR1cm4gdThhcnJheX12YXIgYXNtTGlicmFyeUFyZz17ImQiOl9fX2N4YV9hbGxvY2F0ZV9leGNlcHRpb24sInIiOl9fX2N4YV9yZXRocm93LCJjIjpfX19jeGFfdGhyb3csIkUiOl9fX3N5c19mY250bDY0LCJDIjpfX19zeXNfZ2V0cGlkLCJVIjpfX19zeXNfaW9jdGwsIlYiOl9fX3N5c19vcGVuLCJYIjpfX2VtYmluZF9yZWdpc3Rlcl9ib29sLCJqIjpfX2VtYmluZF9yZWdpc3Rlcl9jbGFzcywiSyI6X19lbWJpbmRfcmVnaXN0ZXJfY2xhc3NfY2xhc3NfZnVuY3Rpb24sImciOl9fZW1iaW5kX3JlZ2lzdGVyX2NsYXNzX2NvbnN0cnVjdG9yLCJmIjpfX2VtYmluZF9yZWdpc3Rlcl9jbGFzc19mdW5jdGlvbiwiZSI6X19lbWJpbmRfcmVnaXN0ZXJfY2xhc3NfcHJvcGVydHksIlciOl9fZW1iaW5kX3JlZ2lzdGVyX2VtdmFsLCJtIjpfX2VtYmluZF9yZWdpc3Rlcl9lbnVtLCJiIjpfX2VtYmluZF9yZWdpc3Rlcl9lbnVtX3ZhbHVlLCJHIjpfX2VtYmluZF9yZWdpc3Rlcl9mbG9hdCwiaCI6X19lbWJpbmRfcmVnaXN0ZXJfZnVuY3Rpb24sIm4iOl9fZW1iaW5kX3JlZ2lzdGVyX2ludGVnZXIsImsiOl9fZW1iaW5kX3JlZ2lzdGVyX21lbW9yeV92aWV3LCJIIjpfX2VtYmluZF9yZWdpc3Rlcl9zdGRfc3RyaW5nLCJ1IjpfX2VtYmluZF9yZWdpc3Rlcl9zdGRfd3N0cmluZywiWSI6X19lbWJpbmRfcmVnaXN0ZXJfdm9pZCwieCI6X19lbXZhbF9hcywicCI6X19lbXZhbF9jYWxsX3ZvaWRfbWV0aG9kLCJpIjpfX2VtdmFsX2RlY3JlZiwicSI6X19lbXZhbF9nZXRfbWV0aG9kX2NhbGxlciwieSI6X19lbXZhbF9nZXRfcHJvcGVydHksImwiOl9fZW12YWxfaW5jcmVmLCJzIjpfX2VtdmFsX25ld19hcnJheSwieiI6X19lbXZhbF9uZXdfY3N0cmluZywidyI6X19lbXZhbF9ydW5fZGVzdHJ1Y3RvcnMsInQiOl9fZW12YWxfdGFrZV92YWx1ZSwiYSI6X2Fib3J0LCJCIjpfY2xvY2tfZ2V0dGltZSwiXyI6X2Rsb3BlbiwiWiI6X2Rsc3ltLCJNIjpfZW1zY3JpcHRlbl9tZW1jcHlfYmlnLCJOIjpfZW1zY3JpcHRlbl9yZXNpemVfaGVhcCwiTyI6X2Vtc2NyaXB0ZW5fdGhyZWFkX3NsZWVwLCJRIjpfZW52aXJvbl9nZXQsIlIiOl9lbnZpcm9uX3NpemVzX2dldCwiRiI6X2ZkX2Nsb3NlLCJTIjpfZmRfZmRzdGF0X2dldCwiVCI6X2ZkX3JlYWQsIkwiOl9mZF9zZWVrLCJEIjpfZmRfd3JpdGUsIiQiOl9nbXRpbWVfciwiYWEiOl9sb2NhbHRpbWVfciwidiI6X3B0aHJlYWRfY3JlYXRlLCJJIjpfcHRocmVhZF9qb2luLCJBIjpfc2V0VGVtcFJldDAsIlAiOl9zdHJmdGltZV9sLCJvIjpfc3lzY29uZiwiSiI6X3RpbWV9O3ZhciBhc209Y3JlYXRlV2FzbSgpO3ZhciBfX193YXNtX2NhbGxfY3RvcnM9TW9kdWxlWyJfX193YXNtX2NhbGxfY3RvcnMiXT1hc21bImNhIl07dmFyIF9tYWxsb2M9TW9kdWxlWyJfbWFsbG9jIl09YXNtWyJkYSJdO3ZhciBfX19lcnJub19sb2NhdGlvbj1Nb2R1bGVbIl9fX2Vycm5vX2xvY2F0aW9uIl09YXNtWyJmYSJdO3ZhciBfZnJlZT1Nb2R1bGVbIl9mcmVlIl09YXNtWyJnYSJdO3ZhciBfX19nZXRUeXBlTmFtZT1Nb2R1bGVbIl9fX2dldFR5cGVOYW1lIl09YXNtWyJoYSJdO3ZhciBfX19lbWJpbmRfcmVnaXN0ZXJfbmF0aXZlX2FuZF9idWlsdGluX3R5cGVzPU1vZHVsZVsiX19fZW1iaW5kX3JlZ2lzdGVyX25hdGl2ZV9hbmRfYnVpbHRpbl90eXBlcyJdPWFzbVsiaWEiXTt2YXIgX19nZXRfdHpuYW1lPU1vZHVsZVsiX19nZXRfdHpuYW1lIl09YXNtWyJqYSJdO3ZhciBfX2dldF9kYXlsaWdodD1Nb2R1bGVbIl9fZ2V0X2RheWxpZ2h0Il09YXNtWyJrYSJdO3ZhciBfX2dldF90aW1lem9uZT1Nb2R1bGVbIl9fZ2V0X3RpbWV6b25lIl09YXNtWyJsYSJdO3ZhciBkeW5DYWxsX3ZpaWppaT1Nb2R1bGVbImR5bkNhbGxfdmlpamlpIl09YXNtWyJtYSJdO3ZhciBkeW5DYWxsX2pqaj1Nb2R1bGVbImR5bkNhbGxfampqIl09YXNtWyJuYSJdO3ZhciBkeW5DYWxsX2ppamk9TW9kdWxlWyJkeW5DYWxsX2ppamkiXT1hc21bIm9hIl07dmFyIGR5bkNhbGxfaWlpaWlqPU1vZHVsZVsiZHluQ2FsbF9paWlpaWoiXT1hc21bInBhIl07dmFyIGR5bkNhbGxfaWlpaWlqaj1Nb2R1bGVbImR5bkNhbGxfaWlpaWlqaiJdPWFzbVsicWEiXTt2YXIgZHluQ2FsbF9paWlpaWlqaj1Nb2R1bGVbImR5bkNhbGxfaWlpaWlpamoiXT1hc21bInJhIl07dmFyIGNhbGxlZFJ1bjtkZXBlbmRlbmNpZXNGdWxmaWxsZWQ9ZnVuY3Rpb24gcnVuQ2FsbGVyKCl7aWYoIWNhbGxlZFJ1bilydW4oKTtpZighY2FsbGVkUnVuKWRlcGVuZGVuY2llc0Z1bGZpbGxlZD1ydW5DYWxsZXJ9O2Z1bmN0aW9uIHJ1bihhcmdzKXthcmdzPWFyZ3N8fGFyZ3VtZW50c187aWYocnVuRGVwZW5kZW5jaWVzPjApe3JldHVybn1wcmVSdW4oKTtpZihydW5EZXBlbmRlbmNpZXM+MCl7cmV0dXJufWZ1bmN0aW9uIGRvUnVuKCl7aWYoY2FsbGVkUnVuKXJldHVybjtjYWxsZWRSdW49dHJ1ZTtNb2R1bGVbImNhbGxlZFJ1biJdPXRydWU7aWYoQUJPUlQpcmV0dXJuO2luaXRSdW50aW1lKCk7cHJlTWFpbigpO3JlYWR5UHJvbWlzZVJlc29sdmUoTW9kdWxlKTtpZihNb2R1bGVbIm9uUnVudGltZUluaXRpYWxpemVkIl0pTW9kdWxlWyJvblJ1bnRpbWVJbml0aWFsaXplZCJdKCk7cG9zdFJ1bigpfWlmKE1vZHVsZVsic2V0U3RhdHVzIl0pe01vZHVsZVsic2V0U3RhdHVzIl0oIlJ1bm5pbmcuLi4iKTtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7c2V0VGltZW91dChmdW5jdGlvbigpe01vZHVsZVsic2V0U3RhdHVzIl0oIiIpfSwxKTtkb1J1bigpfSwxKX1lbHNle2RvUnVuKCl9fU1vZHVsZVsicnVuIl09cnVuO2lmKE1vZHVsZVsicHJlSW5pdCJdKXtpZih0eXBlb2YgTW9kdWxlWyJwcmVJbml0Il09PSJmdW5jdGlvbiIpTW9kdWxlWyJwcmVJbml0Il09W01vZHVsZVsicHJlSW5pdCJdXTt3aGlsZShNb2R1bGVbInByZUluaXQiXS5sZW5ndGg+MCl7TW9kdWxlWyJwcmVJbml0Il0ucG9wKCkoKX19cnVuKCk7CgoKICByZXR1cm4gTW9kdWxlCn0KKTsKfSkoKTsKLyogaGFybW9ueSBkZWZhdWx0IGV4cG9ydCAqLyBjb25zdCBGUGhpX1dvcmtlcl9SdW50aW1lID0gKE1vZHVsZSk7CjsvLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuLi9idWlsZC90ZW1wL2VuZ2luZXMvRlBoaS5FbmdpbmUuQ29uc3QuanMKY29uc3QgRXh0cmFjdGlvblJlc3VsdCA9IHsKICAgIE9LOiAwLAogICAgTk9UX0VWQUxVQVRFRDogMSwgICAgCiAgICBCQURfQU5HTEU6IDIsICAgIAogICAgVE9PX0ZBUjogMywgICAgCiAgICBUT09fQ0xPU0U6IDQsICAgIAogICAgT1VUX09GX0JPVU5EUzogNSwgICAgIAogICAgQkFEX0FTUEVDVF9SQVRJTzogNiwgICAgCiAgICBET0NVTUVOVF9OT1RfRk9VTkQ6IDcsICAgIAogICAgRkFDRV9OT1RfRk9VTkQ6IDgsICAgIAogICAgTVJaX05PVF9GT1VORDogOSwKICAgIEFUVFJJQlVURVNfTk9UX0ZPVU5EOiAxMCwKICAgIFVOREVSRVhQT1NFRDogMTEsIAogICAgT1ZFUkVYUE9TRUQ6IDEyLCAKICAgIEJMVVJSRUQ6IDEzLCAKICAgIElOU1VGRklDSUVOVF9TQU1QTEVTOiAxNCwgCiAgICBJTlNVRkZJQ0lFTlRfVElNRTogMTUsCiAgICBUT09fREVMQVlFRDogMTYsIAogICAgVE9PX01PVkVNRU5UOiAxNywgCiAgICBGUkVFWkVEX0RPQ1VNRU5UOiAxOCwgCiAgICBUT09fTVVDSF9ST0xMOiAxOSwgCiAgICBUT09fU01BTEw6IDIwIAp9Cgpjb25zdCBFeHRyYWN0aW9uUmVzdWx0U3RyID0gewogICAgMDogIk9LIiwKICAgIDE6ICJOT1RfRVZBTFVBVEVEIiwgICAgCiAgICAyOiAiQkFEX0FOR0xFIiwgICAgCiAgICAzOiAiVE9PX0ZBUiIsICAgIAogICAgNDogIlRPT19DTE9TRSIsICAgIAogICAgNTogIk9VVF9PRl9CT1VORFMiLCAgICAgCiAgICA2OiAiQkFEX0FTUEVDVF9SQVRJTyIsICAgIAogICAgNzogIkRPQ1VNRU5UX05PVF9GT1VORCIsICAgIAogICAgODogIkZBQ0VfTk9UX0ZPVU5EIiwgICAgCiAgICA5OiAiTVJaX05PVF9GT1VORCIsCiAgICAxMDogIkFUVFJJQlVURVNfTk9UX0ZPVU5EIiwKICAgIDExOiAiVU5ERVJFWFBPU0VEIiwgCiAgICAxMjogIk9WRVJFWFBPU0VEIiwgCiAgICAxMzogIkJMVVJSRUQiLCAKICAgIDE0OiAiSU5TVUZGSUNJRU5UX1NBTVBMRVMiLCAKICAgIDE1OiAiSU5TVUZGSUNJRU5UX1RJTUUiLAogICAgMTY6ICJUT09fREVMQVlFRCIsIAogICAgMTc6ICJUT09fTU9WRU1FTlQiLCAKICAgIDE4OiAiRlJFRVpFRF9ET0NVTUVOVCIsIAogICAgMTk6ICJUT09fTVVDSF9ST0xMIiwgCiAgICAyMDogIlRPT19TTUFMTCIgCn0KOy8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4uL2J1aWxkL3RlbXAvZW5naW5lcy9mYWNlcGhpL3dvcmtlci9GUGhpLldvcmtlci5FdmVudHMuanMKCgoKCgovKioKICogR2xvYmFsIGluc3RhbmNlcwogKi8KdmFyIGluc3RhbmNlID0gbnVsbDsKdmFyIG9jckVuZ2luZSA9IG51bGw7CnZhciBmYWNlTXJ6RW5naW5lID0gbnVsbDsKdmFyIGRvY3VtZW50RW5naW5lID0gbnVsbDsKdmFyIGRvY3VtZW50Q2FwdHVyZSA9IG51bGw7CgovKioKICogRXh0cmFjdG9yIE1vZGVscwogKi8KdmFyIGRvY3VtZW50TW9kZWwgPSBudWxsOwp2YXIgZmFjZU1vZGVsID0gbnVsbDsKdmFyIG1yek1vZGVsID0gbnVsbDsKdmFyIG9jck1vZGVsID0gbnVsbDsKCi8qKgogKiBXb3JrZXIgY29uZmlndXJhdGlvbgogKi8KdmFyIGJ1bmRsZVBhdGggPSAiIjsKdmFyIGxhc3REZXRlY3RUaW1lc3RhbXAgPSAtMTsKCi8qKgogKiBFdmVudCB0byBpbml0aWFsaXplIGFsbCByZXF1aXJlZCBjb21wb25lbnRzIGZvciB0aGUgZXh0cmFjdGlvbi4KICoKICogQHBhcmFtIHthcnJheX0gbWVzc2FnZQogKi8KY29uc3QgcHJlbG9hZEluaXRFeHRyYWN0b3IgPSBhc3luYyAobWVzc2FnZSkgPT4gewogICAgZGVidWdNZXNzYWdlKCJbV29ya2VyXTogUmVjZWl2ZWQgbWVzc2FnZSBpbiAiICsgInByZUluaXQiICsgIiBldmVudCIpOwoKICAgIC8vIFByb2Nlc3MgaW5wdXQgdmFyaWFibGVzCiAgICBidW5kbGVQYXRoID0gbWVzc2FnZS5idW5kbGVQYXRoOwoKICAgIHRyeSB7CiAgICAgICAgbGV0IHdhc21pbnN0YW5jZSA9IG51bGw7CiAgICAgICAgbGV0IGRvd25sb2FkQnVmZiA9IG51bGw7CgogICAgICAgIC8vIEFzeW5jIGZldGNoZXMgYmVmb3JlIGdldCB0aGUgbW9kZWxzIGluc3RhbmNlCiAgICAgICAgZG93bmxvYWRCdWZmID0gYXdhaXQgZmV0Y2goYnVuZGxlUGF0aCArICcvbW9kZWxzL2ZhY2VwaGlfaWRfY2FyZHNfY29ybmVyX2RldGVjdG9yXzFfMl9tb2RlbC5kYXQnKTsKICAgICAgICBkb2N1bWVudE1vZGVsID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGF3YWl0IGRvd25sb2FkQnVmZi5hcnJheUJ1ZmZlcigpKTsKCiAgICAgICAgZG93bmxvYWRCdWZmID0gYXdhaXQgZmV0Y2goYnVuZGxlUGF0aCArICcvbW9kZWxzL2ZhY2VwaGlfZmFjZV9kZXRlY3Rvcl8xXzBfbW9kZWwuZGF0Jyk7CiAgICAgICAgZmFjZU1vZGVsID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGF3YWl0IGRvd25sb2FkQnVmZi5hcnJheUJ1ZmZlcigpKTsKCiAgICAgICAgZG93bmxvYWRCdWZmID0gYXdhaXQgZmV0Y2goYnVuZGxlUGF0aCArICcvbW9kZWxzL2ZhY2VwaGlfbXJ6X2RldGVjdG9yXzFfMF9tb2RlbC5kYXQnKTsKICAgICAgICBtcnpNb2RlbCA9IG5ldyBVaW50OENsYW1wZWRBcnJheShhd2FpdCBkb3dubG9hZEJ1ZmYuYXJyYXlCdWZmZXIoKSk7CgogICAgICAgIGRvd25sb2FkQnVmZiA9IGF3YWl0IGZldGNoKGJ1bmRsZVBhdGggKyAnL21vZGVscy9mYWNlcGhpX29jcl9tcnpfMV8wX21vZGVsLmRhdCcpOwogICAgICAgIG9jck1vZGVsID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGF3YWl0IGRvd25sb2FkQnVmZi5hcnJheUJ1ZmZlcigpKTsKCiAgICAgICAgLy8gQXN5bmMgZmV0Y2ggYmVmb3JlIGdldCB0aGUgaW5zdGFuY2UKICAgICAgICBkb3dubG9hZEJ1ZmYgPSBhd2FpdCBmZXRjaChidW5kbGVQYXRoICsgIi9GUEJSZWNvZ25pdGlvbi53YXNtIik7CiAgICAgICAgd2FzbWluc3RhbmNlID0gYXdhaXQgZG93bmxvYWRCdWZmLmFycmF5QnVmZmVyKCk7CgogICAgICAgIC8vIEluaXRpYWxpemUgdGhlIGluc3RhbmNlIGluIGdsb2JhbHMgaW5zdGFuY2UKICAgICAgICBpbnN0YW5jZSA9IGF3YWl0IEZQaGlfV29ya2VyX1J1bnRpbWUoewogICAgICAgICAgICB3YXNtQmluYXJ5IDogd2FzbWluc3RhbmNlLAogICAgICAgICAgICBvblJ1bnRpbWVJbml0aWFsaXplZCA6ICgpID0+IHNlbGYucG9zdE1lc3NhZ2UoeyBjbWQ6ICJyZWFkeSIgfSkKICAgICAgICB9KQoKICAgICAgICAvLyBSZXBvcnQgdGhlIHN1Y2Nlc3NmdWwgbG9hZCBvZiBpbnN0YW5jZSB0byBkZWJ1ZyBtZXNzYWdlCiAgICAgICAgZGVidWdNZXNzYWdlKCJbV29ya2VyXTogUHJlbG9hZGluZyB3YXNtIGluc3RhbmNlIGZyb20gcGF0aDogIiArIGJ1bmRsZVBhdGggKyAiL0ZQQlJlY29nbml0aW9uLndhc20iKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAvLyBDcml0aWNhbCBlcnJvciBoYXMgb2NjdXJyZWQgaW4gdGhlIFdvcmtlciBTaWRlLCBzZW5kaW5nIHRvIG1haW4gdGhyZWFkCiAgICAgICAgZXJyb3JNZXNzYWdlKCJbV29ya2VyXTogIiArIGUpOwogICAgfQp9CgovKioKICogRXZlbnQgdG8gaW5pdGlhbGl6ZSBhbGwgcmVxdWlyZWQgZW5naW5lcyBmb3IgdGhlIGV4dHJhY3Rpb24uCiAqLwpjb25zdCBpbml0aWFsaXplRXh0cmFjdG9yID0gYXN5bmMgKCkgPT4gewogICAgLy8gUHJlcGFyZSB0aGUgZGlhZ25vc3RpY0NvZGUgaW5zdGFuY2UKICAgIGxldCBkaWFnbm9zdGljQ29kZSA9IC0xOwoKICAgIC8vIFJlY292ZXIgdGhlIHJlZmVyZW5jZSB0byBlcnJvciBjb2RlIGZ1bmN0aW9ucwogICAgY29uc3QgZXJyb3JDb2RlID0gaW5zdGFuY2UuZ2V0TWVzc2FnZUVycm9yQ29kZURvY3VtZW50OwoKICAgIHRyeSB7CiAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgZW5naW5lcwogICAgICAgIG9jckVuZ2luZSA9IG5ldyBpbnN0YW5jZS5SZWNvZ25pemVyT0NSRW5naW5lKCk7CiAgICAgICAgZG9jdW1lbnRDYXB0dXJlID0gbmV3IGluc3RhbmNlLkRvY3VtZW50Q2FwdHVyZUVuZ2luZSgpOwogICAgICAgIGZhY2VNcnpFbmdpbmUgPSBuZXcgaW5zdGFuY2UuUmVjb2duaXplckZhY2VNcnpFbmdpbmUoKTsKCiAgICAgICAgLy8gQ2hlY2sgaWYgaXMgbG9hYmxlIHRoZSBtb2RlbHMgYW5kIGxvYWQgaXQKICAgICAgICBpZigoZGlhZ25vc3RpY0NvZGUgPSBlcnJvckNvZGUoZG9jdW1lbnRDYXB0dXJlLmxvYWREb2N1bWVudERhdGFGcm9tQnVmZmVyKGRvY3VtZW50TW9kZWwpKSkgIT09ICJPSyIpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJFcnJvciBsb2FkaW5nIHRoZSBtb2RlbCAnRG9jdW1lbnRDYXB0dXJlJywgIiwgZGlhZ25vc3RpY0NvZGUpOwogICAgICAgIH0gZWxzZSBpZigoZGlhZ25vc3RpY0NvZGUgPSBlcnJvckNvZGUoZmFjZU1yekVuZ2luZS5sb2FkTXJ6RGF0YUZyb21CdWZmZXIobXJ6TW9kZWwpKSkgIT09ICJPSyIpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJFcnJvciBsb2FkaW5nIHRoZSBtb2RlbCAnTXJ6TW9kZWwnLCAiLCBkaWFnbm9zdGljQ29kZSk7CiAgICAgICAgfSBlbHNlIGlmKChkaWFnbm9zdGljQ29kZSA9IGVycm9yQ29kZShmYWNlTXJ6RW5naW5lLmxvYWRGYWNlRGF0YUZyb21CdWZmZXIoZmFjZU1vZGVsKSkpICE9PSAiT0siKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiRXJyb3IgbG9hZGluZyB0aGUgbW9kZWwgJ0ZhY2VNb2RlbCcsICIsIGRpYWdub3N0aWNDb2RlKTsKICAgICAgICB9IGVsc2UgaWYoKGRpYWdub3N0aWNDb2RlID0gZXJyb3JDb2RlKG9jckVuZ2luZS5sb2FkT2NyRGF0YUZyb21CdWZmZXIob2NyTW9kZWwpKSkgIT09ICJPSyIpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJFcnJvciBsb2FkaW5nIHRoZSBtb2RlbCAnT2NyTW9kZWwnLCAiLCBkaWFnbm9zdGljQ29kZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gTG9hZCB0aGUgcmVzdCBvZiB1c2VkIG1vZGVscyBvZiBmYWNlIGVuZ2luZS4KICAgICAgICAgICAgZmFjZU1yekVuZ2luZS5sb2FkRG9jdW1lbnREYXRhRnJvbUJ1ZmZlcihkb2N1bWVudE1vZGVsKTsKCiAgICAgICAgICAgIC8vIExvYWQgdGhlIHJlc3Qgb2YgdXNlZCBtb2RlbHMgb2Ygb2NyIGVuZ2luZS4KICAgICAgICAgICAgb2NyRW5naW5lLmxvYWREb2N1bWVudERhdGFGcm9tQnVmZmVyKGRvY3VtZW50TW9kZWwpOwogICAgICAgICAgICBvY3JFbmdpbmUubG9hZE1yekRhdGFGcm9tQnVmZmVyKG1yek1vZGVsKTsKCiAgICAgICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoeyBjbWQ6ICJpbml0IiB9KTsKICAgICAgICB9CiAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgLy8gQ3JpdGljYWwgZXJyb3IgaGFzIG9jY3VycmVkIGluIHRoZSBXb3JrZXIgU2lkZSwgc2VuZGluZyB0byBtYWluIHRocmVhZAogICAgICAgIGVycm9yTWVzc2FnZSgiW1dvcmtlcl06ICIgKyBlKTsKICAgIH0KfQoKLyoqCiAqIEV2ZW50IHRvIGRldGVjdCB0aGUgZG9jdW1lbnQgYW5kIGV4dHJhY3QgZGF0YQogKgogKiBAcGFyYW0ge2FycmF5fSBtZXNzYWdlCiAqLwpjb25zdCBkZXRlY3QgPSBhc3luYyAobWVzc2FnZSkgPT4gewogICAgbGV0IHBvc3REYXRhID0geyBjbWQ6ICJkZXRlY3QiLCByZXN1bHQ6IHt9IH07CgogICAgLy8gTWVhc3VyZSB0aGUgdGltZSBiZXR3ZWVuIGRldGVjdGlvbnMKICAgIHBvc3REYXRhLm1wcyA9IE1hdGgucm91bmQoKDEgLyBkaWZmVGltZShsYXN0RGV0ZWN0VGltZXN0YW1wKSkgKiAxMDApIC8gMTAwOwoKICAgIC8vIFJlZnJlc2ggdGhlIHRpbWVzdGFtcAogICAgbGFzdERldGVjdFRpbWVzdGFtcCA9IERhdGUubm93KCk7CgogICAgbGV0IGVycm9yVGlsdCA9IDE7CgogICAgbGV0IGltYWdlUGFyYW0gPSBtZXNzYWdlLmltYWdlOwogICAgbGV0IGltYWdlRGF0YVBhcmFtID0gbmV3IEltYWdlRGF0YShtZXNzYWdlLmltYWdlLCBtZXNzYWdlLndpZHRoLCBtZXNzYWdlLmhlaWdodCk7CiAgICBsZXQgYWNjZXNzaWJpbGl0eVBhcmFtID0gbWVzc2FnZS5hY2Nlc3NpYmlsaXR5OwogICAgbGV0IHRlc3RpbmdUaW1lc3RhbXAgPSBtZXNzYWdlLnRpbWVzdGFtcCB8fCAtMTsKCiAgICBsZXQgcmVzdWx0T2NyID0gbnVsbDsKICAgIGxldCByZXN1bHRGYWNlTXJ6ID0gbnVsbDsKICAgIGxldCByZXN1bHREb2N1bWVudCA9IG51bGw7CiAgICBsZXQgc2l6ZU9iaiA9IG51bGw7CiAgICBsZXQgaW1hZ2VPYmogPSBudWxsOwogICAgbGV0IG9wdGlvbnMgPSBudWxsOwoKICAgIGxldCBmYWNlSW1hZ2UgPSBudWxsOwogICAgbGV0IGRvY3VtZW50SW1hZ2UgPSBudWxsOwoKICAgIHRyeSB7CiAgICAgICAgc2l6ZU9iaiA9IG5ldyBpbnN0YW5jZS5TaXplKG1lc3NhZ2Uud2lkdGgsIG1lc3NhZ2UuaGVpZ2h0KTsKICAgICAgICBpbWFnZU9iaiA9IG5ldyBpbnN0YW5jZS5JbWFnZShpbWFnZVBhcmFtLCBzaXplT2JqLCBpbnN0YW5jZS5PcmllbnRhdGlvbi5GQUNFX1VQLCBpbnN0YW5jZS5JbWFnZUZvcm1hdC5SR0JBKTsKICAgICAgICBvcHRpb25zID0gbmV3IGluc3RhbmNlLlJlY29nbml6ZXJPcHRpb25zKCk7CiAgICAgICAgc2l6ZU9iai5kZWxldGUoKTsKCiAgICAgICAgaWYgKHRlc3RpbmdUaW1lc3RhbXAgPiAwKSB7CiAgICAgICAgICAgIGltYWdlT2JqLnNldFRpbWVzdGFtcCh0ZXN0aW5nVGltZXN0YW1wLnRvU3RyaW5nKCkpOwogICAgICAgIH0KCiAgICAgICAgcmVzdWx0RG9jdW1lbnQgPSBkb2N1bWVudENhcHR1cmUucmVjb2duaXplRnJvbUltYWdlKGltYWdlT2JqKQoKICAgICAgICBpZihyZXN1bHREb2N1bWVudC5kaXFhUmVzdWx0ICE9PSB1bmRlZmluZWQgJiYgcmVzdWx0RG9jdW1lbnQuZGlxYVJlc3VsdC5kaWFnbm9zdGljLnZhbHVlICE9PSAxKXsKICAgICAgICAgICAgcG9zdERhdGEucmVzdWx0WyJkaXFhUmVzdWx0Il0gPSB7CiAgICAgICAgICAgICAgICBibHVyIDogcmVzdWx0RG9jdW1lbnQuZGlxYVJlc3VsdC5ibHVyLAogICAgICAgICAgICAgICAgZXhwb3N1cmUgOiByZXN1bHREb2N1bWVudC5kaXFhUmVzdWx0LmV4cG9zdXJlLAogICAgICAgICAgICAgICAgZXhwb3N1cmVNZWRpYW4gOiByZXN1bHREb2N1bWVudC5kaXFhUmVzdWx0LmV4cG9zdXJlTWVkaWFuLAogICAgICAgICAgICAgICAgZGlhZ25vc3RpYyA6IHJlc3VsdERvY3VtZW50LmRpcWFSZXN1bHQuZGlhZ25vc3RpYy52YWx1ZQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZihyZXN1bHREb2N1bWVudC5zaGFwZUZpbHRlckRpYWdub3N0aWMgIT09IHVuZGVmaW5lZCAmJiByZXN1bHREb2N1bWVudC5zaGFwZUZpbHRlckRpYWdub3N0aWMudmFsdWUgIT09IDEpewogICAgICAgICAgICBwb3N0RGF0YS5yZXN1bHRbInNoYXBlRmlsdGVyRGlhZ25vc3RpYyJdID0gewogICAgICAgICAgICAgICAgZGlhZ25vc3RpYyA6IHJlc3VsdERvY3VtZW50LnNoYXBlRmlsdGVyRGlhZ25vc3RpYy52YWx1ZQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAocmVzdWx0RG9jdW1lbnQuZXJyb3IgPT09IGluc3RhbmNlLkRvY3VtZW50RXJyb3JDb2RlLk9LICYmIHJlc3VsdERvY3VtZW50LmRpYWdub3N0aWMgPT09IGluc3RhbmNlLkRvY3VtZW50RGlhZ25vc3RpYy5PSyApewogICAgICAgICAgICAvLyBQcmVwYXJlIGV4dHJhY3Rpb24gb3B0aW9ucwogICAgICAgICAgICBvcHRpb25zLmdlbmVyYXRlSW1hZ2UgPSB0cnVlOwoKICAgICAgICAgICAgLy8gU2V0IHRoZSBkb2N1bWVudExvY2F0aW9uIG9iamVjdAogICAgICAgICAgICBwb3N0RGF0YS5yZXN1bHRbImRvY3VtZW50TG9jYXRpb24iXSA9IHsKICAgICAgICAgICAgICAgIHRvcFJpZ2h0OiB7CiAgICAgICAgICAgICAgICAgICAgeDogcmVzdWx0RG9jdW1lbnQuZG9jdW1lbnRMb2NhdGlvbi50b3BSaWdodC54LAogICAgICAgICAgICAgICAgICAgIHk6IHJlc3VsdERvY3VtZW50LmRvY3VtZW50TG9jYXRpb24udG9wUmlnaHQueQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHRvcExlZnQ6IHsKICAgICAgICAgICAgICAgICAgICB4OiByZXN1bHREb2N1bWVudC5kb2N1bWVudExvY2F0aW9uLnRvcExlZnQueCwKICAgICAgICAgICAgICAgICAgICB5OiByZXN1bHREb2N1bWVudC5kb2N1bWVudExvY2F0aW9uLnRvcExlZnQueQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGJvdHRvbVJpZ2h0OiB7CiAgICAgICAgICAgICAgICAgICAgeDogcmVzdWx0RG9jdW1lbnQuZG9jdW1lbnRMb2NhdGlvbi5ib3R0b21SaWdodC54LAogICAgICAgICAgICAgICAgICAgIHk6IHJlc3VsdERvY3VtZW50LmRvY3VtZW50TG9jYXRpb24uYm90dG9tUmlnaHQueQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGJvdHRvbUxlZnQ6IHsKICAgICAgICAgICAgICAgICAgICB4OiByZXN1bHREb2N1bWVudC5kb2N1bWVudExvY2F0aW9uLmJvdHRvbUxlZnQueCwKICAgICAgICAgICAgICAgICAgICB5OiByZXN1bHREb2N1bWVudC5kb2N1bWVudExvY2F0aW9uLmJvdHRvbUxlZnQueQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBsZXQgYmVzdEltYWdlID0gcmVzdWx0RG9jdW1lbnQuYmVzdEltYWdlOwoKICAgICAgICAgICAgLy8gUHJvY2VzcyBkb2N1bWVudCBleHRyYWN0aW9uCiAgICAgICAgICAgIGRvY3VtZW50SW1hZ2UgPSBpbnN0YW5jZS5jcm9wSW1hZ2VXaXRoTG9jYXRpb24oYmVzdEltYWdlLCByZXN1bHREb2N1bWVudC5kb2N1bWVudExvY2F0aW9uKTsKCiAgICAgICAgICAgIC8vUmVzZXQgRG9jdW1lbnRDYXB0dXJlRW5naW5lCiAgICAgICAgICAgIGRvY3VtZW50Q2FwdHVyZS5yZXNldCgpOwoKICAgICAgICAgICAgLy8gU2V0IHRoZSBkb2N1bWVudEltYWdlIG9iamVjdAogICAgICAgICAgICBwb3N0RGF0YS5yZXN1bHRbImRvY3VtZW50SW1hZ2UiXSA9IHsKICAgICAgICAgICAgICAgIGJ1ZmZlcjogbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGRvY3VtZW50SW1hZ2UuaW1hZ2VUb1JnYmEoKSksCiAgICAgICAgICAgICAgICB3aWR0aDogZG9jdW1lbnRJbWFnZS53aWR0aCgpLAogICAgICAgICAgICAgICAgaGVpZ2h0OiBkb2N1bWVudEltYWdlLmhlaWdodCgpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGRvY3VtZW50SW1hZ2UuZGVsZXRlKCk7CgogICAgICAgICAgICAvLyBHZXQgZGF0YSBmcm9tIEZhY2VNcnpFbmdpbmUKICAgICAgICAgICAgcmVzdWx0RmFjZU1yeiA9IGZhY2VNcnpFbmdpbmUucmVjb2duaXplRnJvbUltYWdlKGJlc3RJbWFnZSwgb3B0aW9ucyk7CgogICAgICAgICAgICBwb3N0RGF0YS5yZXN1bHRbImZhY2VEZXRlY3QiXSA9IHJlc3VsdEZhY2VNcnouZmFjZUxvY2F0aW9uLmlzVmFsaWQoKTsKICAgICAgICAgICAgcG9zdERhdGEucmVzdWx0WyJtcnpEZXRlY3QiXSA9IHJlc3VsdEZhY2VNcnoubXJ6TG9jYXRpb24uaXNWYWxpZCgpOwoKICAgICAgICAgICAgLy8gUHJvY2VzcyBGYWNlIExvY2F0aW9uCiAgICAgICAgICAgIGlmIChyZXN1bHRGYWNlTXJ6LmZhY2VMb2NhdGlvbi5pc1ZhbGlkKCkpIHsKICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgZmFjZUxvY2F0aW9uIG9iamVjdAogICAgICAgICAgICAgICAgcG9zdERhdGEucmVzdWx0WyJmYWNlTG9jYXRpb24iXSA9IHsKICAgICAgICAgICAgICAgICAgICB0b3BSaWdodDogewogICAgICAgICAgICAgICAgICAgICAgICB4OiByZXN1bHRGYWNlTXJ6LmZhY2VMb2NhdGlvbi50b3BSaWdodC54LAogICAgICAgICAgICAgICAgICAgICAgICB5OiByZXN1bHRGYWNlTXJ6LmZhY2VMb2NhdGlvbi50b3BSaWdodC55CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB0b3BMZWZ0OiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHJlc3VsdEZhY2VNcnouZmFjZUxvY2F0aW9uLnRvcExlZnQueCwKICAgICAgICAgICAgICAgICAgICAgICAgeTogcmVzdWx0RmFjZU1yei5mYWNlTG9jYXRpb24udG9wTGVmdC55CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBib3R0b21SaWdodDogewogICAgICAgICAgICAgICAgICAgICAgICB4OiByZXN1bHRGYWNlTXJ6LmZhY2VMb2NhdGlvbi5ib3R0b21SaWdodC54LAogICAgICAgICAgICAgICAgICAgICAgICB5OiByZXN1bHRGYWNlTXJ6LmZhY2VMb2NhdGlvbi5ib3R0b21SaWdodC55CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBib3R0b21MZWZ0OiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHJlc3VsdEZhY2VNcnouZmFjZUxvY2F0aW9uLmJvdHRvbUxlZnQueCwKICAgICAgICAgICAgICAgICAgICAgICAgeTogcmVzdWx0RmFjZU1yei5mYWNlTG9jYXRpb24uYm90dG9tTGVmdC55CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIGRvY3VtZW50IGV4dHJhY3Rpb24KICAgICAgICAgICAgICAgIGZhY2VJbWFnZSA9IGluc3RhbmNlLmNyb3BJbWFnZVdpdGhMb2NhdGlvbihiZXN0SW1hZ2UsIHJlc3VsdEZhY2VNcnouZmFjZUxvY2F0aW9uKTsKCiAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIGZhY2VJbWFnZSBvYmplY3QKICAgICAgICAgICAgICAgIHBvc3REYXRhLnJlc3VsdFsiZmFjZUltYWdlIl0gPSB7CiAgICAgICAgICAgICAgICAgICAgYnVmZmVyOiBuZXcgVWludDhDbGFtcGVkQXJyYXkoZmFjZUltYWdlLmltYWdlVG9SZ2JhKCkpLAogICAgICAgICAgICAgICAgICAgIHdpZHRoOiBmYWNlSW1hZ2Uud2lkdGgoKSwKICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGZhY2VJbWFnZS5oZWlnaHQoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBmYWNlSW1hZ2UuZGVsZXRlKCk7CgogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcG9zdERhdGFbImRpYWdub3N0aWMiXSA9IEV4dHJhY3Rpb25SZXN1bHQuRkFDRV9OT1RfRk9VTkQ7CiAgICAgICAgICAgICAgICBwb3N0RGF0YS5yZXN1bHRbImRpYWdub3N0aWMiXSA9IEV4dHJhY3Rpb25SZXN1bHQuRkFDRV9OT1RfRk9VTkQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChyZXN1bHRGYWNlTXJ6Lm1yekxvY2F0aW9uLmlzVmFsaWQoKSkgewogICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBtcnpMb2NhdGlvbiBvYmplY3QKICAgICAgICAgICAgICAgIHBvc3REYXRhLnJlc3VsdFsibXJ6TG9jYXRpb24iXSA9IHsKICAgICAgICAgICAgICAgICAgICB0b3BSaWdodDogewogICAgICAgICAgICAgICAgICAgICAgICB4OiByZXN1bHRGYWNlTXJ6Lm1yekxvY2F0aW9uLnRvcFJpZ2h0LngsCiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHJlc3VsdEZhY2VNcnoubXJ6TG9jYXRpb24udG9wUmlnaHQueQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgdG9wTGVmdDogewogICAgICAgICAgICAgICAgICAgICAgICB4OiByZXN1bHRGYWNlTXJ6Lm1yekxvY2F0aW9uLnRvcExlZnQueCwKICAgICAgICAgICAgICAgICAgICAgICAgeTogcmVzdWx0RmFjZU1yei5tcnpMb2NhdGlvbi50b3BMZWZ0LnkKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGJvdHRvbVJpZ2h0OiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHJlc3VsdEZhY2VNcnoubXJ6TG9jYXRpb24uYm90dG9tUmlnaHQueCwKICAgICAgICAgICAgICAgICAgICAgICAgeTogcmVzdWx0RmFjZU1yei5tcnpMb2NhdGlvbi5ib3R0b21SaWdodC55CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBib3R0b21MZWZ0OiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHJlc3VsdEZhY2VNcnoubXJ6TG9jYXRpb24uYm90dG9tTGVmdC54LAogICAgICAgICAgICAgICAgICAgICAgICB5OiByZXN1bHRGYWNlTXJ6Lm1yekxvY2F0aW9uLmJvdHRvbUxlZnQueQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIE9DUiBEYXRhCiAgICAgICAgICAgICAgICByZXN1bHRPY3IgPSBvY3JFbmdpbmUucmVjb2duaXplRnJvbUltYWdlKGJlc3RJbWFnZSwgb3B0aW9ucyk7CgogICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBPQ1IgUmVzdWx0cwogICAgICAgICAgICAgICAgaWYgKHJlc3VsdE9jci5vY3JSZXN1bHQgIT09ICIiKSB7CiAgICAgICAgICAgICAgICAgICAgcG9zdERhdGEucmVzdWx0Lm9jclJlc3VsdCA9IHJlc3VsdE9jci5vY3JSZXN1bHQ7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gRGVsZXRlIHJlc3VsdCBvZiBNUloKICAgICAgICAgICAgICAgIHJlc3VsdE9jci5kZWxldGUoKTsKICAgICAgICAgICAgICAgIGJlc3RJbWFnZS5kZWxldGUoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYoIXJlc3VsdEZhY2VNcnoubXJ6TG9jYXRpb24uaXNWYWxpZCgpICYmICFyZXN1bHRGYWNlTXJ6LmZhY2VMb2NhdGlvbi5pc1ZhbGlkKCkpIHsKICAgICAgICAgICAgICAgIHBvc3REYXRhWyJkaWFnbm9zdGljIl0gPSBFeHRyYWN0aW9uUmVzdWx0LkFUVFJJQlVURVNfTk9UX0ZPVU5EOwogICAgICAgICAgICAgICAgcG9zdERhdGEucmVzdWx0WyJkaWFnbm9zdGljIl0gPSBFeHRyYWN0aW9uUmVzdWx0LkFUVFJJQlVURVNfTk9UX0ZPVU5EOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcG9zdERhdGFbImRpYWdub3N0aWMiXSA9IHJlc3VsdERvY3VtZW50LmRpYWdub3N0aWMudmFsdWU7CiAgICAgICAgICAgICAgICBwb3N0RGF0YS5yZXN1bHRbImRpYWdub3N0aWMiXSA9IHJlc3VsdERvY3VtZW50LmRpYWdub3N0aWMudmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIENsZWFuIHJlc3VsdCBkb2N1bWVudAogICAgICAgICAgICByZXN1bHREb2N1bWVudC5kZWxldGUoKTsKCiAgICAgICAgICAgIC8vIERlbGV0ZSB0aGUgZmFjZSByZXN1bHQgZXh0cmFjdGlvbgogICAgICAgICAgICByZXN1bHRGYWNlTXJ6LmRlbGV0ZSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF9fY2xlYW5BY2Nlc3NpYmlsaXR5RXJyb3JzKHBvc3REYXRhLCByZXN1bHREb2N1bWVudCwgYWNjZXNzaWJpbGl0eVBhcmFtKTsKICAgICAgICB9CgogICAgICAgIC8vIENsZWFudXAgV2ViQXNzZW1ibHkgT2JqZWN0cwogICAgICAgIGRlbGV0ZVdhc21WYXIoCiAgICAgICAgICAgIG9wdGlvbnMsCiAgICAgICAgICAgIHNpemVPYmosCiAgICAgICAgICAgIGltYWdlT2JqCiAgICAgICAgKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAvLyBDbGVhbnVwIHRoZSByZXN1bHQgZm9yIGF2b2lkIHBhcnRpYWwgZGV0ZWN0aW9uIHJlc3VsdHMKICAgICAgICBwb3N0RGF0YS5yZXN1bHQgPSB7fTsKCiAgICAgICAgLy8gU2V0IHRoZSBlcnJvciBjb2RlIGZvciBjYXRjaAogICAgICAgIF9fY2xlYW5BY2Nlc3NpYmlsaXR5RXJyb3JzKHBvc3REYXRhLCB7IGRpYWdub3N0aWM6IHsgdmFsdWU6IGVycm9yVGlsdCB9IH0sIGFjY2Vzc2liaWxpdHlQYXJhbSk7CgogICAgICAgIC8vIFNlbmQgbG9ncyBpbnRvIHdlYiBjb25zb2xlCiAgICAgICAgZXJyb3JNZXNzYWdlKCJbV29ya2VyXTogIiArIGUpOwoKICAgICAgICAvLyBDbGVhbnVwIFdlYkFzc2VtYmx5IE9iamVjdHMKICAgICAgICBkZWxldGVXYXNtVmFyKAogICAgICAgICAgICBmYWNlSW1hZ2UsCiAgICAgICAgICAgIGRvY3VtZW50SW1hZ2UsCiAgICAgICAgICAgIHJlc3VsdE9jciwKICAgICAgICAgICAgcmVzdWx0RmFjZU1yeiwKICAgICAgICAgICAgcmVzdWx0RG9jdW1lbnQsCiAgICAgICAgICAgIG9wdGlvbnMsCiAgICAgICAgICAgIHNpemVPYmosCiAgICAgICAgICAgIGltYWdlT2JqCiAgICAgICAgKTsKICAgIH0KCiAgICAvLyBTZW5kIGluZm9ybWF0aW9uIHRvIG1haW4gdGhyZWFkCiAgICBzZWxmLnBvc3RNZXNzYWdlKHBvc3REYXRhKTsKfQoKLyoqCiAqIEdldCB0aGUgZXh0cmFjdG9yIHZlcnNpb24gZnJvbSBXZWJBc3NlbWJseSBzaWRlLgogKi8KY29uc3QgdmVyc2lvbiA9IGFzeW5jICgpID0+IHsKICAgIGxldCByZXR1cm5Kc29uID0geyBjbWQgOiAidmVyc2lvbiIgfTsKCiAgICByZXR1cm5Kc29uWyJ2ZXJzaW9uIl0gPSBpbnN0YW5jZS5nZXRWZXJzaW9uKCk7CgogICAgc2VsZi5wb3N0TWVzc2FnZShyZXR1cm5Kc29uKTsKfQoKLyoqCiAqIERlc3Ryb3kgY3JlYXRlZCBvYmplY3RzIGluIFdlYkFzc2VtYmx5IHNpZGUKICovCiBjb25zdCBkZXN0cm95ID0gYXN5bmMgKCkgPT4gewogICAgLy8gRGVzdHJveSBXZWJBc3NlbWJseSBHbG9iYWxzCiAgICBkZWxldGVXYXNtVmFyKAogICAgICAgIGluc3RhbmNlLAogICAgICAgIG9jckVuZ2luZSwKICAgICAgICBmYWNlTXJ6RW5naW5lLAogICAgICAgIGRvY3VtZW50RW5naW5lLAogICAgICAgIGRvY3VtZW50Q2FwdHVyZQogICAgKTsKCiAgICAvLyBDbG9zZSBXb3JrZXIgVGhyZWFkCiAgICBjbG9zZSgpOwp9OwoKLyoqCiAqIFJlc2V0IGJ1ZmZlcnMgb24gZGVtYW5kCiAqLwpjb25zdCByZXNldEJ1ZmZlcnMgPSBhc3luYyAoKSA9PiB7CiAgICBsZXQgcmV0dXJuSnNvbiA9IHsgY21kOiAicmVzZXRCdWZmZXJzIiB9OwoKICAgIGRvY3VtZW50Q2FwdHVyZS5yZXNldCgpOwoKICAgIHNlbGYucG9zdE1lc3NhZ2UocmV0dXJuSnNvbik7Cn0KCi8qKgogKiBNZXRob2QgdG8gY2xlYW4gdGhlIGFjY2Vzc2liaWxpdHkgZGF0YSBpZiBpcyBuZWVkZWQKICoKICogQHBhcmFtIHthcnJheX0gcG9zdERhdGEgVGhlIG9iamVjdCB3aXRoIGRhdGEgYmVmb3JlIHNlbnQgaXQKICogQHBhcmFtIHthcnJheX0gcmVzdWx0RGV0ZWN0IFJhdyBkZXRlY3Rpb24gZGF0YQogKiBAcGFyYW0ge2Jvb2xlYW59IGFjY2Vzc2liaWxpdHlQYXJhbSBUaGUgYWNjZXNzaWJpbGl0eSBwYXJhbSBlbmFibGVkCiAqLwpjb25zdCBfX2NsZWFuQWNjZXNzaWJpbGl0eUVycm9ycyA9IChwb3N0RGF0YSwgcmVzdWx0RGV0ZWN0LCBhY2Nlc3NpYmlsaXR5UGFyYW0pID0+IHsKICAgIGlmIChhY2Nlc3NpYmlsaXR5UGFyYW0gIT09IHRydWUpIHsKICAgICAgICBwb3N0RGF0YS5kaWFnbm9zdGljID0gcmVzdWx0RGV0ZWN0LmRpYWdub3N0aWMudmFsdWU7CiAgICB9IGVsc2UgewogICAgICAgIHBvc3REYXRhLmRpYWdub3N0aWMgPSAwOwogICAgfQp9CgoKCjsvLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuLi9idWlsZC90ZW1wL2VuZ2luZXMvZmFjZXBoaS93b3JrZXIvRlBoaS5Xb3JrZXIuTWFpbi5qcwoKCgovKioKICogT3V0cHV0IG1lc3NhZ2VzIHBhc3NlZCBieSB0aGUgbG9nZ2VyIHN5c3RlbS4KICovCi8vIGNvbnNvbGUubG9nID0gbG9nZ2VyLmluZm9NZXNzYWdlOwovLyBjb25zb2xlLndhcm4gPSBsb2dnZXIud2FybmluZ01lc3NhZ2U7Ci8vIGNvbnNvbGUuZGVidWcgPSBsb2dnZXIuZGVidWdNZXNzYWdlOwovLyBjb25zb2xlLmVycm9yID0gbG9nZ2VyLmVycm9yTWVzc2FnZTsKCgovKioKICogRW50cnlwb2ludCBvZiBtZXNzYWdlIGRhdGEgcmVjZWl2ZWQKICoKICogQHBhcmFtIHtvYmplY3R9IG1lc3NhZ2UgdGhlIG9iamVjdCBvZiB0aGUgZXZlbnQKICovCnNlbGYub25tZXNzYWdlID0gKG1lc3NhZ2UpID0+IHsKICAgIHN3aXRjaCAobWVzc2FnZS5kYXRhLmNtZCkgewogICAgICAgIGNhc2UgInByZUluaXQiOgogICAgICAgICAgICBwcmVsb2FkSW5pdEV4dHJhY3RvcihtZXNzYWdlLmRhdGEpOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJpbml0IjoKICAgICAgICAgICAgaW5pdGlhbGl6ZUV4dHJhY3RvcihtZXNzYWdlLmRhdGEpOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJkZXRlY3QiOgogICAgICAgICAgICBkZXRlY3QobWVzc2FnZS5kYXRhKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAidmVyc2lvbiI6CiAgICAgICAgICAgIHZlcnNpb24obWVzc2FnZS5kYXRhKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAiZGVzdHJveSI6CiAgICAgICAgICAgIGRlc3Ryb3kobWVzc2FnZS5kYXRhKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAicmVzZXRCdWZmZXJzIjoKICAgICAgICAgICAgcmVzZXRCdWZmZXJzKG1lc3NhZ2UuZGF0YSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIGRlYnVnTWVzc2FnZSgidW5rbm93bk1lc3NhZ2UiKTsKICAgICAgICAgICAgYnJlYWs7CiAgICB9Cgp9Cg==")],{type:"text/javascript"}))),R))}return C(e,[{key:"initializeEngine",value:function(){var e=m(u().mark((function e(){var t=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.__worker.postMessage({cmd:"preInit",licenseKey:this.__licenseKey,bundlePath:this.__engineLocation+"/FPhi.Engine.Facephi",imageFormat:this.__imageFormat,imageQuality:this.__imageQuality,blurredThreshold:this.__blurredThreshold}),e.next=4,new Promise((function(e){t.__worker.onmessage=function(t){"ready"===t.data.cmd&&e()}}));case 4:return this.__worker.postMessage({cmd:"init"}),e.next=7,new Promise((function(e){t.__worker.onmessage=function(t){"init"===t.data.cmd&&e()}}));case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),new Error("Fail to initialize the engine!");case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"detectImage",value:function(e){var t=this,i=e.width,n=e.height,a=e.getContext("2d").getImageData(0,0,i,n);return this.__worker.postMessage({cmd:"detect",image:a.data,width:i,height:n,accessibility:this.__accessibility,timestamp:Date.now()}),new Promise((function(e){t.__worker.onmessage=function(i){"detect"===i.data.cmd&&e(t.__generateResultObject(i.data))}}))}},{key:"cleanImageBuffer",value:function(){var e=m(u().mark((function e(){var t=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.__frontDocument=null,this.__faceImage=null,this.__backDocument=null,this.__worker.postMessage({cmd:"resetBuffers"}),new Promise((function(e){t.__worker.onmessage=function(t){"resetBuffers"===t.data.cmd&&e()}}))));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"finalizeEngine",value:function(){var e=m(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.__worker.postMessage({cmd:"destroy"});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"__attributes",get:function(){return{licenseKey:{type:"string",property:"__licenseKey"},bundlePath:{type:"string",property:"__engineLocation"},imageFormat:{type:"string",property:"__imageFormat"},imageQuality:{type:"number",property:"__imageQuality"},accessibility:{type:"boolean",property:"__accessibility"},blurredThreshold:{type:"number",property:"__blurredThreshold"}}}},{key:"__scanResultType",get:function(){return{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,19:19,20:20}}},{key:"__mapperToRealConfig",value:function(e){for(var t=0,i=Object.entries(e);t<i.length;t++){var n=l(i[t],2),a=n[0],s=n[1];void 0!==this.__attributes[a]&&(this[this.__attributes[a].property]=s)}}},{key:"__transformDate",value:function(e){try{var t,i,n=Number((new Date).getFullYear().toString().slice(-2));return t=parseInt(e.slice(0,2))>n?"19"+e.slice(0,2):"20"+e.slice(0,2),i=e.slice(2,4),e.slice(4,7)+"/"+i+"/"+t}catch(e){return null}}},{key:"__generateResultObject",value:function(e){var t={},i={};if(t.diagnostic=this.__scanResultType[e.result.diagnostic],t.detectionStatus={status:this.__scanResultType[e.result.diagnostic],quad:0,glare:0,internalStatus:e.result.diagnostic},t.simpleModeOutput=0,void 0!==e.result.diqaResult&&e.result.diqaResult.blur<this.__blurredThreshold)return this.__generateErrorResultObject(13);if(0===e.result.diagnostic){if(!1!==e.result.faceDetect){var n=e.result.documentImage.buffer,a=e.result.documentImage.width,l=e.result.documentImage.height;this.__frontDocument=new ImageData(new Uint8ClampedArray(n),a,l,i);var s=e.result.faceImage.buffer,r=e.result.faceImage.width,c=e.result.faceImage.height;this.__faceImage=new ImageData(new Uint8ClampedArray(s),r,c,i)}else{var o=e.result.documentImage.buffer,d=e.result.documentImage.width,u=e.result.documentImage.height;this.__backDocument=new ImageData(new Uint8ClampedArray(o),d,u,i)}if(t.images={frontDocument:this.__convertToImageOutput(this.__frontDocument),faceImage:this.__convertToImageOutput(this.__faceImage),backDocument:this.__convertToImageOutput(this.__backDocument),signatureImage:null},t.imagesRaw={frontDocument:this.__frontDocument,faceImage:this.__faceImage,backDocument:this.__backDocument,signatureImage:null},t.extractionRaw={},this.__mrzRawString=e.result.ocrResult,!1!==e.result.mrzDetect&&void 0!==this.__mrzRawString&&93===this.__mrzRawString.length){var h=function(e){if(null!=e&&""!==e){var t={},i=null,n=null,a=e.split("\n");if(a.length>=3){var l=new RegExp("([A|C|I][A-Z0-9<]{1})([A-Z]{3})([A-Z0-9<]{9})([0-9<]{1})([A-Z0-9<]{15})"),s=new RegExp("([0-9]{6})([0-9]{1})(.{1})([0-9]{6})([0-9]{1})([A-Z]{3})([A-Z0-9<]{11})([0-9]{1})"),r=new RegExp("([A-Z0-9<]{30})");if(t.extractionValidated=l.test(a[0])&&s.test(a[1])&&r.test(a[2]),t.extractionValidated)return i=l.exec(a[0]),t.documentType=i[1],t.countryEmitterCode=i[2],t.documentNumber=i[3].replaceAll("<",""),t.opt1=i[5],t.documentId=i[5].replaceAll("<",""),i=s.exec(a[1]),t.birthDate=i[1],t.gender=i[3],t.documentExpiry=i[4],t.nationality=i[6],t.opt2=i[7],n=(i=r.exec(a[2]))[1].replaceAll(/[<]{3,}/g,"").split("<<").map((function(e){return e.replaceAll("<"," ")})),t.firstName=n[1],t.lastName=n[0],t}}return null}(this.__mrzRawString);if(null===h)return this.__generateErrorResultObject(13);t.extractionRaw.mrz={rawData:this.__mrzRawString,opt1:h.opt1,opt2:h.opt2,firstName:h.firstName,lastName:h.lastName,documentId:h.documentId,documentNumber:h.documentNumber,documentIssuer:h.countryEmitterCode,dateOfExpiry:h.documentExpiry,dateOfBirth:h.birthDate,gender:h.gender,nationality:h.nationality}}}return t.extractionData={firstName:G((function(){return t.extractionRaw.mrz.firstName}))||G((function(){return t.extractionRaw.ocr.firstName}))||null,lastName:G((function(){return t.extractionRaw.mrz.lastName}))||G((function(){return t.extractionRaw.ocr.lastName}))||null,gender:G((function(){return t.extractionRaw.mrz.gender}))||G((function(){return t.extractionRaw.ocr.gender}))||null,nationality:G((function(){return t.extractionRaw.mrz.nationality}))||G((function(){return t.extractionRaw.ocr.nationality}))||null,dateOfBirth:this.__transformDate(G((function(){return t.extractionRaw.mrz.dateOfBirth})))||G((function(){return t.extractionRaw.ocr.dateOfBirth}))||null,documentId:G((function(){return t.extractionRaw.mrz.documentId}))||G((function(){return t.extractionRaw.ocr.documentId}))||null,documentNumber:G((function(){return t.extractionRaw.mrz.documentNumber}))||G((function(){return t.extractionRaw.ocr.documentNumber}))||null},t}},{key:"__generateErrorResultObject",value:function(e){return{diagnostic:e,simpleModeOutput:0,detectionStatus:{status:e,glare:0,quad:0,internalStatus:e}}}},{key:"__convertToImageOutput",value:function(e){if(null!==e){var t=document.createElement("canvas"),i=t.getContext("2d");return t.width=e.width,t.height=e.height,i.putImageData(e,0,0),t.toDataURL(this.__imageFormat,this.__imageQuality)}return null}},{key:"__roundUpLenght",value:function(e,t){return Math.ceil(e/t)*t}}]),e}(),N=function(){function e(t){X(this,e),this.__licenseKey="",this.__engineLocation="",this.__mockInformation={},this.__detectsCount=0,this.__detectsNeeded=10,this.__mapperToRealConfig(t)}return C(e,[{key:"initializeEngine",value:function(){var e=m(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"detectImage",value:function(){var e=m(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.__detectsCount<this.__detectsNeeded)){e.next=7;break}return this.__detectsCount++,e.next=4,function(){var e=m(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout(e,200)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()();case 4:e.t0={result:1},e.next=8;break;case 7:e.t0=this.__generateResultObject(this.__mockInformation,t.getContext("2d").getImageData(0,0,t.width,t.height));case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cleanImageBuffer",value:function(){var e=m(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"finalizeEngine",value:function(){var e=m(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"__attributes",get:function(){return{licenseKey:{type:"string",property:"__licenseKey"},bundlePath:{type:"string",property:"__engineLocation"},mockInformation:{type:"object",property:"__mockInformation"}}}},{key:"__scanResultType",get:function(){return{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10}}},{key:"__mapperToRealConfig",value:function(e){for(var t=0,i=Object.entries(e);t<i.length;t++){var n=l(i[t],2),a=n[0],s=n[1];void 0!==this.__attributes[a]&&(this[this.__attributes[a].property]=s)}}},{key:"__generateResultObject",value:function(e,t){var i;return i=e&&0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype?{extractionRaw:{mrz:{rawData:null,opt1:null,opt2:null,firstName:null,lastName:null,documentId:null,documentNumber:null,documentIssuer:null,dateOfExpiry:null,dateOfBirth:null,gender:null,nationality:null},ocr:{firstName:null,lastName:null,documentId:null,documentNumber:null,dateOfBirth:null,dateOfExpiry:null,dateOfIssue:null,gender:null,nationality:null}},extractionData:{firstName:null,lastName:null,gender:null,nationality:null,dateOfBirth:null,placeOfBirth:null,documentId:null,documentNumber:null,address:null}}:e,{diagnostic:this.__scanResultType[0],images:{backDocument:this.__convertToImageOutput(t),frontDocument:this.__convertToImageOutput(t)},imagesRaw:{backDocument:t,frontDocument:t},extractionRaw:{mrz:i.extractionRaw.mrz,ocr:i.extractionRaw.ocr},extractionData:i.extractionData}}},{key:"__convertToImageOutput",value:function(e){if(null!==e){var t=document.createElement("canvas"),i=t.getContext("2d");return t.width=e.width,t.height=e.height,i.putImageData(e,0,0),t.toDataURL(this.__imageFormat,this.__imageQuality)}return null}}]),e}();function E(e,t,i,n){return new(i||(i=Promise))((function(a,l){function s(e){try{c(n.next(e))}catch(e){l(e)}}function r(e){try{c(n.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,r)}c((n=n.apply(e,t||[])).next())}))}var k,x,w,L,T,U=0,K=C((function e(t){X(this,e),this.action=t,this.messageID=function(){var e=U;return U+=1,e}()})),J=function(e){W(i,e);var t=V(i);function i(e,n){var a;return X(this,i),(a=t.call(this,i.action)).wasmModuleName=e.wasmModuleName,a.licenseKey=e.licenseKey,a.userId=n,a.registerLoadCallback=null!==e.loadProgressCallback,a.allowHelloMessage=e.allowHelloMessage,a.engineLocation=e.engineLocation,a.wasmType=e.wasmType,a.numberOfWorkers=e.numberOfWorkers,a}return C(i)}(K);J.action="init",function(e){e[e.Any=0]="Any",e[e.Recognizer=1]="Recognizer",e[e.RecognizerSettings=2]="RecognizerSettings",e[e.Callback=3]="Callback"}(k||(k={}));var H=function(e){W(i,e);var t=V(i);function i(e,n){var a;return X(this,i),(a=t.call(this,i.action)).className=e,a.params=n,a}return C(i)}(K);H.action="createNewNativeObject";var A=function(e){W(i,e);var t=V(i);function i(e,n,a){var l;return X(this,i),(l=t.call(this,i.action)).recognizerHandles=e,l.allowMultipleResults=n,l.registeredMetadataCallbacks=a,l}return C(i)}(K);A.action="createRecognizerRunner";var M=function(e){W(i,e);var t=V(i);function i(e,n){var a;return X(this,i),(a=t.call(this,i.action)).recognizerHandles=e,a.allowMultipleResults=n,a}return C(i)}(K);M.action="reconfigureRecognizerRunner";var P=function(e){W(i,e);var t=V(i);function i(){return X(this,i),t.call(this,i.action)}return C(i)}(K);P.action="deleteRecognizerRunner";var B=function(e){W(i,e);var t=V(i);function i(e,n,a){var l;return X(this,i),(l=t.call(this,i.action)).objectHandle=e,l.methodName=n,l.params=a,l}return C(i)}(K);B.action="invokeObject";var z=function(e){W(i,e);var t=V(i);function i(e){var n;return X(this,i),(n=t.call(this,i.action)).frame=e,n}return C(i,[{key:"getTransferrables",value:function(){return[this.frame.imageData.data.buffer]}}]),i}(K);z.action="processImage";var O=function(e){W(i,e);var t=V(i);function i(e){var n;return X(this,i),(n=t.call(this,i.action)).hardReset=e,n}return C(i)}(K);O.action="resetRecognizers";var D=C((function e(){X(this,e),this.onDebugText=!1,this.onDetectionFailed=!1,this.onQuadDetection=!1,this.onPointsDetection=!1,this.onFirstSideResult=!1,this.onGlare=!1})),_=function(e){W(i,e);var t=V(i);function i(e){var n;return X(this,i),(n=t.call(this,i.action)).registeredMetadataCallbacks=e,n}return C(i)}(K);_.action="registerMetadataCallbacks";var j=function(e){W(i,e);var t=V(i);function i(e){var n;return X(this,i),(n=t.call(this,i.action)).detectionOnlyMode=e,n}return C(i)}(K);j.action="setDetectionOnly";var Q=function(e){W(i,e);var t=V(i);function i(e){var n;return X(this,i),(n=t.call(this,i.action)).callbackNonEmpty=e,n}return C(i)}(K);Q.action="setClearTimeoutCallback";var q=function(e){W(i,e);var t=V(i);function i(e){var n;return X(this,i),(n=t.call(this,i.action)).cameraPreviewMirrored=e,n}return C(i)}(K);q.action="setCameraPreviewMirrored";var $=function(e){W(i,e);var t=V(i);function i(e){var n;return X(this,i),(n=t.call(this,i.action)).userId=e,n}return C(i)}(K);function ee(e,t){return function(i){var n=i;n.success?e():t(n.error)}}function te(e,t){return function(i){var n=i;n.success?e(i):t(n.error)}}$.action="getProductIntegrationInfo",function(e){e[e.onDebugText=0]="onDebugText",e[e.onDetectionFailed=1]="onDetectionFailed",e[e.onQuadDetection=2]="onQuadDetection",e[e.onPointsDetection=3]="onPointsDetection",e[e.onFirstSideResult=4]="onFirstSideResult",e[e.clearTimeoutCallback=5]="clearTimeoutCallback",e[e.onGlare=6]="onGlare",e[e.recognizerCallback=7]="recognizerCallback"}(x||(x={})),function(e){e.Basic="BASIC",e.Advanced="ADVANCED",e.AdvancedWithThreads="ADVANCED_WITH_THREADS"}(w||(w={}));var ie=function(){function e(t,i,n){X(this,e),this.wasmSDKWorker=t,this.objectHandle=n,this.recognizerName=i,this.callbacks=new Map}return C(e,[{key:"getRemoteObjectHandle",value:function(){return this.objectHandle}},{key:"currentSettings",value:function(){var e=this;return new Promise((function(t,i){if(0>e.objectHandle)i("Invalid object handle: "+e.objectHandle);else{var n=new B(e.objectHandle,"currentSettings",[]),a=te((function(e){t(e.result)}),i);e.wasmSDKWorker.postMessage(n,a)}}))}},{key:"toSignedJSON",value:function(){var e=this;return new Promise((function(t,i){if(0>e.objectHandle)i("Invalid object handle: "+e.objectHandle);else{var n=new B(e.objectHandle,"toSignedJSON",[]),a=te((function(e){t(e.result)}),i);e.wasmSDKWorker.postMessage(n,a)}}))}},{key:"clearAllCallbacks",value:function(){this.callbacks.clear(),this.wasmSDKWorker.unregisterRecognizerCallbacks(this.objectHandle)}},{key:"removeFunctions",value:function(e){this.clearAllCallbacks();for(var t=!1,i=0,n=Object.keys(e);i<n.length;i++){var a=n[i],l=e[a];"function"==typeof l&&(this.callbacks.set(a,l),e[a]={parameter:{recognizerHandle:this.objectHandle,callbackName:a},type:k.Callback},t=!0)}return t&&this.wasmSDKWorker.registerRecognizerCallbacks(this.objectHandle,this),e}},{key:"updateSettings",value:function(e){var t=this;return new Promise((function(i,n){if(0>t.objectHandle)n("Invalid object handle: "+t.objectHandle);else{var a=new B(t.objectHandle,"updateSettings",[{parameter:t.removeFunctions(e),type:k.RecognizerSettings}]),l=ee(i,n);t.wasmSDKWorker.postMessage(a,l)}}))}},{key:"invokeCallback",value:function(e,t){var i=this.callbacks.get(e);void 0!==i?i.apply(void 0,g(t)):console.warn("Cannot find callback",e)}},{key:"getResult",value:function(){var e=this;return new Promise((function(t,i){if(0>e.objectHandle)i("Invalid object handle: "+e.objectHandle);else{var n=new B(e.objectHandle,"getResult",[]),a=te((function(e){t(e.result)}),i);e.wasmSDKWorker.postMessage(n,a)}}))}},{key:"delete",value:function(){var e=this;return new Promise((function(t,i){if(0>e.objectHandle)i("Invalid object handle: "+e.objectHandle);else{e.clearAllCallbacks();var n=new B(e.objectHandle,"delete",[]),a=ee((function(){e.objectHandle=-1,t()}),i);e.wasmSDKWorker.postMessage(n,a)}}))}}]),e}();function ne(e){var t=new D;return t.onDebugText=!!e.onDebugText,t.onDetectionFailed=!!e.onDetectionFailed,t.onPointsDetection=!!e.onPointsDetection,t.onQuadDetection=!!e.onQuadDetection,t.onFirstSideResult=!!e.onFirstSideResult,t.onGlare=!!e.onGlare,t}var ae=function(){function e(t){X(this,e),this.deleted=!1,this.wasmSDKWorker=t}return C(e,[{key:"processImage",value:function(e){var t=this;return new Promise((function(i,n){if(t.deleted)n("Recognizer runner is deleted. It cannot be used anymore!");else{var a=new z(e),l=te((function(e){i(e.recognitionState)}),n);t.wasmSDKWorker.postTransferrableMessage(a,l)}}))}},{key:"reconfigureRecognizers",value:function(e,t){var i=this;return new Promise((function(n,a){if(i.deleted)a("Recognizer runner is deleted. It cannot be used anymore!");else{var l=le(e),s=new M(l,t),r=ee(n,a);i.wasmSDKWorker.postMessage(s,r)}}))}},{key:"setMetadataCallbacks",value:function(e){var t=this;return new Promise((function(i,n){var a=new _(ne(e)),l=ee(i,n);t.wasmSDKWorker.postMessageAndRegisterCallbacks(a,e,l)}))}},{key:"resetRecognizers",value:function(e){var t=this;return new Promise((function(i,n){var a=new O(e),l=ee(i,n);t.wasmSDKWorker.postMessage(a,l)}))}},{key:"setDetectionOnlyMode",value:function(e){var t=this;return new Promise((function(i,n){var a=new j(e),l=ee(i,n);t.wasmSDKWorker.postMessage(a,l)}))}},{key:"setClearTimeoutCallback",value:function(e){var t=this;return new Promise((function(i,n){var a=new Q(null!==e),l=ee(i,n);t.wasmSDKWorker.registerClearTimeoutCallback(e),t.wasmSDKWorker.postMessage(a,l)}))}},{key:"setCameraPreviewMirrored",value:function(e){var t=this;return new Promise((function(i,n){var a=new q(e),l=ee(i,n);t.wasmSDKWorker.postMessage(a,l)}))}},{key:"delete",value:function(){var e=this;return this.deleted?Promise.reject("Recognizer runner is already deleted."):new Promise((function(t,i){var n=new P,a=ee((function(){e.deleted=!0,t()}),i);e.wasmSDKWorker.postMessage(n,a)}))}}]),e}();function le(e){var t,i=[],n=p(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;i.push(a.getRemoteObjectHandle())}}catch(l){n.e(l)}finally{n.f()}return i}var se=function(){function e(t){X(this,e),this.wasmSDKWorker=t}return C(e,[{key:"createRecognizerRunner",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(a,l){var s=le(e),r=new A(s,i,ne(n)),c=ee((function(){a(new ae(t.wasmSDKWorker))}),l);t.wasmSDKWorker.postMessageAndRegisterCallbacks(r,n,c)}))}},{key:"newRecognizer",value:function(e){for(var t=this,i=arguments.length,n=new Array(i>1?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];return new Promise((function(i,a){var l=new H(e,function(e){var t,i=[],n=p(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,l=k.Any;a instanceof ie&&(l=k.Recognizer,a=a.getRemoteObjectHandle()),i.push({parameter:a,type:l})}}catch(s){n.e(s)}finally{n.f()}return i}(n)),s=te((function(n){var a=new ie(t.wasmSDKWorker,e,n.objectHandle);i(a)}),a);t.wasmSDKWorker.postMessage(l,s)}))}}]),e}(),re=function(){function e(t,i,n,a){var l=this;X(this,e),this.eventHandlers={},this.metadataCallbacks={},this.clearTimeoutCallback=null,this.loadedWasmType=w.Basic,this.mbWasmWorker=t,this.mbWasmWorker.onmessage=function(e){l.handleWorkerEvent(e)},this.mbWasmWorker.onerror=function(){a("Problem during initialization of worker file!")},this.mbWasmModule=new se(this),this.loadCallback=i,this.recognizersWithCallbacks=new Map,this.userId=n,this.showOverlay=!1}return C(e,[{key:"postMessage",value:function(e,t){this.eventHandlers[e.messageID]=t,this.mbWasmWorker.postMessage(e)}},{key:"postTransferrableMessage",value:function(e,t){this.eventHandlers[e.messageID]=t,this.mbWasmWorker.postMessage(e,e.getTransferrables())}},{key:"postMessageAndRegisterCallbacks",value:function(e,t,i){this.eventHandlers[e.messageID]=i,this.metadataCallbacks=t,this.mbWasmWorker.postMessage(e)}},{key:"registerClearTimeoutCallback",value:function(e){this.clearTimeoutCallback=e}},{key:"registerRecognizerCallbacks",value:function(e,t){this.recognizersWithCallbacks.set(e,t)}},{key:"unregisterRecognizerCallbacks",value:function(e){this.recognizersWithCallbacks.delete(e)}},{key:"delete",value:function(){this.mbWasmWorker.terminate()}},{key:"getProductIntegrationInfo",value:function(){var e=this;return new Promise((function(t,i){var n=new $(e.userId),a=te((function(e){t(e.result)}),i);e.postMessage(n,a)}))}},{key:"handleWorkerEvent",value:function(e){if("isCallbackMessage"in e.data){var t=e.data;switch(t.callbackType){case x.onDebugText:"function"==typeof this.metadataCallbacks.onDebugText&&this.metadataCallbacks.onDebugText(t.callbackParameters[0]);break;case x.onDetectionFailed:"function"==typeof this.metadataCallbacks.onDetectionFailed&&this.metadataCallbacks.onDetectionFailed();break;case x.onPointsDetection:"function"==typeof this.metadataCallbacks.onPointsDetection&&this.metadataCallbacks.onPointsDetection(t.callbackParameters[0]);break;case x.onQuadDetection:"function"==typeof this.metadataCallbacks.onQuadDetection&&this.metadataCallbacks.onQuadDetection(t.callbackParameters[0]);break;case x.onFirstSideResult:"function"==typeof this.metadataCallbacks.onFirstSideResult&&this.metadataCallbacks.onFirstSideResult();break;case x.clearTimeoutCallback:this.clearTimeoutCallback&&"function"==typeof this.clearTimeoutCallback.onClearTimeout&&this.clearTimeoutCallback.onClearTimeout();break;case x.onGlare:"function"==typeof this.metadataCallbacks.onGlare&&this.metadataCallbacks.onGlare(t.callbackParameters[0]);break;case x.recognizerCallback:var i=t.callbackParameters.shift(),n=this.recognizersWithCallbacks.get(i.recognizerHandle);void 0!==n?n.invokeCallback(i.callbackName,t.callbackParameters):console.warn("Cannot find recognizer to deliver callback message. Maybe it's destroyed?",i);break;default:throw Error("Unknown callback type: "+x[t.callbackType])}}else if("isLoadProgressMessage"in e.data){var a=e.data;"function"==typeof this.loadCallback&&this.loadCallback(a.progress)}else{var l=e.data,s=this.eventHandlers[l.messageID];delete this.eventHandlers[l.messageID],s(l)}}}],[{key:"createWasmWorker",value:function(t,i,n){return E(this,void 0,void 0,u().mark((function a(){return u().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise((function(a,l){var s=new e(t,i.loadProgressCallback,n,l),r=new J(i,n),c=te((function(e){var t=e;s.showOverlay=t.showOverlay,s.loadedWasmType=t.wasmType,a(s)}),(function(e){s&&"function"==typeof s.delete&&s.delete(),l(e)}));s.postMessage(r,c)})));case 1:case"end":return a.stop()}}),a)})))}}]),e}(),ce=C((function e(t,i){if(X(this,e),!t.code||!t.message)throw Error("Instance of SDKError is required to have code and message.");this.message=t.message,this.code=t.code,this.details=i}));!function(e){e.WORKER_WASM_LOAD_FAILURE="WORKER_WASM_LOAD_FAILURE",e.WORKER_WASM_INIT_MISSING="WORKER_WASM_INIT_MISSING",e.WORKER_FUNCTION_INVOKE_FAILURE="WORKER_FUNCTION_INVOKE_FAILURE",e.WORKER_RECOGNIZER_CREATION_FAILURE="WORKER_RECOGNIZER_CREATION_FAILURE",e.WORKER_RUNNER_EXISTS="WORKER_RUNNER_EXISTS",e.WORKER_RUNNER_CREATION_FAILURE="WORKER_RUNNER_CREATION_FAILURE",e.WORKER_RUNNER_MISSING="WORKER_RUNNER_MISSING",e.WORKER_RUNNER_RECONFIGURE_FAILURE="WORKER_RUNNER_RECONFIGURE_FAILURE",e.WORKER_RUNNER_DELETED="WORKER_RUNNER_DELETED",e.WORKER_RUNNER_DELETE_FAILURE="WORKER_RUNNER_DELETE_FAILURE",e.WORKER_OBJECT_INVOKE_FAILURE="WORKER_OBJECT_INVOKE_FAILURE",e.WORKER_IMAGE_PROCESS_FAILURE="WORKER_IMAGE_PROCESS_FAILURE",e.WORKER_HANDLE_UNDEFINED="WORKER_HANDLE_UNDEFINED",e.WORKER_MESSAGE_ACTION_UNKNOWN="WORKER_MESSAGE_ACTION_UNKNOWN",e.WORKER_LICENSE_UNLOCK_ERROR="WORKER_LICENSE_UNLOCK_ERROR",e.WORKER_INTEGRATION_INFO_FAILURE="WORKER_INTEGRATION_INFO_FAILURE",e.LOCAL_SDK_RUNNER_MISSING="LOCAL_SDK_RUNNER_MISSING",e.LOCAL_SDK_RUNNER_EMPTY="LOCAL_SDK_RUNNER_EMPTY",e.LICENSE_UNLOCK_ERROR="LICENSE_UNLOCK_ERROR",e.FRAME_CAPTURE_SVG_UNSUPPORTED="FRAME_CAPTURE_SVG_UNSUPPORTED",e.FRAME_CAPTURE_CANVAS_MISSING="FRAME_CAPTURE_CANVAS_MISSING",e.SDK_WASM_SETTINGS_MISSING="SDK_WASM_SETTINGS_MISSING",e.SDK_LICENSE_KEY_MISSING="SDK_LICENSE_KEY_MISSING",e.SDK_WASM_MODULE_NAME_MISSING="SDK_WASM_MODULE_NAME_MISSING",e.SDK_ENGINE_LOCATION_INVALID="SDK_ENGINE_LOCATION_INVALID",e.SDK_MISSING="SDK_MISSING",e.SDK_RECOGNIZERS_MISSING="SDK_RECOGNIZERS_MISSING",e.VIDEO_RECOGNIZER_ELEMENT_MISSING="VIDEO_RECOGNIZER_ELEMENT_MISSING",e.VIDEO_RECOGNIZER_CAMERA_MISSING="VIDEO_RECOGNIZER_CAMERA_MISSING",e.VIDEO_RECOGNIZER_CAMERA_NOT_ALLOWED="VIDEO_RECOGNIZER_CAMERA_NOT_ALLOWED",e.VIDEO_RECOGNIZER_CAMERA_UNAVAILABLE="VIDEO_RECOGNIZER_CAMERA_UNAVAILABLE",e.VIDEO_RECOGNIZER_CAMERA_IN_USE="VIDEO_RECOGNIZER_CAMERA_IN_USE",e.VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED="VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED",e.VIDEO_RECOGNIZER_FEED_RELEASED="VIDEO_RECOGNIZER_FEED_RELEASED",e.VIDEO_RECOGNIZER_FEED_NOT_PAUSED="VIDEO_RECOGNIZER_FEED_NOT_PAUSED",e.VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED="VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED",e.VIDEO_RECOGNIZER_FEED_PAUSED="VIDEO_RECOGNIZER_FEED_PAUSED",e.VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE="VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE",e.VIDEO_RECOGNIZER_FEED_MISSING="VIDEO_RECOGNIZER_FEED_MISSING"}(L||(L={})),function(e){e.WORKER_HANDLE_UNDEFINED="Cannot find object with handle: undefined",e.WORKER_WASM_LOAD_FAILURE="Failed to load WASM in web worker!",e.WORKER_WASM_INIT_MISSING="WASM module is not initialized!",e.WORKER_FUNCTION_INVOKE_FAILURE="Failed to invoke function!",e.WORKER_RECOGNIZER_CREATION_FAILURE="Failed to create new recognizer!",e.WORKER_RUNNER_EXISTS="Recognizer runner is already created! Multiple instances are not allowed!",e.WORKER_RUNNER_CREATION_FAILURE="Failed to create new recognizer runner!",e.WORKER_RUNNER_MISSING="Recognizer runner is not created! There is nothing to reconfigure!",e.WORKER_RUNNER_RECONFIGURE_FAILURE="Failed to reconfigure recognizer runner!",e.WORKER_RUNNER_DELETED="Recognizer runner is already deleted!",e.WORKER_RUNNER_DELETE_FAILURE="Failed to delete recognizer runner!",e.WORKER_OBJECT_INVOKE_FAILURE="Failed to invoke object!",e.WORKER_IMAGE_PROCESS_FAILURE="Recognizer runner is not initialized! Cannot process image!",e.WORKER_INTEGRATION_INFO_FAILURE="Failed to get product integration info!",e.LOCAL_SDK_RUNNER_MISSING="Property nativeRecognizerRunner is not available!",e.LOCAL_SDK_RUNNER_EMPTY="Native RecognizerRunner cannot be empty!",e.LICENSE_TOKEN_STATE_INCORRECT="Internal error (Incorrect token state)",e.LICENSE_PAYLOAD_VERIFICATION_FAILED="Failed to verify server permission's digital signature!",e.LICENSE_PAYLOAD_CORRUPTED="Server permission payload is corrupted!",e.LICENSE_PERMISSION_EXPIRED="Internal error (server permission expired)",e.LICENSE_REMOTE_LOCKED="Provided license key has been remotely locked. Please contact support for more information!",e.FRAME_CAPTURE_SVG_UNSUPPORTED="Recognition of SVG elements not supported!",e.FRAME_CAPTURE_CANVAS_MISSING="Could not get canvas 2d context!",e.SDK_WASM_SETTINGS_MISSING="Missing WASM load settings!",e.SDK_LICENSE_KEY_MISSING="Missing license key!",e.SDK_WASM_MODULE_NAME_MISSING="Missing WASM module name!",e.SDK_ENGINE_LOCATION_INVALID="Setting property 'engineLocation' must be a string!",e.SDK_MISSING="SDK is not provided!",e.SDK_RECOGNIZERS_MISSING="To create RecognizerRunner at least 1 recognizer is required.",e.VIDEO_RECOGNIZER_ELEMENT_MISSING="Video element, i.e. camera feed is not provided!",e.VIDEO_RECOGNIZER_CAMERA_MISSING="Camera not found!",e.VIDEO_RECOGNIZER_CAMERA_NOT_ALLOWED="Camera not allowed!",e.VIDEO_RECOGNIZER_CAMERA_UNAVAILABLE="Camera not available!",e.VIDEO_RECOGNIZER_CAMERA_IN_USE="Camera in use!",e.VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED="Media devices not supported by browser.",e.VIDEO_RECOGNIZER_FEED_RELEASED="The associated video feed has been released!",e.VIDEO_RECOGNIZER_FEED_NOT_PAUSED="The associated video feed is not paused. Use resumeRecognition instead!",e.VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED="The play() request was interrupted or prevented by browser security rules!",e.VIDEO_RECOGNIZER_FEED_PAUSED="Cannot resume recognition while video feed is paused! Use recognize or startRecognition",e.VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE="Could not reset recognizers!",e.VIDEO_RECOGNIZER_FEED_MISSING="Missing video feed!"}(T||(T={})),T.VIDEO_RECOGNIZER_FEED_MISSING,L.VIDEO_RECOGNIZER_FEED_MISSING,T.VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE,L.VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE,T.VIDEO_RECOGNIZER_FEED_PAUSED,L.VIDEO_RECOGNIZER_FEED_PAUSED,T.VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED,L.VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED,T.VIDEO_RECOGNIZER_FEED_NOT_PAUSED,L.VIDEO_RECOGNIZER_FEED_NOT_PAUSED,T.VIDEO_RECOGNIZER_FEED_RELEASED,L.VIDEO_RECOGNIZER_FEED_RELEASED,L.VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED,T.VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED,L.VIDEO_RECOGNIZER_CAMERA_MISSING,T.VIDEO_RECOGNIZER_CAMERA_MISSING,T.VIDEO_RECOGNIZER_ELEMENT_MISSING,L.VIDEO_RECOGNIZER_ELEMENT_MISSING;var oe,de,ue,he,me={wasmSettingsMissing:{message:T.SDK_WASM_SETTINGS_MISSING,code:L.SDK_WASM_SETTINGS_MISSING},licenseKeyMissing:{message:T.SDK_LICENSE_KEY_MISSING,code:L.SDK_LICENSE_KEY_MISSING},wasmModuleNameMissing:{message:T.SDK_WASM_MODULE_NAME_MISSING,code:L.SDK_WASM_MODULE_NAME_MISSING},engineLocationInvalid:{message:T.SDK_ENGINE_LOCATION_INVALID,code:L.SDK_ENGINE_LOCATION_INVALID},missing:{message:T.SDK_MISSING,code:L.SDK_MISSING},recognizersMissing:{message:T.SDK_RECOGNIZERS_MISSING,code:L.SDK_RECOGNIZERS_MISSING}},be={svgUnsupported:{message:T.FRAME_CAPTURE_SVG_UNSUPPORTED,code:L.FRAME_CAPTURE_SVG_UNSUPPORTED},canvasMissing:{message:T.FRAME_CAPTURE_CANVAS_MISSING,code:L.FRAME_CAPTURE_CANVAS_MISSING}};L.LICENSE_UNLOCK_ERROR,T.LICENSE_TOKEN_STATE_INCORRECT,L.LICENSE_UNLOCK_ERROR,T.LICENSE_PAYLOAD_VERIFICATION_FAILED,L.LICENSE_UNLOCK_ERROR,T.LICENSE_PAYLOAD_CORRUPTED,L.LICENSE_UNLOCK_ERROR,T.LICENSE_PERMISSION_EXPIRED,L.LICENSE_UNLOCK_ERROR,T.LICENSE_REMOTE_LOCKED,L.LICENSE_UNLOCK_ERROR,L.LICENSE_UNLOCK_ERROR,T.LOCAL_SDK_RUNNER_MISSING,L.LOCAL_SDK_RUNNER_MISSING,T.LOCAL_SDK_RUNNER_EMPTY,L.LOCAL_SDK_RUNNER_EMPTY,T.WORKER_IMAGE_PROCESS_FAILURE,L.WORKER_IMAGE_PROCESS_FAILURE,T.WORKER_OBJECT_INVOKE_FAILURE,L.WORKER_OBJECT_INVOKE_FAILURE,T.WORKER_RUNNER_DELETE_FAILURE,L.WORKER_RUNNER_DELETE_FAILURE,T.WORKER_RUNNER_DELETED,L.WORKER_RUNNER_DELETED,T.WORKER_RUNNER_RECONFIGURE_FAILURE,L.WORKER_RUNNER_RECONFIGURE_FAILURE,T.WORKER_RUNNER_MISSING,L.WORKER_RUNNER_MISSING,T.WORKER_RUNNER_CREATION_FAILURE,L.WORKER_RUNNER_CREATION_FAILURE,T.WORKER_RUNNER_EXISTS,L.WORKER_RUNNER_EXISTS,T.WORKER_RECOGNIZER_CREATION_FAILURE,L.WORKER_RECOGNIZER_CREATION_FAILURE,T.WORKER_FUNCTION_INVOKE_FAILURE,L.WORKER_FUNCTION_INVOKE_FAILURE,T.WORKER_WASM_INIT_MISSING,L.WORKER_WASM_INIT_MISSING,T.WORKER_WASM_LOAD_FAILURE,L.WORKER_WASM_LOAD_FAILURE,T.WORKER_HANDLE_UNDEFINED,L.WORKER_HANDLE_UNDEFINED,T.WORKER_INTEGRATION_INFO_FAILURE,L.WORKER_INTEGRATION_INFO_FAILURE,function(e){e[e.BackFacingCamera=0]="BackFacingCamera",e[e.FrontFacingCamera=1]="FrontFacingCamera"}(oe||(oe={})),function(e){e[e.RotatedLeft90=0]="RotatedLeft90",e[e.NoRotation=1]="NoRotation",e[e.RotatedRight90=2]="RotatedRight90",e[e.Rotated180=3]="Rotated180"}(de||(de={})),function(e){e[e.Empty=0]="Empty",e[e.Uncertain=1]="Uncertain",e[e.Valid=2]="Valid",e[e.StageValid=3]="StageValid"}(ue||(ue={}));var pe,ge,Ze,Ie,ye,Re,fe,ve,We,Ge,Ve,Xe,Se,Ce,Ne,Ee,Ye,Fe=C((function e(t,i,n){X(this,e),this.imageData=t,this.orientation=i,this.videoFrame=n}));!function(e){e[e.Invalid=0]="Invalid",e[e.RequiresServerPermission=1]="RequiresServerPermission",e[e.Valid=2]="Valid"}(pe||(pe={})),function(e){e.LicenseTokenStateInvalid="LICENSE_TOKEN_STATE_INVALID",e.NetworkError="NETWORK_ERROR",e.RemoteLock="REMOTE_LOCK",e.PermissionExpired="PERMISSION_EXPIRED",e.PayloadCorrupted="PAYLOAD_CORRUPTED",e.PayloadSignatureVerificationFailed="PAYLOAD_SIGNATURE_VERIFICATION_FAILED",e.IncorrectTokenState="INCORRECT_TOKEN_STATE"}(ge||(ge={})),function(e){e[e.Ok=0]="Ok",e[e.NetworkError=1]="NetworkError",e[e.RemoteLock=2]="RemoteLock",e[e.PermissionExpired=3]="PermissionExpired",e[e.PayloadCorrupted=4]="PayloadCorrupted",e[e.PayloadSignatureVerificationFailed=5]="PayloadSignatureVerificationFailed",e[e.IncorrectTokenState=6]="IncorrectTokenState"}(Ze||(Ze={})),function(e){e[e.Fail=0]="Fail",e[e.Success=1]="Success",e[e.CameraTooHigh=2]="CameraTooHigh",e[e.FallbackSuccess=3]="FallbackSuccess",e[e.Partial=4]="Partial",e[e.CameraAtAngle=5]="CameraAtAngle",e[e.CameraTooNear=6]="CameraTooNear",e[e.DocumentTooCloseToEdge=7]="DocumentTooCloseToEdge"}(Ie||(Ie={})),function(e){e.MediaDevicesNotSupported="MediaDevicesNotSupported",e.CameraNotFound="CameraNotFound",e.CameraNotAllowed="CameraNotAllowed",e.CameraInUse="CameraInUse",e.CameraNotAvailable="CameraNotAvailable",e.VideoElementNotProvided="VideoElementNotProvided"}(ye||(ye={})),function(e){e[e.Recognition=0]="Recognition",e[e.RecognitionTest=1]="RecognitionTest",e[e.DetectionTest=2]="DetectionTest"}(Re||(Re={}));var ke=C((function e(t){if(X(this,e),this.allowHelloMessage=!0,this.engineLocation="",this.wasmType=null,this.numberOfWorkers=null,this.loadProgressCallback=null,this.wasmModuleName="BlinkIDWasmSDK",!t)throw new ce(me.licenseKeyMissing);this.licenseKey=t}));function xe(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))}!function(e){e[e.NONE=0]="NONE",e[e.QR_CODE=1]="QR_CODE",e[e.DATA_MATRIX=2]="DATA_MATRIX",e[e.UPC_E=3]="UPC_E",e[e.UPC_A=4]="UPC_A",e[e.EAN_8=5]="EAN_8",e[e.EAN_13=6]="EAN_13",e[e.CODE_128=7]="CODE_128",e[e.CODE_39=8]="CODE_39",e[e.ITF=9]="ITF",e[e.AZTEC_BARCODE=10]="AZTEC_BARCODE",e[e.PDF417_BARCODE=11]="PDF417_BARCODE"}(fe||(fe={})),function(e){e[e.None=0]="None",e[e.ImageOnly=1]="ImageOnly",e[e.ResultFieldsOnly=2]="ResultFieldsOnly",e[e.FullResult=3]="FullResult"}(ve||(ve={})),function(e){e[e.DocumentType=0]="DocumentType",e[e.StandardVersionNumber=1]="StandardVersionNumber",e[e.CustomerFamilyName=2]="CustomerFamilyName",e[e.CustomerFirstName=3]="CustomerFirstName",e[e.CustomerFullName=4]="CustomerFullName",e[e.DateOfBirth=5]="DateOfBirth",e[e.Sex=6]="Sex",e[e.EyeColor=7]="EyeColor",e[e.AddressStreet=8]="AddressStreet",e[e.AddressCity=9]="AddressCity",e[e.AddressJurisdictionCode=10]="AddressJurisdictionCode",e[e.AddressPostalCode=11]="AddressPostalCode",e[e.FullAddress=12]="FullAddress",e[e.Height=13]="Height",e[e.HeightIn=14]="HeightIn",e[e.HeightCm=15]="HeightCm",e[e.CustomerMiddleName=16]="CustomerMiddleName",e[e.HairColor=17]="HairColor",e[e.NameSuffix=18]="NameSuffix",e[e.AKAFullName=19]="AKAFullName",e[e.AKAFamilyName=20]="AKAFamilyName",e[e.AKAGivenName=21]="AKAGivenName",e[e.AKASuffixName=22]="AKASuffixName",e[e.WeightRange=23]="WeightRange",e[e.WeightPounds=24]="WeightPounds",e[e.WeightKilograms=25]="WeightKilograms",e[e.CustomerIdNumber=26]="CustomerIdNumber",e[e.FamilyNameTruncation=27]="FamilyNameTruncation",e[e.FirstNameTruncation=28]="FirstNameTruncation",e[e.MiddleNameTruncation=29]="MiddleNameTruncation",e[e.PlaceOfBirth=30]="PlaceOfBirth",e[e.AddressStreet2=31]="AddressStreet2",e[e.RaceEthnicity=32]="RaceEthnicity",e[e.NamePrefix=33]="NamePrefix",e[e.CountryIdentification=34]="CountryIdentification",e[e.ResidenceStreetAddress=35]="ResidenceStreetAddress",e[e.ResidenceStreetAddress2=36]="ResidenceStreetAddress2",e[e.ResidenceCity=37]="ResidenceCity",e[e.ResidenceJurisdictionCode=38]="ResidenceJurisdictionCode",e[e.ResidencePostalCode=39]="ResidencePostalCode",e[e.ResidenceFullAddress=40]="ResidenceFullAddress",e[e.Under18=41]="Under18",e[e.Under19=42]="Under19",e[e.Under21=43]="Under21",e[e.SocialSecurityNumber=44]="SocialSecurityNumber",e[e.AKASocialSecurityNumber=45]="AKASocialSecurityNumber",e[e.AKAMiddleName=46]="AKAMiddleName",e[e.AKAPrefixName=47]="AKAPrefixName",e[e.OrganDonor=48]="OrganDonor",e[e.Veteran=49]="Veteran",e[e.AKADateOfBirth=50]="AKADateOfBirth",e[e.IssuerIdentificationNumber=51]="IssuerIdentificationNumber",e[e.DocumentExpirationDate=52]="DocumentExpirationDate",e[e.JurisdictionVersionNumber=53]="JurisdictionVersionNumber",e[e.JurisdictionVehicleClass=54]="JurisdictionVehicleClass",e[e.JurisdictionRestrictionCodes=55]="JurisdictionRestrictionCodes",e[e.JurisdictionEndorsementCodes=56]="JurisdictionEndorsementCodes",e[e.DocumentIssueDate=57]="DocumentIssueDate",e[e.FederalCommercialVehicleCodes=58]="FederalCommercialVehicleCodes",e[e.IssuingJurisdiction=59]="IssuingJurisdiction",e[e.StandardVehicleClassification=60]="StandardVehicleClassification",e[e.IssuingJurisdictionName=61]="IssuingJurisdictionName",e[e.StandardEndorsementCode=62]="StandardEndorsementCode",e[e.StandardRestrictionCode=63]="StandardRestrictionCode",e[e.JurisdictionVehicleClassificationDescription=64]="JurisdictionVehicleClassificationDescription",e[e.JurisdictionEndorsmentCodeDescription=65]="JurisdictionEndorsmentCodeDescription",e[e.JurisdictionRestrictionCodeDescription=66]="JurisdictionRestrictionCodeDescription",e[e.InventoryControlNumber=67]="InventoryControlNumber",e[e.CardRevisionDate=68]="CardRevisionDate",e[e.DocumentDiscriminator=69]="DocumentDiscriminator",e[e.LimitedDurationDocument=70]="LimitedDurationDocument",e[e.AuditInformation=71]="AuditInformation",e[e.ComplianceType=72]="ComplianceType",e[e.IssueTimestamp=73]="IssueTimestamp",e[e.PermitExpirationDate=74]="PermitExpirationDate",e[e.PermitIdentifier=75]="PermitIdentifier",e[e.PermitIssueDate=76]="PermitIssueDate",e[e.NumberOfDuplicates=77]="NumberOfDuplicates",e[e.HAZMATExpirationDate=78]="HAZMATExpirationDate",e[e.MedicalIndicator=79]="MedicalIndicator",e[e.NonResident=80]="NonResident",e[e.UniqueCustomerId=81]="UniqueCustomerId",e[e.DataDiscriminator=82]="DataDiscriminator",e[e.DocumentExpirationMonth=83]="DocumentExpirationMonth",e[e.DocumentNonexpiring=84]="DocumentNonexpiring",e[e.SecurityVersion=85]="SecurityVersion",e[e.Count=86]="Count"}(We||(We={})),function(e){e[e.NONE=0]="NONE",e[e.ALBANIA=1]="ALBANIA",e[e.ALGERIA=2]="ALGERIA",e[e.ARGENTINA=3]="ARGENTINA",e[e.AUSTRALIA=4]="AUSTRALIA",e[e.AUSTRIA=5]="AUSTRIA",e[e.AZERBAIJAN=6]="AZERBAIJAN",e[e.BAHRAIN=7]="BAHRAIN",e[e.BANGLADESH=8]="BANGLADESH",e[e.BELGIUM=9]="BELGIUM",e[e.BOSNIA_AND_HERZEGOVINA=10]="BOSNIA_AND_HERZEGOVINA",e[e.BRUNEI=11]="BRUNEI",e[e.BULGARIA=12]="BULGARIA",e[e.CAMBODIA=13]="CAMBODIA",e[e.CANADA=14]="CANADA",e[e.CHILE=15]="CHILE",e[e.COLOMBIA=16]="COLOMBIA",e[e.COSTA_RICA=17]="COSTA_RICA",e[e.CROATIA=18]="CROATIA",e[e.CYPRUS=19]="CYPRUS",e[e.CZECHIA=20]="CZECHIA",e[e.DENMARK=21]="DENMARK",e[e.DOMINICAN_REPUBLIC=22]="DOMINICAN_REPUBLIC",e[e.EGYPT=23]="EGYPT",e[e.ESTONIA=24]="ESTONIA",e[e.FINLAND=25]="FINLAND",e[e.FRANCE=26]="FRANCE",e[e.GEORGIA=27]="GEORGIA",e[e.GERMANY=28]="GERMANY",e[e.GHANA=29]="GHANA",e[e.GREECE=30]="GREECE",e[e.GUATEMALA=31]="GUATEMALA",e[e.HONG_KONG=32]="HONG_KONG",e[e.HUNGARY=33]="HUNGARY",e[e.INDIA=34]="INDIA",e[e.INDONESIA=35]="INDONESIA",e[e.IRELAND=36]="IRELAND",e[e.ISRAEL=37]="ISRAEL",e[e.ITALY=38]="ITALY",e[e.JORDAN=39]="JORDAN",e[e.KAZAKHSTAN=40]="KAZAKHSTAN",e[e.KENYA=41]="KENYA",e[e.KOSOVO=42]="KOSOVO",e[e.KUWAIT=43]="KUWAIT",e[e.LATVIA=44]="LATVIA",e[e.LITHUANIA=45]="LITHUANIA",e[e.MALAYSIA=46]="MALAYSIA",e[e.MALDIVES=47]="MALDIVES",e[e.MALTA=48]="MALTA",e[e.MAURITIUS=49]="MAURITIUS",e[e.MEXICO=50]="MEXICO",e[e.MOROCCO=51]="MOROCCO",e[e.NETHERLANDS=52]="NETHERLANDS",e[e.NEW_ZEALAND=53]="NEW_ZEALAND",e[e.NIGERIA=54]="NIGERIA",e[e.PAKISTAN=55]="PAKISTAN",e[e.PANAMA=56]="PANAMA",e[e.PARAGUAY=57]="PARAGUAY",e[e.PHILIPPINES=58]="PHILIPPINES",e[e.POLAND=59]="POLAND",e[e.PORTUGAL=60]="PORTUGAL",e[e.PUERTO_RICO=61]="PUERTO_RICO",e[e.QATAR=62]="QATAR",e[e.ROMANIA=63]="ROMANIA",e[e.RUSSIA=64]="RUSSIA",e[e.SAUDI_ARABIA=65]="SAUDI_ARABIA",e[e.SERBIA=66]="SERBIA",e[e.SINGAPORE=67]="SINGAPORE",e[e.SLOVAKIA=68]="SLOVAKIA",e[e.SLOVENIA=69]="SLOVENIA",e[e.SOUTH_AFRICA=70]="SOUTH_AFRICA",e[e.SPAIN=71]="SPAIN",e[e.SWEDEN=72]="SWEDEN",e[e.SWITZERLAND=73]="SWITZERLAND",e[e.TAIWAN=74]="TAIWAN",e[e.THAILAND=75]="THAILAND",e[e.TUNISIA=76]="TUNISIA",e[e.TURKEY=77]="TURKEY",e[e.UAE=78]="UAE",e[e.UGANDA=79]="UGANDA",e[e.UK=80]="UK",e[e.UKRAINE=81]="UKRAINE",e[e.USA=82]="USA",e[e.VIETNAM=83]="VIETNAM",e[e.BRAZIL=84]="BRAZIL",e[e.NORWAY=85]="NORWAY",e[e.OMAN=86]="OMAN",e[e.ECUADOR=87]="ECUADOR",e[e.EL_SALVADOR=88]="EL_SALVADOR",e[e.SRI_LANKA=89]="SRI_LANKA",e[e.PERU=90]="PERU",e[e.URUGUAY=91]="URUGUAY",e[e.BAHAMAS=92]="BAHAMAS",e[e.BERMUDA=93]="BERMUDA",e[e.BOLIVIA=94]="BOLIVIA",e[e.CHINA=95]="CHINA",e[e.EUROPEAN_UNION=96]="EUROPEAN_UNION",e[e.HAITI=97]="HAITI",e[e.HONDURAS=98]="HONDURAS",e[e.ICELAND=99]="ICELAND",e[e.JAPAN=100]="JAPAN",e[e.LUXEMBOURG=101]="LUXEMBOURG",e[e.MONTENEGRO=102]="MONTENEGRO",e[e.NICARAGUA=103]="NICARAGUA",e[e.SOUTH_KOREA=104]="SOUTH_KOREA",e[e.VENEZUELA=105]="VENEZUELA",e[e.AFGHANISTAN=106]="AFGHANISTAN",e[e.ALAND_ISLANDS=107]="ALAND_ISLANDS",e[e.AMERICAN_SAMOA=108]="AMERICAN_SAMOA",e[e.ANDORRA=109]="ANDORRA",e[e.ANGOLA=110]="ANGOLA",e[e.ANGUILLA=111]="ANGUILLA",e[e.ANTARCTICA=112]="ANTARCTICA",e[e.ANTIGUA_AND_BARBUDA=113]="ANTIGUA_AND_BARBUDA",e[e.ARMENIA=114]="ARMENIA",e[e.ARUBA=115]="ARUBA",e[e.BAILIWICK_OF_GUERNSEY=116]="BAILIWICK_OF_GUERNSEY",e[e.BAILIWICK_OF_JERSEY=117]="BAILIWICK_OF_JERSEY",e[e.BARBADOS=118]="BARBADOS",e[e.BELARUS=119]="BELARUS",e[e.BELIZE=120]="BELIZE",e[e.BENIN=121]="BENIN",e[e.BHUTAN=122]="BHUTAN",e[e.BONAIRE_SAINT_EUSTATIUS_AND_SABA=123]="BONAIRE_SAINT_EUSTATIUS_AND_SABA",e[e.BOTSWANA=124]="BOTSWANA",e[e.BOUVET_ISLAND=125]="BOUVET_ISLAND",e[e.BRITISH_INDIAN_OCEAN_TERRITORY=126]="BRITISH_INDIAN_OCEAN_TERRITORY",e[e.BURKINA_FASO=127]="BURKINA_FASO",e[e.BURUNDI=128]="BURUNDI",e[e.CAMEROON=129]="CAMEROON",e[e.CAPE_VERDE=130]="CAPE_VERDE",e[e.CARIBBEAN_NETHERLANDS=131]="CARIBBEAN_NETHERLANDS",e[e.CAYMAN_ISLANDS=132]="CAYMAN_ISLANDS",e[e.CENTRAL_AFRICAN_REPUBLIC=133]="CENTRAL_AFRICAN_REPUBLIC",e[e.CHAD=134]="CHAD",e[e.CHRISTMAS_ISLAND=135]="CHRISTMAS_ISLAND",e[e.COCOS_ISLANDS=136]="COCOS_ISLANDS",e[e.COMOROS=137]="COMOROS",e[e.CONGO=138]="CONGO",e[e.COOK_ISLANDS=139]="COOK_ISLANDS",e[e.CUBA=140]="CUBA",e[e.CURACAO=141]="CURACAO",e[e.DEMOCRATIC_REPUBLIC_OF_THE_CONGO=142]="DEMOCRATIC_REPUBLIC_OF_THE_CONGO",e[e.DJIBOUTI=143]="DJIBOUTI",e[e.DOMINICA=144]="DOMINICA",e[e.EAST_TIMOR=145]="EAST_TIMOR",e[e.EQUATORIAL_GUINEA=146]="EQUATORIAL_GUINEA",e[e.ERITREA=147]="ERITREA",e[e.ETHIOPIA=148]="ETHIOPIA",e[e.FALKLAND_ISLANDS=149]="FALKLAND_ISLANDS",e[e.FAROE_ISLANDS=150]="FAROE_ISLANDS",e[e.FEDERATED_STATES_OF_MICRONESIA=151]="FEDERATED_STATES_OF_MICRONESIA",e[e.FIJI=152]="FIJI",e[e.FRENCH_GUIANA=153]="FRENCH_GUIANA",e[e.FRENCH_POLYNESIA=154]="FRENCH_POLYNESIA",e[e.FRENCH_SOUTHERN_TERRITORIES=155]="FRENCH_SOUTHERN_TERRITORIES",e[e.GABON=156]="GABON",e[e.GAMBIA=157]="GAMBIA",e[e.GIBRALTAR=158]="GIBRALTAR",e[e.GREENLAND=159]="GREENLAND",e[e.GRENADA=160]="GRENADA",e[e.GUADELOUPE=161]="GUADELOUPE",e[e.GUAM=162]="GUAM",e[e.GUINEA=163]="GUINEA",e[e.GUINEA_BISSAU=164]="GUINEA_BISSAU",e[e.GUYANA=165]="GUYANA",e[e.HEARD_ISLAND_AND_MCDONALD_ISLANDS=166]="HEARD_ISLAND_AND_MCDONALD_ISLANDS",e[e.IRAN=167]="IRAN",e[e.IRAQ=168]="IRAQ",e[e.ISLE_OF_MAN=169]="ISLE_OF_MAN",e[e.IVORY_COAST=170]="IVORY_COAST",e[e.JAMAICA=171]="JAMAICA",e[e.KIRIBATI=172]="KIRIBATI",e[e.KYRGYZSTAN=173]="KYRGYZSTAN",e[e.LAOS=174]="LAOS",e[e.LEBANON=175]="LEBANON",e[e.LESOTHO=176]="LESOTHO",e[e.LIBERIA=177]="LIBERIA",e[e.LIBYA=178]="LIBYA",e[e.LIECHTENSTEIN=179]="LIECHTENSTEIN",e[e.MACAU=180]="MACAU",e[e.MADAGASCAR=181]="MADAGASCAR",e[e.MALAWI=182]="MALAWI",e[e.MALI=183]="MALI",e[e.MARSHALL_ISLANDS=184]="MARSHALL_ISLANDS",e[e.MARTINIQUE=185]="MARTINIQUE",e[e.MAURITANIA=186]="MAURITANIA",e[e.MAYOTTE=187]="MAYOTTE",e[e.MOLDOVA=188]="MOLDOVA",e[e.MONACO=189]="MONACO",e[e.MONGOLIA=190]="MONGOLIA",e[e.MONTSERRAT=191]="MONTSERRAT",e[e.MOZAMBIQUE=192]="MOZAMBIQUE",e[e.MYANMAR=193]="MYANMAR",e[e.NAMIBIA=194]="NAMIBIA",e[e.NAURU=195]="NAURU",e[e.NEPAL=196]="NEPAL",e[e.NEW_CALEDONIA=197]="NEW_CALEDONIA",e[e.NIGER=198]="NIGER",e[e.NIUE=199]="NIUE",e[e.NORFOLK_ISLAND=200]="NORFOLK_ISLAND",e[e.NORTHERN_CYPRUS=201]="NORTHERN_CYPRUS",e[e.NORTHERN_MARIANA_ISLANDS=202]="NORTHERN_MARIANA_ISLANDS",e[e.NORTH_KOREA=203]="NORTH_KOREA",e[e.NORTH_MACEDONIA=204]="NORTH_MACEDONIA",e[e.PALAU=205]="PALAU",e[e.PALESTINE=206]="PALESTINE",e[e.PAPUA_NEW_GUINEA=207]="PAPUA_NEW_GUINEA",e[e.PITCAIRN=208]="PITCAIRN",e[e.REUNION=209]="REUNION",e[e.RWANDA=210]="RWANDA",e[e.SAINT_BARTHELEMY=211]="SAINT_BARTHELEMY",e[e.SAINT_HELENA_ASCENSION_AND_TRISTIAN_DA_CUNHA=212]="SAINT_HELENA_ASCENSION_AND_TRISTIAN_DA_CUNHA",e[e.SAINT_KITTS_AND_NEVIS=213]="SAINT_KITTS_AND_NEVIS",e[e.SAINT_LUCIA=214]="SAINT_LUCIA",e[e.SAINT_MARTIN=215]="SAINT_MARTIN",e[e.SAINT_PIERRE_AND_MIQUELON=216]="SAINT_PIERRE_AND_MIQUELON",e[e.SAINT_VINCENT_AND_THE_GRENADINES=217]="SAINT_VINCENT_AND_THE_GRENADINES",e[e.SAMOA=218]="SAMOA",e[e.SAN_MARINO=219]="SAN_MARINO",e[e.SAO_TOME_AND_PRINCIPE=220]="SAO_TOME_AND_PRINCIPE",e[e.SENEGAL=221]="SENEGAL",e[e.SEYCHELLES=222]="SEYCHELLES",e[e.SIERRA_LEONE=223]="SIERRA_LEONE",e[e.SINT_MAARTEN=224]="SINT_MAARTEN",e[e.SOLOMON_ISLANDS=225]="SOLOMON_ISLANDS",e[e.SOMALIA=226]="SOMALIA",e[e.SOUTH_GEORGIA_AND_THE_SOUTH_SANDWICH_ISLANDS=227]="SOUTH_GEORGIA_AND_THE_SOUTH_SANDWICH_ISLANDS",e[e.SOUTH_SUDAN=228]="SOUTH_SUDAN",e[e.SUDAN=229]="SUDAN",e[e.SURINAME=230]="SURINAME",e[e.SVALBARD_AND_JAN_MAYEN=231]="SVALBARD_AND_JAN_MAYEN",e[e.ESWATINI=232]="ESWATINI",e[e.SYRIA=233]="SYRIA",e[e.TAJIKISTAN=234]="TAJIKISTAN",e[e.TANZANIA=235]="TANZANIA",e[e.TOGO=236]="TOGO",e[e.TOKELAU=237]="TOKELAU",e[e.TONGA=238]="TONGA",e[e.TRINIDAD_AND_TOBAGO=239]="TRINIDAD_AND_TOBAGO",e[e.TURKMENISTAN=240]="TURKMENISTAN",e[e.TURKS_AND_CAICOS_ISLANDS=241]="TURKS_AND_CAICOS_ISLANDS",e[e.TUVALU=242]="TUVALU",e[e.UNITED_STATES_MINOR_OUTLYING_ISLANDS=243]="UNITED_STATES_MINOR_OUTLYING_ISLANDS",e[e.UZBEKISTAN=244]="UZBEKISTAN",e[e.VANUATU=245]="VANUATU",e[e.VATICAN_CITY=246]="VATICAN_CITY",e[e.VIRGIN_ISLANDS_BRITISH=247]="VIRGIN_ISLANDS_BRITISH",e[e.VIRGIN_ISLANDS_US=248]="VIRGIN_ISLANDS_US",e[e.WALLIS_AND_FUTUNA=249]="WALLIS_AND_FUTUNA",e[e.WESTERN_SAHARA=250]="WESTERN_SAHARA",e[e.YEMEN=251]="YEMEN",e[e.YUGOSLAVIA=252]="YUGOSLAVIA",e[e.ZAMBIA=253]="ZAMBIA",e[e.ZIMBABWE=254]="ZIMBABWE",e[e.COUNT=255]="COUNT"}(Ge||(Ge={})),function(e){e[e.NONE=0]="NONE",e[e.ALABAMA=1]="ALABAMA",e[e.ALASKA=2]="ALASKA",e[e.ALBERTA=3]="ALBERTA",e[e.ARIZONA=4]="ARIZONA",e[e.ARKANSAS=5]="ARKANSAS",e[e.AUSTRALIAN_CAPITAL_TERRITORY=6]="AUSTRALIAN_CAPITAL_TERRITORY",e[e.BRITISH_COLUMBIA=7]="BRITISH_COLUMBIA",e[e.CALIFORNIA=8]="CALIFORNIA",e[e.COLORADO=9]="COLORADO",e[e.CONNECTICUT=10]="CONNECTICUT",e[e.DELAWARE=11]="DELAWARE",e[e.DISTRICT_OF_COLUMBIA=12]="DISTRICT_OF_COLUMBIA",e[e.FLORIDA=13]="FLORIDA",e[e.GEORGIA=14]="GEORGIA",e[e.HAWAII=15]="HAWAII",e[e.IDAHO=16]="IDAHO",e[e.ILLINOIS=17]="ILLINOIS",e[e.INDIANA=18]="INDIANA",e[e.IOWA=19]="IOWA",e[e.KANSAS=20]="KANSAS",e[e.KENTUCKY=21]="KENTUCKY",e[e.LOUISIANA=22]="LOUISIANA",e[e.MAINE=23]="MAINE",e[e.MANITOBA=24]="MANITOBA",e[e.MARYLAND=25]="MARYLAND",e[e.MASSACHUSETTS=26]="MASSACHUSETTS",e[e.MICHIGAN=27]="MICHIGAN",e[e.MINNESOTA=28]="MINNESOTA",e[e.MISSISSIPPI=29]="MISSISSIPPI",e[e.MISSOURI=30]="MISSOURI",e[e.MONTANA=31]="MONTANA",e[e.NEBRASKA=32]="NEBRASKA",e[e.NEVADA=33]="NEVADA",e[e.NEW_BRUNSWICK=34]="NEW_BRUNSWICK",e[e.NEW_HAMPSHIRE=35]="NEW_HAMPSHIRE",e[e.NEW_JERSEY=36]="NEW_JERSEY",e[e.NEW_MEXICO=37]="NEW_MEXICO",e[e.NEW_SOUTH_WALES=38]="NEW_SOUTH_WALES",e[e.NEW_YORK=39]="NEW_YORK",e[e.NORTHERN_TERRITORY=40]="NORTHERN_TERRITORY",e[e.NORTH_CAROLINA=41]="NORTH_CAROLINA",e[e.NORTH_DAKOTA=42]="NORTH_DAKOTA",e[e.NOVA_SCOTIA=43]="NOVA_SCOTIA",e[e.OHIO=44]="OHIO",e[e.OKLAHOMA=45]="OKLAHOMA",e[e.ONTARIO=46]="ONTARIO",e[e.OREGON=47]="OREGON",e[e.PENNSYLVANIA=48]="PENNSYLVANIA",e[e.QUEBEC=49]="QUEBEC",e[e.QUEENSLAND=50]="QUEENSLAND",e[e.RHODE_ISLAND=51]="RHODE_ISLAND",e[e.SASKATCHEWAN=52]="SASKATCHEWAN",e[e.SOUTH_AUSTRALIA=53]="SOUTH_AUSTRALIA",e[e.SOUTH_CAROLINA=54]="SOUTH_CAROLINA",e[e.SOUTH_DAKOTA=55]="SOUTH_DAKOTA",e[e.TASMANIA=56]="TASMANIA",e[e.TENNESSEE=57]="TENNESSEE",e[e.TEXAS=58]="TEXAS",e[e.UTAH=59]="UTAH",e[e.VERMONT=60]="VERMONT",e[e.VICTORIA=61]="VICTORIA",e[e.VIRGINIA=62]="VIRGINIA",e[e.WASHINGTON=63]="WASHINGTON",e[e.WESTERN_AUSTRALIA=64]="WESTERN_AUSTRALIA",e[e.WEST_VIRGINIA=65]="WEST_VIRGINIA",e[e.WISCONSIN=66]="WISCONSIN",e[e.WYOMING=67]="WYOMING",e[e.YUKON=68]="YUKON",e[e.CIUDAD_DE_MEXICO=69]="CIUDAD_DE_MEXICO",e[e.JALISCO=70]="JALISCO",e[e.NEWFOUNDLAND_AND_LABRADOR=71]="NEWFOUNDLAND_AND_LABRADOR",e[e.NUEVO_LEON=72]="NUEVO_LEON",e[e.BAJA_CALIFORNIA=73]="BAJA_CALIFORNIA",e[e.CHIHUAHUA=74]="CHIHUAHUA",e[e.GUANAJUATO=75]="GUANAJUATO",e[e.GUERRERO=76]="GUERRERO",e[e.MEXICO=77]="MEXICO",e[e.MICHOACAN=78]="MICHOACAN",e[e.NEW_YORK_CITY=79]="NEW_YORK_CITY",e[e.TAMAULIPAS=80]="TAMAULIPAS",e[e.VERACRUZ=81]="VERACRUZ",e[e.CHIAPAS=82]="CHIAPAS",e[e.COAHUILA=83]="COAHUILA",e[e.DURANGO=84]="DURANGO",e[e.GUERRERO_COCULA=85]="GUERRERO_COCULA",e[e.GUERRERO_JUCHITAN=86]="GUERRERO_JUCHITAN",e[e.GUERRERO_TEPECOACUILCO=87]="GUERRERO_TEPECOACUILCO",e[e.GUERRERO_TLACOAPA=88]="GUERRERO_TLACOAPA",e[e.GUJARAT=89]="GUJARAT",e[e.HIDALGO=90]="HIDALGO",e[e.KARNATAKA=91]="KARNATAKA",e[e.KERALA=92]="KERALA",e[e.KHYBER_PAKHTUNKHWA=93]="KHYBER_PAKHTUNKHWA",e[e.MADHYA_PRADESH=94]="MADHYA_PRADESH",e[e.MAHARASHTRA=95]="MAHARASHTRA",e[e.MORELOS=96]="MORELOS",e[e.NAYARIT=97]="NAYARIT",e[e.OAXACA=98]="OAXACA",e[e.PUEBLA=99]="PUEBLA",e[e.PUNJAB=100]="PUNJAB",e[e.QUERETARO=101]="QUERETARO",e[e.SAN_LUIS_POTOSI=102]="SAN_LUIS_POTOSI",e[e.SINALOA=103]="SINALOA",e[e.SONORA=104]="SONORA",e[e.TABASCO=105]="TABASCO",e[e.TAMIL_NADU=106]="TAMIL_NADU",e[e.YUCATAN=107]="YUCATAN",e[e.ZACATECAS=108]="ZACATECAS",e[e.AGUASCALIENTES=109]="AGUASCALIENTES",e[e.BAJA_CALIFORNIA_SUR=110]="BAJA_CALIFORNIA_SUR",e[e.CAMPECHE=111]="CAMPECHE",e[e.COLIMA=112]="COLIMA",e[e.QUINTANA_ROO_BENITO_JUAREZ=113]="QUINTANA_ROO_BENITO_JUAREZ",e[e.UINTANA_ROO=114]="UINTANA_ROO",e[e.QUINTANA_ROO_SOLIDARIDAD=115]="QUINTANA_ROO_SOLIDARIDAD",e[e.TLAXCALA=116]="TLAXCALA",e[e.COUNT=117]="COUNT"}(Ve||(Ve={})),function(e){e[e.NONE=0]="NONE",e[e.CONSULAR_ID=1]="CONSULAR_ID",e[e.DL=2]="DL",e[e.DL_PUBLIC_SERVICES_CARD=3]="DL_PUBLIC_SERVICES_CARD",e[e.EMPLOYMENT_PASS=4]="EMPLOYMENT_PASS",e[e.FIN_CARD=5]="FIN_CARD",e[e.ID=6]="ID",e[e.MULTIPURPOSE_ID=7]="MULTIPURPOSE_ID",e[e.MyKad=8]="MyKad",e[e.MyKid=9]="MyKid",e[e.MyPR=10]="MyPR",e[e.MyTentera=11]="MyTentera",e[e.PAN_CARD=12]="PAN_CARD",e[e.PROFESSIONAL_ID=13]="PROFESSIONAL_ID",e[e.PUBLIC_SERVICES_CARD=14]="PUBLIC_SERVICES_CARD",e[e.RESIDENCE_PERMIT=15]="RESIDENCE_PERMIT",e[e.RESIDENT_ID=16]="RESIDENT_ID",e[e.TEMPORARY_RESIDENCE_PERMIT=17]="TEMPORARY_RESIDENCE_PERMIT",e[e.VOTER_ID=18]="VOTER_ID",e[e.WORK_PERMIT=19]="WORK_PERMIT",e[e.iKAD=20]="iKAD",e[e.MILITARY_ID=21]="MILITARY_ID",e[e.MyKAS=22]="MyKAS",e[e.SOCIAL_SECURITY_CARD=23]="SOCIAL_SECURITY_CARD",e[e.HEALTH_INSURANCE_CARD=24]="HEALTH_INSURANCE_CARD",e[e.PASSPORT=25]="PASSPORT",e[e.S_PASS=26]="S_PASS",e[e.ADDRESS_CARD=27]="ADDRESS_CARD",e[e.ALIEN_ID=28]="ALIEN_ID",e[e.ALIEN_PASSPORT=29]="ALIEN_PASSPORT",e[e.GREEN_CARD=30]="GREEN_CARD",e[e.MINORS_ID=31]="MINORS_ID",e[e.POSTAL_ID=32]="POSTAL_ID",e[e.PROFESSIONAL_DL=33]="PROFESSIONAL_DL",e[e.TAX_ID=34]="TAX_ID",e[e.WEAPON_PERMIT=35]="WEAPON_PERMIT",e[e.VISA=36]="VISA",e[e.BORDER_CROSSING_CARD=37]="BORDER_CROSSING_CARD",e[e.DRIVER_CARD=38]="DRIVER_CARD",e[e.GLOBAL_ENTRY_CARD=39]="GLOBAL_ENTRY_CARD",e[e.MyPolis=40]="MyPolis",e[e.NEXUS_CARD=41]="NEXUS_CARD",e[e.PASSPORT_CARD=42]="PASSPORT_CARD",e[e.PROOF_OF_AGE_CARD=43]="PROOF_OF_AGE_CARD",e[e.REFUGEE_ID=44]="REFUGEE_ID",e[e.TRIBAL_ID=45]="TRIBAL_ID",e[e.VETERAN_ID=46]="VETERAN_ID",e[e.CITIZENSHIP_CERTIFICATE=47]="CITIZENSHIP_CERTIFICATE",e[e.MY_NUMBER_CARD=48]="MY_NUMBER_CARD",e[e.COUNT=49]="COUNT"}(Xe||(Xe={})),function(e){e[e.NotAvailable=0]="NotAvailable",e[e.BlackAndWhite=1]="BlackAndWhite",e[e.Color=2]="Color"}(Se||(Se={})),function(e){e[e.NotAvailable=0]="NotAvailable",e[e.NotDetected=1]="NotDetected",e[e.Detected=2]="Detected"}(Ce||(Ce={})),function(e){e[e.Success=0]="Success",e[e.DetectionFailed=1]="DetectionFailed",e[e.ImagePreprocessingFailed=2]="ImagePreprocessingFailed",e[e.StabilityTestFailed=3]="StabilityTestFailed",e[e.ScanningWrongSide=4]="ScanningWrongSide",e[e.FieldIdentificationFailed=5]="FieldIdentificationFailed",e[e.MandatoryFieldMissing=6]="MandatoryFieldMissing",e[e.InvalidCharactersFound=7]="InvalidCharactersFound",e[e.ImageReturnFailed=8]="ImageReturnFailed",e[e.BarcodeRecognitionFailed=9]="BarcodeRecognitionFailed",e[e.MrzParsingFailed=10]="MrzParsingFailed",e[e.ClassFiltered=11]="ClassFiltered",e[e.UnsupportedClass=12]="UnsupportedClass",e[e.UnsupportedByLicense=13]="UnsupportedByLicense",e[e.AwaitingOtherSide=14]="AwaitingOtherSide",e[e.Count=15]="Count"}(Ne||(Ne={})),function(e){e[e.None=0]="None",e[e.MrzId=1]="MrzId",e[e.MrzVisa=2]="MrzVisa",e[e.MrzPassport=3]="MrzPassport",e[e.PhotoId=4]="PhotoId",e[e.FullRecognition=5]="FullRecognition",e[e.BarcodeId=6]="BarcodeId",e[e.Count=7]="Count"}(Ee||(Ee={})),function(e){e[e.None=0]="None",e[e.AAMVACompliant=1]="AAMVACompliant",e[e.ArgentinaID=2]="ArgentinaID",e[e.ArgentinaAlienID=3]="ArgentinaAlienID",e[e.ArgentinaDL=4]="ArgentinaDL",e[e.ColombiaID=5]="ColombiaID",e[e.ColombiaDL=6]="ColombiaDL",e[e.NigeriaVoterID=7]="NigeriaVoterID",e[e.NigeriaDL=8]="NigeriaDL",e[e.PanamaID=9]="PanamaID",e[e.SouthAfricaID=10]="SouthAfricaID"}(Ye||(Ye={}));var we=function(){function t(e){X(this,t),this.__licenseKey="",this.__engineLocation="",this.__mapperToRealConfig(e),this.__glare=!1,this.__detectionStatus=0,this.__quad={topLeft:{x:0,y:0},topRight:{x:0,y:0},bottomLeft:{x:0,y:0},bottomRight:{x:0,y:0}}}return C(t,[{key:"initializeEngine",value:function(){var e=m(u().mark((function e(){var t,i,n=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(t=new ke(this.__licenseKey)).engineLocation=this.__engineLocation+"/FPhi.Engine.Microblink",t.allowHelloMessage=!1,e.next=6,function(e){return E(this,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,i){if(e&&"object"==typeof e)if("string"==typeof e.licenseKey)if(e.wasmModuleName)if("string"==typeof e.engineLocation){var n,a,l=function(){try{var t=localStorage.getItem("mb-user-id");return null===t&&(t=xe(),localStorage.setItem("mb-user-id",t)),t}catch(e){return xe()}}();try{var r=new Blob([String.raw(s||(n=['!function(){"use strict";\n/*! *****************************************************************************\n    Copyright (c) Microsoft Corporation.\n\n    Permission to use, copy, modify, and/or distribute this software for any\n    purpose with or without fee is hereby granted.\n\n    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n    PERFORMANCE OF THIS SOFTWARE.\n    ***************************************************************************** */function e(e,t,s,n){return new(s||(s=Promise))((function(r,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))}let t=0;class s{constructor(e){this.action=e,this.messageID=function(){const e=t;return t+=1,e}()}}class n extends s{constructor(e,t){super(n.action),this.wasmModuleName=e.wasmModuleName,this.licenseKey=e.licenseKey,this.userId=t,this.registerLoadCallback=null!==e.loadProgressCallback,this.allowHelloMessage=e.allowHelloMessage,this.engineLocation=e.engineLocation,this.wasmType=e.wasmType,this.numberOfWorkers=e.numberOfWorkers}}var r,i;n.action="init",function(e){e[e.Any=0]="Any",e[e.Recognizer=1]="Recognizer",e[e.RecognizerSettings=2]="RecognizerSettings",e[e.Callback=3]="Callback"}(r||(r={}));class o extends s{constructor(e,t){super(o.action),this.funcName=e,this.params=t}}o.action="invokeFunction";class a extends s{constructor(e,t){super(a.action),this.className=e,this.params=t}}a.action="createNewNativeObject";class c extends s{constructor(e,t,s){super(c.action),this.recognizerHandles=e,this.allowMultipleResults=t,this.registeredMetadataCallbacks=s}}c.action="createRecognizerRunner";class E extends s{constructor(e,t){super(E.action),this.recognizerHandles=e,this.allowMultipleResults=t}}E.action="reconfigureRecognizerRunner";class R extends s{constructor(){super(R.action)}}R.action="deleteRecognizerRunner";class l extends s{constructor(e,t,s){super(l.action),this.objectHandle=e,this.methodName=t,this.params=s}}l.action="invokeObject";class _ extends s{constructor(e){super(_.action),this.frame=e}getTransferrables(){return[this.frame.imageData.data.buffer]}}_.action="processImage";class u extends s{constructor(e){super(u.action),this.hardReset=e}}u.action="resetRecognizers";class I extends s{constructor(e){super(I.action),this.registeredMetadataCallbacks=e}}I.action="registerMetadataCallbacks";class d extends s{constructor(e){super(d.action),this.detectionOnlyMode=e}}d.action="setDetectionOnly";class N extends s{constructor(e){super(N.action),this.callbackNonEmpty=e}}N.action="setClearTimeoutCallback";class O extends s{constructor(e){super(O.action),this.cameraPreviewMirrored=e}}O.action="setCameraPreviewMirrored";class h extends s{constructor(e){super(h.action),this.userId=e}}h.action="getProductIntegrationInfo";class S{constructor(e,t,s){this.success=!0,this.error=null,this.messageID=e,this.success=t,this.error=s}}class g{constructor(e,t,s,n){this.success=!0,this.showOverlay=!0,this.messageID=e,this.success=t,this.showOverlay=s,this.wasmType=n}}class C extends S{constructor(e,t){super(e,!0,null),this.result=t}}class m extends S{constructor(e,t){super(e,!0,null),this.objectHandle=t}}class A extends S{constructor(e,t){super(e,!0,null),this.recognitionState=t}}class D extends S{constructor(e,t){super(e,!0,null),this.result=t}}class f{constructor(e){this.isLoadProgressMessage=!0,this.progress=e}}!function(e){e[e.onDebugText=0]="onDebugText",e[e.onDetectionFailed=1]="onDetectionFailed",e[e.onQuadDetection=2]="onQuadDetection",e[e.onPointsDetection=3]="onPointsDetection",e[e.onFirstSideResult=4]="onFirstSideResult",e[e.clearTimeoutCallback=5]="clearTimeoutCallback",e[e.onGlare=6]="onGlare",e[e.recognizerCallback=7]="recognizerCallback"}(i||(i={}));class M{constructor(e,t){this.isCallbackMessage=!0,this.callbackType=e,this.callbackParameters=t}}function T(e,t){return t=t||"",""===(e=e||"")?t:e.endsWith("/")?t.startsWith("/")?e+t.substring(1):e+t:t.startsWith("/")?e+t:e+"/"+t}var p,L,w;function y(t){return e(this,void 0,void 0,(function*(){const e=yield(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])))(),s=yield(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,12,1,10,0,67,0,0,0,0,252,0,26,11])))(),n=yield(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,65,0,192,26,11])))(),r=yield(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])))(),i=yield(async e=>{try{return"undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch(e){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]));if(!(e&&s&&n&&r))return p.Basic;if(!i)return p.Advanced;try{return new Worker(t+"/Worker.test.js").terminate(),p.AdvancedWithThreads}catch(e){return p.Advanced}}))}!function(e){e.Basic="BASIC",e.Advanced="ADVANCED",e.AdvancedWithThreads="ADVANCED_WITH_THREADS"}(p||(p={}));class U{constructor(e,t){if(!e.code||!e.message)throw Error("Instance of SDKError is required to have code and message.");this.message=e.message,this.code=e.code,this.details=t}}!function(e){e.WORKER_WASM_LOAD_FAILURE="WORKER_WASM_LOAD_FAILURE",e.WORKER_WASM_INIT_MISSING="WORKER_WASM_INIT_MISSING",e.WORKER_FUNCTION_INVOKE_FAILURE="WORKER_FUNCTION_INVOKE_FAILURE",e.WORKER_RECOGNIZER_CREATION_FAILURE="WORKER_RECOGNIZER_CREATION_FAILURE",e.WORKER_RUNNER_EXISTS="WORKER_RUNNER_EXISTS",e.WORKER_RUNNER_CREATION_FAILURE="WORKER_RUNNER_CREATION_FAILURE",e.WORKER_RUNNER_MISSING="WORKER_RUNNER_MISSING",e.WORKER_RUNNER_RECONFIGURE_FAILURE="WORKER_RUNNER_RECONFIGURE_FAILURE",e.WORKER_RUNNER_DELETED="WORKER_RUNNER_DELETED",e.WORKER_RUNNER_DELETE_FAILURE="WORKER_RUNNER_DELETE_FAILURE",e.WORKER_OBJECT_INVOKE_FAILURE="WORKER_OBJECT_INVOKE_FAILURE",e.WORKER_IMAGE_PROCESS_FAILURE="WORKER_IMAGE_PROCESS_FAILURE",e.WORKER_HANDLE_UNDEFINED="WORKER_HANDLE_UNDEFINED",e.WORKER_MESSAGE_ACTION_UNKNOWN="WORKER_MESSAGE_ACTION_UNKNOWN",e.WORKER_LICENSE_UNLOCK_ERROR="WORKER_LICENSE_UNLOCK_ERROR",e.WORKER_INTEGRATION_INFO_FAILURE="WORKER_INTEGRATION_INFO_FAILURE",e.LOCAL_SDK_RUNNER_MISSING="LOCAL_SDK_RUNNER_MISSING",e.LOCAL_SDK_RUNNER_EMPTY="LOCAL_SDK_RUNNER_EMPTY",e.LICENSE_UNLOCK_ERROR="LICENSE_UNLOCK_ERROR",e.FRAME_CAPTURE_SVG_UNSUPPORTED="FRAME_CAPTURE_SVG_UNSUPPORTED",e.FRAME_CAPTURE_CANVAS_MISSING="FRAME_CAPTURE_CANVAS_MISSING",e.SDK_WASM_SETTINGS_MISSING="SDK_WASM_SETTINGS_MISSING",e.SDK_LICENSE_KEY_MISSING="SDK_LICENSE_KEY_MISSING",e.SDK_WASM_MODULE_NAME_MISSING="SDK_WASM_MODULE_NAME_MISSING",e.SDK_ENGINE_LOCATION_INVALID="SDK_ENGINE_LOCATION_INVALID",e.SDK_MISSING="SDK_MISSING",e.SDK_RECOGNIZERS_MISSING="SDK_RECOGNIZERS_MISSING",e.VIDEO_RECOGNIZER_ELEMENT_MISSING="VIDEO_RECOGNIZER_ELEMENT_MISSING",e.VIDEO_RECOGNIZER_CAMERA_MISSING="VIDEO_RECOGNIZER_CAMERA_MISSING",e.VIDEO_RECOGNIZER_CAMERA_NOT_ALLOWED="VIDEO_RECOGNIZER_CAMERA_NOT_ALLOWED",e.VIDEO_RECOGNIZER_CAMERA_UNAVAILABLE="VIDEO_RECOGNIZER_CAMERA_UNAVAILABLE",e.VIDEO_RECOGNIZER_CAMERA_IN_USE="VIDEO_RECOGNIZER_CAMERA_IN_USE",e.VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED="VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED",e.VIDEO_RECOGNIZER_FEED_RELEASED="VIDEO_RECOGNIZER_FEED_RELEASED",e.VIDEO_RECOGNIZER_FEED_NOT_PAUSED="VIDEO_RECOGNIZER_FEED_NOT_PAUSED",e.VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED="VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED",e.VIDEO_RECOGNIZER_FEED_PAUSED="VIDEO_RECOGNIZER_FEED_PAUSED",e.VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE="VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE",e.VIDEO_RECOGNIZER_FEED_MISSING="VIDEO_RECOGNIZER_FEED_MISSING"}(L||(L={})),function(e){e.WORKER_HANDLE_UNDEFINED="Cannot find object with handle: undefined",e.WORKER_WASM_LOAD_FAILURE="Failed to load WASM in web worker!",e.WORKER_WASM_INIT_MISSING="WASM module is not initialized!",e.WORKER_FUNCTION_INVOKE_FAILURE="Failed to invoke function!",e.WORKER_RECOGNIZER_CREATION_FAILURE="Failed to create new recognizer!",e.WORKER_RUNNER_EXISTS="Recognizer runner is already created! Multiple instances are not allowed!",e.WORKER_RUNNER_CREATION_FAILURE="Failed to create new recognizer runner!",e.WORKER_RUNNER_MISSING="Recognizer runner is not created! There is nothing to reconfigure!",e.WORKER_RUNNER_RECONFIGURE_FAILURE="Failed to reconfigure recognizer runner!",e.WORKER_RUNNER_DELETED="Recognizer runner is already deleted!",e.WORKER_RUNNER_DELETE_FAILURE="Failed to delete recognizer runner!",e.WORKER_OBJECT_INVOKE_FAILURE="Failed to invoke object!",e.WORKER_IMAGE_PROCESS_FAILURE="Recognizer runner is not initialized! Cannot process image!",e.WORKER_INTEGRATION_INFO_FAILURE="Failed to get product integration info!",e.LOCAL_SDK_RUNNER_MISSING="Property nativeRecognizerRunner is not available!",e.LOCAL_SDK_RUNNER_EMPTY="Native RecognizerRunner cannot be empty!",e.LICENSE_TOKEN_STATE_INCORRECT="Internal error (Incorrect token state)",e.LICENSE_PAYLOAD_VERIFICATION_FAILED="Failed to verify server permission\'s digital signature!",e.LICENSE_PAYLOAD_CORRUPTED="Server permission payload is corrupted!",e.LICENSE_PERMISSION_EXPIRED="Internal error (server permission expired)",e.LICENSE_REMOTE_LOCKED="Provided license key has been remotely locked. Please contact support for more information!",e.FRAME_CAPTURE_SVG_UNSUPPORTED="Recognition of SVG elements not supported!",e.FRAME_CAPTURE_CANVAS_MISSING="Could not get canvas 2d context!",e.SDK_WASM_SETTINGS_MISSING="Missing WASM load settings!",e.SDK_LICENSE_KEY_MISSING="Missing license key!",e.SDK_WASM_MODULE_NAME_MISSING="Missing WASM module name!",e.SDK_ENGINE_LOCATION_INVALID="Setting property \'engineLocation\' must be a string!",e.SDK_MISSING="SDK is not provided!",e.SDK_RECOGNIZERS_MISSING="To create RecognizerRunner at least 1 recognizer is required.",e.VIDEO_RECOGNIZER_ELEMENT_MISSING="Video element, i.e. camera feed is not provided!",e.VIDEO_RECOGNIZER_CAMERA_MISSING="Camera not found!",e.VIDEO_RECOGNIZER_CAMERA_NOT_ALLOWED="Camera not allowed!",e.VIDEO_RECOGNIZER_CAMERA_UNAVAILABLE="Camera not available!",e.VIDEO_RECOGNIZER_CAMERA_IN_USE="Camera in use!",e.VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED="Media devices not supported by browser.",e.VIDEO_RECOGNIZER_FEED_RELEASED="The associated video feed has been released!",e.VIDEO_RECOGNIZER_FEED_NOT_PAUSED="The associated video feed is not paused. Use resumeRecognition instead!",e.VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED="The play() request was interrupted or prevented by browser security rules!",e.VIDEO_RECOGNIZER_FEED_PAUSED="Cannot resume recognition while video feed is paused! Use recognize or startRecognition",e.VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE="Could not reset recognizers!",e.VIDEO_RECOGNIZER_FEED_MISSING="Missing video feed!"}(w||(w={}));const F={licenseTokenStateIncorrect:{code:L.LICENSE_UNLOCK_ERROR,message:w.LICENSE_TOKEN_STATE_INCORRECT},licensePayloadVerificationFailed:{code:L.LICENSE_UNLOCK_ERROR,message:w.LICENSE_PAYLOAD_VERIFICATION_FAILED},licensePayloadCorrupted:{code:L.LICENSE_UNLOCK_ERROR,message:w.LICENSE_PAYLOAD_CORRUPTED},licensePermissionExpired:{code:L.LICENSE_UNLOCK_ERROR,message:w.LICENSE_PERMISSION_EXPIRED},licenseRemoteLocked:{code:L.LICENSE_UNLOCK_ERROR,message:w.LICENSE_REMOTE_LOCKED},licenseNetworkError:{code:L.LICENSE_UNLOCK_ERROR},licenseInvalid:{code:L.LICENSE_UNLOCK_ERROR}},b={imageProcessFailure:{message:w.WORKER_IMAGE_PROCESS_FAILURE,code:L.WORKER_IMAGE_PROCESS_FAILURE},objectInvokeFailure:{message:w.WORKER_OBJECT_INVOKE_FAILURE,code:L.WORKER_OBJECT_INVOKE_FAILURE},runnerDeleteFailure:{message:w.WORKER_RUNNER_DELETE_FAILURE,code:L.WORKER_RUNNER_DELETE_FAILURE},runnerDeleted:{message:w.WORKER_RUNNER_DELETED,code:L.WORKER_RUNNER_DELETED},runnerReconfigureFailure:{message:w.WORKER_RUNNER_RECONFIGURE_FAILURE,code:L.WORKER_RUNNER_RECONFIGURE_FAILURE},runnerMissing:{message:w.WORKER_RUNNER_MISSING,code:L.WORKER_RUNNER_MISSING},runnerCreationFailure:{message:w.WORKER_RUNNER_CREATION_FAILURE,code:L.WORKER_RUNNER_CREATION_FAILURE},runnerExists:{message:w.WORKER_RUNNER_EXISTS,code:L.WORKER_RUNNER_EXISTS},recognizerCreationFailure:{message:w.WORKER_RECOGNIZER_CREATION_FAILURE,code:L.WORKER_RECOGNIZER_CREATION_FAILURE},functionInvokeFailure:{message:w.WORKER_FUNCTION_INVOKE_FAILURE,code:L.WORKER_FUNCTION_INVOKE_FAILURE},wasmInitMissing:{message:w.WORKER_WASM_INIT_MISSING,code:L.WORKER_WASM_INIT_MISSING},wasmLoadFailure:{message:w.WORKER_WASM_LOAD_FAILURE,code:L.WORKER_WASM_LOAD_FAILURE},handleUndefined:{message:w.WORKER_HANDLE_UNDEFINED,code:L.WORKER_HANDLE_UNDEFINED},integrationInfoFailure:{message:w.WORKER_INTEGRATION_INFO_FAILURE,code:L.WORKER_INTEGRATION_INFO_FAILURE}};var k,K;!function(e){e[e.Invalid=0]="Invalid",e[e.RequiresServerPermission=1]="RequiresServerPermission",e[e.Valid=2]="Valid"}(k||(k={})),function(e){e.LicenseTokenStateInvalid="LICENSE_TOKEN_STATE_INVALID",e.NetworkError="NETWORK_ERROR",e.RemoteLock="REMOTE_LOCK",e.PermissionExpired="PERMISSION_EXPIRED",e.PayloadCorrupted="PAYLOAD_CORRUPTED",e.PayloadSignatureVerificationFailed="PAYLOAD_SIGNATURE_VERIFICATION_FAILED",e.IncorrectTokenState="INCORRECT_TOKEN_STATE"}(K||(K={}));function v(e){return{licenseId:e.licenseId,licensee:e.licensee,packageName:e.packageName,platform:"Browser",sdkName:e.sdkName,sdkVersion:e.sdkVersion}}var P;function W(t,s){return e(this,void 0,void 0,(function*(){try{const e=yield fetch("https://baltazar.microblink.com/api/v1/status/check",{method:"POST",headers:{"Content-Type":"application/json"},cache:"no-cache",body:JSON.stringify(v(t))});if(e.ok){const t=""+(yield e.text());return s.submitServerPermission(t)}return{status:P.NetworkError,lease:0,networkErrorDescription:"Server responded with status "+e.status}}catch(e){return{status:P.NetworkError,lease:0,networkErrorDescription:"Unexpected error: "+JSON.stringify(e)}}}))}function G(e){return e===p.AdvancedWithThreads}!function(e){e[e.Ok=0]="Ok",e[e.NetworkError=1]="NetworkError",e[e.RemoteLock=2]="RemoteLock",e[e.PermissionExpired=3]="PermissionExpired",e[e.PayloadCorrupted=4]="PayloadCorrupted",e[e.PayloadSignatureVerificationFailed=5]="PayloadSignatureVerificationFailed",e[e.IncorrectTokenState=6]="IncorrectTokenState"}(P||(P={}));new class{constructor(){this.context=self,this.wasmModule=null,this.nativeRecognizerRunner=null,this.objects={},this.nextObjectHandle=0,this.metadataCallbacks={},this.clearTimeoutCallback=null,this.context.onmessage=e=>{const t=e.data;switch(t.action){case n.action:this.processInitMessage(t);break;case o.action:this.processInvokeFunction(t);break;case a.action:this.processCreateNewRecognizer(t);break;case l.action:this.processInvokeObject(t);break;case c.action:this.processCreateRecognizerRunner(t);break;case E.action:this.processReconfigureRecognizerRunner(t);break;case R.action:this.processDeleteRecognizerRunner(t);break;case _.action:this.processImage(t);break;case u.action:this.resetRecognizers(t);break;case d.action:this.setDetectionOnly(t);break;case O.action:this.setCameraPreviewMirrored(t);break;case I.action:this.registerMetadataCallbacks(t);break;case N.action:this.registerClearTimeoutCallback(t);break;case h.action:this.processGetProductIntegrationInfo(t);break;default:throw new U({code:L.WORKER_MESSAGE_ACTION_UNKNOWN,message:"Unknown message action: "+JSON.stringify(t.action)})}}}getNextObjectHandle(){const e=this.nextObjectHandle;return this.nextObjectHandle=this.nextObjectHandle+1,e}notifyError(e,t){this.context.postMessage(new S(e.messageID,!1,t))}notifySuccess(e){this.context.postMessage(new S(e.messageID,!0,null))}notifyInitSuccess(e,t,s){this.context.postMessage(new g(e.messageID,!0,t,s))}unwrapParameters(e){const t=[];for(const s of e.params){let n=s.parameter;s.type===r.Recognizer?(n=this.objects[n],void 0===n&&this.notifyError(e,new U(b.handleUndefined))):s.type===r.RecognizerSettings&&(n=this.restoreFunctions(n)),t.push(n)}return t}restoreFunctions(e){const t=Object.keys(e);for(const s of t){const t=e[s];"object"==typeof t&&null!==t&&"parameter"in t&&"type"in t&&t.type===r.Callback&&(e[s]=(...e)=>{const s=new M(i.recognizerCallback,[t.parameter].concat(e));this.context.postMessage(s)})}return e}scanForTransferrables(e){if("object"==typeof e){const t=Object.keys(e),s=[];for(const n of t){const t=e[n];t instanceof ImageData?s.push(t.data.buffer):t instanceof Uint8Array?s.push(t.buffer):null!==t&&"object"==typeof t&&s.push(...this.scanForTransferrables(t))}return s}return[]}registerHeartBeat(e){this.unregisterHeartBeat(),this.lease=e;let t=e-Math.floor(Date.now()/1e3);t>120?t-=120:t/=2,this.inFlightHeartBeatTimeoutId=setTimeout((()=>{this.obtainNewServerPermission(!0)}),1e3*t)}unregisterHeartBeat(){this.lease&&delete this.lease,this.inFlightHeartBeatTimeoutId&&(clearTimeout(this.inFlightHeartBeatTimeoutId),delete this.inFlightHeartBeatTimeoutId)}obtainNewServerPermission(t){return e(this,void 0,void 0,(function*(){if(this.wasmModule){const e=this.wasmModule.getActiveLicenseTokenInfo(),s=yield W(e,this.wasmModule);switch(s.status){case P.Ok:case P.RemoteLock:this.registerHeartBeat(s.lease);break;case P.NetworkError:case P.PayloadSignatureVerificationFailed:case P.PayloadCorrupted:t?(console.warn("Problem with obtaining server permission. Will attempt in 10 seconds "+P[s.status]),this.inFlightHeartBeatTimeoutId=setTimeout((()=>{this.obtainNewServerPermission(!1)}),1e4)):console.error("Problem with obtaining server permission. "+P[s.status]);break;case P.IncorrectTokenState:case P.PermissionExpired:console.error("Internal error: "+P[s.status])}return s.status}return console.error("Internal inconsistency! Wasm module not initialized where it\'s expected to be!"),P.IncorrectTokenState}))}willSoonExpire(){if(this.lease){if(this.wasmModule.getActiveLicenseTokenInfo().unlockResult===k.Valid){const e=Math.floor(Date.now()/1e3);return 30>this.lease-e}return!0}return!1}calculateWasmType(t){return e(this,void 0,void 0,(function*(){return null!==t.wasmType?t.wasmType:yield y(t.engineLocation)}))}calculateEngineLocationPrefix(e,t){const s=T(""===e.engineLocation?self.location.origin:e.engineLocation,function(e){switch(e){case p.AdvancedWithThreads:return"advanced-threads";case p.Advanced:return"advanced";case p.Basic:return"basic"}}(t));return e.allowHelloMessage&&console.log("Engine location prefix is:",s),s}processInitMessage(t){return e(this,void 0,void 0,(function*(){const s=yield this.calculateWasmType(t),n=this.calculateEngineLocationPrefix(t,s);let r={locateFile:e=>T(n,e)};t.registerLoadCallback&&(r=Object.assign(r,{setStatus:e=>{const t=new f(function(e){if("Running..."===e)return 100;if(0===e.length)return 0;const t=/([^(]+)((d+(.d+)?)/(d+))/.exec(e);if(t)return 100*parseInt(t[2])/parseInt(t[4]);return NaN}(e));this.context.postMessage(t)}}));try{const i=T(n,t.wasmModuleName+".js");G(s)&&(r=function(e,t,s){return t&&t>0&&(e=Object.assign(e,{allowedThreads:t})),null!==s&&(e=Object.assign(e,{mainScriptUrlOrBlob:s})),e}(r,t.numberOfWorkers,i)),importScripts(i);(0,self[t.wasmModuleName])(r).then((n=>e(this,void 0,void 0,(function*(){G(s)&&(t.allowHelloMessage&&console.log("Waiting for thread workers to boot..."),yield function(t){return e(this,void 0,void 0,(function*(){t.threadWorkersReadyPromise&&(yield t.threadWorkersReadyPromise)}))}(n));const r=yield function(t,s,n,r){return e(this,void 0,void 0,(function*(){const e=r.initializeWithLicenseKey(t,n,s);switch(e.unlockResult){case k.Invalid:return{error:new U(Object.assign(Object.assign({},F.licenseInvalid),{message:e.licenseError}),{type:K.LicenseTokenStateInvalid})};case k.Valid:return{error:null,showOverlay:(i=e.isTrial,o=e.allowRemoveDemoOverlay,a=e.allowRemoveProductionOverlay,!(i&&o||!i&&a))};case k.RequiresServerPermission:{const t=yield W(e,r);switch(t.status){case P.Ok:return{error:null,lease:t.lease};case P.NetworkError:{let e="";return t.networkErrorDescription&&(e=" "+t.networkErrorDescription),{error:new U(Object.assign(Object.assign({},F.licenseNetworkError),{message:"There has been a network error while obtaining the server permission!"+e}),{type:K.NetworkError})}}case P.RemoteLock:return{error:new U(F.licenseRemoteLocked,{type:K.RemoteLock}),lease:t.lease};case P.PermissionExpired:return{error:new U(F.licensePermissionExpired,{type:K.PermissionExpired}),lease:t.lease};case P.PayloadCorrupted:return{error:new U(F.licensePayloadCorrupted,{type:K.PayloadCorrupted}),lease:t.lease};case P.PayloadSignatureVerificationFailed:return{error:new U(F.licensePayloadVerificationFailed,{type:K.PayloadSignatureVerificationFailed}),lease:t.lease};case P.IncorrectTokenState:return{error:new U(F.licenseTokenStateIncorrect,{type:K.IncorrectTokenState}),lease:t.lease}}}}var i,o,a}))}(t.licenseKey,t.allowHelloMessage,t.userId,n);null===r.error?(this.wasmModule=n,r.lease?this.registerHeartBeat(r.lease):this.unregisterHeartBeat(),this.notifyInitSuccess(t,!!r.showOverlay,s)):this.notifyError(t,r.error)}))),(e=>{this.notifyError(t,new U(b.wasmLoadFailure,e))}))}catch(e){this.notifyError(t,new U(b.wasmLoadFailure,e))}}))}processInvokeFunction(e){if(null===this.wasmModule)return void this.notifyError(e,new U(b.wasmInitMissing));const t=e.funcName,s=this.unwrapParameters(e);try{const n=this.wasmModule[t](...s);this.context.postMessage(new C(e.messageID,n))}catch(t){this.notifyError(e,new U(b.functionInvokeFailure,t))}}processCreateNewRecognizer(e){if(null===this.wasmModule)return void this.notifyError(e,new U(b.wasmInitMissing));const t=e.className,s=this.unwrapParameters(e);try{const n=new this.wasmModule[t](...s),r=this.getNextObjectHandle();this.objects[r]=n,this.context.postMessage(new m(e.messageID,r))}catch(t){this.notifyError(e,new U(b.recognizerCreationFailure,t))}}getRecognizers(e){const t=[];for(const s of e){t.push(this.objects[s])}return t}processCreateRecognizerRunner(t){return e(this,void 0,void 0,(function*(){if(null===this.wasmModule)this.notifyError(t,new U(b.wasmInitMissing));else if(null!==this.nativeRecognizerRunner)this.notifyError(t,new U(b.runnerExists));else{this.setupMetadataCallbacks(t.registeredMetadataCallbacks);try{if(this.willSoonExpire()){const e=yield this.obtainNewServerPermission(!1);if(e!==P.Ok){const s=P[e];return void this.notifyError(t,new U({code:L.WORKER_LICENSE_UNLOCK_ERROR,message:"Cannot initialize recognizers because of invalid server permission: \n                                    "+s},{type:K[s]}))}}const e=this.getRecognizers(t.recognizerHandles);this.nativeRecognizerRunner=new this.wasmModule.RecognizerRunner(e,t.allowMultipleResults,this.metadataCallbacks),this.notifySuccess(t)}catch(e){this.notifyError(t,new U(b.runnerCreationFailure,e))}}}))}processReconfigureRecognizerRunner(e){if(null===this.wasmModule)this.notifyError(e,new U(b.wasmInitMissing));else if(null===this.nativeRecognizerRunner)this.notifyError(e,new U(b.runnerMissing));else try{const t=this.getRecognizers(e.recognizerHandles);this.nativeRecognizerRunner.reconfigureRecognizers(t,e.allowMultipleResults),this.notifySuccess(e)}catch(t){this.notifyError(e,new U(b.runnerReconfigureFailure,t))}}processDeleteRecognizerRunner(e){if(null!==this.nativeRecognizerRunner)try{this.nativeRecognizerRunner.delete(),this.nativeRecognizerRunner=null,this.notifySuccess(e)}catch(t){this.notifyError(e,new U(b.runnerDeleteFailure,t))}else this.notifyError(e,new U(b.runnerDeleted))}wrapFunctions(e,t){if("object"!=typeof e)return e;const s=Object.assign({},e),n=Object.keys(s);for(const e of n){if("function"==typeof s[e]){s[e]={parameter:{recognizerHandle:t,callbackName:e},type:r.Callback}}}return s}processInvokeObject(e){try{const t=e.objectHandle,s=e.methodName,n=this.unwrapParameters(e),r=this.objects[t];if(void 0===r)this.notifyError(e,new U({message:"Cannot find object with handle: "+t,code:L.WORKER_HANDLE_UNDEFINED}));else{const i=this.wrapFunctions(r[s](...n),t),o=this.scanForTransferrables(i);"delete"===s&&delete this.objects[t],this.context.postMessage(new C(e.messageID,i),o)}}catch(t){this.notifyError(e,new U(b.objectInvokeFailure,t))}}processImage(e){if(null!==this.nativeRecognizerRunner)try{const t=this.nativeRecognizerRunner.processImage(e.frame);this.context.postMessage(new A(e.messageID,t))}catch(t){this.notifyError(e,new U(b.imageProcessFailure,t))}else this.notifyError(e,new U(b.imageProcessFailure))}resetRecognizers(e){if(null!==this.nativeRecognizerRunner)try{this.nativeRecognizerRunner.resetRecognizers(e.hardReset),this.notifySuccess(e)}catch(t){this.notifyError(e,new U(b.imageProcessFailure,t))}else this.notifyError(e,new U(b.imageProcessFailure))}setDetectionOnly(e){if(null!==this.nativeRecognizerRunner)try{this.nativeRecognizerRunner.setDetectionOnlyMode(e.detectionOnlyMode),this.notifySuccess(e)}catch(t){this.notifyError(e,new U(b.imageProcessFailure,t))}else this.notifyError(e,new U(b.imageProcessFailure))}setCameraPreviewMirrored(e){if(null!==this.nativeRecognizerRunner)try{this.nativeRecognizerRunner.setCameraPreviewMirrored(e.cameraPreviewMirrored),this.notifySuccess(e)}catch(t){this.notifyError(e,new U(b.imageProcessFailure,t))}else this.notifyError(e,new U(b.imageProcessFailure))}setupMetadataCallbacks(e){e.onDebugText?this.metadataCallbacks.onDebugText=e=>{const t=new M(i.onDebugText,[e]);this.context.postMessage(t)}:delete this.metadataCallbacks.onDebugText,e.onDetectionFailed?this.metadataCallbacks.onDetectionFailed=()=>{const e=new M(i.onDetectionFailed,[]);this.context.postMessage(e)}:delete this.metadataCallbacks.onDetectionFailed,e.onPointsDetection?this.metadataCallbacks.onPointsDetection=e=>{const t=new M(i.onPointsDetection,[e]);this.context.postMessage(t)}:delete this.metadataCallbacks.onPointsDetection,e.onQuadDetection?this.metadataCallbacks.onQuadDetection=e=>{const t=new M(i.onQuadDetection,[e]);this.context.postMessage(t)}:delete this.metadataCallbacks.onQuadDetection,e.onFirstSideResult?this.metadataCallbacks.onFirstSideResult=()=>{const e=new M(i.onFirstSideResult,[]);this.context.postMessage(e)}:delete this.metadataCallbacks.onFirstSideResult,e.onGlare?this.metadataCallbacks.onGlare=e=>{const t=new M(i.onGlare,[e]);this.context.postMessage(t)}:delete this.metadataCallbacks.onGlare}registerMetadataCallbacks(e){if(null!==this.nativeRecognizerRunner){this.setupMetadataCallbacks(e.registeredMetadataCallbacks);try{this.nativeRecognizerRunner.setJSDelegate(this.metadataCallbacks),this.notifySuccess(e)}catch(t){this.notifyError(e,new U(b.imageProcessFailure,t))}}else this.notifyError(e,new U(b.imageProcessFailure))}registerClearTimeoutCallback(e){if(null!==this.nativeRecognizerRunner){this.clearTimeoutCallback=e.callbackNonEmpty?{onClearTimeout:()=>{const e=new M(i.clearTimeoutCallback,[]);this.context.postMessage(e)}}:null;try{this.nativeRecognizerRunner.setClearTimeoutCallback(this.clearTimeoutCallback),this.notifySuccess(e)}catch(t){this.notifyError(e,new U(b.imageProcessFailure,t))}}else this.notifyError(e,new U(b.imageProcessFailure))}processGetProductIntegrationInfo(e){if(null!==this.wasmModule)try{const t=this.wasmModule.getActiveLicenseTokenInfo(),s={userId:e.userId,licenseId:t.licenseId,licensee:t.licensee,productName:t.sdkName,productVersion:t.sdkVersion,platform:"Browser",device:self.navigator.userAgent,packageName:t.packageName};this.context.postMessage(new D(e.messageID,s))}catch(t){this.notifyError(e,new U(b.objectInvokeFailure,t))}else this.notifyError(e,new U(b.wasmInitMissing))}}}();\n'],a=['!function(){"use strict";\n/*! *****************************************************************************\n    Copyright (c) Microsoft Corporation.\n\n    Permission to use, copy, modify, and/or distribute this software for any\n    purpose with or without fee is hereby granted.\n\n    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n    PERFORMANCE OF THIS SOFTWARE.\n    ***************************************************************************** */function e(e,t,s,n){return new(s||(s=Promise))((function(r,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))}let t=0;class s{constructor(e){this.action=e,this.messageID=function(){const e=t;return t+=1,e}()}}class n extends s{constructor(e,t){super(n.action),this.wasmModuleName=e.wasmModuleName,this.licenseKey=e.licenseKey,this.userId=t,this.registerLoadCallback=null!==e.loadProgressCallback,this.allowHelloMessage=e.allowHelloMessage,this.engineLocation=e.engineLocation,this.wasmType=e.wasmType,this.numberOfWorkers=e.numberOfWorkers}}var r,i;n.action="init",function(e){e[e.Any=0]="Any",e[e.Recognizer=1]="Recognizer",e[e.RecognizerSettings=2]="RecognizerSettings",e[e.Callback=3]="Callback"}(r||(r={}));class o extends s{constructor(e,t){super(o.action),this.funcName=e,this.params=t}}o.action="invokeFunction";class a extends s{constructor(e,t){super(a.action),this.className=e,this.params=t}}a.action="createNewNativeObject";class c extends s{constructor(e,t,s){super(c.action),this.recognizerHandles=e,this.allowMultipleResults=t,this.registeredMetadataCallbacks=s}}c.action="createRecognizerRunner";class E extends s{constructor(e,t){super(E.action),this.recognizerHandles=e,this.allowMultipleResults=t}}E.action="reconfigureRecognizerRunner";class R extends s{constructor(){super(R.action)}}R.action="deleteRecognizerRunner";class l extends s{constructor(e,t,s){super(l.action),this.objectHandle=e,this.methodName=t,this.params=s}}l.action="invokeObject";class _ extends s{constructor(e){super(_.action),this.frame=e}getTransferrables(){return[this.frame.imageData.data.buffer]}}_.action="processImage";class u extends s{constructor(e){super(u.action),this.hardReset=e}}u.action="resetRecognizers";class I extends s{constructor(e){super(I.action),this.registeredMetadataCallbacks=e}}I.action="registerMetadataCallbacks";class d extends s{constructor(e){super(d.action),this.detectionOnlyMode=e}}d.action="setDetectionOnly";class N extends s{constructor(e){super(N.action),this.callbackNonEmpty=e}}N.action="setClearTimeoutCallback";class O extends s{constructor(e){super(O.action),this.cameraPreviewMirrored=e}}O.action="setCameraPreviewMirrored";class h extends s{constructor(e){super(h.action),this.userId=e}}h.action="getProductIntegrationInfo";class S{constructor(e,t,s){this.success=!0,this.error=null,this.messageID=e,this.success=t,this.error=s}}class g{constructor(e,t,s,n){this.success=!0,this.showOverlay=!0,this.messageID=e,this.success=t,this.showOverlay=s,this.wasmType=n}}class C extends S{constructor(e,t){super(e,!0,null),this.result=t}}class m extends S{constructor(e,t){super(e,!0,null),this.objectHandle=t}}class A extends S{constructor(e,t){super(e,!0,null),this.recognitionState=t}}class D extends S{constructor(e,t){super(e,!0,null),this.result=t}}class f{constructor(e){this.isLoadProgressMessage=!0,this.progress=e}}!function(e){e[e.onDebugText=0]="onDebugText",e[e.onDetectionFailed=1]="onDetectionFailed",e[e.onQuadDetection=2]="onQuadDetection",e[e.onPointsDetection=3]="onPointsDetection",e[e.onFirstSideResult=4]="onFirstSideResult",e[e.clearTimeoutCallback=5]="clearTimeoutCallback",e[e.onGlare=6]="onGlare",e[e.recognizerCallback=7]="recognizerCallback"}(i||(i={}));class M{constructor(e,t){this.isCallbackMessage=!0,this.callbackType=e,this.callbackParameters=t}}function T(e,t){return t=t||"",""===(e=e||"")?t:e.endsWith("/")?t.startsWith("/")?e+t.substring(1):e+t:t.startsWith("/")?e+t:e+"/"+t}var p,L,w;function y(t){return e(this,void 0,void 0,(function*(){const e=yield(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])))(),s=yield(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,12,1,10,0,67,0,0,0,0,252,0,26,11])))(),n=yield(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,65,0,192,26,11])))(),r=yield(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])))(),i=yield(async e=>{try{return"undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch(e){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]));if(!(e&&s&&n&&r))return p.Basic;if(!i)return p.Advanced;try{return new Worker(t+"/Worker.test.js").terminate(),p.AdvancedWithThreads}catch(e){return p.Advanced}}))}!function(e){e.Basic="BASIC",e.Advanced="ADVANCED",e.AdvancedWithThreads="ADVANCED_WITH_THREADS"}(p||(p={}));class U{constructor(e,t){if(!e.code||!e.message)throw Error("Instance of SDKError is required to have code and message.");this.message=e.message,this.code=e.code,this.details=t}}!function(e){e.WORKER_WASM_LOAD_FAILURE="WORKER_WASM_LOAD_FAILURE",e.WORKER_WASM_INIT_MISSING="WORKER_WASM_INIT_MISSING",e.WORKER_FUNCTION_INVOKE_FAILURE="WORKER_FUNCTION_INVOKE_FAILURE",e.WORKER_RECOGNIZER_CREATION_FAILURE="WORKER_RECOGNIZER_CREATION_FAILURE",e.WORKER_RUNNER_EXISTS="WORKER_RUNNER_EXISTS",e.WORKER_RUNNER_CREATION_FAILURE="WORKER_RUNNER_CREATION_FAILURE",e.WORKER_RUNNER_MISSING="WORKER_RUNNER_MISSING",e.WORKER_RUNNER_RECONFIGURE_FAILURE="WORKER_RUNNER_RECONFIGURE_FAILURE",e.WORKER_RUNNER_DELETED="WORKER_RUNNER_DELETED",e.WORKER_RUNNER_DELETE_FAILURE="WORKER_RUNNER_DELETE_FAILURE",e.WORKER_OBJECT_INVOKE_FAILURE="WORKER_OBJECT_INVOKE_FAILURE",e.WORKER_IMAGE_PROCESS_FAILURE="WORKER_IMAGE_PROCESS_FAILURE",e.WORKER_HANDLE_UNDEFINED="WORKER_HANDLE_UNDEFINED",e.WORKER_MESSAGE_ACTION_UNKNOWN="WORKER_MESSAGE_ACTION_UNKNOWN",e.WORKER_LICENSE_UNLOCK_ERROR="WORKER_LICENSE_UNLOCK_ERROR",e.WORKER_INTEGRATION_INFO_FAILURE="WORKER_INTEGRATION_INFO_FAILURE",e.LOCAL_SDK_RUNNER_MISSING="LOCAL_SDK_RUNNER_MISSING",e.LOCAL_SDK_RUNNER_EMPTY="LOCAL_SDK_RUNNER_EMPTY",e.LICENSE_UNLOCK_ERROR="LICENSE_UNLOCK_ERROR",e.FRAME_CAPTURE_SVG_UNSUPPORTED="FRAME_CAPTURE_SVG_UNSUPPORTED",e.FRAME_CAPTURE_CANVAS_MISSING="FRAME_CAPTURE_CANVAS_MISSING",e.SDK_WASM_SETTINGS_MISSING="SDK_WASM_SETTINGS_MISSING",e.SDK_LICENSE_KEY_MISSING="SDK_LICENSE_KEY_MISSING",e.SDK_WASM_MODULE_NAME_MISSING="SDK_WASM_MODULE_NAME_MISSING",e.SDK_ENGINE_LOCATION_INVALID="SDK_ENGINE_LOCATION_INVALID",e.SDK_MISSING="SDK_MISSING",e.SDK_RECOGNIZERS_MISSING="SDK_RECOGNIZERS_MISSING",e.VIDEO_RECOGNIZER_ELEMENT_MISSING="VIDEO_RECOGNIZER_ELEMENT_MISSING",e.VIDEO_RECOGNIZER_CAMERA_MISSING="VIDEO_RECOGNIZER_CAMERA_MISSING",e.VIDEO_RECOGNIZER_CAMERA_NOT_ALLOWED="VIDEO_RECOGNIZER_CAMERA_NOT_ALLOWED",e.VIDEO_RECOGNIZER_CAMERA_UNAVAILABLE="VIDEO_RECOGNIZER_CAMERA_UNAVAILABLE",e.VIDEO_RECOGNIZER_CAMERA_IN_USE="VIDEO_RECOGNIZER_CAMERA_IN_USE",e.VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED="VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED",e.VIDEO_RECOGNIZER_FEED_RELEASED="VIDEO_RECOGNIZER_FEED_RELEASED",e.VIDEO_RECOGNIZER_FEED_NOT_PAUSED="VIDEO_RECOGNIZER_FEED_NOT_PAUSED",e.VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED="VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED",e.VIDEO_RECOGNIZER_FEED_PAUSED="VIDEO_RECOGNIZER_FEED_PAUSED",e.VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE="VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE",e.VIDEO_RECOGNIZER_FEED_MISSING="VIDEO_RECOGNIZER_FEED_MISSING"}(L||(L={})),function(e){e.WORKER_HANDLE_UNDEFINED="Cannot find object with handle: undefined",e.WORKER_WASM_LOAD_FAILURE="Failed to load WASM in web worker!",e.WORKER_WASM_INIT_MISSING="WASM module is not initialized!",e.WORKER_FUNCTION_INVOKE_FAILURE="Failed to invoke function!",e.WORKER_RECOGNIZER_CREATION_FAILURE="Failed to create new recognizer!",e.WORKER_RUNNER_EXISTS="Recognizer runner is already created! Multiple instances are not allowed!",e.WORKER_RUNNER_CREATION_FAILURE="Failed to create new recognizer runner!",e.WORKER_RUNNER_MISSING="Recognizer runner is not created! There is nothing to reconfigure!",e.WORKER_RUNNER_RECONFIGURE_FAILURE="Failed to reconfigure recognizer runner!",e.WORKER_RUNNER_DELETED="Recognizer runner is already deleted!",e.WORKER_RUNNER_DELETE_FAILURE="Failed to delete recognizer runner!",e.WORKER_OBJECT_INVOKE_FAILURE="Failed to invoke object!",e.WORKER_IMAGE_PROCESS_FAILURE="Recognizer runner is not initialized! Cannot process image!",e.WORKER_INTEGRATION_INFO_FAILURE="Failed to get product integration info!",e.LOCAL_SDK_RUNNER_MISSING="Property nativeRecognizerRunner is not available!",e.LOCAL_SDK_RUNNER_EMPTY="Native RecognizerRunner cannot be empty!",e.LICENSE_TOKEN_STATE_INCORRECT="Internal error (Incorrect token state)",e.LICENSE_PAYLOAD_VERIFICATION_FAILED="Failed to verify server permission\'s digital signature!",e.LICENSE_PAYLOAD_CORRUPTED="Server permission payload is corrupted!",e.LICENSE_PERMISSION_EXPIRED="Internal error (server permission expired)",e.LICENSE_REMOTE_LOCKED="Provided license key has been remotely locked. Please contact support for more information!",e.FRAME_CAPTURE_SVG_UNSUPPORTED="Recognition of SVG elements not supported!",e.FRAME_CAPTURE_CANVAS_MISSING="Could not get canvas 2d context!",e.SDK_WASM_SETTINGS_MISSING="Missing WASM load settings!",e.SDK_LICENSE_KEY_MISSING="Missing license key!",e.SDK_WASM_MODULE_NAME_MISSING="Missing WASM module name!",e.SDK_ENGINE_LOCATION_INVALID="Setting property \'engineLocation\' must be a string!",e.SDK_MISSING="SDK is not provided!",e.SDK_RECOGNIZERS_MISSING="To create RecognizerRunner at least 1 recognizer is required.",e.VIDEO_RECOGNIZER_ELEMENT_MISSING="Video element, i.e. camera feed is not provided!",e.VIDEO_RECOGNIZER_CAMERA_MISSING="Camera not found!",e.VIDEO_RECOGNIZER_CAMERA_NOT_ALLOWED="Camera not allowed!",e.VIDEO_RECOGNIZER_CAMERA_UNAVAILABLE="Camera not available!",e.VIDEO_RECOGNIZER_CAMERA_IN_USE="Camera in use!",e.VIDEO_RECOGNIZER_MEDIA_DEVICES_UNSUPPORTED="Media devices not supported by browser.",e.VIDEO_RECOGNIZER_FEED_RELEASED="The associated video feed has been released!",e.VIDEO_RECOGNIZER_FEED_NOT_PAUSED="The associated video feed is not paused. Use resumeRecognition instead!",e.VIDEO_RECOGNIZER_PLAY_REQUEST_INTERRUPTED="The play() request was interrupted or prevented by browser security rules!",e.VIDEO_RECOGNIZER_FEED_PAUSED="Cannot resume recognition while video feed is paused! Use recognize or startRecognition",e.VIDEO_RECOGNIZER_RECOGNIZERS_RESET_FAILURE="Could not reset recognizers!",e.VIDEO_RECOGNIZER_FEED_MISSING="Missing video feed!"}(w||(w={}));const F={licenseTokenStateIncorrect:{code:L.LICENSE_UNLOCK_ERROR,message:w.LICENSE_TOKEN_STATE_INCORRECT},licensePayloadVerificationFailed:{code:L.LICENSE_UNLOCK_ERROR,message:w.LICENSE_PAYLOAD_VERIFICATION_FAILED},licensePayloadCorrupted:{code:L.LICENSE_UNLOCK_ERROR,message:w.LICENSE_PAYLOAD_CORRUPTED},licensePermissionExpired:{code:L.LICENSE_UNLOCK_ERROR,message:w.LICENSE_PERMISSION_EXPIRED},licenseRemoteLocked:{code:L.LICENSE_UNLOCK_ERROR,message:w.LICENSE_REMOTE_LOCKED},licenseNetworkError:{code:L.LICENSE_UNLOCK_ERROR},licenseInvalid:{code:L.LICENSE_UNLOCK_ERROR}},b={imageProcessFailure:{message:w.WORKER_IMAGE_PROCESS_FAILURE,code:L.WORKER_IMAGE_PROCESS_FAILURE},objectInvokeFailure:{message:w.WORKER_OBJECT_INVOKE_FAILURE,code:L.WORKER_OBJECT_INVOKE_FAILURE},runnerDeleteFailure:{message:w.WORKER_RUNNER_DELETE_FAILURE,code:L.WORKER_RUNNER_DELETE_FAILURE},runnerDeleted:{message:w.WORKER_RUNNER_DELETED,code:L.WORKER_RUNNER_DELETED},runnerReconfigureFailure:{message:w.WORKER_RUNNER_RECONFIGURE_FAILURE,code:L.WORKER_RUNNER_RECONFIGURE_FAILURE},runnerMissing:{message:w.WORKER_RUNNER_MISSING,code:L.WORKER_RUNNER_MISSING},runnerCreationFailure:{message:w.WORKER_RUNNER_CREATION_FAILURE,code:L.WORKER_RUNNER_CREATION_FAILURE},runnerExists:{message:w.WORKER_RUNNER_EXISTS,code:L.WORKER_RUNNER_EXISTS},recognizerCreationFailure:{message:w.WORKER_RECOGNIZER_CREATION_FAILURE,code:L.WORKER_RECOGNIZER_CREATION_FAILURE},functionInvokeFailure:{message:w.WORKER_FUNCTION_INVOKE_FAILURE,code:L.WORKER_FUNCTION_INVOKE_FAILURE},wasmInitMissing:{message:w.WORKER_WASM_INIT_MISSING,code:L.WORKER_WASM_INIT_MISSING},wasmLoadFailure:{message:w.WORKER_WASM_LOAD_FAILURE,code:L.WORKER_WASM_LOAD_FAILURE},handleUndefined:{message:w.WORKER_HANDLE_UNDEFINED,code:L.WORKER_HANDLE_UNDEFINED},integrationInfoFailure:{message:w.WORKER_INTEGRATION_INFO_FAILURE,code:L.WORKER_INTEGRATION_INFO_FAILURE}};var k,K;!function(e){e[e.Invalid=0]="Invalid",e[e.RequiresServerPermission=1]="RequiresServerPermission",e[e.Valid=2]="Valid"}(k||(k={})),function(e){e.LicenseTokenStateInvalid="LICENSE_TOKEN_STATE_INVALID",e.NetworkError="NETWORK_ERROR",e.RemoteLock="REMOTE_LOCK",e.PermissionExpired="PERMISSION_EXPIRED",e.PayloadCorrupted="PAYLOAD_CORRUPTED",e.PayloadSignatureVerificationFailed="PAYLOAD_SIGNATURE_VERIFICATION_FAILED",e.IncorrectTokenState="INCORRECT_TOKEN_STATE"}(K||(K={}));function v(e){return{licenseId:e.licenseId,licensee:e.licensee,packageName:e.packageName,platform:"Browser",sdkName:e.sdkName,sdkVersion:e.sdkVersion}}var P;function W(t,s){return e(this,void 0,void 0,(function*(){try{const e=yield fetch("https://baltazar.microblink.com/api/v1/status/check",{method:"POST",headers:{"Content-Type":"application/json"},cache:"no-cache",body:JSON.stringify(v(t))});if(e.ok){const t=""+(yield e.text());return s.submitServerPermission(t)}return{status:P.NetworkError,lease:0,networkErrorDescription:"Server responded with status "+e.status}}catch(e){return{status:P.NetworkError,lease:0,networkErrorDescription:"Unexpected error: "+JSON.stringify(e)}}}))}function G(e){return e===p.AdvancedWithThreads}!function(e){e[e.Ok=0]="Ok",e[e.NetworkError=1]="NetworkError",e[e.RemoteLock=2]="RemoteLock",e[e.PermissionExpired=3]="PermissionExpired",e[e.PayloadCorrupted=4]="PayloadCorrupted",e[e.PayloadSignatureVerificationFailed=5]="PayloadSignatureVerificationFailed",e[e.IncorrectTokenState=6]="IncorrectTokenState"}(P||(P={}));new class{constructor(){this.context=self,this.wasmModule=null,this.nativeRecognizerRunner=null,this.objects={},this.nextObjectHandle=0,this.metadataCallbacks={},this.clearTimeoutCallback=null,this.context.onmessage=e=>{const t=e.data;switch(t.action){case n.action:this.processInitMessage(t);break;case o.action:this.processInvokeFunction(t);break;case a.action:this.processCreateNewRecognizer(t);break;case l.action:this.processInvokeObject(t);break;case c.action:this.processCreateRecognizerRunner(t);break;case E.action:this.processReconfigureRecognizerRunner(t);break;case R.action:this.processDeleteRecognizerRunner(t);break;case _.action:this.processImage(t);break;case u.action:this.resetRecognizers(t);break;case d.action:this.setDetectionOnly(t);break;case O.action:this.setCameraPreviewMirrored(t);break;case I.action:this.registerMetadataCallbacks(t);break;case N.action:this.registerClearTimeoutCallback(t);break;case h.action:this.processGetProductIntegrationInfo(t);break;default:throw new U({code:L.WORKER_MESSAGE_ACTION_UNKNOWN,message:"Unknown message action: "+JSON.stringify(t.action)})}}}getNextObjectHandle(){const e=this.nextObjectHandle;return this.nextObjectHandle=this.nextObjectHandle+1,e}notifyError(e,t){this.context.postMessage(new S(e.messageID,!1,t))}notifySuccess(e){this.context.postMessage(new S(e.messageID,!0,null))}notifyInitSuccess(e,t,s){this.context.postMessage(new g(e.messageID,!0,t,s))}unwrapParameters(e){const t=[];for(const s of e.params){let n=s.parameter;s.type===r.Recognizer?(n=this.objects[n],void 0===n&&this.notifyError(e,new U(b.handleUndefined))):s.type===r.RecognizerSettings&&(n=this.restoreFunctions(n)),t.push(n)}return t}restoreFunctions(e){const t=Object.keys(e);for(const s of t){const t=e[s];"object"==typeof t&&null!==t&&"parameter"in t&&"type"in t&&t.type===r.Callback&&(e[s]=(...e)=>{const s=new M(i.recognizerCallback,[t.parameter].concat(e));this.context.postMessage(s)})}return e}scanForTransferrables(e){if("object"==typeof e){const t=Object.keys(e),s=[];for(const n of t){const t=e[n];t instanceof ImageData?s.push(t.data.buffer):t instanceof Uint8Array?s.push(t.buffer):null!==t&&"object"==typeof t&&s.push(...this.scanForTransferrables(t))}return s}return[]}registerHeartBeat(e){this.unregisterHeartBeat(),this.lease=e;let t=e-Math.floor(Date.now()/1e3);t>120?t-=120:t/=2,this.inFlightHeartBeatTimeoutId=setTimeout((()=>{this.obtainNewServerPermission(!0)}),1e3*t)}unregisterHeartBeat(){this.lease&&delete this.lease,this.inFlightHeartBeatTimeoutId&&(clearTimeout(this.inFlightHeartBeatTimeoutId),delete this.inFlightHeartBeatTimeoutId)}obtainNewServerPermission(t){return e(this,void 0,void 0,(function*(){if(this.wasmModule){const e=this.wasmModule.getActiveLicenseTokenInfo(),s=yield W(e,this.wasmModule);switch(s.status){case P.Ok:case P.RemoteLock:this.registerHeartBeat(s.lease);break;case P.NetworkError:case P.PayloadSignatureVerificationFailed:case P.PayloadCorrupted:t?(console.warn("Problem with obtaining server permission. Will attempt in 10 seconds "+P[s.status]),this.inFlightHeartBeatTimeoutId=setTimeout((()=>{this.obtainNewServerPermission(!1)}),1e4)):console.error("Problem with obtaining server permission. "+P[s.status]);break;case P.IncorrectTokenState:case P.PermissionExpired:console.error("Internal error: "+P[s.status])}return s.status}return console.error("Internal inconsistency! Wasm module not initialized where it\'s expected to be!"),P.IncorrectTokenState}))}willSoonExpire(){if(this.lease){if(this.wasmModule.getActiveLicenseTokenInfo().unlockResult===k.Valid){const e=Math.floor(Date.now()/1e3);return 30>this.lease-e}return!0}return!1}calculateWasmType(t){return e(this,void 0,void 0,(function*(){return null!==t.wasmType?t.wasmType:yield y(t.engineLocation)}))}calculateEngineLocationPrefix(e,t){const s=T(""===e.engineLocation?self.location.origin:e.engineLocation,function(e){switch(e){case p.AdvancedWithThreads:return"advanced-threads";case p.Advanced:return"advanced";case p.Basic:return"basic"}}(t));return e.allowHelloMessage&&console.log("Engine location prefix is:",s),s}processInitMessage(t){return e(this,void 0,void 0,(function*(){const s=yield this.calculateWasmType(t),n=this.calculateEngineLocationPrefix(t,s);let r={locateFile:e=>T(n,e)};t.registerLoadCallback&&(r=Object.assign(r,{setStatus:e=>{const t=new f(function(e){if("Running..."===e)return 100;if(0===e.length)return 0;const t=/([^(]+)\\((\\d+(\\.\\d+)?)\\/(\\d+)\\)/.exec(e);if(t)return 100*parseInt(t[2])/parseInt(t[4]);return NaN}(e));this.context.postMessage(t)}}));try{const i=T(n,t.wasmModuleName+".js");G(s)&&(r=function(e,t,s){return t&&t>0&&(e=Object.assign(e,{allowedThreads:t})),null!==s&&(e=Object.assign(e,{mainScriptUrlOrBlob:s})),e}(r,t.numberOfWorkers,i)),importScripts(i);(0,self[t.wasmModuleName])(r).then((n=>e(this,void 0,void 0,(function*(){G(s)&&(t.allowHelloMessage&&console.log("Waiting for thread workers to boot..."),yield function(t){return e(this,void 0,void 0,(function*(){t.threadWorkersReadyPromise&&(yield t.threadWorkersReadyPromise)}))}(n));const r=yield function(t,s,n,r){return e(this,void 0,void 0,(function*(){const e=r.initializeWithLicenseKey(t,n,s);switch(e.unlockResult){case k.Invalid:return{error:new U(Object.assign(Object.assign({},F.licenseInvalid),{message:e.licenseError}),{type:K.LicenseTokenStateInvalid})};case k.Valid:return{error:null,showOverlay:(i=e.isTrial,o=e.allowRemoveDemoOverlay,a=e.allowRemoveProductionOverlay,!(i&&o||!i&&a))};case k.RequiresServerPermission:{const t=yield W(e,r);switch(t.status){case P.Ok:return{error:null,lease:t.lease};case P.NetworkError:{let e="";return t.networkErrorDescription&&(e=" "+t.networkErrorDescription),{error:new U(Object.assign(Object.assign({},F.licenseNetworkError),{message:"There has been a network error while obtaining the server permission!"+e}),{type:K.NetworkError})}}case P.RemoteLock:return{error:new U(F.licenseRemoteLocked,{type:K.RemoteLock}),lease:t.lease};case P.PermissionExpired:return{error:new U(F.licensePermissionExpired,{type:K.PermissionExpired}),lease:t.lease};case P.PayloadCorrupted:return{error:new U(F.licensePayloadCorrupted,{type:K.PayloadCorrupted}),lease:t.lease};case P.PayloadSignatureVerificationFailed:return{error:new U(F.licensePayloadVerificationFailed,{type:K.PayloadSignatureVerificationFailed}),lease:t.lease};case P.IncorrectTokenState:return{error:new U(F.licenseTokenStateIncorrect,{type:K.IncorrectTokenState}),lease:t.lease}}}}var i,o,a}))}(t.licenseKey,t.allowHelloMessage,t.userId,n);null===r.error?(this.wasmModule=n,r.lease?this.registerHeartBeat(r.lease):this.unregisterHeartBeat(),this.notifyInitSuccess(t,!!r.showOverlay,s)):this.notifyError(t,r.error)}))),(e=>{this.notifyError(t,new U(b.wasmLoadFailure,e))}))}catch(e){this.notifyError(t,new U(b.wasmLoadFailure,e))}}))}processInvokeFunction(e){if(null===this.wasmModule)return void this.notifyError(e,new U(b.wasmInitMissing));const t=e.funcName,s=this.unwrapParameters(e);try{const n=this.wasmModule[t](...s);this.context.postMessage(new C(e.messageID,n))}catch(t){this.notifyError(e,new U(b.functionInvokeFailure,t))}}processCreateNewRecognizer(e){if(null===this.wasmModule)return void this.notifyError(e,new U(b.wasmInitMissing));const t=e.className,s=this.unwrapParameters(e);try{const n=new this.wasmModule[t](...s),r=this.getNextObjectHandle();this.objects[r]=n,this.context.postMessage(new m(e.messageID,r))}catch(t){this.notifyError(e,new U(b.recognizerCreationFailure,t))}}getRecognizers(e){const t=[];for(const s of e){t.push(this.objects[s])}return t}processCreateRecognizerRunner(t){return e(this,void 0,void 0,(function*(){if(null===this.wasmModule)this.notifyError(t,new U(b.wasmInitMissing));else if(null!==this.nativeRecognizerRunner)this.notifyError(t,new U(b.runnerExists));else{this.setupMetadataCallbacks(t.registeredMetadataCallbacks);try{if(this.willSoonExpire()){const e=yield this.obtainNewServerPermission(!1);if(e!==P.Ok){const s=P[e];return void this.notifyError(t,new U({code:L.WORKER_LICENSE_UNLOCK_ERROR,message:"Cannot initialize recognizers because of invalid server permission: \\n                                    "+s},{type:K[s]}))}}const e=this.getRecognizers(t.recognizerHandles);this.nativeRecognizerRunner=new this.wasmModule.RecognizerRunner(e,t.allowMultipleResults,this.metadataCallbacks),this.notifySuccess(t)}catch(e){this.notifyError(t,new U(b.runnerCreationFailure,e))}}}))}processReconfigureRecognizerRunner(e){if(null===this.wasmModule)this.notifyError(e,new U(b.wasmInitMissing));else if(null===this.nativeRecognizerRunner)this.notifyError(e,new U(b.runnerMissing));else try{const t=this.getRecognizers(e.recognizerHandles);this.nativeRecognizerRunner.reconfigureRecognizers(t,e.allowMultipleResults),this.notifySuccess(e)}catch(t){this.notifyError(e,new U(b.runnerReconfigureFailure,t))}}processDeleteRecognizerRunner(e){if(null!==this.nativeRecognizerRunner)try{this.nativeRecognizerRunner.delete(),this.nativeRecognizerRunner=null,this.notifySuccess(e)}catch(t){this.notifyError(e,new U(b.runnerDeleteFailure,t))}else this.notifyError(e,new U(b.runnerDeleted))}wrapFunctions(e,t){if("object"!=typeof e)return e;const s=Object.assign({},e),n=Object.keys(s);for(const e of n){if("function"==typeof s[e]){s[e]={parameter:{recognizerHandle:t,callbackName:e},type:r.Callback}}}return s}processInvokeObject(e){try{const t=e.objectHandle,s=e.methodName,n=this.unwrapParameters(e),r=this.objects[t];if(void 0===r)this.notifyError(e,new U({message:"Cannot find object with handle: "+t,code:L.WORKER_HANDLE_UNDEFINED}));else{const i=this.wrapFunctions(r[s](...n),t),o=this.scanForTransferrables(i);"delete"===s&&delete this.objects[t],this.context.postMessage(new C(e.messageID,i),o)}}catch(t){this.notifyError(e,new U(b.objectInvokeFailure,t))}}processImage(e){if(null!==this.nativeRecognizerRunner)try{const t=this.nativeRecognizerRunner.processImage(e.frame);this.context.postMessage(new A(e.messageID,t))}catch(t){this.notifyError(e,new U(b.imageProcessFailure,t))}else this.notifyError(e,new U(b.imageProcessFailure))}resetRecognizers(e){if(null!==this.nativeRecognizerRunner)try{this.nativeRecognizerRunner.resetRecognizers(e.hardReset),this.notifySuccess(e)}catch(t){this.notifyError(e,new U(b.imageProcessFailure,t))}else this.notifyError(e,new U(b.imageProcessFailure))}setDetectionOnly(e){if(null!==this.nativeRecognizerRunner)try{this.nativeRecognizerRunner.setDetectionOnlyMode(e.detectionOnlyMode),this.notifySuccess(e)}catch(t){this.notifyError(e,new U(b.imageProcessFailure,t))}else this.notifyError(e,new U(b.imageProcessFailure))}setCameraPreviewMirrored(e){if(null!==this.nativeRecognizerRunner)try{this.nativeRecognizerRunner.setCameraPreviewMirrored(e.cameraPreviewMirrored),this.notifySuccess(e)}catch(t){this.notifyError(e,new U(b.imageProcessFailure,t))}else this.notifyError(e,new U(b.imageProcessFailure))}setupMetadataCallbacks(e){e.onDebugText?this.metadataCallbacks.onDebugText=e=>{const t=new M(i.onDebugText,[e]);this.context.postMessage(t)}:delete this.metadataCallbacks.onDebugText,e.onDetectionFailed?this.metadataCallbacks.onDetectionFailed=()=>{const e=new M(i.onDetectionFailed,[]);this.context.postMessage(e)}:delete this.metadataCallbacks.onDetectionFailed,e.onPointsDetection?this.metadataCallbacks.onPointsDetection=e=>{const t=new M(i.onPointsDetection,[e]);this.context.postMessage(t)}:delete this.metadataCallbacks.onPointsDetection,e.onQuadDetection?this.metadataCallbacks.onQuadDetection=e=>{const t=new M(i.onQuadDetection,[e]);this.context.postMessage(t)}:delete this.metadataCallbacks.onQuadDetection,e.onFirstSideResult?this.metadataCallbacks.onFirstSideResult=()=>{const e=new M(i.onFirstSideResult,[]);this.context.postMessage(e)}:delete this.metadataCallbacks.onFirstSideResult,e.onGlare?this.metadataCallbacks.onGlare=e=>{const t=new M(i.onGlare,[e]);this.context.postMessage(t)}:delete this.metadataCallbacks.onGlare}registerMetadataCallbacks(e){if(null!==this.nativeRecognizerRunner){this.setupMetadataCallbacks(e.registeredMetadataCallbacks);try{this.nativeRecognizerRunner.setJSDelegate(this.metadataCallbacks),this.notifySuccess(e)}catch(t){this.notifyError(e,new U(b.imageProcessFailure,t))}}else this.notifyError(e,new U(b.imageProcessFailure))}registerClearTimeoutCallback(e){if(null!==this.nativeRecognizerRunner){this.clearTimeoutCallback=e.callbackNonEmpty?{onClearTimeout:()=>{const e=new M(i.clearTimeoutCallback,[]);this.context.postMessage(e)}}:null;try{this.nativeRecognizerRunner.setClearTimeoutCallback(this.clearTimeoutCallback),this.notifySuccess(e)}catch(t){this.notifyError(e,new U(b.imageProcessFailure,t))}}else this.notifyError(e,new U(b.imageProcessFailure))}processGetProductIntegrationInfo(e){if(null!==this.wasmModule)try{const t=this.wasmModule.getActiveLicenseTokenInfo(),s={userId:e.userId,licenseId:t.licenseId,licensee:t.licensee,productName:t.sdkName,productVersion:t.sdkVersion,platform:"Browser",device:self.navigator.userAgent,packageName:t.packageName};this.context.postMessage(new D(e.messageID,s))}catch(t){this.notifyError(e,new U(b.objectInvokeFailure,t))}else this.notifyError(e,new U(b.wasmInitMissing))}}}();\n'],a||(a=n.slice(0)),s=Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(a)}}))))],{type:"application/javascript"}),c=URL.createObjectURL(r),o=new Worker(c);re.createWasmWorker(o,e,l).then((function(e){t(e)}),i)}catch(t){i(t)}}else i(new ce(me.engineLocationInvalid));else i(new ce(me.wasmModuleNameMissing));else i(new ce(me.licenseKeyMissing));else i(new ce(me.wasmSettingsMissing))})));case 1:case"end":return t.stop()}}),t)})))}(t);case 6:return this.__sdkInstance=e.sent,e.next=9,function(e){return E(this,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.mbWasmModule.newRecognizer("BlinkIdCombinedRecognizer"));case 1:case"end":return t.stop()}}),t)})))}(this.__sdkInstance);case 9:return this.__sdkRecognizer=e.sent,e.next=12,this.__sdkRecognizer.currentSettings();case 12:return this.__sdkSettings=e.sent,this.__sdkSettings.returnFullDocumentImage=!0,this.__sdkSettings.saveCameraFrames=!0,this.__sdkSettings.fullDocumentImageDpi=400,this.__sdkSettings.returnFaceImage=!0,this.__sdkSettings.faceImageDpi=400,this.__sdkSettings.returnSignatureImage=!0,this.__sdkSettings.signatureImageDpi=400,this.__sdkSettings.anonymizationMode=ve.FullResult,e.next=23,this.__sdkRecognizer.updateSettings(this.__sdkSettings);case 23:return i={onQuadDetection:function(e){n.__detectionStatus=e.detectionStatus,n.__quad={topLeft:e.topLeft,topRight:e.topRight,bottomLeft:e.bottomLeft,bottomRight:e.bottomRight}},onGlare:function(e){n.__glare=e}},e.next=26,function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return E(this,void 0,void 0,u().mark((function a(){return u().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("object"==typeof e){a.next=2;break}throw new ce(me.missing);case 2:if(!("object"!=typeof t||1>t.length)){a.next=4;break}throw new ce(me.recognizersMissing);case 4:return a.abrupt("return",e.mbWasmModule.createRecognizerRunner(t,i,n));case 5:case"end":return a.stop()}}),a)})))}(this.__sdkInstance,[this.__sdkRecognizer],!1,i);case 26:this.__sdkRunnerRecognizer=e.sent,e.next=32;break;case 29:throw e.prev=29,e.t0=e.catch(0),new Error("Fail to initialize the engine!");case 32:case"end":return e.stop()}}),e,this,[[0,29]])})));return function(){return e.apply(this,arguments)}}()},{key:"detectImage",value:function(){var e=m(u().mark((function e(t,i){var n,a,l,s,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(e){var t,i,n=!1;if(e instanceof HTMLVideoElement)t=e.videoWidth,i=e.videoHeight,n=!0;else if(e instanceof HTMLImageElement)t=e.naturalWidth,i=e.naturalHeight;else{if(e instanceof SVGImageElement)throw new ce(be.svgUnsupported);t=e.width,i=e.height}(he=he||document.createElement("canvas")).width=t,he.height=i;var a=he.getContext("2d");if(!a)throw new ce(be.canvasMissing);a.drawImage(e,0,0,he.width,he.height);var l=a.getImageData(0,0,he.width,he.height);return new Fe(l,de.NoRotation,n)}(t),e.next=3,this.__sdkRunnerRecognizer.processImage(n);case 3:return a=e.sent,e.next=6,this.__sdkRecognizer.getResult();case 6:l=e.sent,s=this.__generateResultObject(a,l,i),r=0,e.t0=this.__detectionStatus,e.next=e.t0===Ie.Fail?11:e.t0===Ie.CameraTooHigh?13:e.t0===Ie.CameraTooNear?15:e.t0===Ie.DocumentTooCloseToEdge?17:e.t0===Ie.CameraAtAngle?19:e.t0===Ie.Partial?21:22;break;case 11:return r=1,e.abrupt("break",22);case 13:return r=3,e.abrupt("break",22);case 15:return r=4,e.abrupt("break",22);case 17:return r=5,e.abrupt("break",22);case 19:return r=2,e.abrupt("break",22);case 21:r=5;case 22:return e.abrupt("return",(s.detectionStatus={status:r,quad:this.__quad,glare:this.__glare,internalStatus:l.processingStatus},s));case 23:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"cleanImageBuffer",value:function(){var e=m(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.__sdkRunnerRecognizer.resetRecognizers(!0);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"finalizeEngine",value:function(){var e=m(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.__deleteWasmVar(this.__sdkRecognizer,this.__sdkRunnerRecognizer,this.__sdkSettings,this.__sdkInstance);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"__attributes",get:function(){return{licenseKey:{type:"string",property:"__licenseKey"},bundlePath:{type:"string",property:"__engineLocation"},imageFormat:{type:"string",property:"__imageFormat"},imageQuality:{type:"number",property:"__imageQuality"}}}},{key:"__scanResultType",get:function(){var e;return b(e={},ue.Valid,0),b(e,ue.StageValid,0),b(e,ue.Uncertain,1),b(e,ue.Empty,1),e}},{key:"__mapperToRealConfig",value:function(e){for(var t=0,i=Object.entries(e);t<i.length;t++){var n=l(i[t],2),a=n[0],s=n[1];void 0!==this.__attributes[a]&&(this[this.__attributes[a].property]=s)}}},{key:"__generateResultObject",value:function(e,t,i){var n={};return e!==ue.Empty&&this.__validateResultDiagnostic(t.state,i)?(n.diagnostic=this.__scanResultType[t.state],n.simpleModeOutput=0,n.images={backDocument:this.__convertToImageOutput(t.fullDocumentBackImage.rawImage),frontDocument:this.__convertToImageOutput(t.fullDocumentFrontImage.rawImage),faceImage:this.__convertToImageOutput(t.faceImage.rawImage),signatureImage:this.__convertToImageOutput(t.signatureImage.rawImage)},n.imagesRaw={backDocument:t.fullDocumentBackImage.rawImage,frontDocument:t.fullDocumentFrontImage.rawImage,faceImage:t.faceImage.rawImage,signatureImage:t.signatureImage.rawImage},n.imagesFullsize={backDocument:this.__convertToImageOutput(t.backCameraFrame.frame),frontDocument:this.__convertToImageOutput(t.frontCameraFrame.frame),faceImage:this.__convertToImageOutput(t.faceImage.rawImage),signatureImage:this.__convertToImageOutput(t.signatureImage.rawImage)},n.extractionRaw={},n.extractionRaw.mrz={rawData:t.mrz.rawMRZString||null,opt1:t.mrz.opt1||null,opt2:t.mrz.opt2||null,firstName:t.mrz.secondaryID||null,lastName:t.mrz.primaryID||null,documentId:t.mrz.sanitizedOpt1||null,documentNumber:t.mrz.documentNumber||null,documentIssuer:t.mrz.issuer||null,dateOfExpiry:t.mrz.dateOfExpiry.originalString||null,dateOfBirth:t.mrz.dateOfBirth.originalString||null,gender:t.mrz.gender||null,nationality:t.mrz.nationality||null},n.extractionRaw.ocr={firstName:t.frontViz.firstName||null,lastName:t.frontViz.lastName||null,documentId:t.frontViz.personalIdNumber||null,documentNumber:t.frontViz.documentNumber||null,dateOfBirth:t.frontViz.dateOfBirth.originalString||null,dateOfExpiry:t.frontViz.dateOfExpiry.originalString||null,dateOfIssue:t.frontViz.dateOfIssue.originalString||null,gender:t.frontViz.sex||null,nationality:t.frontViz.nationality||null},n.extractionData={firstName:t.firstName||null,lastName:t.lastName.replaceAll("\n"," ")||null,gender:t.sex||null,nationality:t.nationality||null,dateOfBirth:t.dateOfBirth.originalString.replaceAll(" ","/")||null,placeOfBirth:t.placeOfBirth.replaceAll("\n",", ")||null,documentId:t.personalIdNumber||null,documentNumber:t.documentNumber||null,address:t.address.replaceAll("\n",", ")||null,documentCountryIssuer:t.classInfo.isoAlpha3CountryCode,documentType:this.__getDocumentType(t.classInfo.documentType),debug1:t.classInfo.documentType},t.dateOfExpiryPermanent?n.extractionData.dateOfIssue=t.dateOfIssue.originalString.replaceAll(" ","/")||null:n.extractionData.dateOfExpiry=t.dateOfExpiry.originalString.replaceAll(" ","/")||null):n.diagnostic=1,n}},{key:"__getDocumentType",value:function(e){switch(e){case Xe.NONE:return 1;case Xe.ID:return 2;case Xe.PASSPORT_CARD:return 3;case Xe.VISA:return 4;case Xe.GREEN_CARD:return 5;case Xe.DRIVER_CARD:return 6;case Xe.RESIDENT_ID:return 7;case Xe.SOCIAL_SECURITY_CARD:return 8;case Xe.HEALTH_INSURANCE_CARD:return 9;case Xe.TEMPORARY_RESIDENCE_PERMIT:return 10;default:return 0}}},{key:"__validateResultDiagnostic",value:function(t,i){return t===ue.StageValid&&i===e.Mode.Front||t===ue.Valid&&i===e.Mode.Back}},{key:"__deleteWasmVar",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach((function(e){null!==e&&void 0!==e.delete&&e.delete()}))}},{key:"__convertToImageOutput",value:function(e){if(null!==e){var t=document.createElement("canvas"),i=t.getContext("2d");return t.width=e.width,t.height=e.height,i.putImageData(e,0,0),t.toDataURL(this.__imageFormat,this.__imageQuality)}return null}}]),t}(),Le=function(){function e(){X(this,e)}return C(e,null,[{key:"getAvailableEngines",value:function(){return Object.keys(e.__engines)}},{key:"generateInstance",value:function(t,i){return new e.__engines[t](i)}}]),e}();b(Le,"__engines",{Dummy:N,Microblink:we,Facephi:S});var Te=null,Ue=function(){function e(){X(this,e)}return C(e,null,[{key:"__checkWorker",value:function(){var t=m(u().mark((function t(i){var n,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==e.worker){t.next=3;break}return n=e,a=new Worker((null===Te&&(Te=URL.createObjectURL(new Blob([atob("dmFyIGU7Y29uc3QgdD0oZT0idW5kZWZpbmVkIiE9dHlwZW9mIGRvY3VtZW50JiZkb2N1bWVudC5jdXJyZW50U2NyaXB0P2RvY3VtZW50LmN1cnJlbnRTY3JpcHQuc3JjOnZvaWQgMCxmdW5jdGlvbih0KXt2YXIgcixuLGEsbyxpLHUscyxjLGYsbCxkLHAsaCx5LG0sZyx2Oyh0PXZvaWQgMCE9PSh0PXR8fHt9KT90Ont9KS5yZWFkeT1uZXcgUHJvbWlzZSgoZnVuY3Rpb24oZSx0KXtuPWUsYT10fSkpO3ZhciB3PXt9O2ZvcihvIGluIHQpdC5oYXNPd25Qcm9wZXJ0eShvKSYmKHdbb109dFtvXSk7dmFyIGI9W10sVD0iIjsidW5kZWZpbmVkIiE9dHlwZW9mIGRvY3VtZW50JiZkb2N1bWVudC5jdXJyZW50U2NyaXB0JiYoVD1kb2N1bWVudC5jdXJyZW50U2NyaXB0LnNyYyksZSYmKFQ9ZSksVD0wIT09VC5pbmRleE9mKCJibG9iOiIpP1Quc3Vic3RyKDAsVC5sYXN0SW5kZXhPZigiLyIpKzEpOiIiLHQucHJpbnR8fGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSk7dmFyICQ9dC5wcmludEVycnx8Y29uc29sZS53YXJuLmJpbmQoY29uc29sZSk7Zm9yKG8gaW4gdyl3Lmhhc093blByb3BlcnR5KG8pJiYodFtvXT13W29dKTt3PW51bGwsdC5hcmd1bWVudHMmJihiPXQuYXJndW1lbnRzKSx0LnRoaXNQcm9ncmFtJiZ0LnRoaXNQcm9ncmFtLHQucXVpdCYmdC5xdWl0LHQud2FzbUJpbmFyeSYmKGk9dC53YXNtQmluYXJ5KSx0Lm5vRXhpdFJ1bnRpbWUsIm9iamVjdCIhPXR5cGVvZiBXZWJBc3NlbWJseSYmVigibm8gbmF0aXZlIHdhc20gc3VwcG9ydCBkZXRlY3RlZCIpO3ZhciBfPSExLEM9InVuZGVmaW5lZCIhPXR5cGVvZiBUZXh0RGVjb2Rlcj9uZXcgVGV4dERlY29kZXIoInV0ZjgiKTp2b2lkIDA7ZnVuY3Rpb24gUChlLHQpe3JldHVybiBlP2Z1bmN0aW9uKGUsdCxyKXtmb3IodmFyIG49dCtyLGE9dDtlW2FdJiYhKGE+PW4pOykrK2E7aWYoYS10PjE2JiZlLnN1YmFycmF5JiZDKXJldHVybiBDLmRlY29kZShlLnN1YmFycmF5KHQsYSkpO2Zvcih2YXIgbz0iIjt0PGE7KXt2YXIgaT1lW3QrK107aWYoMTI4Jmkpe3ZhciB1PTYzJmVbdCsrXTtpZigxOTIhPSgyMjQmaSkpe3ZhciBzPTYzJmVbdCsrXTtpZigoaT0yMjQ9PSgyNDAmaSk/KDE1JmkpPDwxMnx1PDw2fHM6KDcmaSk8PDE4fHU8PDEyfHM8PDZ8NjMmZVt0KytdKTw2NTUzNilvKz1TdHJpbmcuZnJvbUNoYXJDb2RlKGkpO2Vsc2V7dmFyIGM9aS02NTUzNjtvKz1TdHJpbmcuZnJvbUNoYXJDb2RlKDU1Mjk2fGM+PjEwLDU2MzIwfDEwMjMmYyl9fWVsc2Ugbys9U3RyaW5nLmZyb21DaGFyQ29kZSgoMzEmaSk8PDZ8dSl9ZWxzZSBvKz1TdHJpbmcuZnJvbUNoYXJDb2RlKGkpfXJldHVybiBvfShjLGUsdCk6IiJ9ZnVuY3Rpb24gRChlLHQscixuKXtpZighKG4+MCkpcmV0dXJuIDA7Zm9yKHZhciBhPXIsbz1yK24tMSxpPTA7aTxlLmxlbmd0aDsrK2kpe3ZhciB1PWUuY2hhckNvZGVBdChpKTtpZih1Pj01NTI5NiYmdTw9NTczNDMmJih1PTY1NTM2KygoMTAyMyZ1KTw8MTApfDEwMjMmZS5jaGFyQ29kZUF0KCsraSkpLHU8PTEyNyl7aWYocj49bylicmVhazt0W3IrK109dX1lbHNlIGlmKHU8PTIwNDcpe2lmKHIrMT49bylicmVhazt0W3IrK109MTkyfHU+PjYsdFtyKytdPTEyOHw2MyZ1fWVsc2UgaWYodTw9NjU1MzUpe2lmKHIrMj49bylicmVhazt0W3IrK109MjI0fHU+PjEyLHRbcisrXT0xMjh8dT4+NiY2Myx0W3IrK109MTI4fDYzJnV9ZWxzZXtpZihyKzM+PW8pYnJlYWs7dFtyKytdPTI0MHx1Pj4xOCx0W3IrK109MTI4fHU+PjEyJjYzLHRbcisrXT0xMjh8dT4+NiY2Myx0W3IrK109MTI4fDYzJnV9fXJldHVybiB0W3JdPTAsci1hfWZ1bmN0aW9uIEEoZSl7Zm9yKHZhciB0PTAscj0wO3I8ZS5sZW5ndGg7KytyKXt2YXIgbj1lLmNoYXJDb2RlQXQocik7bj49NTUyOTYmJm48PTU3MzQzJiYobj02NTUzNisoKDEwMjMmbik8PDEwKXwxMDIzJmUuY2hhckNvZGVBdCgrK3IpKSxuPD0xMjc/Kyt0OnQrPW48PTIwNDc/MjpuPD02NTUzNT8zOjR9cmV0dXJuIHR9dmFyIE89InVuZGVmaW5lZCIhPXR5cGVvZiBUZXh0RGVjb2Rlcj9uZXcgVGV4dERlY29kZXIoInV0Zi0xNmxlIik6dm9pZCAwO2Z1bmN0aW9uIFMoZSx0KXtmb3IodmFyIHI9ZSxuPXI+PjEsYT1uK3QvMjshKG4+PWEpJiZsW25dOykrK247aWYoKHI9bjw8MSktZT4zMiYmTylyZXR1cm4gTy5kZWNvZGUoYy5zdWJhcnJheShlLHIpKTtmb3IodmFyIG89IiIsaT0wOyEoaT49dC8yKTsrK2kpe3ZhciB1PWZbZSsyKmk+PjFdO2lmKDA9PXUpYnJlYWs7bys9U3RyaW5nLmZyb21DaGFyQ29kZSh1KX1yZXR1cm4gb31mdW5jdGlvbiBGKGUsdCxyKXtpZih2b2lkIDA9PT1yJiYocj0yMTQ3NDgzNjQ3KSxyPDIpcmV0dXJuIDA7Zm9yKHZhciBuPXQsYT0oci09Mik8MiplLmxlbmd0aD9yLzI6ZS5sZW5ndGgsbz0wO288YTsrK28pe3ZhciBpPWUuY2hhckNvZGVBdChvKTtmW3Q+PjFdPWksdCs9Mn1yZXR1cm4gZlt0Pj4xXT0wLHQtbn1mdW5jdGlvbiBNKGUpe3JldHVybiAyKmUubGVuZ3RofWZ1bmN0aW9uIEUoZSx0KXtmb3IodmFyIHI9MCxuPSIiOyEocj49dC80KTspe3ZhciBhPWRbZSs0KnI+PjJdO2lmKDA9PWEpYnJlYWs7aWYoKytyLGE+PTY1NTM2KXt2YXIgbz1hLTY1NTM2O24rPVN0cmluZy5mcm9tQ2hhckNvZGUoNTUyOTZ8bz4+MTAsNTYzMjB8MTAyMyZvKX1lbHNlIG4rPVN0cmluZy5mcm9tQ2hhckNvZGUoYSl9cmV0dXJuIG59ZnVuY3Rpb24gVyhlLHQscil7aWYodm9pZCAwPT09ciYmKHI9MjE0NzQ4MzY0Nykscjw0KXJldHVybiAwO2Zvcih2YXIgbj10LGE9bityLTQsbz0wO288ZS5sZW5ndGg7KytvKXt2YXIgaT1lLmNoYXJDb2RlQXQobyk7aWYoaT49NTUyOTYmJmk8PTU3MzQzJiYoaT02NTUzNisoKDEwMjMmaSk8PDEwKXwxMDIzJmUuY2hhckNvZGVBdCgrK28pKSxkW3Q+PjJdPWksKHQrPTQpKzQ+YSlicmVha31yZXR1cm4gZFt0Pj4yXT0wLHQtbn1mdW5jdGlvbiBJKGUpe2Zvcih2YXIgdD0wLHI9MDtyPGUubGVuZ3RoOysrcil7dmFyIG49ZS5jaGFyQ29kZUF0KHIpO24+PTU1Mjk2JiZuPD01NzM0MyYmKytyLHQrPTR9cmV0dXJuIHR9ZnVuY3Rpb24gayhlKXt2YXIgdD1BKGUpKzEscj1udCh0KTtyZXR1cm4gciYmRChlLHMscix0KSxyfXQuSU5JVElBTF9NRU1PUlk7dmFyIFI9W10sWT1bXSxVPVtdLHg9W107ZnVuY3Rpb24gSChlKXtSLnVuc2hpZnQoZSl9ZnVuY3Rpb24gaihlKXt4LnVuc2hpZnQoZSl9WS5wdXNoKHtmdW5jOmZ1bmN0aW9uKCl7dHQoKX19KTt2YXIgej0wLE49bnVsbCxCPW51bGw7ZnVuY3Rpb24gVihlKXt0Lm9uQWJvcnQmJnQub25BYm9ydChlKSwkKGUrPSIiKSxfPSEwLGU9ImFib3J0KCIrZSsiKS4gQnVpbGQgd2l0aCAtcyBBU1NFUlRJT05TPTEgZm9yIG1vcmUgaW5mby4iO3ZhciByPW5ldyBXZWJBc3NlbWJseS5SdW50aW1lRXJyb3IoZSk7dGhyb3cgYShyKSxyfXQucHJlbG9hZGVkSW1hZ2VzPXt9LHQucHJlbG9hZGVkQXVkaW9zPXt9O3ZhciBMLEosRz0iRlBoaVNlbHBoSURUb2tlbml6ZXJXYXNtLndhc20iO2Z1bmN0aW9uIHEoZSl7Zm9yKDtlLmxlbmd0aD4wOyl7dmFyIHI9ZS5zaGlmdCgpO2lmKCJmdW5jdGlvbiIhPXR5cGVvZiByKXt2YXIgbj1yLmZ1bmM7Im51bWJlciI9PXR5cGVvZiBuP3ZvaWQgMD09PXIuYXJnP20uZ2V0KG4pKCk6bS5nZXQobikoci5hcmcpOm4odm9pZCAwPT09ci5hcmc/bnVsbDpyLmFyZyl9ZWxzZSByKHQpfX1MPUcsSj0iZGF0YTphcHBsaWNhdGlvbi9vY3RldC1zdHJlYW07YmFzZTY0LCIsKFN0cmluZy5wcm90b3R5cGUuc3RhcnRzV2l0aD9MLnN0YXJ0c1dpdGgoSik6MD09PUwuaW5kZXhPZihKKSl8fChyPUcsRz10LmxvY2F0ZUZpbGU/dC5sb2NhdGVGaWxlKHIsVCk6VCtyKTtmdW5jdGlvbiBYKGUpe3RoaXMuZXhjUHRyPWUsdGhpcy5wdHI9ZS0xNix0aGlzLnNldF90eXBlPWZ1bmN0aW9uKGUpe2RbdGhpcy5wdHIrOD4+Ml09ZX0sdGhpcy5nZXRfdHlwZT1mdW5jdGlvbigpe3JldHVybiBkW3RoaXMucHRyKzg+PjJdfSx0aGlzLnNldF9kZXN0cnVjdG9yPWZ1bmN0aW9uKGUpe2RbdGhpcy5wdHIrMD4+Ml09ZX0sdGhpcy5nZXRfZGVzdHJ1Y3Rvcj1mdW5jdGlvbigpe3JldHVybiBkW3RoaXMucHRyKzA+PjJdfSx0aGlzLnNldF9yZWZjb3VudD1mdW5jdGlvbihlKXtkW3RoaXMucHRyKzQ+PjJdPWV9LHRoaXMuc2V0X2NhdWdodD1mdW5jdGlvbihlKXtlPWU/MTowLHNbdGhpcy5wdHIrMTI+PjBdPWV9LHRoaXMuZ2V0X2NhdWdodD1mdW5jdGlvbigpe3JldHVybiAwIT1zW3RoaXMucHRyKzEyPj4wXX0sdGhpcy5zZXRfcmV0aHJvd249ZnVuY3Rpb24oZSl7ZT1lPzE6MCxzW3RoaXMucHRyKzEzPj4wXT1lfSx0aGlzLmdldF9yZXRocm93bj1mdW5jdGlvbigpe3JldHVybiAwIT1zW3RoaXMucHRyKzEzPj4wXX0sdGhpcy5pbml0PWZ1bmN0aW9uKGUsdCl7dGhpcy5zZXRfdHlwZShlKSx0aGlzLnNldF9kZXN0cnVjdG9yKHQpLHRoaXMuc2V0X3JlZmNvdW50KDApLHRoaXMuc2V0X2NhdWdodCghMSksdGhpcy5zZXRfcmV0aHJvd24oITEpfSx0aGlzLmFkZF9yZWY9ZnVuY3Rpb24oKXt2YXIgZT1kW3RoaXMucHRyKzQ+PjJdO2RbdGhpcy5wdHIrND4+Ml09ZSsxfSx0aGlzLnJlbGVhc2VfcmVmPWZ1bmN0aW9uKCl7dmFyIGU9ZFt0aGlzLnB0cis0Pj4yXTtyZXR1cm4gZFt0aGlzLnB0cis0Pj4yXT1lLTEsMT09PWV9fWZ1bmN0aW9uIFooKXtpZighWi5jYWxsZWQpe1ouY2FsbGVkPSEwO3ZhciBlPShuZXcgRGF0ZSkuZ2V0RnVsbFllYXIoKSx0PW5ldyBEYXRlKGUsMCwxKSxyPW5ldyBEYXRlKGUsNiwxKSxuPXQuZ2V0VGltZXpvbmVPZmZzZXQoKSxhPXIuZ2V0VGltZXpvbmVPZmZzZXQoKSxvPU1hdGgubWF4KG4sYSk7ZFtzdCgpPj4yXT02MCpvLGRbdXQoKT4+Ml09TnVtYmVyKG4hPWEpO3ZhciBpPWYodCksdT1mKHIpLHM9ayhpKSxjPWsodSk7YTxuPyhkW2l0KCk+PjJdPXMsZFtpdCgpKzQ+PjJdPWMpOihkW2l0KCk+PjJdPWMsZFtpdCgpKzQ+PjJdPXMpfWZ1bmN0aW9uIGYoZSl7dmFyIHQ9ZS50b1RpbWVTdHJpbmcoKS5tYXRjaCgvXCgoW0EtWmEteiBdKylcKSQvKTtyZXR1cm4gdD90WzFdOiJHTVQifX1mdW5jdGlvbiBLKGUpe3N3aXRjaChlKXtjYXNlIDE6cmV0dXJuIDA7Y2FzZSAyOnJldHVybiAxO2Nhc2UgNDpyZXR1cm4gMjtjYXNlIDg6cmV0dXJuIDM7ZGVmYXVsdDp0aHJvdyBuZXcgVHlwZUVycm9yKCJVbmtub3duIHR5cGUgc2l6ZTogIitlKX19dmFyIFE9dm9pZCAwO2Z1bmN0aW9uIGVlKGUpe2Zvcih2YXIgdD0iIixyPWU7Y1tyXTspdCs9UVtjW3IrK11dO3JldHVybiB0fXZhciB0ZT17fSxyZT17fSxuZT17fTtmdW5jdGlvbiBhZShlKXtpZih2b2lkIDA9PT1lKXJldHVybiJfdW5rbm93biI7dmFyIHQ9KGU9ZS5yZXBsYWNlKC9bXmEtekEtWjAtOV9dL2csIiQiKSkuY2hhckNvZGVBdCgwKTtyZXR1cm4gdD49NDgmJnQ8PTU3PyJfIitlOmV9ZnVuY3Rpb24gb2UoZSx0KXtyZXR1cm4gZT1hZShlKSxuZXcgRnVuY3Rpb24oImJvZHkiLCJyZXR1cm4gZnVuY3Rpb24gIitlKycoKSB7XG4gICAgInVzZSBzdHJpY3QiOyAgICByZXR1cm4gYm9keS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufTtcbicpKHQpfWZ1bmN0aW9uIGllKGUsdCl7dmFyIHI9b2UodCwoZnVuY3Rpb24oZSl7dGhpcy5uYW1lPXQsdGhpcy5tZXNzYWdlPWU7dmFyIHI9bmV3IEVycm9yKGUpLnN0YWNrO3ZvaWQgMCE9PXImJih0aGlzLnN0YWNrPXRoaXMudG9TdHJpbmcoKSsiXG4iK3IucmVwbGFjZSgvXkVycm9yKDpbXlxuXSopP1xuLywiIikpfSkpO3JldHVybiByLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGUucHJvdG90eXBlKSxyLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1yLHIucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHZvaWQgMD09PXRoaXMubWVzc2FnZT90aGlzLm5hbWU6dGhpcy5uYW1lKyI6ICIrdGhpcy5tZXNzYWdlfSxyfXZhciB1ZT12b2lkIDA7ZnVuY3Rpb24gc2UoZSl7dGhyb3cgbmV3IHVlKGUpfXZhciBjZT12b2lkIDA7ZnVuY3Rpb24gZmUoZSl7dGhyb3cgbmV3IGNlKGUpfWZ1bmN0aW9uIGxlKGUsdCxyKXtmdW5jdGlvbiBuKHQpe3ZhciBuPXIodCk7bi5sZW5ndGghPT1lLmxlbmd0aCYmZmUoIk1pc21hdGNoZWQgdHlwZSBjb252ZXJ0ZXIgY291bnQiKTtmb3IodmFyIGE9MDthPGUubGVuZ3RoOysrYSlkZShlW2FdLG5bYV0pfWUuZm9yRWFjaCgoZnVuY3Rpb24oZSl7bmVbZV09dH0pKTt2YXIgYT1uZXcgQXJyYXkodC5sZW5ndGgpLG89W10saT0wO3QuZm9yRWFjaCgoZnVuY3Rpb24oZSx0KXtyZS5oYXNPd25Qcm9wZXJ0eShlKT9hW3RdPXJlW2VdOihvLnB1c2goZSksdGUuaGFzT3duUHJvcGVydHkoZSl8fCh0ZVtlXT1bXSksdGVbZV0ucHVzaCgoZnVuY3Rpb24oKXthW3RdPXJlW2VdLCsraT09PW8ubGVuZ3RoJiZuKGEpfSkpKX0pKSwwPT09by5sZW5ndGgmJm4oYSl9ZnVuY3Rpb24gZGUoZSx0LHIpe2lmKHI9cnx8e30sISgiYXJnUGFja0FkdmFuY2UiaW4gdCkpdGhyb3cgbmV3IFR5cGVFcnJvcigicmVnaXN0ZXJUeXBlIHJlZ2lzdGVyZWRJbnN0YW5jZSByZXF1aXJlcyBhcmdQYWNrQWR2YW5jZSIpO3ZhciBuPXQubmFtZTtpZihlfHxzZSgndHlwZSAiJytuKyciIG11c3QgaGF2ZSBhIHBvc2l0aXZlIGludGVnZXIgdHlwZWlkIHBvaW50ZXInKSxyZS5oYXNPd25Qcm9wZXJ0eShlKSl7aWYoci5pZ25vcmVEdXBsaWNhdGVSZWdpc3RyYXRpb25zKXJldHVybjtzZSgiQ2Fubm90IHJlZ2lzdGVyIHR5cGUgJyIrbisiJyB0d2ljZSIpfWlmKHJlW2VdPXQsZGVsZXRlIG5lW2VdLHRlLmhhc093blByb3BlcnR5KGUpKXt2YXIgYT10ZVtlXTtkZWxldGUgdGVbZV0sYS5mb3JFYWNoKChmdW5jdGlvbihlKXtlKCl9KSl9fWZ1bmN0aW9uIHBlKGUpe3NlKGUuJCQucHRyVHlwZS5yZWdpc3RlcmVkQ2xhc3MubmFtZSsiIGluc3RhbmNlIGFscmVhZHkgZGVsZXRlZCIpfXZhciBoZT0hMTtmdW5jdGlvbiB5ZShlKXt9ZnVuY3Rpb24gbWUoZSl7dmFyIHQ7ZS5jb3VudC52YWx1ZS09MSwwPT09ZS5jb3VudC52YWx1ZSYmKCh0PWUpLnNtYXJ0UHRyP3Quc21hcnRQdHJUeXBlLnJhd0Rlc3RydWN0b3IodC5zbWFydFB0cik6dC5wdHJUeXBlLnJlZ2lzdGVyZWRDbGFzcy5yYXdEZXN0cnVjdG9yKHQucHRyKSl9ZnVuY3Rpb24gZ2UoZSl7cmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiBGaW5hbGl6YXRpb25Hcm91cD8oZ2U9ZnVuY3Rpb24oZSl7cmV0dXJuIGV9LGUpOihoZT1uZXcgRmluYWxpemF0aW9uR3JvdXAoKGZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLm5leHQoKTshdC5kb25lO3Q9ZS5uZXh0KCkpe3ZhciByPXQudmFsdWU7ci5wdHI/bWUocik6Y29uc29sZS53YXJuKCJvYmplY3QgYWxyZWFkeSBkZWxldGVkOiAiK3IucHRyKX19KSksZ2U9ZnVuY3Rpb24oZSl7cmV0dXJuIGhlLnJlZ2lzdGVyKGUsZS4kJCxlLiQkKSxlfSx5ZT1mdW5jdGlvbihlKXtoZS51bnJlZ2lzdGVyKGUuJCQpfSxnZShlKSl9dmFyIHZlPXZvaWQgMCx3ZT1bXTtmdW5jdGlvbiBiZSgpe2Zvcig7d2UubGVuZ3RoOyl7dmFyIGU9d2UucG9wKCk7ZS4kJC5kZWxldGVTY2hlZHVsZWQ9ITEsZS5kZWxldGUoKX19ZnVuY3Rpb24gVGUoKXt9dmFyICRlPXt9O2Z1bmN0aW9uIF9lKGUsdCxyKXtpZih2b2lkIDA9PT1lW3RdLm92ZXJsb2FkVGFibGUpe3ZhciBuPWVbdF07ZVt0XT1mdW5jdGlvbigpe3JldHVybiBlW3RdLm92ZXJsb2FkVGFibGUuaGFzT3duUHJvcGVydHkoYXJndW1lbnRzLmxlbmd0aCl8fHNlKCJGdW5jdGlvbiAnIityKyInIGNhbGxlZCB3aXRoIGFuIGludmFsaWQgbnVtYmVyIG9mIGFyZ3VtZW50cyAoIithcmd1bWVudHMubGVuZ3RoKyIpIC0gZXhwZWN0cyBvbmUgb2YgKCIrZVt0XS5vdmVybG9hZFRhYmxlKyIpISIpLGVbdF0ub3ZlcmxvYWRUYWJsZVthcmd1bWVudHMubGVuZ3RoXS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGVbdF0ub3ZlcmxvYWRUYWJsZT1bXSxlW3RdLm92ZXJsb2FkVGFibGVbbi5hcmdDb3VudF09bn19ZnVuY3Rpb24gQ2UoZSx0LHIsbixhLG8saSx1KXt0aGlzLm5hbWU9ZSx0aGlzLmNvbnN0cnVjdG9yPXQsdGhpcy5pbnN0YW5jZVByb3RvdHlwZT1yLHRoaXMucmF3RGVzdHJ1Y3Rvcj1uLHRoaXMuYmFzZUNsYXNzPWEsdGhpcy5nZXRBY3R1YWxUeXBlPW8sdGhpcy51cGNhc3Q9aSx0aGlzLmRvd25jYXN0PXUsdGhpcy5wdXJlVmlydHVhbEZ1bmN0aW9ucz1bXX1mdW5jdGlvbiBQZShlLHQscil7Zm9yKDt0IT09cjspdC51cGNhc3R8fHNlKCJFeHBlY3RlZCBudWxsIG9yIGluc3RhbmNlIG9mICIrci5uYW1lKyIsIGdvdCBhbiBpbnN0YW5jZSBvZiAiK3QubmFtZSksZT10LnVwY2FzdChlKSx0PXQuYmFzZUNsYXNzO3JldHVybiBlfWZ1bmN0aW9uIERlKGUsdCl7aWYobnVsbD09PXQpcmV0dXJuIHRoaXMuaXNSZWZlcmVuY2UmJnNlKCJudWxsIGlzIG5vdCBhIHZhbGlkICIrdGhpcy5uYW1lKSwwO3QuJCR8fHNlKCdDYW5ub3QgcGFzcyAiJytWZSh0KSsnIiBhcyBhICcrdGhpcy5uYW1lKSx0LiQkLnB0cnx8c2UoIkNhbm5vdCBwYXNzIGRlbGV0ZWQgb2JqZWN0IGFzIGEgcG9pbnRlciBvZiB0eXBlICIrdGhpcy5uYW1lKTt2YXIgcj10LiQkLnB0clR5cGUucmVnaXN0ZXJlZENsYXNzO3JldHVybiBQZSh0LiQkLnB0cixyLHRoaXMucmVnaXN0ZXJlZENsYXNzKX1mdW5jdGlvbiBBZShlLHQpe2lmKG51bGw9PT10KXJldHVybiB0aGlzLmlzUmVmZXJlbmNlJiZzZSgibnVsbCBpcyBub3QgYSB2YWxpZCAiK3RoaXMubmFtZSksdGhpcy5pc1NtYXJ0UG9pbnRlcj8ocj10aGlzLnJhd0NvbnN0cnVjdG9yKCksbnVsbCE9PWUmJmUucHVzaCh0aGlzLnJhd0Rlc3RydWN0b3Iscikscik6MDt0LiQkfHxzZSgnQ2Fubm90IHBhc3MgIicrVmUodCkrJyIgYXMgYSAnK3RoaXMubmFtZSksdC4kJC5wdHJ8fHNlKCJDYW5ub3QgcGFzcyBkZWxldGVkIG9iamVjdCBhcyBhIHBvaW50ZXIgb2YgdHlwZSAiK3RoaXMubmFtZSksIXRoaXMuaXNDb25zdCYmdC4kJC5wdHJUeXBlLmlzQ29uc3QmJnNlKCJDYW5ub3QgY29udmVydCBhcmd1bWVudCBvZiB0eXBlICIrKHQuJCQuc21hcnRQdHJUeXBlP3QuJCQuc21hcnRQdHJUeXBlLm5hbWU6dC4kJC5wdHJUeXBlLm5hbWUpKyIgdG8gcGFyYW1ldGVyIHR5cGUgIit0aGlzLm5hbWUpO3ZhciByLG49dC4kJC5wdHJUeXBlLnJlZ2lzdGVyZWRDbGFzcztpZihyPVBlKHQuJCQucHRyLG4sdGhpcy5yZWdpc3RlcmVkQ2xhc3MpLHRoaXMuaXNTbWFydFBvaW50ZXIpc3dpdGNoKHZvaWQgMD09PXQuJCQuc21hcnRQdHImJnNlKCJQYXNzaW5nIHJhdyBwb2ludGVyIHRvIHNtYXJ0IHBvaW50ZXIgaXMgaWxsZWdhbCIpLHRoaXMuc2hhcmluZ1BvbGljeSl7Y2FzZSAwOnQuJCQuc21hcnRQdHJUeXBlPT09dGhpcz9yPXQuJCQuc21hcnRQdHI6c2UoIkNhbm5vdCBjb252ZXJ0IGFyZ3VtZW50IG9mIHR5cGUgIisodC4kJC5zbWFydFB0clR5cGU/dC4kJC5zbWFydFB0clR5cGUubmFtZTp0LiQkLnB0clR5cGUubmFtZSkrIiB0byBwYXJhbWV0ZXIgdHlwZSAiK3RoaXMubmFtZSk7YnJlYWs7Y2FzZSAxOnI9dC4kJC5zbWFydFB0cjticmVhaztjYXNlIDI6aWYodC4kJC5zbWFydFB0clR5cGU9PT10aGlzKXI9dC4kJC5zbWFydFB0cjtlbHNle3ZhciBhPXQuY2xvbmUoKTtyPXRoaXMucmF3U2hhcmUocixCZSgoZnVuY3Rpb24oKXthLmRlbGV0ZSgpfSkpKSxudWxsIT09ZSYmZS5wdXNoKHRoaXMucmF3RGVzdHJ1Y3RvcixyKX1icmVhaztkZWZhdWx0OnNlKCJVbnN1cHBvcnRpbmcgc2hhcmluZyBwb2xpY3kiKX1yZXR1cm4gcn1mdW5jdGlvbiBPZShlLHQpe2lmKG51bGw9PT10KXJldHVybiB0aGlzLmlzUmVmZXJlbmNlJiZzZSgibnVsbCBpcyBub3QgYSB2YWxpZCAiK3RoaXMubmFtZSksMDt0LiQkfHxzZSgnQ2Fubm90IHBhc3MgIicrVmUodCkrJyIgYXMgYSAnK3RoaXMubmFtZSksdC4kJC5wdHJ8fHNlKCJDYW5ub3QgcGFzcyBkZWxldGVkIG9iamVjdCBhcyBhIHBvaW50ZXIgb2YgdHlwZSAiK3RoaXMubmFtZSksdC4kJC5wdHJUeXBlLmlzQ29uc3QmJnNlKCJDYW5ub3QgY29udmVydCBhcmd1bWVudCBvZiB0eXBlICIrdC4kJC5wdHJUeXBlLm5hbWUrIiB0byBwYXJhbWV0ZXIgdHlwZSAiK3RoaXMubmFtZSk7dmFyIHI9dC4kJC5wdHJUeXBlLnJlZ2lzdGVyZWRDbGFzcztyZXR1cm4gUGUodC4kJC5wdHIscix0aGlzLnJlZ2lzdGVyZWRDbGFzcyl9ZnVuY3Rpb24gU2UoZSl7cmV0dXJuIHRoaXMuZnJvbVdpcmVUeXBlKHBbZT4+Ml0pfWZ1bmN0aW9uIEZlKGUsdCxyKXtpZih0PT09cilyZXR1cm4gZTtpZih2b2lkIDA9PT1yLmJhc2VDbGFzcylyZXR1cm4gbnVsbDt2YXIgbj1GZShlLHQsci5iYXNlQ2xhc3MpO3JldHVybiBudWxsPT09bj9udWxsOnIuZG93bmNhc3Qobil9dmFyIE1lPXt9O2Z1bmN0aW9uIEVlKGUsdCl7cmV0dXJuIHQucHRyVHlwZSYmdC5wdHJ8fGZlKCJtYWtlQ2xhc3NIYW5kbGUgcmVxdWlyZXMgcHRyIGFuZCBwdHJUeXBlIiksISF0LnNtYXJ0UHRyVHlwZSE9ISF0LnNtYXJ0UHRyJiZmZSgiQm90aCBzbWFydFB0clR5cGUgYW5kIHNtYXJ0UHRyIG11c3QgYmUgc3BlY2lmaWVkIiksdC5jb3VudD17dmFsdWU6MX0sZ2UoT2JqZWN0LmNyZWF0ZShlLHskJDp7dmFsdWU6dH19KSl9ZnVuY3Rpb24gV2UoZSx0LHIsbixhLG8saSx1LHMsYyxmKXt0aGlzLm5hbWU9ZSx0aGlzLnJlZ2lzdGVyZWRDbGFzcz10LHRoaXMuaXNSZWZlcmVuY2U9cix0aGlzLmlzQ29uc3Q9bix0aGlzLmlzU21hcnRQb2ludGVyPWEsdGhpcy5wb2ludGVlVHlwZT1vLHRoaXMuc2hhcmluZ1BvbGljeT1pLHRoaXMucmF3R2V0UG9pbnRlZT11LHRoaXMucmF3Q29uc3RydWN0b3I9cyx0aGlzLnJhd1NoYXJlPWMsdGhpcy5yYXdEZXN0cnVjdG9yPWYsYXx8dm9pZCAwIT09dC5iYXNlQ2xhc3M/dGhpcy50b1dpcmVUeXBlPUFlOm4/KHRoaXMudG9XaXJlVHlwZT1EZSx0aGlzLmRlc3RydWN0b3JGdW5jdGlvbj1udWxsKToodGhpcy50b1dpcmVUeXBlPU9lLHRoaXMuZGVzdHJ1Y3RvckZ1bmN0aW9uPW51bGwpfWZ1bmN0aW9uIEllKGUscil7ZT1lZShlKTt2YXIgbj1mdW5jdGlvbigpe3ZhciBuLGEsbztyZXR1cm4tMSE9ZS5pbmRleE9mKCJqIik/KG49ZSxhPXIsbz1bXSxmdW5jdGlvbigpe28ubGVuZ3RoPWFyZ3VtZW50cy5sZW5ndGg7Zm9yKHZhciBlPTA7ZTxhcmd1bWVudHMubGVuZ3RoO2UrKylvW2VdPWFyZ3VtZW50c1tlXTtyZXR1cm4gZnVuY3Rpb24oZSxyLG4pe3ZhciBhLG8saTtyZXR1cm4tMSE9ZS5pbmRleE9mKCJqIik/KGE9cixvPW4saT10WyJkeW5DYWxsXyIrZV0sbyYmby5sZW5ndGg/aS5hcHBseShudWxsLFthXS5jb25jYXQobykpOmkuY2FsbChudWxsLGEpKTptLmdldChyKS5hcHBseShudWxsLG4pfShuLGEsbyl9KTptLmdldChyKX0oKTtyZXR1cm4iZnVuY3Rpb24iIT10eXBlb2YgbiYmc2UoInVua25vd24gZnVuY3Rpb24gcG9pbnRlciB3aXRoIHNpZ25hdHVyZSAiK2UrIjogIityKSxufXZhciBrZT12b2lkIDA7ZnVuY3Rpb24gUmUoZSl7dmFyIHQ9YXQoZSkscj1lZSh0KTtyZXR1cm4gb3QodCkscn1mdW5jdGlvbiBZZShlLHQpe3ZhciByPVtdLG49e307dGhyb3cgdC5mb3JFYWNoKChmdW5jdGlvbiBlKHQpe2lmKCFuW3RdJiYhcmVbdF0pe2lmKG5lW3RdKXJldHVybiB2b2lkIG5lW3RdLmZvckVhY2goZSk7ci5wdXNoKHQpLG5bdF09ITB9fSkpLG5ldyBrZShlKyI6ICIrci5tYXAoUmUpLmpvaW4oWyIsICJdKSl9ZnVuY3Rpb24gVWUoZSx0KXtmb3IodmFyIHI9W10sbj0wO248ZTtuKyspci5wdXNoKGRbKHQ+PjIpK25dKTtyZXR1cm4gcn1mdW5jdGlvbiB4ZShlKXtmb3IoO2UubGVuZ3RoOyl7dmFyIHQ9ZS5wb3AoKTtlLnBvcCgpKHQpfX1mdW5jdGlvbiBIZShlLHQscil7cmV0dXJuIGUgaW5zdGFuY2VvZiBPYmplY3R8fHNlKHIrJyB3aXRoIGludmFsaWQgInRoaXMiOiAnK2UpLGUgaW5zdGFuY2VvZiB0LnJlZ2lzdGVyZWRDbGFzcy5jb25zdHJ1Y3Rvcnx8c2UocisnIGluY29tcGF0aWJsZSB3aXRoICJ0aGlzIiBvZiB0eXBlICcrZS5jb25zdHJ1Y3Rvci5uYW1lKSxlLiQkLnB0cnx8c2UoImNhbm5vdCBjYWxsIGVtc2NyaXB0ZW4gYmluZGluZyBtZXRob2QgIityKyIgb24gZGVsZXRlZCBvYmplY3QiKSxQZShlLiQkLnB0cixlLiQkLnB0clR5cGUucmVnaXN0ZXJlZENsYXNzLHQucmVnaXN0ZXJlZENsYXNzKX12YXIgamU9W10semU9W3t9LHt2YWx1ZTp2b2lkIDB9LHt2YWx1ZTpudWxsfSx7dmFsdWU6ITB9LHt2YWx1ZTohMX1dO2Z1bmN0aW9uIE5lKGUpe2U+NCYmMD09LS16ZVtlXS5yZWZjb3VudCYmKHplW2VdPXZvaWQgMCxqZS5wdXNoKGUpKX1mdW5jdGlvbiBCZShlKXtzd2l0Y2goZSl7Y2FzZSB2b2lkIDA6cmV0dXJuIDE7Y2FzZSBudWxsOnJldHVybiAyO2Nhc2UhMDpyZXR1cm4gMztjYXNlITE6cmV0dXJuIDQ7ZGVmYXVsdDp2YXIgdD1qZS5sZW5ndGg/amUucG9wKCk6emUubGVuZ3RoO3JldHVybiB6ZVt0XT17cmVmY291bnQ6MSx2YWx1ZTplfSx0fX1mdW5jdGlvbiBWZShlKXtpZihudWxsPT09ZSlyZXR1cm4ibnVsbCI7dmFyIHQ9dHlwZW9mIGU7cmV0dXJuIm9iamVjdCI9PT10fHwiYXJyYXkiPT09dHx8ImZ1bmN0aW9uIj09PXQ/ZS50b1N0cmluZygpOiIiK2V9ZnVuY3Rpb24gTGUoZSl7cmV0dXJuIGUlND09MCYmKGUlMTAwIT0wfHxlJTQwMD09MCl9ZnVuY3Rpb24gSmUoZSx0KXtmb3IodmFyIHI9MCxuPTA7bjw9dDtyKz1lW24rK10pO3JldHVybiByfWc9ZnVuY3Rpb24oKXtyZXR1cm4gcGVyZm9ybWFuY2Uubm93KCl9O3ZhciBHZT1bMzEsMjksMzEsMzAsMzEsMzAsMzEsMzEsMzAsMzEsMzAsMzFdLHFlPVszMSwyOCwzMSwzMCwzMSwzMCwzMSwzMSwzMCwzMSwzMCwzMV07ZnVuY3Rpb24gWGUoZSx0KXtmb3IodmFyIHI9bmV3IERhdGUoZS5nZXRUaW1lKCkpO3Q+MDspe3ZhciBuPUxlKHIuZ2V0RnVsbFllYXIoKSksYT1yLmdldE1vbnRoKCksbz0obj9HZTpxZSlbYV07aWYoISh0Pm8tci5nZXREYXRlKCkpKXtyLnNldERhdGUoci5nZXREYXRlKCkrdCk7YnJlYWt9dC09by1yLmdldERhdGUoKSsxLHIuc2V0RGF0ZSgxKSxhPDExP3Iuc2V0TW9udGgoYSsxKTooci5zZXRNb250aCgwKSxyLnNldEZ1bGxZZWFyKHIuZ2V0RnVsbFllYXIoKSsxKSl9cmV0dXJuIHJ9ZnVuY3Rpb24gWmUoZSl7cmV0dXJuIHBhcnNlSW50KGUpfWZ1bmN0aW9uIEtlKGUsdCxyKXt2YXIgbj1yPjA/cjpBKGUpKzEsYT1uZXcgQXJyYXkobiksbz1EKGUsYSwwLGEubGVuZ3RoKTtyZXR1cm4gdCYmKGEubGVuZ3RoPW8pLGF9IWZ1bmN0aW9uKCl7Zm9yKHZhciBlPW5ldyBBcnJheSgyNTYpLHQ9MDt0PDI1NjsrK3QpZVt0XT1TdHJpbmcuZnJvbUNoYXJDb2RlKHQpO1E9ZX0oKSx1ZT10LkJpbmRpbmdFcnJvcj1pZShFcnJvciwiQmluZGluZ0Vycm9yIiksY2U9dC5JbnRlcm5hbEVycm9yPWllKEVycm9yLCJJbnRlcm5hbEVycm9yIiksVGUucHJvdG90eXBlLmlzQWxpYXNPZj1mdW5jdGlvbihlKXtpZighKHRoaXMgaW5zdGFuY2VvZiBUZSYmZSBpbnN0YW5jZW9mIFRlKSlyZXR1cm4hMTtmb3IodmFyIHQ9dGhpcy4kJC5wdHJUeXBlLnJlZ2lzdGVyZWRDbGFzcyxyPXRoaXMuJCQucHRyLG49ZS4kJC5wdHJUeXBlLnJlZ2lzdGVyZWRDbGFzcyxhPWUuJCQucHRyO3QuYmFzZUNsYXNzOylyPXQudXBjYXN0KHIpLHQ9dC5iYXNlQ2xhc3M7Zm9yKDtuLmJhc2VDbGFzczspYT1uLnVwY2FzdChhKSxuPW4uYmFzZUNsYXNzO3JldHVybiB0PT09biYmcj09PWF9LFRlLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe2lmKHRoaXMuJCQucHRyfHxwZSh0aGlzKSx0aGlzLiQkLnByZXNlcnZlUG9pbnRlck9uRGVsZXRlKXJldHVybiB0aGlzLiQkLmNvdW50LnZhbHVlKz0xLHRoaXM7dmFyIGUsdD1nZShPYmplY3QuY3JlYXRlKE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKSx7JCQ6e3ZhbHVlOntjb3VudDooZT10aGlzLiQkKS5jb3VudCxkZWxldGVTY2hlZHVsZWQ6ZS5kZWxldGVTY2hlZHVsZWQscHJlc2VydmVQb2ludGVyT25EZWxldGU6ZS5wcmVzZXJ2ZVBvaW50ZXJPbkRlbGV0ZSxwdHI6ZS5wdHIscHRyVHlwZTplLnB0clR5cGUsc21hcnRQdHI6ZS5zbWFydFB0cixzbWFydFB0clR5cGU6ZS5zbWFydFB0clR5cGV9fX0pKTtyZXR1cm4gdC4kJC5jb3VudC52YWx1ZSs9MSx0LiQkLmRlbGV0ZVNjaGVkdWxlZD0hMSx0fSxUZS5wcm90b3R5cGUuZGVsZXRlPWZ1bmN0aW9uKCl7dGhpcy4kJC5wdHJ8fHBlKHRoaXMpLHRoaXMuJCQuZGVsZXRlU2NoZWR1bGVkJiYhdGhpcy4kJC5wcmVzZXJ2ZVBvaW50ZXJPbkRlbGV0ZSYmc2UoIk9iamVjdCBhbHJlYWR5IHNjaGVkdWxlZCBmb3IgZGVsZXRpb24iKSx5ZSh0aGlzKSxtZSh0aGlzLiQkKSx0aGlzLiQkLnByZXNlcnZlUG9pbnRlck9uRGVsZXRlfHwodGhpcy4kJC5zbWFydFB0cj12b2lkIDAsdGhpcy4kJC5wdHI9dm9pZCAwKX0sVGUucHJvdG90eXBlLmlzRGVsZXRlZD1mdW5jdGlvbigpe3JldHVybiF0aGlzLiQkLnB0cn0sVGUucHJvdG90eXBlLmRlbGV0ZUxhdGVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJCQucHRyfHxwZSh0aGlzKSx0aGlzLiQkLmRlbGV0ZVNjaGVkdWxlZCYmIXRoaXMuJCQucHJlc2VydmVQb2ludGVyT25EZWxldGUmJnNlKCJPYmplY3QgYWxyZWFkeSBzY2hlZHVsZWQgZm9yIGRlbGV0aW9uIiksd2UucHVzaCh0aGlzKSwxPT09d2UubGVuZ3RoJiZ2ZSYmdmUoYmUpLHRoaXMuJCQuZGVsZXRlU2NoZWR1bGVkPSEwLHRoaXN9LFdlLnByb3RvdHlwZS5nZXRQb2ludGVlPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnJhd0dldFBvaW50ZWUmJihlPXRoaXMucmF3R2V0UG9pbnRlZShlKSksZX0sV2UucHJvdG90eXBlLmRlc3RydWN0b3I9ZnVuY3Rpb24oZSl7dGhpcy5yYXdEZXN0cnVjdG9yJiZ0aGlzLnJhd0Rlc3RydWN0b3IoZSl9LFdlLnByb3RvdHlwZS5hcmdQYWNrQWR2YW5jZT04LFdlLnByb3RvdHlwZS5yZWFkVmFsdWVGcm9tUG9pbnRlcj1TZSxXZS5wcm90b3R5cGUuZGVsZXRlT2JqZWN0PWZ1bmN0aW9uKGUpe251bGwhPT1lJiZlLmRlbGV0ZSgpfSxXZS5wcm90b3R5cGUuZnJvbVdpcmVUeXBlPWZ1bmN0aW9uKGUpe3ZhciB0LHI9dGhpcy5nZXRQb2ludGVlKGUpO2lmKCFyKXJldHVybiB0aGlzLmRlc3RydWN0b3IoZSksbnVsbDt2YXIgbj1NZVtmdW5jdGlvbihlLHQpe2Zvcih2b2lkIDA9PT10JiZzZSgicHRyIHNob3VsZCBub3QgYmUgdW5kZWZpbmVkIik7ZS5iYXNlQ2xhc3M7KXQ9ZS51cGNhc3QodCksZT1lLmJhc2VDbGFzcztyZXR1cm4gdH0odGhpcy5yZWdpc3RlcmVkQ2xhc3MscildO2lmKHZvaWQgMCE9PW4pe2lmKDA9PT1uLiQkLmNvdW50LnZhbHVlKXJldHVybiBuLiQkLnB0cj1yLG4uJCQuc21hcnRQdHI9ZSxuLmNsb25lKCk7dmFyIGE9bi5jbG9uZSgpO3JldHVybiB0aGlzLmRlc3RydWN0b3IoZSksYX1mdW5jdGlvbiBvKCl7cmV0dXJuIHRoaXMuaXNTbWFydFBvaW50ZXI/RWUodGhpcy5yZWdpc3RlcmVkQ2xhc3MuaW5zdGFuY2VQcm90b3R5cGUse3B0clR5cGU6dGhpcy5wb2ludGVlVHlwZSxwdHI6cixzbWFydFB0clR5cGU6dGhpcyxzbWFydFB0cjplfSk6RWUodGhpcy5yZWdpc3RlcmVkQ2xhc3MuaW5zdGFuY2VQcm90b3R5cGUse3B0clR5cGU6dGhpcyxwdHI6ZX0pfXZhciBpPSRlW3RoaXMucmVnaXN0ZXJlZENsYXNzLmdldEFjdHVhbFR5cGUocildO2lmKCFpKXJldHVybiBvLmNhbGwodGhpcyk7dD10aGlzLmlzQ29uc3Q/aS5jb25zdFBvaW50ZXJUeXBlOmkucG9pbnRlclR5cGU7dmFyIHU9RmUocix0aGlzLnJlZ2lzdGVyZWRDbGFzcyx0LnJlZ2lzdGVyZWRDbGFzcyk7cmV0dXJuIG51bGw9PT11P28uY2FsbCh0aGlzKTp0aGlzLmlzU21hcnRQb2ludGVyP0VlKHQucmVnaXN0ZXJlZENsYXNzLmluc3RhbmNlUHJvdG90eXBlLHtwdHJUeXBlOnQscHRyOnUsc21hcnRQdHJUeXBlOnRoaXMsc21hcnRQdHI6ZX0pOkVlKHQucmVnaXN0ZXJlZENsYXNzLmluc3RhbmNlUHJvdG90eXBlLHtwdHJUeXBlOnQscHRyOnV9KX0sdC5nZXRJbmhlcml0ZWRJbnN0YW5jZUNvdW50PWZ1bmN0aW9uKCl7cmV0dXJuIE9iamVjdC5rZXlzKE1lKS5sZW5ndGh9LHQuZ2V0TGl2ZUluaGVyaXRlZEluc3RhbmNlcz1mdW5jdGlvbigpe3ZhciBlPVtdO2Zvcih2YXIgdCBpbiBNZSlNZS5oYXNPd25Qcm9wZXJ0eSh0KSYmZS5wdXNoKE1lW3RdKTtyZXR1cm4gZX0sdC5mbHVzaFBlbmRpbmdEZWxldGVzPWJlLHQuc2V0RGVsYXlGdW5jdGlvbj1mdW5jdGlvbihlKXt2ZT1lLHdlLmxlbmd0aCYmdmUmJnZlKGJlKX0sa2U9dC5VbmJvdW5kVHlwZUVycm9yPWllKEVycm9yLCJVbmJvdW5kVHlwZUVycm9yIiksdC5jb3VudF9lbXZhbF9oYW5kbGVzPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPTAsdD01O3Q8emUubGVuZ3RoOysrdCl2b2lkIDAhPT16ZVt0XSYmKytlO3JldHVybiBlfSx0LmdldF9maXJzdF9lbXZhbD1mdW5jdGlvbigpe2Zvcih2YXIgZT01O2U8emUubGVuZ3RoOysrZSlpZih2b2lkIDAhPT16ZVtlXSlyZXR1cm4gemVbZV07cmV0dXJuIG51bGx9O3ZhciBRZT17YzpmdW5jdGlvbihlKXtyZXR1cm4gbnQoZSsxNikrMTZ9LGI6ZnVuY3Rpb24oZSx0LHIpe3Rocm93IG5ldyBYKGUpLmluaXQodCxyKSxlfSx3OmZ1bmN0aW9uKGUsdCl7dmFyIHIsbixhLG8saSx1LHMsYyxmO3JldHVybiByPWUsbj10LFooKSxhPW5ldyBEYXRlKDFlMypkW3I+PjJdKSxkW24+PjJdPWEuZ2V0U2Vjb25kcygpLGRbbis0Pj4yXT1hLmdldE1pbnV0ZXMoKSxkW24rOD4+Ml09YS5nZXRIb3VycygpLGRbbisxMj4+Ml09YS5nZXREYXRlKCksZFtuKzE2Pj4yXT1hLmdldE1vbnRoKCksZFtuKzIwPj4yXT1hLmdldEZ1bGxZZWFyKCktMTkwMCxkW24rMjQ+PjJdPWEuZ2V0RGF5KCksbz1uZXcgRGF0ZShhLmdldEZ1bGxZZWFyKCksMCwxKSxpPShhLmdldFRpbWUoKS1vLmdldFRpbWUoKSkvODY0ZTV8MCxkW24rMjg+PjJdPWksZFtuKzM2Pj4yXT0tNjAqYS5nZXRUaW1lem9uZU9mZnNldCgpLGM9MHwoKHU9bmV3IERhdGUoYS5nZXRGdWxsWWVhcigpLDYsMSkuZ2V0VGltZXpvbmVPZmZzZXQoKSkhPShzPW8uZ2V0VGltZXpvbmVPZmZzZXQoKSkmJmEuZ2V0VGltZXpvbmVPZmZzZXQoKT09TWF0aC5taW4ocyx1KSksZFtuKzMyPj4yXT1jLGY9ZFtpdCgpKyhjPzQ6MCk+PjJdLGRbbis0MD4+Ml09ZixufSx5OmZ1bmN0aW9uKGUsdCxyLG4sYSl7dmFyIG89SyhyKTtkZShlLHtuYW1lOnQ9ZWUodCksZnJvbVdpcmVUeXBlOmZ1bmN0aW9uKGUpe3JldHVybiEhZX0sdG9XaXJlVHlwZTpmdW5jdGlvbihlLHQpe3JldHVybiB0P246YX0sYXJnUGFja0FkdmFuY2U6OCxyZWFkVmFsdWVGcm9tUG9pbnRlcjpmdW5jdGlvbihlKXt2YXIgbjtpZigxPT09ciluPXM7ZWxzZSBpZigyPT09ciluPWY7ZWxzZXtpZig0IT09cil0aHJvdyBuZXcgVHlwZUVycm9yKCJVbmtub3duIGJvb2xlYW4gdHlwZSBzaXplOiAiK3QpO249ZH1yZXR1cm4gdGhpcy5mcm9tV2lyZVR5cGUobltlPj5vXSl9LGRlc3RydWN0b3JGdW5jdGlvbjpudWxsfSl9LGc6ZnVuY3Rpb24oZSxyLG4sYSxvLGksdSxzLGMsZixsLGQscCl7bD1lZShsKSxpPUllKG8saSkscyYmKHM9SWUodSxzKSksZiYmKGY9SWUoYyxmKSkscD1JZShkLHApO3ZhciBoPWFlKGwpOyFmdW5jdGlvbihlLHIsbil7dC5oYXNPd25Qcm9wZXJ0eShlKT8oc2UoIkNhbm5vdCByZWdpc3RlciBwdWJsaWMgbmFtZSAnIitlKyInIHR3aWNlIiksX2UodCxlLGUpLHQuaGFzT3duUHJvcGVydHkobikmJnNlKCJDYW5ub3QgcmVnaXN0ZXIgbXVsdGlwbGUgb3ZlcmxvYWRzIG9mIGEgZnVuY3Rpb24gd2l0aCB0aGUgc2FtZSBudW1iZXIgb2YgYXJndW1lbnRzICgiK24rIikhIiksdFtlXS5vdmVybG9hZFRhYmxlW25dPXIpOnRbZV09cn0oaCwoZnVuY3Rpb24oKXtZZSgiQ2Fubm90IGNvbnN0cnVjdCAiK2wrIiBkdWUgdG8gdW5ib3VuZCB0eXBlcyIsW2FdKX0pKSxsZShbZSxyLG5dLGE/W2FdOltdLChmdW5jdGlvbihyKXtyPXJbMF0sbz1hPyhuPXIucmVnaXN0ZXJlZENsYXNzKS5pbnN0YW5jZVByb3RvdHlwZTpUZS5wcm90b3R5cGU7dmFyIG4sbyx1PW9lKGgsKGZ1bmN0aW9uKCl7aWYoT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpIT09Yyl0aHJvdyBuZXcgdWUoIlVzZSAnbmV3JyB0byBjb25zdHJ1Y3QgIitsKTtpZih2b2lkIDA9PT1tLmNvbnN0cnVjdG9yX2JvZHkpdGhyb3cgbmV3IHVlKGwrIiBoYXMgbm8gYWNjZXNzaWJsZSBjb25zdHJ1Y3RvciIpO3ZhciBlPW0uY29uc3RydWN0b3JfYm9keVthcmd1bWVudHMubGVuZ3RoXTtpZih2b2lkIDA9PT1lKXRocm93IG5ldyB1ZSgiVHJpZWQgdG8gaW52b2tlIGN0b3Igb2YgIitsKyIgd2l0aCBpbnZhbGlkIG51bWJlciBvZiBwYXJhbWV0ZXJzICgiK2FyZ3VtZW50cy5sZW5ndGgrIikgLSBleHBlY3RlZCAoIitPYmplY3Qua2V5cyhtLmNvbnN0cnVjdG9yX2JvZHkpLnRvU3RyaW5nKCkrIikgcGFyYW1ldGVycyBpbnN0ZWFkISIpO3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pKSxjPU9iamVjdC5jcmVhdGUobyx7Y29uc3RydWN0b3I6e3ZhbHVlOnV9fSk7dS5wcm90b3R5cGU9Yzt2YXIgZCx5LG09bmV3IENlKGwsdSxjLHAsbixpLHMsZiksZz1uZXcgV2UobCxtLCEwLCExLCExKSx2PW5ldyBXZShsKyIqIixtLCExLCExLCExKSx3PW5ldyBXZShsKyIgY29uc3QqIixtLCExLCEwLCExKTtyZXR1cm4gJGVbZV09e3BvaW50ZXJUeXBlOnYsY29uc3RQb2ludGVyVHlwZTp3fSxkPWgseT11LHQuaGFzT3duUHJvcGVydHkoZCl8fGZlKCJSZXBsYWNpbmcgbm9uZXhpc3RhbnQgcHVibGljIHN5bWJvbCIpLHRbZF0ub3ZlcmxvYWRUYWJsZSx0W2RdPXksdFtkXS5hcmdDb3VudD11bmRlZmluZWQsW2csdix3XX0pKX0sZjpmdW5jdGlvbihlLHQscixuLGEsbyl7dD4wfHxWKCJBc3NlcnRpb24gZmFpbGVkOiB1bmRlZmluZWQiKTt2YXIgaT1VZSh0LHIpO2E9SWUobixhKTt2YXIgdT1bb10scz1bXTtsZShbXSxbZV0sKGZ1bmN0aW9uKGUpe3ZhciByPSJjb25zdHJ1Y3RvciAiKyhlPWVbMF0pLm5hbWU7aWYodm9pZCAwPT09ZS5yZWdpc3RlcmVkQ2xhc3MuY29uc3RydWN0b3JfYm9keSYmKGUucmVnaXN0ZXJlZENsYXNzLmNvbnN0cnVjdG9yX2JvZHk9W10pLHZvaWQgMCE9PWUucmVnaXN0ZXJlZENsYXNzLmNvbnN0cnVjdG9yX2JvZHlbdC0xXSl0aHJvdyBuZXcgdWUoIkNhbm5vdCByZWdpc3RlciBtdWx0aXBsZSBjb25zdHJ1Y3RvcnMgd2l0aCBpZGVudGljYWwgbnVtYmVyIG9mIHBhcmFtZXRlcnMgKCIrKHQtMSkrIikgZm9yIGNsYXNzICciK2UubmFtZSsiJyEgT3ZlcmxvYWQgcmVzb2x1dGlvbiBpcyBjdXJyZW50bHkgb25seSBwZXJmb3JtZWQgdXNpbmcgdGhlIHBhcmFtZXRlciBjb3VudCwgbm90IGFjdHVhbCB0eXBlIGluZm8hIik7cmV0dXJuIGUucmVnaXN0ZXJlZENsYXNzLmNvbnN0cnVjdG9yX2JvZHlbdC0xXT1mdW5jdGlvbigpe1llKCJDYW5ub3QgY29uc3RydWN0ICIrZS5uYW1lKyIgZHVlIHRvIHVuYm91bmQgdHlwZXMiLGkpfSxsZShbXSxpLChmdW5jdGlvbihuKXtyZXR1cm4gZS5yZWdpc3RlcmVkQ2xhc3MuY29uc3RydWN0b3JfYm9keVt0LTFdPWZ1bmN0aW9uKCl7YXJndW1lbnRzLmxlbmd0aCE9PXQtMSYmc2UocisiIGNhbGxlZCB3aXRoICIrYXJndW1lbnRzLmxlbmd0aCsiIGFyZ3VtZW50cywgZXhwZWN0ZWQgIisodC0xKSkscy5sZW5ndGg9MCx1Lmxlbmd0aD10O2Zvcih2YXIgZT0xO2U8dDsrK2UpdVtlXT1uW2VdLnRvV2lyZVR5cGUocyxhcmd1bWVudHNbZS0xXSk7dmFyIG89YS5hcHBseShudWxsLHUpO3JldHVybiB4ZShzKSxuWzBdLmZyb21XaXJlVHlwZShvKX0sW119KSksW119KSl9LGE6ZnVuY3Rpb24oZSx0LHIsbixhLG8saSx1KXt2YXIgcz1VZShyLG4pO3Q9ZWUodCksbz1JZShhLG8pLGxlKFtdLFtlXSwoZnVuY3Rpb24oZSl7dmFyIG49KGU9ZVswXSkubmFtZSsiLiIrdDtmdW5jdGlvbiBhKCl7WWUoIkNhbm5vdCBjYWxsICIrbisiIGR1ZSB0byB1bmJvdW5kIHR5cGVzIixzKX11JiZlLnJlZ2lzdGVyZWRDbGFzcy5wdXJlVmlydHVhbEZ1bmN0aW9ucy5wdXNoKHQpO3ZhciBjPWUucmVnaXN0ZXJlZENsYXNzLmluc3RhbmNlUHJvdG90eXBlLGY9Y1t0XTtyZXR1cm4gdm9pZCAwPT09Znx8dm9pZCAwPT09Zi5vdmVybG9hZFRhYmxlJiZmLmNsYXNzTmFtZSE9PWUubmFtZSYmZi5hcmdDb3VudD09PXItMj8oYS5hcmdDb3VudD1yLTIsYS5jbGFzc05hbWU9ZS5uYW1lLGNbdF09YSk6KF9lKGMsdCxuKSxjW3RdLm92ZXJsb2FkVGFibGVbci0yXT1hKSxsZShbXSxzLChmdW5jdGlvbihhKXt2YXIgdT1mdW5jdGlvbihlLHQscixuLGEpe3ZhciBvPXQubGVuZ3RoO288MiYmc2UoImFyZ1R5cGVzIGFycmF5IHNpemUgbWlzbWF0Y2ghIE11c3QgYXQgbGVhc3QgZ2V0IHJldHVybiB2YWx1ZSBhbmQgJ3RoaXMnIHR5cGVzISIpO2Zvcih2YXIgaT1udWxsIT09dFsxXSYmbnVsbCE9PXIsdT0hMSxzPTE7czx0Lmxlbmd0aDsrK3MpaWYobnVsbCE9PXRbc10mJnZvaWQgMD09PXRbc10uZGVzdHJ1Y3RvckZ1bmN0aW9uKXt1PSEwO2JyZWFrfXZhciBjPSJ2b2lkIiE9PXRbMF0ubmFtZSxmPSIiLGw9IiI7Zm9yKHM9MDtzPG8tMjsrK3MpZis9KDAhPT1zPyIsICI6IiIpKyJhcmciK3MsbCs9KDAhPT1zPyIsICI6IiIpKyJhcmciK3MrIldpcmVkIjt2YXIgZD0icmV0dXJuIGZ1bmN0aW9uICIrYWUoZSkrIigiK2YrIikge1xuaWYgKGFyZ3VtZW50cy5sZW5ndGggIT09ICIrKG8tMikrIikge1xudGhyb3dCaW5kaW5nRXJyb3IoJ2Z1bmN0aW9uICIrZSsiIGNhbGxlZCB3aXRoICcgKyBhcmd1bWVudHMubGVuZ3RoICsgJyBhcmd1bWVudHMsIGV4cGVjdGVkICIrKG8tMikrIiBhcmdzIScpO1xufVxuIjt1JiYoZCs9InZhciBkZXN0cnVjdG9ycyA9IFtdO1xuIik7dmFyIHA9dT8iZGVzdHJ1Y3RvcnMiOiJudWxsIixoPVsidGhyb3dCaW5kaW5nRXJyb3IiLCJpbnZva2VyIiwiZm4iLCJydW5EZXN0cnVjdG9ycyIsInJldFR5cGUiLCJjbGFzc1BhcmFtIl0seT1bc2UsbixhLHhlLHRbMF0sdFsxXV07Zm9yKGkmJihkKz0idmFyIHRoaXNXaXJlZCA9IGNsYXNzUGFyYW0udG9XaXJlVHlwZSgiK3ArIiwgdGhpcyk7XG4iKSxzPTA7czxvLTI7KytzKWQrPSJ2YXIgYXJnIitzKyJXaXJlZCA9IGFyZ1R5cGUiK3MrIi50b1dpcmVUeXBlKCIrcCsiLCBhcmciK3MrIik7IC8vICIrdFtzKzJdLm5hbWUrIlxuIixoLnB1c2goImFyZ1R5cGUiK3MpLHkucHVzaCh0W3MrMl0pO2lmKGkmJihsPSJ0aGlzV2lyZWQiKyhsLmxlbmd0aD4wPyIsICI6IiIpK2wpLGQrPShjPyJ2YXIgcnYgPSAiOiIiKSsiaW52b2tlcihmbiIrKGwubGVuZ3RoPjA/IiwgIjoiIikrbCsiKTtcbiIsdSlkKz0icnVuRGVzdHJ1Y3RvcnMoZGVzdHJ1Y3RvcnMpO1xuIjtlbHNlIGZvcihzPWk/MToyO3M8dC5sZW5ndGg7KytzKXt2YXIgbT0xPT09cz8idGhpc1dpcmVkIjoiYXJnIisocy0yKSsiV2lyZWQiO251bGwhPT10W3NdLmRlc3RydWN0b3JGdW5jdGlvbiYmKGQrPW0rIl9kdG9yKCIrbSsiKTsgLy8gIit0W3NdLm5hbWUrIlxuIixoLnB1c2gobSsiX2R0b3IiKSx5LnB1c2godFtzXS5kZXN0cnVjdG9yRnVuY3Rpb24pKX1yZXR1cm4gYyYmKGQrPSJ2YXIgcmV0ID0gcmV0VHlwZS5mcm9tV2lyZVR5cGUocnYpO1xucmV0dXJuIHJldDtcbiIpLGQrPSJ9XG4iLGgucHVzaChkKSxmdW5jdGlvbihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJuZXdfIGNhbGxlZCB3aXRoIGNvbnN0cnVjdG9yIHR5cGUgIit0eXBlb2YgZSsiIHdoaWNoIGlzIG5vdCBhIGZ1bmN0aW9uIik7dmFyIHI9b2UoZS5uYW1lfHwidW5rbm93bkZ1bmN0aW9uTmFtZSIsKGZ1bmN0aW9uKCl7fSkpO3IucHJvdG90eXBlPWUucHJvdG90eXBlO3ZhciBuPW5ldyByLGE9ZS5hcHBseShuLHQpO3JldHVybiBhIGluc3RhbmNlb2YgT2JqZWN0P2E6bn0oRnVuY3Rpb24saCkuYXBwbHkobnVsbCx5KX0obixhLGUsbyxpKTtyZXR1cm4gdm9pZCAwPT09Y1t0XS5vdmVybG9hZFRhYmxlPyh1LmFyZ0NvdW50PXItMixjW3RdPXUpOmNbdF0ub3ZlcmxvYWRUYWJsZVtyLTJdPXUsW119KSksW119KSl9LHA6ZnVuY3Rpb24oZSx0LHIsbixhLG8saSx1LHMsYyl7dD1lZSh0KSxhPUllKG4sYSksbGUoW10sW2VdLChmdW5jdGlvbihlKXt2YXIgbj0oZT1lWzBdKS5uYW1lKyIuIit0LGY9e2dldDpmdW5jdGlvbigpe1llKCJDYW5ub3QgYWNjZXNzICIrbisiIGR1ZSB0byB1bmJvdW5kIHR5cGVzIixbcixpXSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfTtyZXR1cm4gZi5zZXQ9cz9mdW5jdGlvbigpe1llKCJDYW5ub3QgYWNjZXNzICIrbisiIGR1ZSB0byB1bmJvdW5kIHR5cGVzIixbcixpXSl9OmZ1bmN0aW9uKGUpe3NlKG4rIiBpcyBhIHJlYWQtb25seSBwcm9wZXJ0eSIpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5yZWdpc3RlcmVkQ2xhc3MuaW5zdGFuY2VQcm90b3R5cGUsdCxmKSxsZShbXSxzP1tyLGldOltyXSwoZnVuY3Rpb24ocil7dmFyIGk9clswXSxmPXtnZXQ6ZnVuY3Rpb24oKXt2YXIgdD1IZSh0aGlzLGUsbisiIGdldHRlciIpO3JldHVybiBpLmZyb21XaXJlVHlwZShhKG8sdCkpfSxlbnVtZXJhYmxlOiEwfTtpZihzKXtzPUllKHUscyk7dmFyIGw9clsxXTtmLnNldD1mdW5jdGlvbih0KXt2YXIgcj1IZSh0aGlzLGUsbisiIHNldHRlciIpLGE9W107cyhjLHIsbC50b1dpcmVUeXBlKGEsdCkpLHhlKGEpfX1yZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KGUucmVnaXN0ZXJlZENsYXNzLmluc3RhbmNlUHJvdG90eXBlLHQsZiksW119KSksW119KSl9LHg6ZnVuY3Rpb24oZSx0KXtkZShlLHtuYW1lOnQ9ZWUodCksZnJvbVdpcmVUeXBlOmZ1bmN0aW9uKGUpe3ZhciB0PXplW2VdLnZhbHVlO3JldHVybiBOZShlKSx0fSx0b1dpcmVUeXBlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIEJlKHQpfSxhcmdQYWNrQWR2YW5jZTo4LHJlYWRWYWx1ZUZyb21Qb2ludGVyOlNlLGRlc3RydWN0b3JGdW5jdGlvbjpudWxsfSl9LGw6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuPUsocik7ZGUoZSx7bmFtZTp0PWVlKHQpLGZyb21XaXJlVHlwZTpmdW5jdGlvbihlKXtyZXR1cm4gZX0sdG9XaXJlVHlwZTpmdW5jdGlvbihlLHQpe2lmKCJudW1iZXIiIT10eXBlb2YgdCYmImJvb2xlYW4iIT10eXBlb2YgdCl0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29udmVydCAiJytWZSh0KSsnIiB0byAnK3RoaXMubmFtZSk7cmV0dXJuIHR9LGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6ZnVuY3Rpb24oZSx0KXtzd2l0Y2godCl7Y2FzZSAyOnJldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5mcm9tV2lyZVR5cGUoaFtlPj4yXSl9O2Nhc2UgMzpyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZnJvbVdpcmVUeXBlKHlbZT4+M10pfTtkZWZhdWx0OnRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gZmxvYXQgdHlwZTogIitlKX19KHQsbiksZGVzdHJ1Y3RvckZ1bmN0aW9uOm51bGx9KX0sZTpmdW5jdGlvbihlLHQscixuLGEpe3Q9ZWUodCksLTE9PT1hJiYoYT00Mjk0OTY3Mjk1KTt2YXIgbz1LKHIpLGk9ZnVuY3Rpb24oZSl7cmV0dXJuIGV9O2lmKDA9PT1uKXt2YXIgdT0zMi04KnI7aT1mdW5jdGlvbihlKXtyZXR1cm4gZTw8dT4+PnV9fXZhciBoPS0xIT10LmluZGV4T2YoInVuc2lnbmVkIik7ZGUoZSx7bmFtZTp0LGZyb21XaXJlVHlwZTppLHRvV2lyZVR5cGU6ZnVuY3Rpb24oZSxyKXtpZigibnVtYmVyIiE9dHlwZW9mIHImJiJib29sZWFuIiE9dHlwZW9mIHIpdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNvbnZlcnQgIicrVmUocikrJyIgdG8gJyt0aGlzLm5hbWUpO2lmKHI8bnx8cj5hKXRocm93IG5ldyBUeXBlRXJyb3IoJ1Bhc3NpbmcgYSBudW1iZXIgIicrVmUocikrJyIgZnJvbSBKUyBzaWRlIHRvIEMvQysrIHNpZGUgdG8gYW4gYXJndW1lbnQgb2YgdHlwZSAiJyt0KyciLCB3aGljaCBpcyBvdXRzaWRlIHRoZSB2YWxpZCByYW5nZSBbJytuKyIsICIrYSsiXSEiKTtyZXR1cm4gaD9yPj4+MDowfHJ9LGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6ZnVuY3Rpb24oZSx0LHIpe3N3aXRjaCh0KXtjYXNlIDA6cmV0dXJuIHI/ZnVuY3Rpb24oZSl7cmV0dXJuIHNbZV19OmZ1bmN0aW9uKGUpe3JldHVybiBjW2VdfTtjYXNlIDE6cmV0dXJuIHI/ZnVuY3Rpb24oZSl7cmV0dXJuIGZbZT4+MV19OmZ1bmN0aW9uKGUpe3JldHVybiBsW2U+PjFdfTtjYXNlIDI6cmV0dXJuIHI/ZnVuY3Rpb24oZSl7cmV0dXJuIGRbZT4+Ml19OmZ1bmN0aW9uKGUpe3JldHVybiBwW2U+PjJdfTtkZWZhdWx0OnRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gaW50ZWdlciB0eXBlOiAiK2UpfX0odCxvLDAhPT1uKSxkZXN0cnVjdG9yRnVuY3Rpb246bnVsbH0pfSxkOmZ1bmN0aW9uKGUsdCxyKXt2YXIgbj1bSW50OEFycmF5LFVpbnQ4QXJyYXksSW50MTZBcnJheSxVaW50MTZBcnJheSxJbnQzMkFycmF5LFVpbnQzMkFycmF5LEZsb2F0MzJBcnJheSxGbG9hdDY0QXJyYXldW3RdO2Z1bmN0aW9uIGEoZSl7dmFyIHQ9cCxyPXRbZT4+PTJdLGE9dFtlKzFdO3JldHVybiBuZXcgbih1LGEscil9ZGUoZSx7bmFtZTpyPWVlKHIpLGZyb21XaXJlVHlwZTphLGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6YX0se2lnbm9yZUR1cGxpY2F0ZVJlZ2lzdHJhdGlvbnM6ITB9KX0sbTpmdW5jdGlvbihlLHQpe3ZhciByPSJzdGQ6OnN0cmluZyI9PT0odD1lZSh0KSk7ZGUoZSx7bmFtZTp0LGZyb21XaXJlVHlwZTpmdW5jdGlvbihlKXt2YXIgdCxuPXBbZT4+Ml07aWYocilmb3IodmFyIGE9ZSs0LG89MDtvPD1uOysrbyl7dmFyIGk9ZSs0K287aWYobz09bnx8MD09Y1tpXSl7dmFyIHU9UChhLGktYSk7dm9pZCAwPT09dD90PXU6KHQrPSJcMCIsdCs9dSksYT1pKzF9fWVsc2V7dmFyIHM9bmV3IEFycmF5KG4pO2ZvcihvPTA7bzxuOysrbylzW29dPVN0cmluZy5mcm9tQ2hhckNvZGUoY1tlKzQrb10pO3Q9cy5qb2luKCIiKX1yZXR1cm4gb3QoZSksdH0sdG9XaXJlVHlwZTpmdW5jdGlvbihlLHQpe3QgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciYmKHQ9bmV3IFVpbnQ4QXJyYXkodCkpO3ZhciBuPSJzdHJpbmciPT10eXBlb2YgdDtufHx0IGluc3RhbmNlb2YgVWludDhBcnJheXx8dCBpbnN0YW5jZW9mIFVpbnQ4Q2xhbXBlZEFycmF5fHx0IGluc3RhbmNlb2YgSW50OEFycmF5fHxzZSgiQ2Fubm90IHBhc3Mgbm9uLXN0cmluZyB0byBzdGQ6OnN0cmluZyIpO3ZhciBhPShyJiZuP2Z1bmN0aW9uKCl7cmV0dXJuIEEodCl9OmZ1bmN0aW9uKCl7cmV0dXJuIHQubGVuZ3RofSkoKSxvPW50KDQrYSsxKTtpZihwW28+PjJdPWEsciYmbilEKHQsYyxvKzQsYSsxKTtlbHNlIGlmKG4pZm9yKHZhciBpPTA7aTxhOysraSl7dmFyIHU9dC5jaGFyQ29kZUF0KGkpO3U+MjU1JiYob3Qobyksc2UoIlN0cmluZyBoYXMgVVRGLTE2IGNvZGUgdW5pdHMgdGhhdCBkbyBub3QgZml0IGluIDggYml0cyIpKSxjW28rNCtpXT11fWVsc2UgZm9yKGk9MDtpPGE7KytpKWNbbys0K2ldPXRbaV07cmV0dXJuIG51bGwhPT1lJiZlLnB1c2gob3Qsbyksb30sYXJnUGFja0FkdmFuY2U6OCxyZWFkVmFsdWVGcm9tUG9pbnRlcjpTZSxkZXN0cnVjdG9yRnVuY3Rpb246ZnVuY3Rpb24oZSl7b3QoZSl9fSl9LGk6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuLGEsbyxpLHU7cj1lZShyKSwyPT09dD8obj1TLGE9RixpPU0sbz1mdW5jdGlvbigpe3JldHVybiBsfSx1PTEpOjQ9PT10JiYobj1FLGE9VyxpPUksbz1mdW5jdGlvbigpe3JldHVybiBwfSx1PTIpLGRlKGUse25hbWU6cixmcm9tV2lyZVR5cGU6ZnVuY3Rpb24oZSl7Zm9yKHZhciByLGE9cFtlPj4yXSxpPW8oKSxzPWUrNCxjPTA7Yzw9YTsrK2Mpe3ZhciBmPWUrNCtjKnQ7aWYoYz09YXx8MD09aVtmPj51XSl7dmFyIGw9bihzLGYtcyk7dm9pZCAwPT09cj9yPWw6KHIrPSJcMCIscis9bCkscz1mK3R9fXJldHVybiBvdChlKSxyfSx0b1dpcmVUeXBlOmZ1bmN0aW9uKGUsbil7InN0cmluZyIhPXR5cGVvZiBuJiZzZSgiQ2Fubm90IHBhc3Mgbm9uLXN0cmluZyB0byBDKysgc3RyaW5nIHR5cGUgIityKTt2YXIgbz1pKG4pLHM9bnQoNCtvK3QpO3JldHVybiBwW3M+PjJdPW8+PnUsYShuLHMrNCxvK3QpLG51bGwhPT1lJiZlLnB1c2gob3Qscyksc30sYXJnUGFja0FkdmFuY2U6OCxyZWFkVmFsdWVGcm9tUG9pbnRlcjpTZSxkZXN0cnVjdG9yRnVuY3Rpb246ZnVuY3Rpb24oZSl7b3QoZSl9fSl9LHo6ZnVuY3Rpb24oZSx0KXtkZShlLHtpc1ZvaWQ6ITAsbmFtZTp0PWVlKHQpLGFyZ1BhY2tBZHZhbmNlOjAsZnJvbVdpcmVUeXBlOmZ1bmN0aW9uKCl7fSx0b1dpcmVUeXBlOmZ1bmN0aW9uKGUsdCl7fX0pfSxuOk5lLG86ZnVuY3Rpb24oZSl7ZT40JiYoemVbZV0ucmVmY291bnQrPTEpfSxoOmZ1bmN0aW9uKGUsdCl7dmFyIHIsbjtyZXR1cm4gQmUoKHZvaWQgMD09PShuPXJlW3I9ZV0pJiZzZSgiX2VtdmFsX3Rha2VfdmFsdWUgaGFzIHVua25vd24gdHlwZSAiK1JlKHIpKSxlPW4pLnJlYWRWYWx1ZUZyb21Qb2ludGVyKHQpKX0sazpmdW5jdGlvbigpe1YoKX0sdjpmdW5jdGlvbihlLHQpe3ZhciByO2lmKDA9PT1lKXI9RGF0ZS5ub3coKTtlbHNle2lmKDEhPT1lJiY0IT09ZSlyZXR1cm4gZFtydCgpPj4yXT0yOCwtMTtyPWcoKX1yZXR1cm4gZFt0Pj4yXT1yLzFlM3wwLGRbdCs0Pj4yXT1yJTFlMyoxZTZ8MCwwfSx0OmZ1bmN0aW9uKGUsdCxyKXtjLmNvcHlXaXRoaW4oZSx0LHQrcil9LHU6ZnVuY3Rpb24oZSl7VigiT09NIil9LHE6ZnVuY3Rpb24oZSl7WigpO3ZhciB0PW5ldyBEYXRlKGRbZSsyMD4+Ml0rMTkwMCxkW2UrMTY+PjJdLGRbZSsxMj4+Ml0sZFtlKzg+PjJdLGRbZSs0Pj4yXSxkW2U+PjJdLDApLHI9ZFtlKzMyPj4yXSxuPXQuZ2V0VGltZXpvbmVPZmZzZXQoKSxhPW5ldyBEYXRlKHQuZ2V0RnVsbFllYXIoKSwwLDEpLG89bmV3IERhdGUodC5nZXRGdWxsWWVhcigpLDYsMSkuZ2V0VGltZXpvbmVPZmZzZXQoKSxpPWEuZ2V0VGltZXpvbmVPZmZzZXQoKSx1PU1hdGgubWluKGksbyk7aWYocjwwKWRbZSszMj4+Ml09TnVtYmVyKG8hPWkmJnU9PW4pO2Vsc2UgaWYocj4wIT0odT09bikpe3ZhciBzPU1hdGgubWF4KGksbyksYz1yPjA/dTpzO3Quc2V0VGltZSh0LmdldFRpbWUoKSs2ZTQqKGMtbikpfWRbZSsyND4+Ml09dC5nZXREYXkoKTt2YXIgZj0odC5nZXRUaW1lKCktYS5nZXRUaW1lKCkpLzg2NGU1fDA7cmV0dXJuIGRbZSsyOD4+Ml09ZixkW2U+PjJdPXQuZ2V0U2Vjb25kcygpLGRbZSs0Pj4yXT10LmdldE1pbnV0ZXMoKSxkW2UrOD4+Ml09dC5nZXRIb3VycygpLGRbZSsxMj4+Ml09dC5nZXREYXRlKCksZFtlKzE2Pj4yXT10LmdldE1vbnRoKCksdC5nZXRUaW1lKCkvMWUzfDB9LHM6ZnVuY3Rpb24oZSx0LHIsbil7dmFyIGEsbyxpPWRbbis0MD4+Ml0sdT17dG1fc2VjOmRbbj4+Ml0sdG1fbWluOmRbbis0Pj4yXSx0bV9ob3VyOmRbbis4Pj4yXSx0bV9tZGF5OmRbbisxMj4+Ml0sdG1fbW9uOmRbbisxNj4+Ml0sdG1feWVhcjpkW24rMjA+PjJdLHRtX3dkYXk6ZFtuKzI0Pj4yXSx0bV95ZGF5OmRbbisyOD4+Ml0sdG1faXNkc3Q6ZFtuKzMyPj4yXSx0bV9nbXRvZmY6ZFtuKzM2Pj4yXSx0bV96b25lOmk/UChpKToiIn0sYz1QKHIpLGY9eyIlYyI6IiVhICViICVkICVIOiVNOiVTICVZIiwiJUQiOiIlbS8lZC8leSIsIiVGIjoiJVktJW0tJWQiLCIlaCI6IiViIiwiJXIiOiIlSTolTTolUyAlcCIsIiVSIjoiJUg6JU0iLCIlVCI6IiVIOiVNOiVTIiwiJXgiOiIlbS8lZC8leSIsIiVYIjoiJUg6JU06JVMiLCIlRWMiOiIlYyIsIiVFQyI6IiVDIiwiJUV4IjoiJW0vJWQvJXkiLCIlRVgiOiIlSDolTTolUyIsIiVFeSI6IiV5IiwiJUVZIjoiJVkiLCIlT2QiOiIlZCIsIiVPZSI6IiVlIiwiJU9IIjoiJUgiLCIlT0kiOiIlSSIsIiVPbSI6IiVtIiwiJU9NIjoiJU0iLCIlT1MiOiIlUyIsIiVPdSI6IiV1IiwiJU9VIjoiJVUiLCIlT1YiOiIlViIsIiVPdyI6IiV3IiwiJU9XIjoiJVciLCIlT3kiOiIleSJ9O2Zvcih2YXIgbCBpbiBmKWM9Yy5yZXBsYWNlKG5ldyBSZWdFeHAobCwiZyIpLGZbbF0pO3ZhciBwPVsiU3VuZGF5IiwiTW9uZGF5IiwiVHVlc2RheSIsIldlZG5lc2RheSIsIlRodXJzZGF5IiwiRnJpZGF5IiwiU2F0dXJkYXkiXSxoPVsiSmFudWFyeSIsIkZlYnJ1YXJ5IiwiTWFyY2giLCJBcHJpbCIsIk1heSIsIkp1bmUiLCJKdWx5IiwiQXVndXN0IiwiU2VwdGVtYmVyIiwiT2N0b2JlciIsIk5vdmVtYmVyIiwiRGVjZW1iZXIiXTtmdW5jdGlvbiB5KGUsdCxyKXtmb3IodmFyIG49Im51bWJlciI9PXR5cGVvZiBlP2UudG9TdHJpbmcoKTplfHwiIjtuLmxlbmd0aDx0OyluPXJbMF0rbjtyZXR1cm4gbn1mdW5jdGlvbiBtKGUsdCl7cmV0dXJuIHkoZSx0LCIwIil9ZnVuY3Rpb24gZyhlLHQpe3ZhciByO2Z1bmN0aW9uIG4oZSl7cmV0dXJuIGU8MD8tMTplPjA/MTowfXJldHVybiAwPT09KHI9bihlLmdldEZ1bGxZZWFyKCktdC5nZXRGdWxsWWVhcigpKSkmJjA9PT0ocj1uKGUuZ2V0TW9udGgoKS10LmdldE1vbnRoKCkpKSYmKHI9bihlLmdldERhdGUoKS10LmdldERhdGUoKSkpLHJ9ZnVuY3Rpb24gdihlKXtzd2l0Y2goZS5nZXREYXkoKSl7Y2FzZSAwOnJldHVybiBuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCktMSwxMSwyOSk7Y2FzZSAxOnJldHVybiBlO2Nhc2UgMjpyZXR1cm4gbmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLDAsMyk7Y2FzZSAzOnJldHVybiBuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCksMCwyKTtjYXNlIDQ6cmV0dXJuIG5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKSwwLDEpO2Nhc2UgNTpyZXR1cm4gbmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLTEsMTEsMzEpO2Nhc2UgNjpyZXR1cm4gbmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLTEsMTEsMzApfX1mdW5jdGlvbiB3KGUpe3ZhciB0PVhlKG5ldyBEYXRlKGUudG1feWVhcisxOTAwLDAsMSksZS50bV95ZGF5KSxyPW5ldyBEYXRlKHQuZ2V0RnVsbFllYXIoKSwwLDQpLG49bmV3IERhdGUodC5nZXRGdWxsWWVhcigpKzEsMCw0KSxhPXYociksbz12KG4pO3JldHVybiAwPj1nKGEsdCk/MD49ZyhvLHQpP3QuZ2V0RnVsbFllYXIoKSsxOnQuZ2V0RnVsbFllYXIoKTp0LmdldEZ1bGxZZWFyKCktMX12YXIgYj17IiVhIjpmdW5jdGlvbihlKXtyZXR1cm4gcFtlLnRtX3dkYXldLnN1YnN0cmluZygwLDMpfSwiJUEiOmZ1bmN0aW9uKGUpe3JldHVybiBwW2UudG1fd2RheV19LCIlYiI6ZnVuY3Rpb24oZSl7cmV0dXJuIGhbZS50bV9tb25dLnN1YnN0cmluZygwLDMpfSwiJUIiOmZ1bmN0aW9uKGUpe3JldHVybiBoW2UudG1fbW9uXX0sIiVDIjpmdW5jdGlvbihlKXtyZXR1cm4gbSgoZS50bV95ZWFyKzE5MDApLzEwMHwwLDIpfSwiJWQiOmZ1bmN0aW9uKGUpe3JldHVybiBtKGUudG1fbWRheSwyKX0sIiVlIjpmdW5jdGlvbihlKXtyZXR1cm4geShlLnRtX21kYXksMiwiICIpfSwiJWciOmZ1bmN0aW9uKGUpe3JldHVybiB3KGUpLnRvU3RyaW5nKCkuc3Vic3RyaW5nKDIpfSwiJUciOmZ1bmN0aW9uKGUpe3JldHVybiB3KGUpfSwiJUgiOmZ1bmN0aW9uKGUpe3JldHVybiBtKGUudG1faG91ciwyKX0sIiVJIjpmdW5jdGlvbihlKXt2YXIgdD1lLnRtX2hvdXI7cmV0dXJuIDA9PXQ/dD0xMjp0PjEyJiYodC09MTIpLG0odCwyKX0sIiVqIjpmdW5jdGlvbihlKXtyZXR1cm4gbShlLnRtX21kYXkrSmUoTGUoZS50bV95ZWFyKzE5MDApP0dlOnFlLGUudG1fbW9uLTEpLDMpfSwiJW0iOmZ1bmN0aW9uKGUpe3JldHVybiBtKGUudG1fbW9uKzEsMil9LCIlTSI6ZnVuY3Rpb24oZSl7cmV0dXJuIG0oZS50bV9taW4sMil9LCIlbiI6ZnVuY3Rpb24oKXtyZXR1cm4iXG4ifSwiJXAiOmZ1bmN0aW9uKGUpe3JldHVybiBlLnRtX2hvdXI+PTAmJmUudG1faG91cjwxMj8iQU0iOiJQTSJ9LCIlUyI6ZnVuY3Rpb24oZSl7cmV0dXJuIG0oZS50bV9zZWMsMil9LCIldCI6ZnVuY3Rpb24oKXtyZXR1cm4iXHQifSwiJXUiOmZ1bmN0aW9uKGUpe3JldHVybiBlLnRtX3dkYXl8fDd9LCIlVSI6ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IERhdGUoZS50bV95ZWFyKzE5MDAsMCwxKSxyPTA9PT10LmdldERheSgpP3Q6WGUodCw3LXQuZ2V0RGF5KCkpLG49bmV3IERhdGUoZS50bV95ZWFyKzE5MDAsZS50bV9tb24sZS50bV9tZGF5KTtpZigwPmcocixuKSl7dmFyIGE9SmUoTGUobi5nZXRGdWxsWWVhcigpKT9HZTpxZSxuLmdldE1vbnRoKCktMSktMzE7cmV0dXJuIG0oTWF0aC5jZWlsKCgzMS1yLmdldERhdGUoKSthK24uZ2V0RGF0ZSgpKS83KSwyKX1yZXR1cm4gMD09PWcocix0KT8iMDEiOiIwMCJ9LCIlViI6ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IERhdGUoZS50bV95ZWFyKzE5MDAsMCw0KSxyPW5ldyBEYXRlKGUudG1feWVhcisxOTAxLDAsNCksbj12KHQpLGE9dihyKSxvPVhlKG5ldyBEYXRlKGUudG1feWVhcisxOTAwLDAsMSksZS50bV95ZGF5KTtyZXR1cm4gMD5nKG8sbik/IjUzIjowPj1nKGEsbyk/IjAxIjptKE1hdGguY2VpbCgobi5nZXRGdWxsWWVhcigpPGUudG1feWVhcisxOTAwP2UudG1feWRheSszMi1uLmdldERhdGUoKTplLnRtX3lkYXkrMS1uLmdldERhdGUoKSkvNyksMil9LCIldyI6ZnVuY3Rpb24oZSl7cmV0dXJuIGUudG1fd2RheX0sIiVXIjpmdW5jdGlvbihlKXt2YXIgdD1uZXcgRGF0ZShlLnRtX3llYXIsMCwxKSxyPTE9PT10LmdldERheSgpP3Q6WGUodCwwPT09dC5nZXREYXkoKT8xOjctdC5nZXREYXkoKSsxKSxuPW5ldyBEYXRlKGUudG1feWVhcisxOTAwLGUudG1fbW9uLGUudG1fbWRheSk7aWYoMD5nKHIsbikpe3ZhciBhPUplKExlKG4uZ2V0RnVsbFllYXIoKSk/R2U6cWUsbi5nZXRNb250aCgpLTEpLTMxO3JldHVybiBtKE1hdGguY2VpbCgoMzEtci5nZXREYXRlKCkrYStuLmdldERhdGUoKSkvNyksMil9cmV0dXJuIDA9PT1nKHIsdCk/IjAxIjoiMDAifSwiJXkiOmZ1bmN0aW9uKGUpe3JldHVybihlLnRtX3llYXIrMTkwMCkudG9TdHJpbmcoKS5zdWJzdHJpbmcoMil9LCIlWSI6ZnVuY3Rpb24oZSl7cmV0dXJuIGUudG1feWVhcisxOTAwfSwiJXoiOmZ1bmN0aW9uKGUpe3ZhciB0PWUudG1fZ210b2ZmO3JldHVybih0Pj0wPyIrIjoiLSIpK1N0cmluZygiMDAwMCIrKHQ9KHQ9TWF0aC5hYnModCkvNjApLzYwKjEwMCt0JTYwKSkuc2xpY2UoLTQpfSwiJVoiOmZ1bmN0aW9uKGUpe3JldHVybiBlLnRtX3pvbmV9LCIlJSI6ZnVuY3Rpb24oKXtyZXR1cm4iJSJ9fTtmb3IodmFyIGwgaW4gYiljLmluZGV4T2YobCk+PTAmJihjPWMucmVwbGFjZShuZXcgUmVnRXhwKGwsImciKSxiW2xdKHUpKSk7dmFyIFQ9S2UoYywhMSk7cmV0dXJuIFQubGVuZ3RoPnQ/MDooYT1ULG89ZSxzLnNldChhLG8pLFQubGVuZ3RoLTEpfSxyOmZ1bmN0aW9uKGUsdCxyKXtmb3IodmFyIG49UCh0KSxhPSJcXCFAIyReJiooKSs9LVtdL3t9fDo8Pj8sLiIsbz0wLGk9YS5sZW5ndGg7bzxpOysrbyluPW4ucmVwbGFjZShuZXcgUmVnRXhwKCJcXCIrYVtvXSwiZyIpLCJcXCIrYVtvXSk7dmFyIHU9eyIlQSI6IiVhIiwiJUIiOiIlYiIsIiVjIjoiJWEgJWIgJWQgJUg6JU06JVMgJVkiLCIlRCI6IiVtXFwvJWRcXC8leSIsIiVlIjoiJWQiLCIlRiI6IiVZLSVtLSVkIiwiJWgiOiIlYiIsIiVSIjoiJUhcXDolTSIsIiVyIjoiJUlcXDolTVxcOiVTXFxzJXAiLCIlVCI6IiVIXFw6JU1cXDolUyIsIiV4IjoiJW1cXC8lZFxcLyg/OiV5fCVZKSIsIiVYIjoiJUhcXDolTVxcOiVTIn07Zm9yKHZhciBzIGluIHUpbj1uLnJlcGxhY2Uocyx1W3NdKTt2YXIgYz17IiVhIjoiKD86U3VuKD86ZGF5KT8pfCg/Ok1vbig/OmRheSk/KXwoPzpUdWUoPzpzZGF5KT8pfCg/OldlZCg/Om5lc2RheSk/KXwoPzpUaHUoPzpyc2RheSk/KXwoPzpGcmkoPzpkYXkpPyl8KD86U2F0KD86dXJkYXkpPykiLCIlYiI6Iig/Okphbig/OnVhcnkpPyl8KD86RmViKD86cnVhcnkpPyl8KD86TWFyKD86Y2gpPyl8KD86QXByKD86aWwpPyl8TWF5fCg/Okp1big/OmUpPyl8KD86SnVsKD86eSk/KXwoPzpBdWcoPzp1c3QpPyl8KD86U2VwKD86dGVtYmVyKT8pfCg/Ok9jdCg/Om9iZXIpPyl8KD86Tm92KD86ZW1iZXIpPyl8KD86RGVjKD86ZW1iZXIpPykiLCIlQyI6IlxcZFxcZCIsIiVkIjoiMFsxLTldfFsxLTldKD8hXFxkKXwxXFxkfDJcXGR8MzB8MzEiLCIlSCI6IlxcZCg/IVxcZCl8WzAsMV1cXGR8MjB8MjF8MjJ8MjMiLCIlSSI6IlxcZCg/IVxcZCl8MFxcZHwxMHwxMXwxMiIsIiVqIjoiMDBbMS05XXwwP1sxLTldKD8hXFxkKXwwP1sxLTldXFxkKD8hXFxkKXxbMSwyXVxcZFxcZHwzWzAtNl1cXGQiLCIlbSI6IjBbMS05XXxbMS05XSg/IVxcZCl8MTB8MTF8MTIiLCIlTSI6IjBcXGR8XFxkKD8hXFxkKXxbMS01XVxcZCIsIiVuIjoiXFxzIiwiJXAiOiJBTXxhbXxQTXxwbXxBXFwuTVxcLnxhXFwubVxcLnxQXFwuTVxcLnxwXFwubVxcLiIsIiVTIjoiMFxcZHxcXGQoPyFcXGQpfFsxLTVdXFxkfDYwIiwiJVUiOiIwXFxkfFxcZCg/IVxcZCl8WzEtNF1cXGR8NTB8NTF8NTJ8NTMiLCIlVyI6IjBcXGR8XFxkKD8hXFxkKXxbMS00XVxcZHw1MHw1MXw1Mnw1MyIsIiV3IjoiWzAtNl0iLCIleSI6IlxcZFxcZCIsIiVZIjoiXFxkXFxkXFxkXFxkIiwiJSUiOiIlIiwiJXQiOiJcXHMifTtmb3IodmFyIGYgaW4gYyluPW4ucmVwbGFjZShmLCIoIitmK2NbZl0rIikiKTt2YXIgbD1bXTtmb3Iobz1uLmluZGV4T2YoIiUiKTtvPj0wO289bi5pbmRleE9mKCIlIikpbC5wdXNoKG5bbysxXSksbj1uLnJlcGxhY2UobmV3IFJlZ0V4cCgiXFwlIituW28rMV0sImciKSwiIik7dmFyIHA9bmV3IFJlZ0V4cCgiXiIrbiwiaSIpLmV4ZWMoUChlKSk7aWYocCl7dmFyIGg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCxyKXtyZXR1cm4ibnVtYmVyIiE9dHlwZW9mIGV8fGlzTmFOKGUpP3Q6ZT49dD9lPD1yP2U6cjp0fXJldHVybnt5ZWFyOmUoZFtyKzIwPj4yXSsxOTAwLDE5NzAsOTk5OSksbW9udGg6ZShkW3IrMTY+PjJdLDAsMTEpLGRheTplKGRbcisxMj4+Ml0sMSwzMSksaG91cjplKGRbcis4Pj4yXSwwLDIzKSxtaW46ZShkW3IrND4+Ml0sMCw1OSksc2VjOmUoZFtyPj4yXSwwLDU5KX19KCkseT1mdW5jdGlvbihlKXt2YXIgdD1sLmluZGV4T2YoZSk7aWYodD49MClyZXR1cm4gcFt0KzFdfTtpZigoXz15KCJTIikpJiYoaC5zZWM9WmUoXykpLChfPXkoIk0iKSkmJihoLm1pbj1aZShfKSksXz15KCJIIikpaC5ob3VyPVplKF8pO2Vsc2UgaWYoXz15KCJJIikpe3ZhciBtPVplKF8pOyhfPXkoInAiKSkmJihtKz0iUCI9PT1fLnRvVXBwZXJDYXNlKClbMF0/MTI6MCksaC5ob3VyPW19aWYoXz15KCJZIikpaC55ZWFyPVplKF8pO2Vsc2UgaWYoXz15KCJ5Iikpe3ZhciBnPVplKF8pOyhfPXkoIkMiKSk/Zys9MTAwKlplKF8pOmcrPWc8Njk/MmUzOjE5MDAsaC55ZWFyPWd9aWYoKF89eSgibSIpKT9oLm1vbnRoPVplKF8pLTE6KF89eSgiYiIpKSYmKGgubW9udGg9e0pBTjowLEZFQjoxLE1BUjoyLEFQUjozLE1BWTo0LEpVTjo1LEpVTDo2LEFVRzo3LFNFUDo4LE9DVDo5LE5PVjoxMCxERUM6MTF9W18uc3Vic3RyaW5nKDAsMykudG9VcHBlckNhc2UoKV18fDApLF89eSgiZCIpKWguZGF5PVplKF8pO2Vsc2UgaWYoXz15KCJqIikpZm9yKHZhciB2PVplKF8pLHc9TGUoaC55ZWFyKSxiPTA7YjwxMjsrK2Ipe3ZhciBUPUplKHc/R2U6cWUsYi0xKTt2PD1UKyh3P0dlOnFlKVtiXSYmKGguZGF5PXYtVCl9ZWxzZSBpZihfPXkoImEiKSl7dmFyICQ9Xy5zdWJzdHJpbmcoMCwzKS50b1VwcGVyQ2FzZSgpO2lmKF89eSgiVSIpKXt2YXIgXyxDPXtTVU46MCxNT046MSxUVUU6MixXRUQ6MyxUSFU6NCxGUkk6NSxTQVQ6Nn1bJF0sRD1aZShfKTtBPTA9PT0oTz1uZXcgRGF0ZShoLnllYXIsMCwxKSkuZ2V0RGF5KCk/WGUoTyxDKzcqKEQtMSkpOlhlKE8sNy1PLmdldERheSgpK0MrNyooRC0xKSksaC5kYXk9QS5nZXREYXRlKCksaC5tb250aD1BLmdldE1vbnRoKCl9ZWxzZSBpZihfPXkoIlciKSl7dmFyIEEsTztDPXtNT046MCxUVUU6MSxXRUQ6MixUSFU6MyxGUkk6NCxTQVQ6NSxTVU46Nn1bJF0sRD1aZShfKSxBPTE9PT0oTz1uZXcgRGF0ZShoLnllYXIsMCwxKSkuZ2V0RGF5KCk/WGUoTyxDKzcqKEQtMSkpOlhlKE8sNy1PLmdldERheSgpKzErQys3KihELTEpKSxoLmRheT1BLmdldERhdGUoKSxoLm1vbnRoPUEuZ2V0TW9udGgoKX19dmFyIFM9bmV3IERhdGUoaC55ZWFyLGgubW9udGgsaC5kYXksaC5ob3VyLGgubWluLGguc2VjLDApO3JldHVybiBkW3I+PjJdPVMuZ2V0U2Vjb25kcygpLGRbcis0Pj4yXT1TLmdldE1pbnV0ZXMoKSxkW3IrOD4+Ml09Uy5nZXRIb3VycygpLGRbcisxMj4+Ml09Uy5nZXREYXRlKCksZFtyKzE2Pj4yXT1TLmdldE1vbnRoKCksZFtyKzIwPj4yXT1TLmdldEZ1bGxZZWFyKCktMTkwMCxkW3IrMjQ+PjJdPVMuZ2V0RGF5KCksZFtyKzI4Pj4yXT1KZShMZShTLmdldEZ1bGxZZWFyKCkpP0dlOnFlLFMuZ2V0TW9udGgoKS0xKStTLmdldERhdGUoKS0xLGRbciszMj4+Ml09MCxlK0tlKHBbMF0pLmxlbmd0aC0xfXJldHVybiAwfSxqOmZ1bmN0aW9uKGUpe3ZhciB0PURhdGUubm93KCkvMWUzfDA7cmV0dXJuIGUmJihkW2U+PjJdPXQpLHR9fSxldD1mdW5jdGlvbigpe3ZhciBlPXthOlFlfTtmdW5jdGlvbiByKGUscil7dmFyIG4sYT1lLmV4cG9ydHM7dC5hc209YSx1PW49dC5hc20uQS5idWZmZXIsdC5IRUFQOD1zPW5ldyBJbnQ4QXJyYXkobiksdC5IRUFQMTY9Zj1uZXcgSW50MTZBcnJheShuKSx0LkhFQVAzMj1kPW5ldyBJbnQzMkFycmF5KG4pLHQuSEVBUFU4PWM9bmV3IFVpbnQ4QXJyYXkobiksdC5IRUFQVTE2PWw9bmV3IFVpbnQxNkFycmF5KG4pLHQuSEVBUFUzMj1wPW5ldyBVaW50MzJBcnJheShuKSx0LkhFQVBGMzI9aD1uZXcgRmxvYXQzMkFycmF5KG4pLHQuSEVBUEY2ND15PW5ldyBGbG9hdDY0QXJyYXkobiksbT10LmFzbS5DLGZ1bmN0aW9uKGUpe2lmKHotLSx0Lm1vbml0b3JSdW5EZXBlbmRlbmNpZXMmJnQubW9uaXRvclJ1bkRlcGVuZGVuY2llcyh6KSwwPT16JiYobnVsbCE9PU4mJihjbGVhckludGVydmFsKE4pLE49bnVsbCksQikpe3ZhciByPUI7Qj1udWxsLHIoKX19KCl9aWYoeisrLHQubW9uaXRvclJ1bkRlcGVuZGVuY2llcyYmdC5tb25pdG9yUnVuRGVwZW5kZW5jaWVzKHopLHQuaW5zdGFudGlhdGVXYXNtKXRyeXtyZXR1cm4gdC5pbnN0YW50aWF0ZVdhc20oZSxyKX1jYXRjaChlKXtyZXR1cm4gJCgiTW9kdWxlLmluc3RhbnRpYXRlV2FzbSBjYWxsYmFjayBmYWlsZWQgd2l0aCBlcnJvcjogIitlKSwhMX12YXIgbj1mdW5jdGlvbihlLHQpe3RyeXthPWZ1bmN0aW9uKGUpe3RyeXtpZihlPT1HJiZpKXJldHVybiBuZXcgVWludDhBcnJheShpKTt0aHJvdyJzeW5jIGZldGNoaW5nIG9mIHRoZSB3YXNtIGZhaWxlZDogeW91IGNhbiBwcmVsb2FkIGl0IHRvIE1vZHVsZVsnd2FzbUJpbmFyeSddIG1hbnVhbGx5LCBvciBlbWNjLnB5IHdpbGwgZG8gdGhhdCBmb3IgeW91IHdoZW4gZ2VuZXJhdGluZyBIVE1MIChidXQgbm90IEpTKSJ9Y2F0Y2goZSl7VihlKX19KGUpLG49bmV3IFdlYkFzc2VtYmx5Lk1vZHVsZShhKSxyPW5ldyBXZWJBc3NlbWJseS5JbnN0YW5jZShuLHQpfWNhdGNoKGUpe3ZhciByLG4sYSxvPWUudG9TdHJpbmcoKTt0aHJvdyAkKCJmYWlsZWQgdG8gY29tcGlsZSB3YXNtIG1vZHVsZTogIitvKSwoby5pbmRleE9mKCJpbXBvcnRlZCBNZW1vcnkiKT49MHx8by5pbmRleE9mKCJtZW1vcnkgaW1wb3J0Iik+PTApJiYkKCJNZW1vcnkgc2l6ZSBpbmNvbXBhdGliaWxpdHkgaXNzdWVzIG1heSBiZSBkdWUgdG8gY2hhbmdpbmcgSU5JVElBTF9NRU1PUlkgYXQgcnVudGltZSB0byBzb21ldGhpbmcgdG9vIGxhcmdlLiBVc2UgQUxMT1dfTUVNT1JZX0dST1dUSCB0byBhbGxvdyBhbnkgc2l6ZSBtZW1vcnkgKGFuZCBhbHNvIG1ha2Ugc3VyZSBub3QgdG8gc2V0IElOSVRJQUxfTUVNT1JZIGF0IHJ1bnRpbWUgdG8gc29tZXRoaW5nIHNtYWxsZXIgdGhhbiBpdCB3YXMgYXQgY29tcGlsZSB0aW1lKS4iKSxlfXJldHVybltyLG5dfShHLGUpO3JldHVybiByKG5bMF0sblsxXSksdC5hc219KCksdHQ9dC5fX193YXNtX2NhbGxfY3RvcnM9ZXQuQixydD10Ll9fX2Vycm5vX2xvY2F0aW9uPWV0LkQsbnQ9dC5fbWFsbG9jPWV0LkUsYXQ9dC5fX19nZXRUeXBlTmFtZT1ldC5GO3QuX19fZW1iaW5kX3JlZ2lzdGVyX25hdGl2ZV9hbmRfYnVpbHRpbl90eXBlcz1ldC5HO3ZhciBvdD10Ll9mcmVlPWV0LkgsaXQ9dC5fX2dldF90em5hbWU9ZXQuSSx1dD10Ll9fZ2V0X2RheWxpZ2h0PWV0Lkosc3Q9dC5fX2dldF90aW1lem9uZT1ldC5LO2Z1bmN0aW9uIGN0KGUpe2Z1bmN0aW9uIHIoKXshdiYmKHY9ITAsdC5jYWxsZWRSdW49ITAsX3x8KHEoWSkscShVKSxuKHQpLHQub25SdW50aW1lSW5pdGlhbGl6ZWQmJnQub25SdW50aW1lSW5pdGlhbGl6ZWQoKSxmdW5jdGlvbigpe2lmKHQucG9zdFJ1bilmb3IoImZ1bmN0aW9uIj09dHlwZW9mIHQucG9zdFJ1biYmKHQucG9zdFJ1bj1bdC5wb3N0UnVuXSk7dC5wb3N0UnVuLmxlbmd0aDspaih0LnBvc3RSdW4uc2hpZnQoKSk7cSh4KX0oKSkpfWU9ZXx8YiwhKHo+MCkmJihmdW5jdGlvbigpe2lmKHQucHJlUnVuKWZvcigiZnVuY3Rpb24iPT10eXBlb2YgdC5wcmVSdW4mJih0LnByZVJ1bj1bdC5wcmVSdW5dKTt0LnByZVJ1bi5sZW5ndGg7KUgodC5wcmVSdW4uc2hpZnQoKSk7cShSKX0oKSx6PjB8fCh0LnNldFN0YXR1cz8odC5zZXRTdGF0dXMoIlJ1bm5pbmcuLi4iKSxzZXRUaW1lb3V0KChmdW5jdGlvbigpe3NldFRpbWVvdXQoKGZ1bmN0aW9uKCl7dC5zZXRTdGF0dXMoIiIpfSksMSkscigpfSksMSkpOnIoKSkpfWlmKEI9ZnVuY3Rpb24gZSgpe3Z8fGN0KCksdnx8KEI9ZSl9LHQucnVuPWN0LHQucHJlSW5pdClmb3IoImZ1bmN0aW9uIj09dHlwZW9mIHQucHJlSW5pdCYmKHQucHJlSW5pdD1bdC5wcmVJbml0XSk7dC5wcmVJbml0Lmxlbmd0aD4wOyl0LnByZUluaXQucG9wKCkoKTtyZXR1cm4gY3QoKSx0fSk7bGV0IHI9bnVsbDtzZWxmLm9ubWVzc2FnZT1mdW5jdGlvbihlKXtzd2l0Y2goZS5kYXRhLmNtZCl7Y2FzZSJwcmVJbml0IjooYXN5bmMgZT0+e2xldCBuPWF3YWl0KGF3YWl0IGZldGNoKGUuYnVuZGxlUGF0aCsiL0ZQaGlTZWxwaElEVG9rZW5pemVyV2FzbS53YXNtIikpLmFycmF5QnVmZmVyKCk7cj1hd2FpdCB0KHt3YXNtQmluYXJ5Om59KSxzZWxmLnBvc3RNZXNzYWdlKHtjbWQ6InByZUluaXQifSl9KShlLmRhdGEpO2JyZWFrO2Nhc2UiZ2V0SW50ZXJuYWxMaWNlbnNlIjooYXN5bmMgZT0+e2xldCB0PW5ldyByLlNlbHBoSUREb2N1bWVudFJhd0RhdGE7dC5zZXRMaWNlbnNlSGV4KGUudG9rZW4udG9VcHBlckNhc2UoKSk7bGV0IG49dC5nZXRMaWNlbnNlU3RhdHVzKCksYT10LmdldExpY2Vuc2VEb2N1bWVudCgpLG89dC5nZXRMaWNlbnNlRW5naW5lVHlwZSgpO3NlbGYucG9zdE1lc3NhZ2Uoe2NtZDoiZ2V0SW50ZXJuYWxMaWNlbnNlIix0b2tlbjphLGVuZ2luZVR5cGU6byxzdGF0dXM6bn0pfSkoZS5kYXRhKTticmVhaztjYXNlImRlc3Ryb3kiOihhc3luYygpPT57W3JdLmZvckVhY2goKGU9PntudWxsIT09ZSYmdm9pZCAwIT09ZS5kZWxldGUmJmUuZGVsZXRlKCl9KSksY2xvc2UoKX0pKGUuZGF0YSl9fTs=")],{type:"text/javascript"}))),Te)),t.abrupt("return",(a.postMessage({cmd:"preInit",bundlePath:i}),new Promise((function(e){a.onmessage=function(t){"preInit"===t.data.cmd&&(n.worker=a,e())}}))));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getInternalLicense",value:function(){var t=m(u().mark((function t(i,n){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.__checkWorker(i);case 2:return e.worker.postMessage({cmd:"getInternalLicense",token:n}),t.abrupt("return",new Promise((function(t){e.worker.onmessage=function(e){"getInternalLicense"===e.data.cmd&&t({token:e.data.token,engineType:e.data.engineType})}})));case 4:case"end":return t.stop()}}),t)})));return function(e,i){return t.apply(this,arguments)}}()},{key:"destroyWorker",value:function(){null!==e.worker&&(e.worker.postMessage({cmd:"destroy"}),e.worker=null)}}]),e}();b(Ue,"worker",null),b(Ue,"getInternalLicenseResolve",null),b(Ue,"preinit",!1),b(Ue,"callGetInternalLicense",!1);var Ke={};Ke.SelphID=e,Ke.SelphID.RecorderType={Local:0,Remote:1},Ke.SelphID.ConfigurationManager=function(){function t(){X(this,t),this.container=null,this.language="en",this.dpiList=[163,326,489],this.cameraWidth=1920,this.cameraHeight=1080,this.cameraId=null,this.showLog=!1,this.bundlePath="",this.resourcesPath=this.bundlePath+"/FPhi.Widget.Resources",this.accessibility=!1,this.accessibleElements=["button","buttonImage"],this.onExtractionFinish=null,this.onUserCancel=null,this.onExceptionCaptured=null,this.onExtractionTimeout=null,this.onModuleLoaded=null,this.onTrackStatus=null,this.mode=e.Mode.Full,this.captureMode=e.CaptureMode.DoubleSide,this.license="",this.askSimpleMode=!0,this.previewCapture=!0,this.blurredThreshold=.1,this.cameraOverflow=!1,this.forceLandscape=!1,this.canvasHD=!1,this.cropFactor=1,this.initialTip=!1,this.captureTimeout=10,this.captureRetries=3,this.graphPath=this.bundlePath+"/graph.xml",this.imageFormat="image/png",this.imageQuality=.95,this.externalCamera=!1,this.videoRecord=!1,this.videoRecordRate=3,this.videoRecordScale=.5,this.videoRecordType=e.RecorderType.Local,this.startSimpleMode=!1,this.cameraMirror=!0,this.documentType=e.DocumentType.IDCard,this.scanMode=e.ScanMode.Search,this.specificData="ES"}return C(t,[{key:"setContainer",value:function(e){this.container=e}},{key:"getContainer",value:function(){return this.container}},{key:"setLanguage",value:function(e){this.language=e}},{key:"getLanguage",value:function(){return this.language}},{key:"setDpiList",value:function(e){this.dpiList=e}},{key:"getDpiList",value:function(){return this.dpiList}},{key:"setResourcesPath",value:function(e){this.resourcesPath=e}},{key:"getResourcesPath",value:function(){return this.resourcesPath}},{key:"setBundlePath",value:function(e){this.bundlePath=e,this.graphPath=this.bundlePath+"/graph.xml",this.resourcesPath=this.bundlePath+"/FPhi.Widget.Resources"}},{key:"getBundlePath",value:function(){return this.bundlePath}},{key:"setGraphPath",value:function(e){this.graphPath=e}},{key:"getGraphPath",value:function(){return this.graphPath}},{key:"setCameraWidth",value:function(e){this.cameraWidth=e}},{key:"getCameraWidth",value:function(){return this.cameraWidth}},{key:"setCameraHeight",value:function(e){this.cameraHeight=e}},{key:"getCameraHeight",value:function(){return this.cameraHeight}},{key:"setOnExtractionFinish",value:function(e){this.onExtractionFinish=e}},{key:"getOnExtractionFinish",value:function(){return this.onExtractionFinish}},{key:"setOnUserCancel",value:function(e){this.onUserCancel=e}},{key:"getOnUserCancel",value:function(){return this.onUserCancel}},{key:"setOnExceptionCaptured",value:function(e){this.onExceptionCaptured=e}},{key:"getOnExceptionCaptured",value:function(){return this.onExceptionCaptured}},{key:"setOnExtractionTimeout",value:function(e){this.onExtractionTimeout=e}},{key:"getOnExtractionTimeout",value:function(){return this.onExtractionTimeout}},{key:"setOnModuleLoaded",value:function(e){this.onModuleLoaded=e}},{key:"getOnModuleLoaded",value:function(){return this.onModuleLoaded}},{key:"setOnTrackStatus",value:function(e){this.onTrackStatus=e}},{key:"getOnTrackStatus",value:function(){return this.onTrackStatus}},{key:"setMode",value:function(e){this.mode=e}},{key:"getMode",value:function(){return this.mode}},{key:"setAskSimpleMode",value:function(e){this.askSimpleMode=e}},{key:"getAskSimpleMode",value:function(){return this.askSimpleMode}},{key:"setPreviewCapture",value:function(e){this.previewCapture=e}},{key:"getPreviewCapture",value:function(){return this.previewCapture}},{key:"setDocumentAspectRatio",value:function(e){this.documentAspectRatio=e}},{key:"getDocumentAspectRatio",value:function(){return this.documentAspectRatio}},{key:"setCropFactor",value:function(e){this.cropFactor=e,this.cropFactor<1&&(this.cropFactor=1)}},{key:"getCropFactor",value:function(){return this.cropFactor}},{key:"setForceLandscape",value:function(e){this.forceLandscape=e}},{key:"getForceLandscape",value:function(){return this.forceLandscape}},{key:"setCanvasHD",value:function(e){this.canvasHD=e}},{key:"getCanvasHD",value:function(){return this.canvasHD}},{key:"setCaptureTimeout",value:function(e){this.captureTimeout=e}},{key:"getCaptureTimeout",value:function(){return this.captureTimeout}},{key:"setCaptureRetries",value:function(e){this.captureRetries=e}},{key:"getCaptureRetries",value:function(){return this.captureRetries}},{key:"setImageFormat",value:function(e){this.imageFormat=e}},{key:"getImageFormat",value:function(){return this.imageFormat}},{key:"setImageQuality",value:function(e){this.imageQuality=e}},{key:"getImageQuality",value:function(){return this.imageQuality}},{key:"setCameraId",value:function(e){this.cameraId=e}},{key:"getCameraId",value:function(){return this.cameraId}},{key:"setInitialTip",value:function(e){this.initialTip=e}},{key:"getInitialTip",value:function(){return this.initialTip}},{key:"setVideoRecord",value:function(e){this.videoRecord=e}},{key:"getVideoRecord",value:function(){return this.videoRecord}},{key:"setVideoRecordRate",value:function(e){this.videoRecordRate=e}},{key:"getVideoRecordRate",value:function(){return this.videoRecordRate}},{key:"setVideoRecordScale",value:function(e){this.videoRecordScale=e}},{key:"getVideoRecordScale",value:function(){return this.videoRecordScale}},{key:"setVideoRecordType",value:function(e){this.videoRecordType=e}},{key:"getVideoRecordType",value:function(){return this.videoRecordType}},{key:"setShowLog",value:function(e){this.showLog=e}},{key:"getShowLog",value:function(){return this.showLog}},{key:"setStartSimpleMode",value:function(e){this.startSimpleMode=e}},{key:"getStartSimpleMode",value:function(){return this.startSimpleMode}},{key:"setAccessibility",value:function(e){this.accessibility=e}},{key:"getAccessibility",value:function(){return this.accessibility}},{key:"setAccessibleElements",value:function(e){this.accessibleElements=e}},{key:"getAccessibleElements",value:function(){return this.accessibleElements}},{key:"setDocumentType",value:function(e){this.documentType=e}},{key:"getDocumentType",value:function(){return this.documentType}},{key:"setScanMode",value:function(e){this.scanMode=e}},{key:"getScanMode",value:function(){return this.scanMode}},{key:"setSpecificData",value:function(e){this.specificData=e}},{key:"getSpecificData",value:function(){return this.specificData}},{key:"setCameraOverflow",value:function(e){this.cameraOverflow=e}},{key:"getCameraOverflow",value:function(){return this.cameraOverflow}},{key:"setCaptureMode",value:function(e){this.captureMode=e}},{key:"getCaptureMode",value:function(){return this.captureMode}},{key:"setLicense",value:function(e){this.license=e}},{key:"getLicense",value:function(){return this.license}},{key:"getBlurredThreshold",value:function(){return this.blurredThreshold}},{key:"setBlurredThreshold",value:function(e){this.blurredThreshold=e}},{key:"setExternalCamera",value:function(e){this.externalCamera=e}},{key:"getExternalCamera",value:function(){return this.externalCamera}},{key:"setCameraMirror",value:function(e){this.cameraMirror=e}},{key:"getCameraMirror",value:function(){return this.cameraMirror}}]),t}(),Ke.SelphID.SimpleMode=function(){function e(t){X(this,e),this.cm=t,this.path=this.isPathAbsolute(this.cm.getBundlePath())?this.cm.getBundlePath():this.getScriptPath()+this.cm.getBundlePath(),this.baseURL=this.isPathAbsolute(this.cm.getResourcesPath())?this.cm.getResourcesPath():this.getScriptPath()+this.cm.getResourcesPath(),this.devicePixelRatio=window.devicePixelRatio,!1===t.getCanvasHD()&&(this.devicePixelRatio=1),this.secondsWidget=0,this.secondsState=0}return C(e,[{key:"OnResourceManagerStatus",value:function(e,t){t&&(e.rmReady||(e.rmReady=!0,e.CheckDependencies(e)))}},{key:"CheckDependencies",value:function(e){if(1==e.rmReady&&void 0!==e.drawer){var t=new CustomEvent("FPhi.SelphID.ModuleLoaded.event");e.cm.getContainer().dispatchEvent(t);var i=this.canvas;switch(null!=i&&(i.style.display="inline-block"),e.drawer.rm=e.rm,e.canvas,e.drawer.setCanvasSize(e.cameraContainer.offsetWidth,e.cameraContainer.offsetHeight),e.cm.getMode()){case r.SelphID.Mode.Full:case r.SelphID.Mode.Front:e.newState(r.SelphID.SimpleModeStates.InfoFront);break;default:e.newState(r.SelphID.SimpleModeStates.InfoBack)}}}},{key:"start",value:function(){this.onTrackStatus=this.cm.getOnTrackStatus(),this.divContainer=this.cm.getContainer(),this.onCanvasResizeContext=this.onCanvasResize.bind(this),window.addEventListener("resize",this.onCanvasResizeContext,!1),this.cameraContainer=document.createElement("div"),this.cameraContainer.id="cameraContainer",this.cameraContainer.style.overflow="hidden",this.cameraContainer.style.position="relative",this.cameraContainer.style.width=this.cm.getContainer().offsetWidth+"px",this.cameraContainer.style.height=this.cm.getContainer().offsetHeight+"px",this.cm.getContainer().appendChild(this.cameraContainer);var e=document.createElement("canvas");e.id="display",e.style="position:absolute; top:0px; left:0px; zIndex:1;",this.cameraContainer.appendChild(e),e.width=this.cameraContainer.offsetWidth*this.devicePixelRatio,e.height=this.cameraContainer.offsetHeight*this.devicePixelRatio,e.style.width=this.cameraContainer.offsetWidth+"px",e.style.height=this.cameraContainer.offsetHeight+"px",e.onclick=this.canvasOnClick.bind(this),e.addEventListener("mousemove",this.canvasOnMove.bind(this),!1),this.canvas=e;var t=document.createElement("input");t.type="file",t.accept="image/*",t.capture="environment",t.style="visibility:hidden",t.addEventListener("change",this.fileCaptureEvent.bind(this)),this.cm.getContainer().appendChild(t),this.inputFromDevice=t,this.cm.getContainer().addEventListener("FPhi.SelphID.Finish.event",this.cm.getOnExtractionFinish(),!0),this.cm.getContainer().addEventListener("FPhi.SelphID.UserCancel.event",this.cm.getOnUserCancel(),!0),this.cm.getContainer().addEventListener("FPhi.SelphID.ModuleLoaded.event",this.cm.getOnModuleLoaded(),!0),this.cm.getContainer().addEventListener("FPhi.SelphID.TrackStatus.event",this.onTrackStatus,!0),this.rm=new i(this.baseURL,this.cm.getLanguage(),this,this.OnResourceManagerStatus,this.cm.getDpiList(),window.devicePixelRatio,1),this.widgetTime=performance.now(),this.drawer=new a({mode:this.cm.getMode(),preview:this.cm.getPreviewCapture(),documentAspectRatio:85.6/53.98}),this.CheckDependencies(this)}},{key:"stop",value:function(){this.cm.getContainer().removeChild(this.cameraContainer),this.cameraContainer=null,this.onCanvasResizeContext&&(window.removeEventListener("resize",this.onCanvasResizeContext,!1),this.onCanvasResizeContext=void 0),null!=this.rm&&(this.rm.caller=null,this.rm=null),null!=this.drawer&&(this.drawer=null),this.cm.getContainer().removeEventListener("FPhi.SelphID.Finish.event",this.onExtractionFinish,!0),this.cm.getContainer().removeEventListener("FPhi.SelphID.UserCancel.event",this.onUserCancel,!0),this.cm.getContainer().removeEventListener("FPhi.SelphID.ModuleLoaded.event",this.onModuleLoaded,!0),this.cm.getContainer().removeEventListener("FPhi.SelphID.TrackStatus.event",this.onTrackStatus,!0)}},{key:"newState",value:function(e){if(this.inputFromDevice.value="",this.stateTime=performance.now(),this.secondsWidget=(this.actualTime-this.widgetTime)/1e3,this.secondsState=(this.actualTime-this.stateTime)/1e3,this.state=e,this.resourceParent=this.drawer.getResourceIdForState(r.SelphID.SimpleModeStatesStr[this.state]),this.elements=null,null!=this.resourceParent&&(this.elements=this.rm.getElements(this.resourceParent,this.drawer.landscape)),null!=this.onTrackStatus&&this.divContainer){var t=new CustomEvent("FPhi.SelphID.TrackStatus.event",{detail:{code:r.SelphID.TrackStatus.ChangeState,timeStamp:this.secondsWidget,data:r.SelphID.SimpleModeStatesStr[this.state]}});this.divContainer.dispatchEvent(t)}this.draw(this)}},{key:"finish",value:function(){var e=m(u().mark((function e(){var t,i,n,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,i=null,e.t0=this.frontImage,!e.t0){e.next=6;break}return e.next=5,this.convertImage(this.frontImage,this.cm.getImageFormat(),this.cm.getImageQuality());case 5:t=e.sent;case 6:if(e.t1=this.backImage,!e.t1){e.next=11;break}return e.next=10,this.convertImage(this.backImage,this.cm.getImageFormat(),this.cm.getImageQuality());case 10:i=e.sent;case 11:n={images:{backDocument:i.src||null,frontDocument:t.src||null},simpleModeOutput:1},a=new CustomEvent("FPhi.SelphID.Finish.event",{detail:n}),this.cm.getContainer().dispatchEvent(a),this.stop();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"rotateImage",value:function(e,t,i){return new Promise((function(n,a){var l=document.createElement("canvas");l.width=e.height,l.height=e.width;var s=l.getContext("2d");s.save(),s.translate(l.width/2,l.height/2),s.rotate(-Math.PI/2),s.drawImage(e,-e.width/2,-e.height/2),s.restore();var r=document.createElement("img");r.onload=function(){n(r)},r.src=l.toDataURL(t,i)}))}},{key:"convertImage",value:function(e,t,i){return new Promise((function(n,a){var l=document.createElement("canvas");l.width=e.width,l.height=e.height,l.getContext("2d").drawImage(e,0,0);var s=document.createElement("img");s.onload=function(){n(s)},s.src=l.toDataURL(t,i)}))}},{key:"fileCaptureEvent",value:function(e){var t=this,i=new FileReader;i.onload=function(e){switch(t.state){case r.SelphID.SimpleModeStates.InfoFront:t.previewImage=document.createElement("img"),t.previewImage.src=e.target.result,t.frontImage=t.previewImage,t.newState(r.SelphID.SimpleModeStates.PreviewFront);break;case r.SelphID.SimpleModeStates.InfoBack:t.previewImage=document.createElement("img"),t.previewImage.src=e.target.result,t.backImage=t.previewImage,t.newState(r.SelphID.SimpleModeStates.PreviewBack)}},i.readAsDataURL(e.target.files[0])}},{key:"getLayoutFromXML",value:function(e,t,i,n,a){var l="LEFT",s="TOP",r=i;if(this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"width")){null==r&&(r={});var c=this.rm.getSetupFloat(e,t,this.drawer.landscape,"width");r.width=c<=1?c*n:c,!0}if(this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"height")){null==r&&(r={});var o=this.rm.getSetupFloat(e,t,this.drawer.landscape,"height");r.height=o<=1?o*a:o,!0}if(this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"xAnchor")&&(l=this.rm.getSetupAlign(e,t,this.drawer.landscape,"xAnchor")),this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"yAnchor")&&(s=this.rm.getSetupAlign(e,t,this.drawer.landscape,"yAnchor")),this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"x")){null==r&&(r={});var d=this.rm.getSetupFloat(e,t,this.drawer.landscape,"x");r.x=d<=1&&d>=-1?d*n:d,"CENTER"==l?r.x=n/2-r.width/2+r.x:"RIGHT"==l&&(r.x=n-r.width+r.x),!0}if(this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"y")){null==r&&(r={});var u=this.rm.getSetupFloat(e,t,this.drawer.landscape,"y");r.y=u<=1&&u>=-1?u*a:u,"CENTER"==s?r.y=a/2-r.height/2+r.y:"BOTTOM"==s&&(r.y=a-r.height+r.y),!0}return r}},{key:"draw",value:function(e){if(null!=e.drawer){e.actualTime=performance.now(),e.secondsWidget=(e.actualTime-e.widgetTime)/1e3,e.secondsState=(e.actualTime-e.stateTime)/1e3;var t=e.canvas.getContext("2d",{alpha:!0}),i=t.canvas.width,n=t.canvas.height;if(t.clearRect(0,0,i,n),this.canvasWidth=i,this.canvasHeight=n,t.save(),t.scale(e.devicePixelRatio,e.devicePixelRatio),null!=e.elements){var a={contour:[!1,!1,!1,!1]};a.previewImage=e.previewImage,a.forceLandscape=e.cm.getForceLandscape(),a.state=r.SelphID.SimpleModeStatesStr[e.state];for(var l=0;l<e.elements.length;l++)if("button"!=e.elements[l].type&&"buttonImage"!=e.elements[l].type||0!=e.interactible){var s=e.drawer.getLayout(t,e.resourceParent,e.elements[l].id,e.elements[l].type,e.secondsWidget,e.secondsState,"",a);if(null!=s&&(s=e.getLayoutFromXML(e.resourceParent,e.elements[l].id,s,i,n)),null!=s){e.elements[l].layout=s;var c=e.elements[l].mode,o=!1;if(null!=c){for(var d=c.split("|"),u=0;u<d.length;u++)if("Normal"==d[u]){o=!0;break}}else o=!0;1==o&&e.drawer.draw(t,s,e.resourceParent,e.elements[l].id,e.elements[l].type,e.secondsWidget,e.secondsState,e.cm.getMode(),a)}}}t.restore(),setTimeout(e.draw,0,e)}}},{key:"onCanvasResize",value:function(){var e=this.canvas;e.getContext("2d",{alpha:!0}),this.cameraContainer.style.width=this.cm.getContainer().offsetWidth+"px",this.cameraContainer.style.height=this.cm.getContainer().offsetHeight+"px",e.width=this.cameraContainer.offsetWidth*this.devicePixelRatio,e.height=this.cameraContainer.offsetHeight*this.devicePixelRatio,e.style.width=this.cameraContainer.offsetWidth+"px",e.style.height=this.cameraContainer.offsetHeight+"px",this.drawer.setCanvasSize(this.cameraContainer.offsetWidth,this.cameraContainer.offsetHeight),this.elements=this.rm.getElements(this.resourceParent,this.drawer.landscape)}},{key:"canvasOnMove",value:function(e){if(null!=this.elements)for(var t=this.elements.length-1;t>=0;t--)if(null!=this.elements[t].layout&&e.offsetX>=this.elements[t].layout.x&&e.offsetX<this.elements[t].layout.x+this.elements[t].layout.width&&e.offsetY>=this.elements[t].layout.y&&e.offsetY<this.elements[t].layout.y+this.elements[t].layout.height){this.drawer.onMouseMove(e.target,this.elements[t].layout,this.resourceParent,this.elements[t].id,this.elements[t].type);break}}},{key:"canvasOnClick",value:function(){var e=m(u().mark((function e(t){var i,n,a,l,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.elements){e.next=2;break}return e.abrupt("return");case 2:i=null,n=this.elements.length-1;case 4:if(!(n>=0)){e.next=38;break}if(a=t.offsetX,l=t.offsetY,!(null!=this.elements[n].layout&&a>=this.elements[n].layout.x&&a<this.elements[n].layout.x+this.elements[n].layout.width&&l>=this.elements[n].layout.y&&l<this.elements[n].layout.y+this.elements[n].layout.height)){e.next=35;break}if("button_start"!=(i=this.elements[n].id)){e.next=11;break}this.inputFromDevice.click(),e.next=34;break;case 11:if("button_repeat"!=i){e.next=15;break}this.state==r.SelphID.SimpleModeStates.PreviewFront?this.newState(r.SelphID.SimpleModeStates.InfoFront):this.newState(r.SelphID.SimpleModeStates.InfoBack),e.next=34;break;case 15:if("button_ok"!=i){e.next=19;break}this.state==r.SelphID.SimpleModeStates.PreviewFront&&this.cm.getMode()==r.SelphID.Mode.Full?this.newState(r.SelphID.SimpleModeStates.InfoBack):this.finish(),e.next=34;break;case 19:if("button_rotate"!=i){e.next=33;break}if(this.state!=r.SelphID.SimpleModeStates.PreviewFront){e.next=27;break}return e.next=23,this.rotateImage(this.frontImage,this.cm.getImageFormat(),this.cm.getImageQuality());case 23:this.frontImage=e.sent,this.previewImage=this.frontImage,e.next=31;break;case 27:return e.next=29,this.rotateImage(this.backImage,this.cm.getImageFormat(),this.cm.getImageQuality());case 29:this.backImage=e.sent,this.previewImage=this.backImage;case 31:e.next=34;break;case 33:"button_exit"==i&&(s=new CustomEvent("FPhi.SelphID.UserCancel.event"),this.cm.getContainer().dispatchEvent(s),this.stop());case 34:return e.abrupt("break",38);case 35:n--,e.next=4;break;case 38:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isPathAbsolute",value:function(e){return/^(?:\/|.+:\/\/|http)/.test(e)}},{key:"getScriptPath",value:function(){return String((new Error).stack).replace(/^Error.*\n/,"").split("\n")[1].match(/http.*\.js/)[0].split("/").slice(0,-1).join("/")+"/"}}]),e}(),Ke.SelphID.DocumentType={0:"UNKNOWN",1:"NONE",2:"ID",3:"PASSPORT",4:"VISA",5:"GREEN_CARD",6:"DRIVING_LICENSE",7:"RESIDENT_ID",8:"SOCIAL_SECURITY_CARD",9:"HEALTH_INSURANCE_CARD",10:"TEMPORARY_RESIDENCE"},Ke.ExceptionType={CameraError:0,ExtractorError:1,ControlNotInitializedError:2,ImageCropResizeError:3,UnexpectedCaptureError:4},Ke.SelphID.Widget=function(e){this.showLog=e.getShowLog(),this.version="4.1.1.178",this.printLog("FPhi.SelphID.Widget version: "+this.version+" - enable showLog property to display detailed info."),this.cm=e,this.divContainer=this.cm.getContainer(),this.captureTimeout=this.cm.getCaptureTimeout(),this.captureRetries=this.cm.getCaptureRetries(),this.onExtractionFinish=this.cm.getOnExtractionFinish(),this.onUserCancel=this.cm.getOnUserCancel(),this.onExceptionCaptured=this.cm.getOnExceptionCaptured(),this.onExtractionTimeout=this.cm.getOnExtractionTimeout(),this.onModuleLoaded=this.cm.getOnModuleLoaded(),this.onTrackStatus=this.cm.getOnTrackStatus(),this.cameraReady=!1,this.contour=[!1,!1,!1,!1],this.cameraMustFlip=this.cm.getCameraMirror(),this.cameraFrontSide=!1,this.mode=this.cm.getMode(),this.status=Ke.SelphID.Mode.Full,this.blurredThreshold=this.cm.getBlurredThreshold(),this.preview=this.cm.getPreviewCapture(),this.graphPath=this.isPathAbsolute(this.cm.getGraphPath())?this.cm.getGraphPath():this.getScriptPath()+this.cm.getGraphPath(),this.cropFactor=this.cm.getCropFactor(),this.devicePixelRatio=window.devicePixelRatio,!1===this.cm.getCanvasHD()&&(this.devicePixelRatio=1),this.bundlePath=this.isPathAbsolute(this.cm.getBundlePath())?this.cm.getBundlePath():this.getScriptPath()+this.cm.getBundlePath(),this.showLog&&this.printLog("FPhi.SelphID.Widget: Serving from URL: "+this.bundlePath),this.resourceParent=null,this.language=this.cm.getLanguage(),this.expectedExternalCamera=this.cm.getExternalCamera(),this.fontSizeFactor=this.canvasHeight/500,this.fpsTime=performance.now(),this.baseURL=this.isPathAbsolute(this.cm.getResourcesPath())?this.cm.getResourcesPath():this.getScriptPath()+this.cm.getResourcesPath(),this.showLog&&this.printLog("FPhi.SelphID.Widget: Serving resources from URL: "+this.baseURL),this.dpiList=this.cm.getDpiList(),this.imageFormat=this.cm.getImageFormat(),this.imageQuality=this.cm.getImageQuality(),this.rmReady=!1,this.graphReady=!1,this.rm=new i(this.baseURL,this.language,this,this.OnResourceManagerStatus,this.dpiList,window.devicePixelRatio,this.canvasSizeFactor),this.graph=new t.k(this.graphPath,this.OnGraphReady.bind(this),this.OnGraphNewState.bind(this)),this.drawer=new a({mode:this.mode,preview:this.preview,documentAspectRatio:85.6/53.98,enableButtonCamera:!this.expectedExternalCamera}),this.divContainer.addEventListener("FPhi.SelphID.Finish.event",this.onExtractionFinish,!0),this.divContainer.addEventListener("FPhi.SelphID.UserCancel.event",this.onUserCancel,!0),this.divContainer.addEventListener("FPhi.SelphID.ExtractionTimeout.event",this.onExtractionTimeout,!0),this.divContainer.addEventListener("FPhi.SelphID.ExceptionCaptured.event",this.onExceptionCaptured,!0),this.divContainer.addEventListener("FPhi.SelphID.ModuleLoaded.event",this.onModuleLoaded,!0),this.divContainer.addEventListener("FPhi.SelphID.TrackStatus.event",this.onTrackStatus,!0)},Ke.SelphID.Widget.prototype={constructor:Ke.SelphID.Widget,language:"es",privateCanvas:null,extractor:null,extractorLiveness:null,extractorVersion:"",lastDetectResult:null,lastExtractionResult:null,lastExtractionResultWizard:null,actualTime:0,actualTimePrev:0,idContainer:null,divContainer:null,extractorContainer:null,videoSelectId:null,cameraContainer:null,cameraWidth:null,cameraHeight:null,cameraRotation:0,expectedExternalCamera:null,canvasWidth:void 0,canvasHeight:void 0,cameraStream:null,selectedSource:null,samplePeriod:0,blurredThreshold:0,debug:!1,interactible:!0,stopCameraStream:!0,globalTimeout:30,sceneTimeout:30,fps:0,fpse:0,fpsframes:0,fpseframes:0,fpsTime:null,fontSizeFactor:1,canvasSizeFactor:1,cameraList:[],graphPath:"/graph.xml",Start:function(){var e=m(u().mark((function e(t){var i,n,a,l,s,r,c,o,d,h,m,b,g,Z=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.printLog("SelphId: Init process - Widget Web Internals starting"),""!==this.cm.getLicense()){e.next=2;break}return e.abrupt("return",(console.error("FPhi.SelphID.Widget: The Widget is not license correctly, stopping execution..."),this.divContainer.dispatchEvent(new CustomEvent("FPhi.SelphID.ExceptionCaptured.event",{detail:{exceptionType:"licenseError",message:"FPhi.SelphID.Widget: The Widget is not license correctly, stopping execution..."}})),void this.Stop()));case 2:return e.next=4,Ue.getInternalLicense(this.bundlePath,this.cm.getLicense());case 4:if(i=e.sent,-1!==Le.getAvailableEngines().findIndex((function(e){return i.engineType===e}))){e.next=7;break}return e.abrupt("return",(console.error("FPhi.SelphID.Widget: The Widget license is not supported by this version, please contact support team!"),this.divContainer.dispatchEvent(new CustomEvent("FPhi.SelphID.ExceptionCaptured.event",{detail:{exceptionType:"licenseError",message:"FPhi.SelphID.Widget: The Widget license is not supported by this version, please contact support team!"}})),void this.Stop()));case 7:e.prev=7,this.engine=Le.generateInstance(i.engineType,{licenseKey:i.token,bundlePath:this.bundlePath,imageFormat:this.imageFormat,imageQuality:this.imageQuality,accessibility:this.accessibility,blurredThreshold:100*this.blurredThreshold}),this.engine.initializeEngine().then((function(){Z.engineLoaded=!0,Z.CheckDependencies(Z)})),e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(7),e.abrupt("return",(this.divContainer.dispatchEvent(new CustomEvent("FPhi.SelphID.ExceptionCaptured.event",{detail:{exceptionType:"engineError",message:"FPhi.SelphID.Widget: "+e.t0.message}})),void this.Stop()));case 14:if(this.cameraContainer=document.createElement("div"),this.cameraContainer.id="cameraContainer",this.cameraContainer.style.overflow="hidden",this.cameraContainer.style.position="relative",this.cameraContainer.style.width=this.divContainer.offsetWidth+"px",this.cameraContainer.style.height=this.divContainer.offsetHeight+"px",this.divContainer.appendChild(this.cameraContainer),this.printLog("SelphId: Init process - Camera Container linked"),this.checkCanvasDimensions(),this.gifWait=document.createElement("img"),this.gifWait.style.display="none",this.gifWaitOnLoadContext=this.onWaitingLoaded.bind(this),this.gifWait.addEventListener("load",this.gifWaitOnLoadContext),this.gifWait.src=this.baseURL+"/resources/163dpi/1_loading_selphID.gif",this.cameraContainer.appendChild(this.gifWait),this.printLog("SelphId: Init process - Showing the loading animation"),this.cropFactor<=0&&(n=new CustomEvent("FPhi.SelphID.ExceptionCaptured.event",{detail:{message:"Invalid value of CropFactor. Must be greather than 0.",exceptionType:3}}),this.divContainer.dispatchEvent(n),this.cropFactor=1),this.resizeFactor<=0&&(a=new CustomEvent("FPhi.SelphID.ExceptionCaptured.event",{detail:{message:"Invalid value of ResizeFactor. Must be greather than 0.",exceptionType:3}}),this.divContainer.dispatchEvent(a),this.resizeFactor=1),this.sceneTimeout<=0&&(this.sceneTimeout=0),window.location!==window.parent.location&&this.printLog("SelphId: widget running inside iframe."),(l=document.createElement("canvas")).id="display",l.style="position:absolute; top:0px; left:0px; zIndex:1;",this.cameraContainer.appendChild(l),l.width=this.cameraContainer.offsetWidth*this.devicePixelRatio,l.height=this.cameraContainer.offsetHeight*this.devicePixelRatio,l.style.width=this.cameraContainer.offsetWidth+"px",l.style.height=this.cameraContainer.offsetHeight+"px",this.canvas=l,this.canvasRotated=document.createElement("canvas"),this.canvasRotated.width=l.height*this.devicePixelRatio,this.canvasRotated.height=l.width*this.devicePixelRatio,this.onCanvasResizeContext=this.onCanvasResize.bind(this),window.addEventListener("resize",this.onCanvasResizeContext,!1),this.printLog("SelphId: Init process - Canvas linked"),this.initCamera(this.cameraContainer,this.cameraWidth,this.cameraHeight),console.log(t),null==t){e.next=24;break}this.printLog("FPhi.Selphi.Widget: Detected external camera stream, using this..."),this.stopCameraStream=!1,this.cameraStream=t,this.video.srcObject=t,s=t.getVideoTracks()[0],this.cameraName=s.label,this.video.onloadedmetadata=this.videoLoaded.bind(this),this.video.play(),this.setCameraPosition(this.canvas,this.video),e.next=65;break;case 24:if(!this.expectedExternalCamera){e.next=28;break}this.printLog("FPhi.SelphID.Widget: Entering into loading state until waits the external camera..."),e.next=65;break;case 28:return this.printLog("FPhi.SelphID.Widget: No detected external camera stream, running own stream..."),this.printLog("SelphId: Init process - Checked parameters are correctly"),document.featurePolicy&&!1===document.featurePolicy.allowsFeature("camera")&&(this.printLog("SelphId: Feature Policy issue: Camera feature is restricted in the actual environment. Check your server HTTP Headers."),this.printLog("https://developers.google.com/web/updates/2018/06/feature-policy#js")),e.next=33,this.grantVideoPermission();case 33:return this.printLog("SelphId: Init process - Checked camera permissions"),e.next=36,navigator.mediaDevices.enumerateDevices();case 36:this.cameras=e.sent,this.cameraCount=0,this.printLog("SelphId: Camera enumeration"),r=[],c=p(this.cameras),e.prev=41,c.s();case 43:if((o=c.n()).done){e.next=55;break}if("videoinput"!==(d=o.value).kind){e.next=53;break}if(null!=this.cm.getCameraId()){e.next=52;break}return e.next=49,navigator.mediaDevices.getUserMedia({video:{deviceId:d.deviceId}});case 49:(h=e.sent).getVideoTracks().length>0&&"function"==typeof h.getVideoTracks()[0].getCapabilities&&"environment"==(b=h.getVideoTracks()[0].getCapabilities()).facingMode&&((null===(m=b.focusDistance)||void 0===m?void 0:m.max)<1e3?(r.push(b),this.printLog("SelphId: environment camera with id: "+d.deviceId+" - focusDistance: "+JSON.stringify(b.focusDistance))):this.printLog("SelphId: ignoring environment (focusDistance) camera with id: "+d.deviceId+" - focusDistance: "+JSON.stringify(b.focusDistance))),h.getTracks().forEach((function(e){e.stop()}));case 52:this.cameraCount++,this.printLog("SelphId: camera with id: "+d.deviceId);case 53:e.next=43;break;case 55:e.next=60;break;case 57:e.prev=57,e.t1=e.catch(41),c.e(e.t1);case 60:return e.prev=60,c.f(),e.finish(60);case 63:this.printLog("Environment cameras: "+r.length),r.length>0&&(r.sort((function(e,t){var i,n;return(null===(i=e.focusDistance)||void 0===i?void 0:i.max)-(null===(n=t.focusDistance)||void 0===n?void 0:n.max)})),g=Math.floor(r.length/2),this.forceCameraId=r[g].deviceId,this.printLog("SelphId: forced camera with id: "+this.forceCameraId)),this.printLog("SelphId: "+this.cameraCount+" cameras found."),this.printLog("SelphId: Init process - Checked available cameras"),this.selectedSource=null,this.setVideoInput(this),this.stopCameraStream=!0;case 65:this.widgetTime=performance.now(),this.stateTime=this.widgetTime,this.printLog("SelphId: Init process - Started Widget");case 66:case"end":return e.stop()}}),e,this,[[7,11],[41,57,60,63]])})));return function(t){return e.apply(this,arguments)}}(),StartManual:function(){this.selphIDSimpleMode=new Ke.SelphID.SimpleMode(this.cm),this.selphIDSimpleMode.start()},Stop:function(){null!==this.divContainer&&(this.onCanvasResizeContext&&(window.removeEventListener("resize",this.onCanvasResizeContext,!1),this.onCanvasResizeContext=void 0),void 0!==this.onExtractionFinish&&null!==this.onExtractionFinish&&this.divContainer.removeEventListener("FPhi.SelphID.Finish.event",this.onExtractionFinish,!0),void 0!==this.onUserCancel&&null!==this.onUserCancel&&this.divContainer.removeEventListener("FPhi.SelphID.UserCancel.event",this.onUserCancel,!0),void 0!==this.onExtractionTimeout&&null!==this.onExtractionTimeout&&this.divContainer.removeEventListener("FPhi.SelphID.ExtractionTimeout.event",this.onExtractionTimeout,!0),void 0!==this.onExceptionCaptured&&null!==this.onExceptionCaptured&&this.divContainer.removeEventListener("FPhi.SelphID.ExceptionCaptured.event",this.onExceptionCaptured,!0),void 0!==this.onModuleLoaded&&null!==this.onModuleLoaded&&this.divContainer.removeEventListener("FPhi.SelphID.ModuleLoaded.event",this.onModuleLoaded,!0),void 0!==this.onTrackStatus&&null!==this.onTrackStatus&&this.divContainer.removeEventListener("FPhi.SelphID.TrackStatus.event",this.onTrackStatus,!0),null!==this.cameraContainer&&this.divContainer.removeChild(this.cameraContainer),this.divContainer=null,this.cameraContainer=null),null!==this.cameraStream&&(!0===this.stopCameraStream&&this.cameraStream.getVideoTracks()[0].stop(),this.video.pause()),null!==this.rm&&void 0!==this.rm&&(this.rm.caller=null,this.rm=null),null!==this.graph&&void 0!==this.graph&&(this.graph=null),null!==this.drawer&&void 0!==this.drawer&&(this.drawer=null),null!==this.rmScript&&void 0!==this.rmScript&&(this.rmScript.onreadystatechange=null,this.rmScript.onload=null,this.rmScript=null),null!==this.graphScript&&void 0!==this.graphScript&&(this.graphScript.onreadystatechange=null,this.graphScript.onload=null,this.graphScript=null),null!==this.drawerScript&&void 0!==this.drawerScript&&(this.drawerScript.onload=null,this.drawerScript=null),this.engine&&this.engine.finalizeEngine(),Ue.destroyWorker()},onWaitingLoaded:function(){var e=this.cameraContainer.offsetHeight/2-this.gifWait.height/2,t=this.cameraContainer.offsetWidth/2-this.gifWait.width/2;this.gifWait.style="position:absolute; top:"+e+"px; left:"+t+"px;"},onCanvasResize:function(){var e=this.canvas,t=e.getContext("2d",{alpha:!0}),i=this.video;this.cameraWidth=i.videoWidth,this.cameraHeight=i.videoHeight,0===this.cameraRotation||2===this.cameraRotation?(this.privateCanvas.width=this.cameraWidth,this.privateCanvas.height=this.cameraHeight):(this.privateCanvas.width=this.cameraHeight,this.privateCanvas.height=this.cameraWidth),this.imagesProcessed=0,this.cameraContainer.style.width=this.divContainer.offsetWidth+"px",this.cameraContainer.style.height=this.divContainer.offsetHeight+"px",e.width=this.cameraContainer.offsetWidth*this.devicePixelRatio,e.height=this.cameraContainer.offsetHeight*this.devicePixelRatio,e.style.width=this.cameraContainer.offsetWidth+"px",e.style.height=this.cameraContainer.offsetHeight+"px",this.canvasRotated.width=e.height,this.canvasRotated.height=e.width,e.width<e.height&&this.cm.forceLandscape?(this.drawer.setCanvasSize(this.cameraContainer.offsetHeight,this.cameraContainer.offsetWidth),this.elements=this.rm.getElements(this.resourceParent,!0)):(this.drawer.setCanvasSize(this.cameraContainer.offsetWidth,this.cameraContainer.offsetHeight),this.elements=this.rm.getElements(this.resourceParent,this.drawer.landscape)),this.checkCanvasDimensions(),this.startVideos(this),this.setCameraPosition(t,i)},checkCanvasDimensions:function(){this.cameraContainer.offsetWidth<this.cameraContainer.offsetHeight&&this.cm.forceLandscape?((this.cameraContainer.offsetWidth<400||this.cameraContainer.offsetHeight<550)&&this.printLog("Selphid: Warning!!! Minimum visual dimensions check failed. "),this.printLog("Selphid: Actual widget size: "+this.cameraContainer.offsetWidth+"x"+this.cameraContainer.offsetHeight),this.printLog("Selphid: Minimum widget size: 400x550")):((this.cameraContainer.offsetWidth<550||this.cameraContainer.offsetHeight<400)&&this.printLog("Selphid: Warning!!! Minimum visual dimensions check failed. "),this.printLog("Selphid: Actual widget size: "+this.cameraContainer.offsetWidth+"x"+this.cameraContainer.offsetHeight),this.printLog("Selphid: Minimum widget size: 550x400"))},printLog:function(e){this.showLog&&console.log(e)},onOrientationChange:function(){window.screen.orientation},GetAvailableCameras:function(){return navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then(this.gotDevices).catch(this.handleCameraError):null},compareArray:function(e,t){if(!e)return!1;if(!t)return!1;if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0},setCameraPosition:function(e,t){var i=this.drawer.getCameraRect(e,this.cameraWidth,this.cameraHeight,this.cameraContainer.offsetWidth,this.cameraContainer.offsetHeight,this.resourceParent);if(0==this.cm.getCameraOverflow()){var n=this.drawer.getDocRectScreenSpace(this.cameraContainer.offsetWidth,this.cameraContainer.offsetHeight,0);(i=this.drawer.getCameraRect(e,this.cameraWidth,this.cameraHeight,n.width,n.height,this.resourceParent)).x+=n.x,i.y+=n.y,i.x*=1,i.y*=1,i.width+=.5,i.height+=.5}var a="0deg";!0===this.cameraMustFlip&&(a="180deg"),i.visible?t.style="position:absolute; top:"+i.y+"px; left:"+i.x+"px; width:"+i.width+"px; height:"+i.height+"px; transform:rotateY("+a+"); zIndex:0;":t.style="position:absolute; top:-10000px; left:0px; width:"+i.width+"px; height:"+i.height+"px; transform:rotateY("+a+"); zIndex:0;"},OnGraphNewState:function(){var e=m(u().mark((function e(t){var i,n,a,l,s,r,c,o,d,h,m,b,p,g,Z,I,y,R,f,v,W,G,V,X,S,C,N,E,Y,F,k;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.stateTime=performance.now(),i=this.canvas,this.secondsWidget=(this.actualTime-this.widgetTime)/1e3,this.secondsState=(this.actualTime-this.stateTime)/1e3,this.state=t,this.resourceParent=this.drawer.getResourceIdForState(t),n=this.video,this.setCameraPosition(i.getContext("2d",{alpha:!0}),n),("UCNothing"===this.state||void 0===this.state)&&(this.actualTime=this.stateTime,this.widgetTime=this.stateTime,null!=(a=this.canvas)&&(a.style.display="inline-block"),this.video&&(this.video.style.display="inline-block")),this.printLog("SelphId: state: "+t),null!=this.elements)for(l=0;l<this.elements.length;l++)null!=this.elements[l].videoPlayer&&(this.elements[l].videoPlayer.pause(),this.elements[l].videoPlayer.removeAttribute("src"),this.elements[l].videoPlayer.removeEventListener("ended",this.videoplayerEnded.bind(self),!1),this.elements[l].videoPlayer.load(),this.elements[l].videoPlayer=null);if(this.elements=null,null!=this.resourceParent&&(this.canvas.width<this.canvas.height&&this.cm.forceLandscape?this.elements=this.rm.getElements(this.resourceParent,!0):this.elements=this.rm.getElements(this.resourceParent,this.drawer.landscape),this.startVideos(this)),"UCNothing"!==t){e.next=10;break}this.clockNewScenario=performance.now(),this.lastExtractionResult=null,this.privateImages=[],this.retries=0,this.status=Ke.SelphID.Mode.Front,e.next=52;break;case 10:if("UCCapture"!==t){e.next=14;break}this.clockNewScenario=performance.now(),this.imagesProcessed=0,this.imageCaptured=!1,this.imageCapturedTime=0,this.previewImage=void 0,this.contour=[!1,!1,!1,!1],this.status===Ke.SelphID.Mode.Back?this.privateImages.length=1:this.privateImages=[],e.next=52;break;case 14:if("UCCaptureCameraSwitch"!==t){e.next=51;break}if(s=this,null==this.cameraStream){e.next=49;break}return r=this.cameraStream.getVideoTracks()[0].getSettings().deviceId,e.next=20,navigator.mediaDevices.enumerateDevices();case 20:c=e.sent,o=-1,d=-1,h=0;case 24:if(!(h<c.length)){e.next=31;break}if(c[h].deviceId!==r){e.next=28;break}return o=h,e.abrupt("break",31);case 28:h++,e.next=24;break;case 31:m=o+1;case 32:if(!(m<c.length)){e.next=39;break}if("videoinput"!==c[m].kind){e.next=36;break}return d=m,e.abrupt("break",39);case 36:m++,e.next=32;break;case 39:if(-1!==d){e.next=48;break}b=0;case 41:if(!(b<c.length)){e.next=48;break}if("videoinput"!==c[b].kind){e.next=45;break}return d=b,e.abrupt("break",48);case 45:b++,e.next=41;break;case 48:-1!==d&&d!==o?(this.video.pause(),this.cameraStream.getVideoTracks().forEach((function(e){e.stop()})),this.cameraStream=null,this.video.srcObject=null,p=this.cm.getCameraWidth(),g=this.cm.getCameraHeight(),Z={video:{deviceId:c[d].deviceId,width:p,height:g},audio:!1},navigator.mediaDevices.getUserMedia(Z).then((function(e){var t=this,i=e.getVideoTracks()[0].getSettings();i&&(s.cameraMustFlip="environment"!==i.facingMode&&s.cm.getCameraMirror()),s.cameraStream=e,s.cameraId=s.cameraStream.getVideoTracks()[0].getSettings().deviceId,n.srcObject=e,s.switchTimeoutHandler=setTimeout((function(){s.video.pause(),s.cameraStream.getVideoTracks().forEach((function(e){e.stop()})),t.retries=0,s.graph.sendMessage("retry")}),5e3),n.play().then((function(){s.printLog("Selphid: Camera switch success. New camera with id: "+c[d].deviceId),clearTimeout(s.switchTimeoutHandler),s.setCameraPosition(s.canvas.getContext("2d",{alpha:!0}),s.video),s.graph.sendMessage("cameraSwitched")})).catch((function(e){s.printLog("Selphid: Camera switch unsuccess."),s.printLog(e),clearTimeout(s.switchTimeoutHandler),t.retries=0,s.graph.sendMessage("retry")}))})).catch((function(e){s.printLog("SelphId: Fatal error camera switch..."),s.printLog(e)}))):(this.printLog("SelphId: Camera switch aborted. Only 1 available camera."),this.graph.sendMessage("cameraSwitched"));case 49:e.next=52;break;case 51:if("UCPreview"===t)this.clockNewScenario=performance.now();else if("UCRepeat"===t)this.imageCaptured=!1,this.status=Ke.SelphID.Mode.Front,this.retries=0,this.engine.cleanImageBuffer(Ke.SelphID.Mode.Front),this.graph.sendMessage("repeat");else if("UCPreviewDecision"===t)this.cm.getCaptureMode()===Ke.SelphID.CaptureMode.DoubleSide&&this.status===Ke.SelphID.Mode.Front?this.graph.sendMessage("Next"):this.graph.sendMessage("Finish");else if("UCFlip"===t)this.status=Ke.SelphID.Mode.Back,this.retries=0;else if("UCCancelByUser"===t)this.clockNewScenario=performance.now(),I=new CustomEvent("FPhi.SelphID.UserCancel.event"),this.divContainer.dispatchEvent(I),this.Stop();else if("UCFinish"===t)this.results.cameraId=this.cameraId,this.cm.getVideoRecord()&&(this.results.video=this.recordedVideo),y=new CustomEvent("FPhi.SelphID.Finish.event",{detail:this.results}),this.divContainer.dispatchEvent(y),this.Stop();else if("UCTimeout"===t)this.divContainer.dispatchEvent(new CustomEvent("FPhi.SelphID.ExtractionTimeout.event")),this.Stop();else if("UCErrors"===t){if(R={livenessMoveFails:this.livenessMoveActualFailedAttempts,livenessMoveHistory:this.livenessMoveHistory,livenessMoveStabilizedHistory:this.livenessMoveStabilizedStatusHistory,livenessMoveStabilizedStatus:this.livenessMoveLastStabilizedStatus},null!=this.lastExtractionResult&&null!=this.lastExtractionResult.sunGlassesScore&&(R.sunGlassesScore=this.lastExtractionResult.sunGlassesScore),this.logAllImages){for(f=[],v=0;v<this.privateImages.length;v++)void 0!==this.privateImages[v]&&f.push(this.getImgTag(this.privateImages[v],this.cropImage,this.cropFactor,this.imageFormat,this.imageQuality));R.images=f,R.timeStamp=this.privateLivenessResults}this.clockNewScenario=performance.now(),this.livenessDiagnostic<0?this.divContainer.dispatchEvent(new CustomEvent("FPhi.SelphID.ExtractionTimeout.event",{detail:R})):(R.livenessErrorType=this.livenessDiagnostic,W=new CustomEvent("FPhi.SelphID.LivenessError.event",{detail:R}),this.divContainer.dispatchEvent(W))}else"UCWaitRecording"===t?this.cm.getVideoRecord()&&(this.printLog("SelphId: generating movie"),this.agProcessing=!0,G=this,this.agProcessingFirst=performance.now(),this.recorder.generateVideo().then((function(e){G.recorderFinish=!0,G.recordedVideo=e}),(function(e){G.recorderFinish=!0,G.printLog("SelphId: Error generating video")}))):"UCJumpSimpleMode"===t&&(this.Stop(),this.StartManual());case 52:if(this.divContainer&&(V=new CustomEvent("FPhi.SelphID.TrackStatus.event",{detail:{code:Ke.SelphID.TrackStatus.ChangeState,timeStamp:this.secondsWidget,data:t}}),this.divContainer.dispatchEvent(V),this.cm.getAccessibility()&&void 0!==this.elements)){for(X=this.canvas.getContext("2d",{alpha:!0}),this.canvas.width<this.canvas.height&&this.cm.forceLandscape&&(X=this.canvasRotated.getContext("2d",{alpha:!0})),S=X.canvas.width,C=X.canvas.height,(N={}).state=this.state,E=[],null===this.elements&&(this.elements=[]),Y=0;Y<this.elements.length;Y++)this.cm.getAccessibleElements().includes(this.elements[Y].type)&&(null!=(F=this.drawer.getLayout(X,this.resourceParent,this.elements[Y].id,this.elements[Y].type,this.secondsWidget,this.secondsState,"Normal",N))&&(F=this.getLayoutFromXML(this.resourceParent,this.elements[Y].id,F,S,C)),null!=F&&E.push({id:this.elements[Y].id,type:this.elements[Y].type,x:F.x*this.devicePixelRatio,y:F.y*this.devicePixelRatio,width:F.width*this.devicePixelRatio,height:F.height*this.devicePixelRatio}));k=new CustomEvent("FPhi.SelphID.TrackStatus.event",{detail:{code:Ke.SelphID.TrackStatus.AccessibilityData,timeStamp:this.secondsWidget,data:E}}),this.divContainer.dispatchEvent(k)}null!=this.graph&&this.graph.sendMessage("SetStatusFinished");case 54:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),getImageData:function(e){var t=e.getContext("2d",{alpha:!0}),i=e.height,n=e.width;return{width:n,height:i,pixels:t.getImageData(0,0,n,i),time:performance.now()}},getImgTag:function(e,t,i,n,a){var l=document.createElement("canvas");l.width=e.width,l.height=e.height,l.getContext("2d").putImageData(e.pixels,0,0);var s=document.createElement("canvas");if(t&&void 0!==e.extractionResult&&void 0!==e.extractionResult.face){var r=e.extractionResult.face.width*i,c=e.extractionResult.face.height*i,o=e.extractionResult.face.x-(i-1)*e.extractionResult.face.width/2,d=e.extractionResult.face.y-(i-1)*e.extractionResult.face.height/2;o<0&&(r+=o,o=0),d<0&&(c+=d,d=0),o+r>=e.width&&(r=e.width-o),d+c>=e.height&&(c=e.height-d),s.width=r,s.height=c,s.getContext("2d").drawImage(l,o,d,r,c,0,0,s.width,s.height)}else s.width=e.width,s.height=e.height,s.getContext("2d").drawImage(l,0,0,s.width,s.height);var u=document.createElement("img");return u.src=s.toDataURL(this.imageFormat,this.imageQuality),u},startVideos:function(e){if(null!=e.elements)for(var t=0;t<e.elements.length;t++)if("video"===e.elements[t].type){var i=document.createElement("video");i.hidden=!0,i.playsinline=!0,i.loop=!1,i.muted=!0,i.autoplay=!0,i.controls=!0,i.src=e.rm.getResourceUrlBase(e.rm.getSetupResourceId(e.resourceParent,e.elements[t].id,e.canvas.width<e.canvas.height,"value")),i.addEventListener("ended",e.videoplayerEnded.bind(e),!1),i.setAttribute("playsinline",""),i.setAttribute("webkit-playsinline",""),i.play(),e.elements[t].videoPlayer=i,this.printLog("SelphId: start of video: "+e.elements[t].id,e.elements[t])}},canvasOnMove:function(e){if(void 0!==this.elements)for(var t=this.elements.length-1;t>=0;t--)if(void 0!==this.elements[t].layout&&e.offsetX>=this.elements[t].layout.x&&e.offsetX<this.elements[t].layout.x+this.elements[t].layout.width&&e.offsetY>=this.elements[t].layout.y&&e.offsetY<this.elements[t].layout.y+this.elements[t].layout.height){this.drawer.onMouseMove(e.target,this.elements[t].layout,this.resourceParent,this.elements[t].id,this.elements[t].type);break}},routeClick:function(e,t){this.canvasOnClick({offsetX:e,offsetY:t})},canvasOnClick:function(e){if("UCErrors"===this.state){var t;if(e.offsetX,e.offsetY>this.canvasHeight-this.buttonHeight)-1===this.livenessDiagnostic?(t=new CustomEvent("FPhi.SelphID.TimeoutErrorButtonClick.event"),this.divContainer.dispatchEvent(t)):(t=new CustomEvent("FPhi.SelphID.LivenessErrorButtonClick.event"),this.divContainer.dispatchEvent(t))}else{if(void 0===this.elements)return;for(var i=null,n=this.elements.length-1;n>=0;n--){var a=e.offsetX,l=e.offsetY;if(this.canvas.width<this.canvas.height&&this.cm.forceLandscape&&(a=e.offsetY,l=this.canvas.width/this.devicePixelRatio-e.offsetX),null!=this.elements[n].layout&&a>=this.elements[n].layout.x&&a<this.elements[n].layout.x+this.elements[n].layout.width&&l>=this.elements[n].layout.y&&l<this.elements[n].layout.y+this.elements[n].layout.height){i=this.elements[n].id;var s=new CustomEvent("FPhi.SelphID.TrackStatus.event",{detail:{code:Ke.SelphID.TrackStatus.Tap,timeStamp:this.secondsWidget,data:i}});this.divContainer.dispatchEvent(s);var r="Click//"+this.elements[n].id;this.graph.sendMessage(r);break}}}},initCamera:function(e,t,i){var n=this.canvas;if(!this.video){var a=document.createElement("video");a.id="live",a.setAttribute("playsinline",""),a.setAttribute("webkit-playsinline",""),a.setAttribute("autoplay",""),a.setAttribute("muted",""),a.style.display="none",e.insertBefore(a,e.firstChild),this.video=a}n.imageSmoothingEnabled=!0,n&&(n.style.display="none",n.onclick=this.canvasOnClick.bind(this),n.addEventListener("mousemove",this.canvasOnMove.bind(this),!1),this.privateCanvas=document.createElement("canvas"),0===this.cameraRotation||2===this.cameraRotation?(this.privateCanvas.width=t,this.privateCanvas.height=i):(this.privateCanvas.width=i,this.privateCanvas.height=t))},grantVideoPermission:function(){var e=m(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={video:{width:640,height:480},audio:!1},e.next=4,navigator.mediaDevices.getUserMedia(t);case 4:e.sent.getTracks().forEach((function(e){e.stop()})),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),setVideoInput:function(e){e.canvas&&e.playDevice(e,e.cm.getCameraId())},playDevice:function(){var e=m(u().mark((function e(t,i){var n,a,l,s,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.video,this.canvas.getContext("2d",{alpha:!0}),window.stream&&window.stream.getTracks().forEach((function(e){e.stop()})),t.forceCameraId&&(i=t.forceCameraId),null!=i?(a={video:{deviceId:i,width:t.cm.getCameraWidth(),height:t.cm.getCameraHeight()},audio:!1},navigator.mediaDevices.getUserMedia(a).then((function(e){var i=e.getVideoTracks()[0].getSettings();i&&(t.cameraMustFlip="environment"!==i.facingMode&&t.cm.getCameraMirror()),t.cameraStream=e,t.cameraId=t.cameraStream.getVideoTracks()[0].getSettings().deviceId,n.srcObject=e,n.addEventListener("loadedmetadata",t.videoLoaded.bind(t),!1),n.play()})).catch((function(e){t.printLog("SelphId: Error open camera with id: "+t.cm.getCameraId()),t.printLog(e),t.playDevice(t,null)}))):(l=t.cm.getCameraWidth(),s=t.cm.getCameraHeight(),r={video:{width:l,height:s,facingMode:{exact:!0===t.cameraFrontSide?"user":"environment"},zoom:1,focusMode:"continuous",exposureMode:"continuous"},audio:!1},navigator.mediaDevices.getUserMedia(r).then((function(e){var i=e.getVideoTracks()[0].getConstraints();i&&(t.cameraMustFlip="environment"!==i.facingMode.exact&&t.cm.getCameraMirror()),t.cameraId=t.cameraStream.getVideoTracks()[0].getSettings().deviceId,n.srcObject=e,n.addEventListener("loadedmetadata",t.videoLoaded.bind(t),!1),n.play()})).catch((function(e){var i={video:{width:l,height:s,facingMode:{exact:!0!==t.cameraFrontSide?"user":"environment"},zoom:1,focusMode:"continuous",exposureMode:"continuous"},audio:!1};t.cameraMustFlip=!0!==t.cameraFrontSide&&t.cm.getCameraMirror(),navigator.mediaDevices.getUserMedia(i).then((function(e){var i=e.getVideoTracks()[0].getConstraints();i&&(t.cameraMustFlip="environment"!==i.facingMode.exact&&t.cm.getCameraMirror()),t.cameraStream=e,t.cameraId=t.cameraStream.getVideoTracks()[0].getSettings().deviceId,n.srcObject=e,n.addEventListener("loadedmetadata",t.videoLoaded.bind(t),!1),n.play()})).catch((function(e){var i={video:{width:l,height:s,facingMode:"environment",zoom:1,focusMode:"continuous",exposureMode:"continuous"},audio:!1};navigator.mediaDevices.getUserMedia(i).then((function(e){t.cameraMustFlip=!(t.mobileCheck()|t.isIpadOS())&&t.cm.getCameraMirror(),t.cameraStream=e,t.cameraId=t.cameraStream.getVideoTracks()[0].getSettings().deviceId,n.srcObject=e,n.addEventListener("loadedmetadata",t.videoLoaded.bind(t),!1),n.play()})).catch((function(e){console.log(e),t.printLog("SelphId: Camera error");var i=new CustomEvent("FPhi.SelphID.ExceptionCaptured.event",{detail:{message:"Camera not found.",exceptionType:0}});t.divContainer.dispatchEvent(i)}))}))})));case 2:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}(),handleRecorderDataAvailable:function(e){e.data&&e.data.size>0&&this.recordedBlobs.push(e.data)},handleRecorderOnStop:function(e){this.recorderFinish=!0},mobileCheck:function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},isIpadOS:function(){return navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform)},gotDevices:function(e){for(var t=0,i=0;i!==e.length;++i)"videoinput"===e[i].kind&&t++;this.cameraList=new Array(t);for(var n=0,a=0;a!==e.length;++a){var l=e[a];if("videoinput"===l.kind){var s=document.createElement("option");s.value=l.deviceId,s.text=l.label,this.cameraList[n]=s,n++}}var r=new CustomEvent("FPhi.SelphID.Cameras.event",{detail:{cameras:this.cameraList}});this.divContainer.dispatchEvent(r)},handleCameraError:function(e){},getLayoutFromXML:function(e,t,i,n,a){var l="LEFT",s="TOP",r=i;if(this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"width")){null==r&&(r={});var c=this.rm.getSetupFloat(e,t,this.drawer.landscape,"width");r.width=c<=1?c*n:c,!0}if(this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"height")){null==r&&(r={});var o=this.rm.getSetupFloat(e,t,this.drawer.landscape,"height");r.height=o<=1?o*a:o,!0}if(this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"xAnchor")&&(l=this.rm.getSetupAlign(e,t,this.drawer.landscape,"xAnchor")),this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"yAnchor")&&(s=this.rm.getSetupAlign(e,t,this.drawer.landscape,"yAnchor")),this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"x")){null==r&&(r={});var d=this.rm.getSetupFloat(e,t,this.drawer.landscape,"x");r.x=d<=1&&d>=-1?d*n:d,"CENTER"===l?r.x=n/2-r.width/2+r.x:"RIGHT"===l&&(r.x=n-r.width+r.x),!0}if(this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"y")){null==r&&(r={});var u=this.rm.getSetupFloat(e,t,this.drawer.landscape,"y");r.y=u<=1&&u>=-1?u*a:u,"CENTER"===s?r.y=a/2-r.height/2+r.y:"BOTTOM"===s&&(r.y=a-r.height+r.y),!0}return r},draw:function(e,t){if(null!=e.drawer){var i=e.canvas.getContext("2d",{alpha:!0});e.canvas.width<e.canvas.height&&e.cm.forceLandscape&&(i=e.canvasRotated.getContext("2d",{alpha:!0}));var n=i.canvas.width,a=i.canvas.height;i.clearRect(0,0,n,a),this.canvasWidth=n,this.canvasHeight=a,e.fpsframes++,e.actualTimePrev=e.actualTime,e.actualTime=performance.now();var l=(e.actualTime-e.fpsTime)/1e3;l>1&&(e.fps=e.fpsframes/l,e.fpseframes>0?e.fpse=e.fpseframes/l:e.fpse=0,e.fpsTime=e.actualTime,e.fpsframes=0,e.fpseframes=0);var s="Normal";if("UCCaptureStatus"===e.state&&!1===e.imageCaptured&&(s="Warning"),e.iterateAutomata(e,t,i),e.secondsWidget=(e.actualTime-e.widgetTime)/1e3,e.secondsState=(e.actualTime-e.stateTime)/1e3,i.save(),i.scale(e.devicePixelRatio,e.devicePixelRatio),void 0!==e.elements&&null!==e.elements){var r={progress:0};r.state=e.state,r.contour=e.contour,r.status=e.status,r.previewImage=e.previewImage,r.forceLandscape=e.cm.getForceLandscape(),r.diagnostic=e.diagnostic,r.cameraOverflow=e.cm.getCameraOverflow();for(var c=0;c<e.elements.length;c++)if("button"!==e.elements[c].type&&"buttonImage"!==e.elements[c].type||!1!==e.interactible){var o=e.drawer.getLayout(i,e.resourceParent,e.elements[c].id,e.elements[c].type,e.secondsWidget,e.secondsState,s,r);if(null!=o&&(o=e.getLayoutFromXML(e.resourceParent,e.elements[c].id,o,n,a)),null!=o){e.elements[c].layout=o;var d=e.elements[c].mode,u=!1;if(null!=d){for(var h=d.split("|"),m=0;m<h.length;m++)if(h[m]===s){u=!0;break}}else u=!0;if(!0===u){if("video"===e.elements[c].type)r.player=e.elements[c].videoPlayer;else if("camera"===e.elements[c].type){var b=e.privateCanvas.getContext("2d");switch(b.save(),e.cameraRotation){case 0:b.drawImage(t,0,0,e.cameraWidth,e.cameraHeight);break;case 1:case 3:b.translate(e.cameraHeight/2,e.cameraWidth/2),b.rotate(Math.PI/2*e.cameraRotation),b.drawImage(t,-e.cameraWidth/2,-e.cameraHeight/2);break;case 2:b.translate(e.cameraWidth/2,e.cameraHeight/2),b.rotate(Math.PI/2*e.cameraRotation),b.drawImage(t,-e.cameraWidth/2,-e.cameraHeight/2)}switch(b.restore(),r.camera=e.privateCanvas,e.cameraRotation){case 0:case 2:r.width=e.cameraWidth,r.height=e.cameraHeight;break;default:r.width=e.cameraHeight,r.height=e.cameraWidth}r.cameraRotation=e.cameraRotation,r.cameraMustFlip=e.cameraMustFlip}e.cm.getAccessibility()&&e.cm.getAccessibleElements().includes(e.elements[c].type)||e.drawer.draw(i,o,e.resourceParent,e.elements[c].id,e.elements[c].type,e.secondsWidget,e.secondsState,s,r)}}}}else if("UCErrors"===e.state){i.fillStyle="white",i.fillRect(0,0,n,a);var p=e.livenessErrorString,g=15*e.fontSizeFactor,Z=e.rm.getSetupResourceId("facephi-widget-conf","","font_warning_message");i.font=g+"px '"+Z+"'",i.fillStyle="black";for(var I=p.split("\n"),R=0;R<I.length;R++){var f=i.measureText(I[R]),v=330*e.canvasSizeFactor+g*R;i.fillText(I[R],n/2-f.width/2,v)}var W=e.livenessErrorImage,G=e.scaleRect({width:W.width,height:W.height},{x:.03*n,y:.378*a,width:.94*n,height:.1*a},!0);i.drawImage(W,G.x,G.y,G.width,G.height),e.drawButton(e,i,{x:0,y:a-e.buttonHeight,width:n,height:e.buttonHeight},"Results","button_finish"),e.secondsState}else"UCTimeout"===e.state&&(i.fillStyle="white",i.fillRect(0,0,n,a));if(e.debug){var V,X,S,C=4;if(i.fillStyle="#ff000044",i.fillRect(0,51,250,320),i.lineWidth=1,i.strokeStyle="#ff000088",i.strokeRect(0,51,250,320),i.font="14px Verdana",e.drawBorderedText(i,"Version"+e.extractorVersion,3,20*C,"black","white"),C++,e.drawBorderedText(i,"Preview: "+e.preview,3,20*C,"black","white"),C++,e.drawBorderedText(i,"State: "+e.state,3,20*C,"black","white"),C++,e.drawBorderedText(i,"FPS: "+e.fps.toFixed(2),3,20*C,"black","white"),C++,e.drawBorderedText(i,"FPS Extractor: "+e.fpse.toFixed(2),3,20*C,"black","white"),C++,e.drawBorderedText(i,"Camera size: "+e.cameraWidth+"x"+e.cameraHeight+" px",3,20*C,"black","white"),C++,e.drawBorderedText(i,"Canvas size: "+n+"x"+a+" px",3,20*C,"black","white"),C++,e.drawBorderedText(i,"Camera rotation: "+e.cameraRotation,3,20*C,"black","white"),C++,e.drawBorderedText(i,"WidgetTime: "+e.secondsWidget.toFixed(2),3,20*C,"black","white"),C++,e.drawBorderedText(i,"StateTime: "+e.secondsState.toFixed(2),3,20*C,"black","white"),C++,e.drawBorderedText(i,"Operating mode: "+s,3,20*C,"black","white"),C++,e.drawBorderedText(i,"Internal status: "+(null===(V=e.detectionStatus)||void 0===V?void 0:V.internalStatus),3,20*C,"black","white"),C++,e.drawBorderedText(i,"Detection status: "+y[null===(X=e.detectionStatus)||void 0===X?void 0:X.status],3,20*C,"black","white"),C++,e.drawBorderedText(i,"Glare detection: "+(null===(S=e.detectionStatus)||void 0===S?void 0:S.glare),3,20*C,"black","white"),C++,e.docRect){var N=n/e.devicePixelRatio/4,E=N/e.cameraWidth,Y=e.cameraHeight*E;i.drawImage(e.privateCanvas,0,0,e.cameraWidth,e.cameraHeight,n/e.devicePixelRatio-N-5,55,N,Y)}}if(i.restore(),e.canvas.width<e.canvas.height&&e.cm.forceLandscape){var F=e.canvas.getContext("2d",{alpha:!0});F.clearRect(0,0,F.canvas.width,F.canvas.height),F.save(),F.translate(F.canvas.width/2,F.canvas.height/2),F.rotate(Math.PI/2),F.drawImage(e.canvasRotated,-F.canvas.height/2,-F.canvas.width/2),F.restore()}setTimeout(e.draw,e.samplePeriod,e,t)}},drawBorderedText:function(e,t,i,n,a,l){e.fillStyle=a,e.fillText(t,i,n),e.fillStyle=l,e.fillText(t,i-1,n-2)},openFullScreen:function(e){var t;e.requestFullscreen?t=e.requestFullscreen():e.mozRequestFullScreen?t=e.mozRequestFullScreen():e.webkitRequestFullscreen?t=e.webkitRequestFullscreen():e.msRequestFullscreen&&(t=e.msRequestFullscreen()),t.catch((function(e){}))},iterateAutomata:function(e,t,i){if(!1!==e.cameraReady){if("UCNothing"===e.state)e.workerWorking=!1,e.graph.sendMessage("SetMode//0,0,0,"+(!0===e.cm.getInitialTip()?"1":"0"));else if("UCCapture"===e.state){if(0==e.workerWorking)if(!0===e.imageCaptured&&e.secondsWidget-e.imageCapturedTime>1||e.secondsState>e.captureTimeout&&e.captureTimeout>0)e.graph.sendMessage("CaptureFinish");else{var n=e.privateCanvas.getContext("2d");switch(n.save(),e.cameraRotation){case 0:n.drawImage(t,0,0,e.cameraWidth,e.cameraHeight);break;case 1:case 3:n.translate(e.cameraHeight/2,e.cameraWidth/2),n.rotate(Math.PI/2*e.cameraRotation),n.drawImage(t,-e.cameraWidth/2,-e.cameraHeight/2);break;case 2:n.translate(e.cameraWidth/2,e.cameraHeight/2),n.rotate(Math.PI/2*e.cameraRotation),n.drawImage(t,-e.cameraWidth/2,-e.cameraHeight/2)}if(n.restore(),e.canvas.width<e.canvas.height&&e.cm.forceLandscape){var a=e.drawer.getDocRectScreenSpace(i.canvas.width,i.canvas.height),l={x:i.canvas.height-(a.y+a.height),y:a.x,width:a.height,height:a.width};e.docRect=e.drawer.fromScreenToCamera(i,e.cameraWidth,e.cameraHeight,i.canvas.height,i.canvas.width,e.cameraMustFlip,l)}else e.docRect=e.drawer.getDocRect(i,e.cameraWidth,e.cameraHeight,e.cameraContainer.offsetWidth,e.cameraContainer.offsetHeight,e.cameraMustFlip);e.docRect.x-=(1.2*e.docRect.width-e.docRect.width)/2,e.docRect.y-=(1.2*e.docRect.height-e.docRect.height)/2,e.docRect.width*=1.2,e.docRect.height*=1.2,e.docRect.x+e.docRect.width>e.cameraWidth&&(e.docRect.width=e.cameraWidth-e.docRect.x),e.docRect.y+e.docRect.height>e.cameraHeight&&(e.docRect.height=e.cameraHeight-e.docRect.y),e.fpseframes++,e.workerWorking=!0,this.engine.detectImage(e.privateCanvas,e.status).then((function(t){e.detectionStatus=t.detectionStatus,e.results=t,e.diagnostic=t.detectionStatus.status,e.cm.getCaptureMode()==Ke.SelphID.CaptureMode.SingleSide||e.status===Ke.SelphID.Mode.Front&&e.cm.getCaptureMode()===Ke.SelphID.CaptureMode.DoubleSide?0===t.diagnostic&&null!==t.images.frontDocument&&null!==t.images.frontDocument.rawImage&&(e.previewImage=e.getImg(t.imagesRaw.frontDocument),e.imageCaptured=!0):e.status===Ke.SelphID.Mode.Back&&0===t.diagnostic&&null!==t.images&&null!==t.images.backDocument&&null!==t.images.backDocument.rawImage&&(e.previewImage=e.getImg(t.imagesRaw.backDocument),e.imageCaptured=!0),e.workerWorking=!1}),(function(t){console.error(t),e.workerWorking=!1}))}}else"UCCaptureStatus"===e.state?e.secondsState>1.5&&(!0===this.imageCaptured?this.preview?this.graph.sendMessage("Preview"):this.cm.getCaptureMode()===Ke.SelphID.CaptureMode.DoubleSide&&this.status===Ke.SelphID.Mode.Front?this.graph.sendMessage("Next"):this.graph.sendMessage("Finish"):(this.retries++,this.retries>=this.captureRetries&&this.captureRetries>0&&!1===this.debug?this.cm.getAskSimpleMode()?this.graph.sendMessage("TimeoutPreview"):this.graph.sendMessage("Timeout"):this.graph.sendMessage("Fail"))):"UCPreview"===e.state||("UCFlip"===e.state?e.secondsState>1&&e.graph.sendMessage("Timer"):"UCWaitRecording"===e.state&&(e.cm.getVideoRecord()?e.recorderFinish&&e.graph.sendMessage("Finish"):e.graph.sendMessage("Finish")));if(e.cm.getVideoRecord()&&e.recorder.isReady()){e.privateRecordCanvasContext.drawImage(t,0,0,e.privateRecordCanvas.width,e.privateRecordCanvas.height);var s=e.privateRecordCanvasContext.getImageData(0,0,e.privateRecordCanvas.width,e.privateRecordCanvas.height);e.recorder.addFrame(s)}}},getImg:function(e){var t=new ImageData(e.data,e.width,e.height,{colorSpace:e.colorSpace}),i=document.createElement("canvas");i.width=e.width,i.height=e.height,i.getContext("2d").putImageData(t,0,0);var n=i.toDataURL(),a=document.createElement("img");return a.src=n,a},getVideoSources:function(e){var t=null;navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then((function(i){var n=i.filter((function(e){return"video"===e.kind})).map((function(e,t){return e.id}));t=n[0],e.setVideoInput(e)})):MediaStreamTrack.getSources((function(i){var n=i.filter((function(e){return"video"===e.kind})).map((function(e,t){return e.id}));t=n[0],e.setVideoInput(e)})),null==t&&e.printLog("selectedSource==null")},isPathAbsolute:function(e){return/^(?:\/|.+:\/\/|http)/.test(e)},getScriptPath:function(){return String((new Error).stack).replace(/^Error.*\n/,"").split("\n")[1].match(/http.*\.js/)[0].split("/").slice(0,-1).join("/")+"/"},OnResourceManagerStatus:function(e,t){null!==e&&t&&(e.rmReady=!0,e.CheckDependencies(e))},OnGraphReady:function(e){this.graphReady=!0,this.CheckDependencies(this)},CheckDependencies:function(){var e=m(u().mark((function e(t){var i,n,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:!0===t.rmReady&&void 0!==t.drawer&&!0===t.graphReady&&!0===t.cameraReady&&1==t.engineLoaded&&"UCNothing"!==t.graph.state&&(null!=(i=t.canvas)&&(i.style.display="none"),n=new CustomEvent("FPhi.SelphID.ModuleLoaded.event",{detail:{cameraWidth:t.cameraWidth,cameraHeight:t.cameraHeight}}),this.divContainer.dispatchEvent(n),t.drawer.rm=t.rm,t.drawer.cameraCount=t.cameraCount,a=t.canvas,t.canvas.width<t.canvas.height&&t.cm.forceLandscape?(t.drawer.setCanvasSize(t.cameraContainer.offsetHeight,t.cameraContainer.offsetWidth),a=t.canvasRotated):t.drawer.setCanvasSize(t.cameraContainer.offsetWidth,t.cameraContainer.offsetHeight),t.graph.setInitialState("UCNothing"),a.getContext("2d",{alpha:!0}),t.draw(t,t.video),t.cameraContainer.removeChild(t.gifWait));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),videoLoaded:function(e){var t=!0;!0===this.cameraReady&&(t=!1),this.cameraWidth=e.target.videoWidth,this.cameraHeight=e.target.videoHeight,0===this.cameraRotation||2===this.cameraRotation?(this.privateCanvas.width=this.cameraWidth,this.privateCanvas.height=this.cameraHeight):(this.privateCanvas.width=this.cameraHeight,this.privateCanvas.height=this.cameraWidth),this.cameraReady=!0,this.video,this.canvas.getContext("2d",{alpha:!0});var i=document.createElement("canvas");if(i.width=this.cameraWidth,i.height=this.cameraHeight,this.workerCanvas=i,this.workerCanvasContext=i.getContext("2d").getImageData(0,0,this.cameraWidth,this.cameraHeight),this.cm.getVideoRecord()){switch(this.printLog("Selphi: Video recording enabled..."),this.videoRecordWidth=this.cameraWidth*this.cm.getVideoRecordScale(),this.videoRecordHeight=this.cameraHeight*this.cm.getVideoRecordScale(),this.cm.getVideoRecordType()){case Ke.SelphID.RecorderType.Local:this.recorder=new o(this.cameraWidth*this.cm.getVideoRecordScale(),this.cameraHeight*this.cm.getVideoRecordScale(),this.cm.getVideoRecordRate(),this.bundlePath);break;case Ke.SelphID.RecorderType.Remote:this.recorder=new h(this.cameraWidth*this.cm.getVideoRecordScale(),this.cameraHeight*this.cm.getVideoRecordScale(),this.cm.getVideoRecordRate(),this.bundlePath)}this.privateRecordCanvas=document.createElement("canvas"),this.privateRecordCanvas.width=this.videoRecordWidth,this.privateRecordCanvas.height=this.videoRecordHeight,this.privateRecordCanvasContext=this.privateRecordCanvas.getContext("2d")}t&&this.CheckDependencies(this)},videoFrame:function(e){this.canvasVideoPlayer.getContext("2d").drawImage(e.target,0,0)},videoplayerEnded:function(e){"UCWizardCompleted"===this.state?this.graph.sendMessage("VideoFinished"):e.target.play()}},Ke.SelphID.CheckCapabilities=m(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,navigator.mediaDevices.enumerateDevices();case 3:return e.next=5,e.sent.filter((function(e){return"videoinput"==e.kind})).length;case 5:return e.t0=e.sent,t.video_devices=e.t0>0,t.wasm=function(){try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var e=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(e instanceof WebAssembly.Module)return new WebAssembly.Instance(e)instanceof WebAssembly.Instance}}catch(t){}return!1}(),t.wasm_pthreads=!1,!0===t.wasm&&"function"==typeof SharedArrayBuffer&&(t.wasm_pthreads=!0),e.abrupt("return",t);case 11:case"end":return e.stop()}}),e)}))),Ke.SelphID.Component=I,customElements.define("facephi-selphid",Ke.SelphID.Component)}();var k=F.l,x=function(){var t=(0,e.useContext)(c).setActiveView,i={res480p:{title:"640x480",width:640,height:480},res600p:{title:"800x600",width:800,height:600},res768p:{title:"1024x768",width:1024,height:768},res720p:{title:"1280x720 (720p)",width:1280,height:720},res1080p:{title:"1920x1080 (1080p)",width:1920,height:1080}},n=l((0,e.useState)(!0),2),a=n[0],s=n[1],o=l((0,e.useState)(!0),2),d=o[0],u=(o[1],l((0,e.useState)(!1),2)),h=u[0],m=(u[1],l((0,e.useState)(!1),2)),b=m[0],p=(m[1],l((0,e.useState)(!1),2)),g=p[0],Z=(p[1],l((0,e.useState)("res720p"),2)),I=(Z[0],Z[1],l((0,e.useState)(i.res720p.width),2)),y=I[0],R=(I[1],l((0,e.useState)(i.res720p.height),2)),f=R[0],v=(R[1],l((0,e.useState)(!1),2)),W=v[0],G=(v[1],l((0,e.useState)(!1),2)),V=G[0],X=(G[1],l((0,e.useState)(!1),2)),S=X[0],C=X[1],N=l((0,e.useState)("3D430010231C062B0411476A4A2F2702061538014903324149720C0625140E003E1C3D3F1106476A4A252F02060B230D2C281706093F180C644D4109390B0C281206476A134B250E0E0835061D354359473C070A270D0B0A231C4B6A430704240D2C2805415F725A5974534E5569455A76434F4735101D3400270424094B7C435021645B590051205663582D76565050605C5B7151225663592D76555156602E5871555453115C2877205251615E5B74535754615B5874525151625E5C07512555695B2F7750515C605B5C7653215360592872575124622D5A75515156165C5E77245450655C5B7650565411585C76555321605D5C755451556959507653502363595C71502554665A507253505265595C7050505563592F76225121602A5A72512057625B507456515060515874525756115B5876255256655E5A70532654675B2F76545053625D5B7654275666592F73225026632A590451525667595974595226655A5977545153695D5174235423602B5B7E515454645C5A7750535661505A7053265415585C76515257615F5873512254665D517457512465585C7054575568595072535326635F5B7052205362585876225055635C5B76515552165A5073275320615F5A07525253625C5E77235423625D5804515B5567592A74565326615A5C70505656695B2C75225455655E5A7551535565585C75275327635A5904505456125A2F74255320605C5D7E545356145A5C76555457602A5875542053605D5876235423655E597E515755605D5874255454625A587550535461585F74275326615F5903525752165D5877275352605D5903535755635B5976515251625F5872545657695B2F772254516150597F522054665D507524535464295807532757625B5B7453535262505A7054565467585974275050602C5D77555A5262585D76515150605C5902505556655B2A76575121605C590253525616582B77225127605C5902505252625D5B72235021632C5D7751555765592B7725515C602B5970505455135C2873525224645B5B7351575663582D7758512060505D75535355635B5D72235524632C5D7751525616582B77225127605C590250525564595877585156632C5D77542555135C2874545123605A597051215763582D7422515D615F5970515A5616595176225224645B5D00525A5262585D76515150605C5902505556655B5D7223542661295A0055545663585E76555127605C5902505257635B5D72235426632C5D77515A5616582B7659512460515905505557645B5D72235524632C5D7751525661592A76225356602E5971525A52625D5B75545551655B5C75545453625C5C73585423642B5C76545655135C2872545224645B590051205663582D76565050605C5B7151225663592D76555156602E5871525A52625D5B75545551615A5A77505154615A5074595223622A597753515369585B7551525461515905515453635A5F73585051642D590053225560582F7657555C615E5C7654535463595174525127602B5B7E515253605D2F755150526029580752565364595B742753526429587454565365592C75205054605C597E51255567585877235252622E5976512757615B5076525223605D5A70545155655A5A74245254602C5875535254635D5976275054655C587F52255668582A7624502062585A7F545556625D2F73515453625B5C07515B541258287425552161515B70502055655A5A7456512760505A7150505766585E74275453622D5900545753655D507550505264295B7F525054655B5873235123605C587352535463582B72575352655F5B04505055695B2A7323555C615B5C0753525768585C75245057622E5B7F50555365595176515255635C5C7354515560582D75225127635F5B0352555668592876535354625D5B04515352125D2D76555327602B5C71512557605D5873585423605B5C0754515612585075585423625D5C7253555760592D7459515D625F5B7F505056145B5072575423615F5B74515256145A507520522060505A77535057675D5177515254615C5C77502056115B5874275452635E5B72552657695A597723522662295B74532055655D5174245120625F5876515A55135C2872545224645B587551575663585A76595154605C5B0251575614582D75545551652A5A0055545613585E76205152602C590451225763592A75545551642C5A0055545665585F76245123602E597052525769595176225224645B5C7F525A52625A5C76515150615B590551545613585876565121632C5D77555A55135C2877585051602D597150535663592A75545551652A5A0055545563582D7654505360515B07535255135C2872545224645B587351535762592B7651515C602E5A00555453115B5D72235452642E5C75525A5262595C72545224645B587550545616592C76515157605C5877525A52625D5B75545551625F5974515556655B5176505123632C5D77505B52625C5D72235124602D597251515669585F76245551652A597351575613592B76225524645B597051215667585876565156635D5807505656655C2873525551622B590751555762585E762351246050590251265262595C644D4109390B0C281206213F0B1C2B040D1172521D3414064972040025040D16352E082508020972520F270D10007C4A052F02060B230D3D290A060B14070A330C060B244A53321316007C4A052906040C3E0F4B7C070209230D45640E10476A4A2828184149721808250A02023526082B04415F72040625000F0D3F1B1D644D41003E0F002804371C200D4B7C432E0C331A06240D0A0B3B4A456411110A341D0A32435947030D0536092A2172444B30041116390707645B41547E584B3B4D411522071F2F05061772524B00000000000000641C"),2),E=N[0],Y=N[1],F=function(e){return console.warn("[SelphID] onModuleLoaded",e)},x=function(e){console.warn("[SelphID] onExtractionFinished",e);var i=e.detail.images.backDocument||null,n=e.detail.images.frontDocument||null,a=e.detail.extractionData||null;console.log("Document Captured:",JSON.stringify(a)),null!==i&&console.log("Document back:",JSON.stringify(i)),null!==n&&console.log("Document front:",JSON.stringify(n)),s(!1),C(!1),t("Selphi")},w=function(){console.warn("[SelphID] onUserCancelled"),s(!1),C(!1)},L=function(e){console.warn("[SelphID] onExceptionCaptured",e),console.log("exceptionType: ".concat(e.detail.exceptionType)),console.log("exceptionMessage: ".concat(e.detail.message)),s(!1),C(!1)},T=function(e){console.warn("[SelphID] onExtractionTimeout",e),s(!1),C(!1)},U=function(e){var t=Object.entries(k.SelphID.TrackStatus).find((function(t){return t[1]===e.detail.code}));console.warn("[SelphID] onTrackStatus (Code: ".concat(t[1]," - ").concat(t[0],", Timestamp: ").concat(e.detail.timeStamp)),console.log(e)},K=(0,e.createRef)(),J=(0,e.useRef)();return(0,e.useEffect)((function(){if(J.current){if(a){var e=K.current;e.addWidgetEventListener("onModuleLoaded",F),e.addWidgetEventListener("onExtractionFinished",x),e.addWidgetEventListener("onUserCancelled",w),e.addWidgetEventListener("onExceptionCaptured",L),e.addWidgetEventListener("onExtractionTimeout",T),e.addWidgetEventListener("onTrackStatus",U),""===E&&Y(window.prompt("Please, enter the license key before start the operations: ",""))}}else J.current=!0}),[a,K,E]),(0,r.jsx)("facephi-selphid",{ref:K,language:"es",documentAspectRatio:85.6/53.98,bundlePath:"../../assets/selphid",previewCapture:d,forceLandscape:h,initialTip:b,licenseKey:E,imageFormat:"image/jpeg",style:{width:"100%",height:h?"56.25%":"100%"},cameraWidth:y,cameraHeight:f,specificData:"ES",videoRecord:W,videoRecordType:k.SelphID.RecorderType.Remote,videoRecordScale:y<1280?1:.5,showLog:V,debugMode:g,startSimpleMode:S})},w={871:function(e,t,i){i.d(t,{k:function(){return n}}),e=i.hmd(e);var n=function(){function e(t,i,n){X(this,e),this.graphUrl=t,this.graphReadyEvent=i,this.graphNewStateEvent=n,this.xmlHttpWidget=new XMLHttpRequest,this.xmlHttpWidget.onreadystatechange=this.readyEvent.bind(this),this.xmlHttpWidget.open("GET",this.graphUrl),this.xmlHttpWidget.send(null)}return C(e,[{key:"readyEvent",value:function(e){if(4==e.target.readyState&&200==e.target.status){var t=new DOMParser;this.xmlDoc=t.parseFromString(e.target.responseText,"text/xml"),this.graphReadyEvent()}}},{key:"setInitialState",value:function(e){null!=this.xmlDoc.querySelector("[name='"+e+"']")&&(this.state=e,this.graphNewStateEvent(this.state))}},{key:"sendMessage",value:function(e){var t=this.xmlDoc.querySelector("[name='"+this.state+"']");if(null!=t){var i=t.querySelector("[message='"+e+"']");if(null!=i||(e=e.split("//")[0],null!=(i=t.querySelector("[message='"+e+"']")))){var n=i.getAttribute("to");this.state=n,this.graphNewStateEvent(this.state)}}}}]),e}();!function(t){"object"==typeof exports?e.exports=t():"function"==typeof define&&i.amdO?define([],t):("undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:this).Animated_GIF=t()}((function(){return function e(t,i,n){function a(s,r){if(!i[s]){if(!t[s]){if(l)return l(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var o=i[s]={exports:{}};t[s][0].call(o.exports,(function(e){return a(t[s][1][e]||e)}),o,o.exports,e,t,i,n)}return i[s].exports}for(var l=void 0,s=0;s<n.length;s++)a(n[s]);return a}({1:[function(e,t,i){function n(e,t,i,n){for(var a=e[t++],l=1<<a,s=l+1,r=s+1,c=a+1,o=(1<<c)-1,d=0,u=0,h=0,m=e[t++],b=new Int32Array(4096),p=null;;){for(;d<16&&0!==m;)u|=e[t++]<<d,d+=8,1===m?m=e[t++]:--m;if(d<c)break;var g=u&o;if(u>>=c,d-=c,g!==l){if(g===s)break;for(var Z=g<r?g:p,I=0,y=Z;y>l;)y=b[y]>>8,++I;var R=y;if(h+I+(Z!==g?1:0)>n)return void console.log("Warning, gif stream longer than expected.");i[h++]=R;var f=h+=I;for(Z!==g&&(i[h++]=R),y=Z;I--;)y=b[y],i[--f]=255&y,y>>=8;null!==p&&r<4096&&(b[r++]=p<<8|R,r>=o+1&&c<12&&(++c,o=o<<1|1)),p=g}else r=s+1,o=(1<<(c=a+1))-1,p=null}return h!==n&&console.log("Warning, gif stream shorter than expected."),i}try{i.GifWriter=function(e,t,i,n){function a(e){var t=e.length;if(t<2||t>256||t&t-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return t}var l=0,s=void 0===(n=void 0===n?{}:n).loop?null:n.loop,r=void 0===n.palette?null:n.palette;if(t<=0||i<=0||t>65535||i>65535)throw"Width/Height invalid.";e[l++]=71,e[l++]=73,e[l++]=70,e[l++]=56,e[l++]=57,e[l++]=97;var c=0,o=0;if(null!==r){for(var d=a(r);d>>=1;)++c;if(d=1<<c,--c,void 0!==n.background){if((o=n.background)>=d)throw"Background index out of range.";if(0===o)throw"Background index explicitly passed as 0."}}if(e[l++]=255&t,e[l++]=t>>8&255,e[l++]=255&i,e[l++]=i>>8&255,e[l++]=(null!==r?128:0)|c,e[l++]=o,e[l++]=0,null!==r)for(var u=0,h=r.length;u<h;++u){var m=r[u];e[l++]=m>>16&255,e[l++]=m>>8&255,e[l++]=255&m}if(null!==s){if(s<0||s>65535)throw"Loop count invalid.";e[l++]=33,e[l++]=255,e[l++]=11,e[l++]=78,e[l++]=69,e[l++]=84,e[l++]=83,e[l++]=67,e[l++]=65,e[l++]=80,e[l++]=69,e[l++]=50,e[l++]=46,e[l++]=48,e[l++]=3,e[l++]=1,e[l++]=255&s,e[l++]=s>>8&255,e[l++]=0}var b=!1;this.addFrame=function(t,i,n,s,c,o){if(!0===b&&(--l,b=!1),o=void 0===o?{}:o,t<0||i<0||t>65535||i>65535)throw"x/y invalid.";if(n<=0||s<=0||n>65535||s>65535)throw"Width/Height invalid.";if(c.length<n*s)throw"Not enough pixels for the frame size.";var d=!0,u=o.palette;if(null!=u||(d=!1,u=r),null==u)throw"Must supply either a local or global palette.";for(var h=a(u),m=0;h>>=1;)++m;h=1<<m;var p=void 0===o.delay?0:o.delay,g=void 0===o.disposal?0:o.disposal;if(g<0||g>3)throw"Disposal out of range.";var Z=!1,I=0;if(void 0!==o.transparent&&null!==o.transparent&&(Z=!0,(I=o.transparent)<0||I>=h))throw"Transparent color index.";if((0!==g||Z||0!==p)&&(e[l++]=33,e[l++]=249,e[l++]=4,e[l++]=g<<2|(!0===Z?1:0),e[l++]=255&p,e[l++]=p>>8&255,e[l++]=I,e[l++]=0),e[l++]=44,e[l++]=255&t,e[l++]=t>>8&255,e[l++]=255&i,e[l++]=i>>8&255,e[l++]=255&n,e[l++]=n>>8&255,e[l++]=255&s,e[l++]=s>>8&255,e[l++]=!0===d?128|m-1:0,!0===d)for(var y=0,R=u.length;y<R;++y){var f=u[y];e[l++]=f>>16&255,e[l++]=f>>8&255,e[l++]=255&f}l=function(e,t,i,n){function a(i){for(;h>=i;)e[t++]=255&m,m>>=8,h-=8,t===s+256&&(e[s]=255,s=t++)}function l(e){m|=e<<h,h+=u,a(8)}e[t++]=i;var s=t++,r=1<<i,c=r-1,o=r+1,d=o+1,u=i+1,h=0,m=0,b=n[0]&c,p={};l(r);for(var g=1,Z=n.length;g<Z;++g){var I=n[g]&c,y=b<<8|I,R=p[y];if(void 0===R){for(m|=b<<h,h+=u;h>=8;)e[t++]=255&m,m>>=8,h-=8,t===s+256&&(e[s]=255,s=t++);4096===d?(l(r),d=o+1,u=i+1,p={}):(d>=1<<u&&++u,p[y]=d++),b=I}else b=R}return l(b),l(o),a(1),s+1===t?e[s]=0:(e[s]=t-s-1,e[t++]=0),t}(e,l,m<2?2:m,c)},this.end=function(){return!1===b&&(e[l++]=59,b=!0),l}},i.GifReader=function(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw"Invalid GIF 87a/89a header.";var i=e[t++]|e[t++]<<8,a=e[t++]|e[t++]<<8,l=e[t++],s=l>>7,r=1<<1+(7&l);e[t++],e[t++];var c=null;s&&(c=t,t+=3*r);var o=!0,d=[],u=0,h=null,m=0,b=null;for(this.width=i,this.height=a;o&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,b=e[t++]|e[t++]<<8,t++;else for(t+=12;0!==(V=e[t++]);)t+=V;break;case 249:if(4!==e[t++]||0!==e[t+4])throw"Invalid graphics extension block.";var p=e[t++];u=e[t++]|e[t++]<<8,h=e[t++],0==(1&p)&&(h=null),m=p>>2&7,t++;break;case 254:for(;0!==(V=e[t++]);)t+=V;break;default:throw"Unknown graphic control label: 0x"+e[t-1].toString(16)}break;case 44:var g=e[t++]|e[t++]<<8,Z=e[t++]|e[t++]<<8,I=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,R=e[t++],f=R>>6&1,v=c,W=!1;R>>7&&(W=!0,v=t,t+=3*(1<<1+(7&R)));var G=t;for(t++;;){var V;if(0===(V=e[t++]))break;t+=V}d.push({x:g,y:Z,width:I,height:y,has_local_palette:W,palette_offset:v,data_offset:G,data_length:t-G,transparent_index:h,interlaced:!!f,delay:u,disposal:m});break;case 59:o=!1;break;default:throw"Unknown gif block: 0x"+e[t-1].toString(16)}this.numFrames=function(){return d.length},this.loopCount=function(){return b},this.frameInfo=function(e){if(e<0||e>=d.length)throw"Frame index out of range.";return d[e]},this.decodeAndBlitFrameBGRA=function(t,a){var l=this.frameInfo(t),s=l.width*l.height,r=new Uint8Array(s);n(e,l.data_offset,r,s);var c=l.palette_offset,o=l.transparent_index;null===o&&(o=256);var d=l.width,u=i-d,h=d,m=4*(l.y*i+l.x),b=4*((l.y+l.height)*i+l.x),p=m,g=4*u;!0===l.interlaced&&(g+=4*i*7);for(var Z=8,I=0,y=r.length;I<y;++I){var R=r[I];if(0===h&&(h=d,(p+=g)>=b&&(g=4*u+4*i*(Z-1),p=m+(d+u)*(Z<<1),Z>>=1)),R===o)p+=4;else{var f=e[c+3*R],v=e[c+3*R+1],W=e[c+3*R+2];a[p++]=W,a[p++]=v,a[p++]=f,a[p++]=255}--h}},this.decodeAndBlitFrameRGBA=function(t,a){var l=this.frameInfo(t),s=l.width*l.height,r=new Uint8Array(s);n(e,l.data_offset,r,s);var c=l.palette_offset,o=l.transparent_index;null===o&&(o=256);var d=l.width,u=i-d,h=d,m=4*(l.y*i+l.x),b=4*((l.y+l.height)*i+l.x),p=m,g=4*u;!0===l.interlaced&&(g+=4*i*7);for(var Z=8,I=0,y=r.length;I<y;++I){var R=r[I];if(0===h&&(h=d,(p+=g)>=b&&(g=4*u+4*i*(Z-1),p=m+(d+u)*(Z<<1),Z>>=1)),R===o)p+=4;else{var f=e[c+3*R],v=e[c+3*R+1],W=e[c+3*R+2];a[p++]=f,a[p++]=v,a[p++]=W,a[p++]=255}--h}}}}catch(e){}},{}],2:[function(e,t,i){t.exports=function(t){function i(e){I.length,R=e;for(var t=0;t<c&&t<I.length;t++)n(t)}function n(e){var t,i;return(t=I[e]).beingProcessed||t.done?(console.error("Frame already being processed or done!",t.position),void l()):(t.sampleInterval=r,t.beingProcessed=!0,(i=function(){if(0===W.length)throw"No workers left!";return W.pop()}()).onmessage=function(e){var n=e.data;delete t.data,t.pixels=Array.prototype.slice.call(n.pixels),t.palette=Array.prototype.slice.call(n.palette),t.done=!0,t.beingProcessed=!1,function(e){W.push(e)}(i),l()},void i.postMessage(t))}function a(){for(var e=-1,t=0;t<I.length;t++){var i=I[t];if(!i.done&&!i.beingProcessed){e=t;break}}e>=0&&n(e)}function l(){var e=I.every((function(e){return!e.beingProcessed&&e.done}));y++,f(.75*y/I.length),e?G||function(e,t){var i,n=[],a={loop:g};null!==h&&null!==m&&(i=m,a.palette=i);var l=new o(n,d,u,a);G=!0,e.forEach((function(t,n){var a;i||(a=t.palette),f(.75+.25*t.position*1/e.length),l.addFrame(0,0,d,u,t.pixels,{palette:a,delay:Z})})),l.end(),f(1),e=[],G=!1,t(n)}(I,R):setTimeout(a,1)}function s(e){return 0!==e&&0==(e&e-1)}t=t||{};var r,c,o=e("omggif").GifWriter,d=t.width||160,u=t.height||120,h=t.dithering||null,m=t.palette||null,b=null,p=null,g=0,Z=250,I=[],y=0,R=function(){},f=function(){},v=[],W=[],G=!1;if(m){if(!(m instanceof Array))throw m;if(m.length<2||m.length>256){for(console.error("Palette must hold only between 2 and 256 colours");m.length<2;)m.push(0);m.length>256&&(m=m.slice(0,256))}if(!s(m.length))for(console.error("Palette must have a power of two number of colours");!s(m.length);)m.splice(m.length-1,1)}r=(t=t||{}).sampleInterval||10,c=t.numWorkers||2;for(var V=0;V<c;V++){var X=new Worker(window.URL.createObjectURL(new Blob(['(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module \'"+o+"\'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\nfunction colorClamp(value) {\n\tif(value < 0) return 0;\n\telse if(value > 255) return 255;\n\n\treturn value;\n}\n\nvar bayerMatrix8x8 = [\n\t[  1, 49, 13, 61,  4, 52, 16, 64 ],\n\t[ 33, 17, 45, 29, 36, 20, 48, 32 ],\n\t[  9, 57,  5, 53, 12, 60,  8, 56 ],\n\t[ 41, 25, 37, 21, 44, 28, 40, 24 ],\n\t[  3, 51, 15, 63,  2, 50, 14, 62 ],\n\t[ 35, 19, 47, 31, 34, 18, 46, 30 ],\n\t[ 11, 59,  7, 55, 10, 58,  6, 54 ],\n\t[ 43, 27, 39, 23, 42, 26, 38, 22 ]\n\t];\n\n\t// int r, int g, int b, int[][] palette, int paletteLength\n\tfunction getClosestPaletteColorIndex(r, g, b, palette, paletteLength) {\n\t\tvar minDistance = 195076;\n\t\tvar diffR, diffG, diffB;\n\t\tvar distanceSquared;\n\t\tvar bestIndex = 0;\n\t\tvar paletteChannels;\n\n\t\tfor(var i = 0; i < paletteLength; i++) {\n\n\t\t\tpaletteChannels = palette[i];\n\t\t\tdiffR = r - paletteChannels[0];\n\t\t\tdiffG = g - paletteChannels[1];\n\t\t\tdiffB = b - paletteChannels[2];\n\n\t\t\tdistanceSquared = diffR*diffR + diffG*diffG + diffB*diffB;\n\n\t\t\tif(distanceSquared < minDistance) {\n\t\t\t\tbestIndex = i;\n\t\t\t\tminDistance = distanceSquared;\n\t\t\t}\n\n\t\t}\n\n\t\treturn bestIndex;\n\t}\n\n// TODO: inPixels -> inComponents or inColors or something more accurate\nfunction BayerDithering(inPixels, width, height, palette) {\n\tvar offset = 0;\n\tvar indexedOffset = 0;\n\tvar r, g, b;\n\tvar pixel, threshold, index;\n\tvar paletteLength = palette.length;\n\tvar matrix = bayerMatrix8x8;\n\tvar indexedPixels = new Uint8Array( width * height );\n\n\tvar modI = 8;\n\tvar modJ = 8;\n\n\tfor(var j = 0; j < height; j++) {\n\t\tvar modj = j % modJ;\n\n\t\tfor(var i = 0; i < width; i++) {\n\n\t\t\tthreshold = matrix[i % modI][modj];\n\n\t\t\tr = colorClamp( inPixels[offset++] + threshold );\n\t\t\tg = colorClamp( inPixels[offset++] + threshold );\n\t\t\tb = colorClamp( inPixels[offset++] + threshold );\n\n\t\t\tindex = getClosestPaletteColorIndex(r, g, b, palette, paletteLength);\n\t\t\tindexedPixels[indexedOffset++] = index;\n\n\t\t}\n\t}\n\n\treturn indexedPixels;\n}\n\n\nfunction ClosestDithering(inPixels, width, height, palette) {\n\n\tvar offset = 0;\n\tvar indexedOffset = 0;\n\tvar r, g, b;\n\tvar index;\n\tvar paletteLength = palette.length;\n\tvar matrix = bayerMatrix8x8;\n\tvar numPixels = width * height;\n\tvar indexedPixels = new Uint8Array( numPixels );\n\n\tfor(var i = 0; i < numPixels; i++) {\n\n\t\tr = inPixels[offset++];\n\t\tg = inPixels[offset++];\n\t\tb = inPixels[offset++];\n\n\t\tindexedPixels[i] = getClosestPaletteColorIndex(r, g, b, palette, paletteLength);\n\n\t}\n\n\treturn indexedPixels;\n\n}\n\n\nfunction FloydSteinberg(inPixels, width, height, palette) {\n\tvar paletteLength = palette.length;\n\tvar offset = 0;\n\tvar indexedOffset = 0;\n\tvar r, g, b;\n\tvar widthLimit = width - 1;\n\tvar heightLimit = height - 1;\n\tvar offsetNextI, offsetNextJ;\n\tvar offsetPrevINextJ;\n\tvar channels, nextChannels;\n\tvar indexedPixels = new Uint8Array( width * height );\n\n\tfor(var j = 0; j < height; j++) {\n\t\tfor(var i = 0; i < width; i++) {\n\n\t\t\tr = colorClamp(inPixels[offset++]);\n\t\t\tg = colorClamp(inPixels[offset++]);\n\t\t\tb = colorClamp(inPixels[offset++]);\n\n\t\t\tvar colorIndex = getClosestPaletteColorIndex(r, g, b, palette, paletteLength);\n\t\t\tvar paletteColor = palette[colorIndex];\n\t\t\tvar closestColor = paletteColor[3];\n\n\t\t\t// We are done with finding the best value for this pixel\n\t\t\tindexedPixels[indexedOffset] = colorIndex;\n\n\t\t\t// Now find difference between assigned value and original color\n\t\t\t// and propagate that error forward\n\t\t\tvar errorR = r - paletteColor[0];\n\t\t\tvar errorG = g - paletteColor[1];\n\t\t\tvar errorB = b - paletteColor[2];\n\n\t\t\tif(i < widthLimit) {\n\n\t\t\t\toffsetNextI = offset + 1;\n\n\t\t\t\tinPixels[offsetNextI++] += (errorR * 7) >> 4;\n\t\t\t\tinPixels[offsetNextI++] += (errorG * 7) >> 4;\n\t\t\t\tinPixels[offsetNextI++] += (errorB * 7) >> 4;\n\n\t\t\t}\n\n\n\t\t\tif(j < heightLimit) {\n\n\t\t\t\tif(i > 0) {\n\n\t\t\t\t\toffsetPrevINextJ = offset - 1 + width;\n\n\t\t\t\t\tinPixels[offsetPrevINextJ++] += (errorR * 3) >> 4;\n\t\t\t\t\tinPixels[offsetPrevINextJ++] += (errorG * 3) >> 4;\n\t\t\t\t\tinPixels[offsetPrevINextJ++] += (errorB * 3) >> 4;\n\n\t\t\t\t}\n\n\t\t\t\toffsetNextJ = offset + width;\n\n\t\t\t\tinPixels[offsetNextJ++] += (errorR * 5) >> 4;\n\t\t\t\tinPixels[offsetNextJ++] += (errorG * 5) >> 4;\n\t\t\t\tinPixels[offsetNextJ++] += (errorB * 5) >> 4;\n\n\n\t\t\t\tif(i < widthLimit) {\n\n\t\t\t\t\tinPixels[offsetNextJ++] += errorR >> 4;\n\t\t\t\t\tinPixels[offsetNextJ++] += errorG >> 4;\n\t\t\t\t\tinPixels[offsetNextJ++] += errorB >> 4;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tindexedOffset++;\n\t\t}\n\t}\n\n\treturn indexedPixels;\n}\n\nmodule.exports = {\n\tBayer: BayerDithering,\n\tClosest: ClosestDithering,\n\tFloydSteinberg: FloydSteinberg\n};\n\n\n},{}],2:[function(require,module,exports){\nvar NeuQuant = require(\'./lib/NeuQuant\');\nvar Dithering = require(\'node-dithering\');\n\nfunction channelizePalette( palette ) {\n    var channelizedPalette = [];\n\n    for(var i = 0; i < palette.length; i++) {\n        var color = palette[i];\n\n        var r = (color & 0xFF0000) >> 16;\n        var g = (color & 0x00FF00) >>  8;\n        var b = (color & 0x0000FF);\n\n        channelizedPalette.push([ r, g, b, color ]);\n    }\n\n    return channelizedPalette;\n\n}\n\n\nfunction dataToRGB( data, width, height ) {\n    var i = 0;\n    var length = width * height * 4;\n    var rgb = [];\n\n    while(i < length) {\n        rgb.push( data[i++] );\n        rgb.push( data[i++] );\n        rgb.push( data[i++] );\n        i++; // for the alpha channel which we don\'t care about\n    }\n\n    return rgb;\n}\n\n\nfunction componentizedPaletteToArray(paletteRGB) {\n\n    var paletteArray = [];\n\n    for(var i = 0; i < paletteRGB.length; i += 3) {\n        var r = paletteRGB[ i ];\n        var g = paletteRGB[ i + 1 ];\n        var b = paletteRGB[ i + 2 ];\n        paletteArray.push(r << 16 | g << 8 | b);\n    }\n\n    return paletteArray;\n}\n\n\n// This is the "traditional" Animated_GIF style of going from RGBA to indexed color frames\nfunction processFrameWithQuantizer(imageData, width, height, sampleInterval) {\n\n    var rgbComponents = dataToRGB( imageData, width, height );\n    var nq = new NeuQuant(rgbComponents, rgbComponents.length, sampleInterval);\n    var paletteRGB = nq.process();\n    var paletteArray = new Uint32Array(componentizedPaletteToArray(paletteRGB));\n\n    var numberPixels = width * height;\n    var indexedPixels = new Uint8Array(numberPixels);\n\n    var k = 0;\n    for(var i = 0; i < numberPixels; i++) {\n        r = rgbComponents[k++];\n        g = rgbComponents[k++];\n        b = rgbComponents[k++];\n        indexedPixels[i] = nq.map(r, g, b);\n    }\n\n    return {\n        pixels: indexedPixels,\n        palette: paletteArray\n    };\n\n}\n\n\n// And this is a version that uses dithering against of quantizing\n// It can also use a custom palette if provided, or will build one otherwise\nfunction processFrameWithDithering(imageData, width, height, ditheringType, palette) {\n\n    // Extract component values from data\n    var rgbComponents = dataToRGB( imageData, width, height );\n\n\n    // Build palette if none provided\n    if(palette === null) {\n\n        var nq = new NeuQuant(rgbComponents, rgbComponents.length, 16);\n        var paletteRGB = nq.process();\n        palette = componentizedPaletteToArray(paletteRGB);\n\n    }\n\n    var paletteArray = new Uint32Array( palette );\n    var paletteChannels = channelizePalette( palette );\n\n    // Convert RGB image to indexed image\n    var ditheringFunction;\n\n    if(ditheringType === \'closest\') {\n        ditheringFunction = Dithering.Closest;\n    } else if(ditheringType === \'floyd\') {\n        ditheringFunction = Dithering.FloydSteinberg;\n    } else {\n        ditheringFunction = Dithering.Bayer;\n    }\n\n    pixels = ditheringFunction(rgbComponents, width, height, paletteChannels);\n\n    return ({\n        pixels: pixels,\n        palette: paletteArray\n    });\n\n}\n\n\n// ~~~\n\nfunction run(frame) {\n    var width = frame.width;\n    var height = frame.height;\n    var imageData = frame.data;\n    var dithering = frame.dithering;\n    var palette = frame.palette;\n    var sampleInterval = frame.sampleInterval;\n\n    if(dithering) {\n        return processFrameWithDithering(imageData, width, height, dithering, palette);\n    } else {\n        return processFrameWithQuantizer(imageData, width, height, sampleInterval);\n    }\n\n}\n\n\nself.onmessage = function(ev) {\n    var data = ev.data;\n    var response = run(data);\n    postMessage(response);\n};\n\n},{"./lib/NeuQuant":3,"node-dithering":1}],3:[function(require,module,exports){\n/*\n* NeuQuant Neural-Net Quantization Algorithm\n* ------------------------------------------\n*\n* Copyright (c) 1994 Anthony Dekker\n*\n* NEUQUANT Neural-Net quantization algorithm by Anthony Dekker, 1994. See\n* "Kohonen neural networks for optimal colour quantization" in "Network:\n* Computation in Neural Systems" Vol. 5 (1994) pp 351-367. for a discussion of\n* the algorithm.\n*\n* Any party obtaining a copy of these files from the author, directly or\n* indirectly, is granted, free of charge, a full and unrestricted irrevocable,\n* world-wide, paid up, royalty-free, nonexclusive right and license to deal in\n* this software and documentation files (the "Software"), including without\n* limitation the rights to use, copy, modify, merge, publish, distribute,\n* sublicense, and/or sell copies of the Software, and to permit persons who\n* receive copies from any such party to do so, with the only requirement being\n* that this copyright notice remain intact.\n*/\n\n/*\n* This class handles Neural-Net quantization algorithm\n* @author Kevin Weiner (original Java version - kweiner@fmsware.com)\n* @author Thibault Imbert (AS3 version - bytearray.org)\n* @version 0.1 AS3 implementation\n* @version 0.2 JS->AS3 "translation" by antimatter15\n* @version 0.3 JS clean up + using modern JS idioms by sole - http://soledadpenades.com\n* Also implement fix in color conversion described at http://stackoverflow.com/questions/16371712/neuquant-js-javascript-color-quantization-hidden-bug-in-js-conversion\n*/\n\nmodule.exports = function NeuQuant() {\n\n    var netsize = 256; // number of colours used\n\n    // four primes near 500 - assume no image has a length so large\n    // that it is divisible by all four primes\n    var prime1 = 499;\n    var prime2 = 491;\n    var prime3 = 487;\n    var prime4 = 503;\n\n    // minimum size for input image\n    var minpicturebytes = (3 * prime4);\n\n    // Network Definitions\n\n    var maxnetpos = (netsize - 1);\n    var netbiasshift = 4; // bias for colour values\n    var ncycles = 100; // no. of learning cycles\n\n    // defs for freq and bias\n    var intbiasshift = 16; // bias for fractions\n    var intbias = (1 << intbiasshift);\n    var gammashift = 10; // gamma = 1024\n    var gamma = (1 << gammashift);\n    var betashift = 10;\n    var beta = (intbias >> betashift); // beta = 1/1024\n    var betagamma = (intbias << (gammashift - betashift));\n\n    // defs for decreasing radius factor\n    // For 256 colors, radius starts at 32.0 biased by 6 bits\n    // and decreases by a factor of 1/30 each cycle\n    var initrad = (netsize >> 3);\n    var radiusbiasshift = 6;\n    var radiusbias = (1 << radiusbiasshift);\n    var initradius = (initrad * radiusbias);\n    var radiusdec = 30;\n\n    // defs for decreasing alpha factor\n    // Alpha starts at 1.0 biased by 10 bits\n    var alphabiasshift = 10;\n    var initalpha = (1 << alphabiasshift);\n    var alphadec;\n\n    // radbias and alpharadbias used for radpower calculation\n    var radbiasshift = 8;\n    var radbias = (1 << radbiasshift);\n    var alpharadbshift = (alphabiasshift + radbiasshift);\n    var alpharadbias = (1 << alpharadbshift);\n\n\n    // Input image\n    var thepicture;\n    // Height * Width * 3\n    var lengthcount;\n    // Sampling factor 1..30\n    var samplefac;\n\n    // The network itself\n    var network;\n    var netindex = [];\n\n    // for network lookup - really 256\n    var bias = [];\n\n    // bias and freq arrays for learning\n    var freq = [];\n    var radpower = [];\n\n    function NeuQuantConstructor(thepic, len, sample) {\n\n        var i;\n        var p;\n\n        thepicture = thepic;\n        lengthcount = len;\n        samplefac = sample;\n\n        network = new Array(netsize);\n\n        for (i = 0; i < netsize; i++) {\n            network[i] = new Array(4);\n            p = network[i];\n            p[0] = p[1] = p[2] = ((i << (netbiasshift + 8)) / netsize) | 0;\n            freq[i] = (intbias / netsize) | 0; // 1 / netsize\n            bias[i] = 0;\n        }\n\n    }\n\n    function colorMap() {\n        var map = [];\n        var index = new Array(netsize);\n        for (var i = 0; i < netsize; i++)\n            index[network[i][3]] = i;\n        var k = 0;\n        for (var l = 0; l < netsize; l++) {\n            var j = index[l];\n            map[k++] = (network[j][0]);\n            map[k++] = (network[j][1]);\n            map[k++] = (network[j][2]);\n        }\n        return map;\n    }\n\n    // Insertion sort of network and building of netindex[0..255]\n    // (to do after unbias)\n    function inxbuild() {\n        var i;\n        var j;\n        var smallpos;\n        var smallval;\n        var p;\n        var q;\n        var previouscol;\n        var startpos;\n\n        previouscol = 0;\n        startpos = 0;\n\n        for (i = 0; i < netsize; i++)\n        {\n\n            p = network[i];\n            smallpos = i;\n            smallval = p[1]; // index on g\n            // find smallest in i..netsize-1\n            for (j = i + 1; j < netsize; j++) {\n\n                q = network[j];\n\n                if (q[1] < smallval) { // index on g\n                    smallpos = j;\n                    smallval = q[1]; // index on g\n                }\n            }\n\n            q = network[smallpos];\n\n            // swap p (i) and q (smallpos) entries\n            if (i != smallpos) {\n                j = q[0];\n                q[0] = p[0];\n                p[0] = j;\n                j = q[1];\n                q[1] = p[1];\n                p[1] = j;\n                j = q[2];\n                q[2] = p[2];\n                p[2] = j;\n                j = q[3];\n                q[3] = p[3];\n                p[3] = j;\n            }\n\n            // smallval entry is now in position i\n            if (smallval != previouscol) {\n\n                netindex[previouscol] = (startpos + i) >> 1;\n\n                for (j = previouscol + 1; j < smallval; j++) {\n                    netindex[j] = i;\n                }\n\n                previouscol = smallval;\n                startpos = i;\n\n            }\n\n        }\n\n        netindex[previouscol] = (startpos + maxnetpos) >> 1;\n        for (j = previouscol + 1; j < 256; j++) {\n            netindex[j] = maxnetpos; // really 256\n        }\n\n    }\n\n\n    // Main Learning Loop\n\n    function learn() {\n        var i;\n        var j;\n        var b;\n        var g;\n        var r;\n        var radius;\n        var rad;\n        var alpha;\n        var step;\n        var delta;\n        var samplepixels;\n        var p;\n        var pix;\n        var lim;\n\n        if (lengthcount < minpicturebytes) {\n            samplefac = 1;\n        }\n\n        alphadec = 30 + ((samplefac - 1) / 3);\n        p = thepicture;\n        pix = 0;\n        lim = lengthcount;\n        samplepixels = lengthcount / (3 * samplefac);\n        delta = (samplepixels / ncycles) | 0;\n        alpha = initalpha;\n        radius = initradius;\n\n        rad = radius >> radiusbiasshift;\n        if (rad <= 1) {\n            rad = 0;\n        }\n\n        for (i = 0; i < rad; i++) {\n            radpower[i] = alpha * (((rad * rad - i * i) * radbias) / (rad * rad));\n        }\n\n\n        if (lengthcount < minpicturebytes) {\n            step = 3;\n        } else if ((lengthcount % prime1) !== 0) {\n            step = 3 * prime1;\n        } else {\n\n            if ((lengthcount % prime2) !== 0) {\n                step = 3 * prime2;\n            } else {\n                if ((lengthcount % prime3) !== 0) {\n                    step = 3 * prime3;\n                } else {\n                    step = 3 * prime4;\n                }\n            }\n\n        }\n\n        i = 0;\n\n        while (i < samplepixels) {\n\n            b = (p[pix + 0] & 0xff) << netbiasshift;\n            g = (p[pix + 1] & 0xff) << netbiasshift;\n            r = (p[pix + 2] & 0xff) << netbiasshift;\n            j = contest(b, g, r);\n\n            altersingle(alpha, j, b, g, r);\n\n            if (rad !== 0) {\n                // Alter neighbours\n                alterneigh(rad, j, b, g, r);\n            }\n\n            pix += step;\n\n            if (pix >= lim) {\n                pix -= lengthcount;\n            }\n\n            i++;\n\n            if (delta === 0) {\n                delta = 1;\n            }\n\n            if (i % delta === 0) {\n                alpha -= alpha / alphadec;\n                radius -= radius / radiusdec;\n                rad = radius >> radiusbiasshift;\n\n                if (rad <= 1) {\n                    rad = 0;\n                }\n\n                for (j = 0; j < rad; j++) {\n                    radpower[j] = alpha * (((rad * rad - j * j) * radbias) / (rad * rad));\n                }\n\n            }\n\n        }\n\n    }\n\n    // Search for BGR values 0..255 (after net is unbiased) and return colour index\n    function map(b, g, r) {\n        var i;\n        var j;\n        var dist;\n        var a;\n        var bestd;\n        var p;\n        var best;\n\n        // Biggest possible distance is 256 * 3\n        bestd = 1000;\n        best = -1;\n        i = netindex[g]; // index on g\n        j = i - 1; // start at netindex[g] and work outwards\n\n        while ((i < netsize) || (j >= 0)) {\n\n            if (i < netsize) {\n\n                p = network[i];\n\n                dist = p[1] - g; // inx key\n\n                if (dist >= bestd) {\n                    i = netsize; // stop iter\n                } else {\n\n                    i++;\n\n                    if (dist < 0) {\n                        dist = -dist;\n                    }\n\n                    a = p[0] - b;\n\n                    if (a < 0) {\n                        a = -a;\n                    }\n\n                    dist += a;\n\n                    if (dist < bestd) {\n                        a = p[2] - r;\n\n                        if (a < 0) {\n                            a = -a;\n                        }\n\n                        dist += a;\n\n                        if (dist < bestd) {\n                            bestd = dist;\n                            best = p[3];\n                        }\n                    }\n\n                }\n\n            }\n\n            if (j >= 0) {\n\n                p = network[j];\n\n                dist = g - p[1]; // inx key - reverse dif\n\n                if (dist >= bestd) {\n                    j = -1; // stop iter\n                } else {\n\n                    j--;\n                    if (dist < 0) {\n                        dist = -dist;\n                    }\n                    a = p[0] - b;\n                    if (a < 0) {\n                        a = -a;\n                    }\n                    dist += a;\n\n                    if (dist < bestd) {\n                        a = p[2] - r;\n                        if (a < 0) {\n                            a = -a;\n                        }\n                        dist += a;\n                        if (dist < bestd) {\n                            bestd = dist;\n                            best = p[3];\n                        }\n                    }\n\n                }\n\n            }\n\n        }\n\n        return (best);\n\n    }\n\n    function process() {\n        learn();\n        unbiasnet();\n        inxbuild();\n        return colorMap();\n    }\n\n    // Unbias network to give byte values 0..255 and record position i\n    // to prepare for sort\n    function unbiasnet() {\n        var i;\n        var j;\n\n        for (i = 0; i < netsize; i++) {\n            network[i][0] >>= netbiasshift;\n            network[i][1] >>= netbiasshift;\n            network[i][2] >>= netbiasshift;\n            network[i][3] = i; // record colour no\n        }\n    }\n\n    // Move adjacent neurons by precomputed alpha*(1-((i-j)^2/[r]^2))\n    // in radpower[|i-j|]\n    function alterneigh(rad, i, b, g, r) {\n\n        var j;\n        var k;\n        var lo;\n        var hi;\n        var a;\n        var m;\n\n        var p;\n\n        lo = i - rad;\n        if (lo < -1) {\n            lo = -1;\n        }\n\n        hi = i + rad;\n\n        if (hi > netsize) {\n            hi = netsize;\n        }\n\n        j = i + 1;\n        k = i - 1;\n        m = 1;\n\n        while ((j < hi) || (k > lo)) {\n\n            a = radpower[m++];\n\n            if (j < hi) {\n\n                p = network[j++];\n\n                try {\n\n                    p[0] -= ((a * (p[0] - b)) / alpharadbias) | 0;\n                    p[1] -= ((a * (p[1] - g)) / alpharadbias) | 0;\n                    p[2] -= ((a * (p[2] - r)) / alpharadbias) | 0;\n\n                } catch (e) {}\n\n            }\n\n            if (k > lo) {\n\n                p = network[k--];\n\n                try {\n\n                    p[0] -= ((a * (p[0] - b)) / alpharadbias) | 0;\n                    p[1] -= ((a * (p[1] - g)) / alpharadbias) | 0;\n                    p[2] -= ((a * (p[2] - r)) / alpharadbias) | 0;\n\n                } catch (e) {}\n\n            }\n\n        }\n\n    }\n\n\n    // Move neuron i towards biased (b,g,r) by factor alpha\n    function altersingle(alpha, i, b, g, r) {\n\n        // alter hit neuron\n        var n = network[i];\n        var alphaMult = alpha / initalpha;\n        n[0] -= ((alphaMult * (n[0] - b))) | 0;\n        n[1] -= ((alphaMult * (n[1] - g))) | 0;\n        n[2] -= ((alphaMult * (n[2] - r))) | 0;\n\n    }\n\n    // Search for biased BGR values\n    function contest(b, g, r) {\n\n        // finds closest neuron (min dist) and updates freq\n        // finds best neuron (min dist-bias) and returns position\n        // for frequently chosen neurons, freq[i] is high and bias[i] is negative\n        // bias[i] = gamma*((1/netsize)-freq[i])\n\n        var i;\n        var dist;\n        var a;\n        var biasdist;\n        var betafreq;\n        var bestpos;\n        var bestbiaspos;\n        var bestd;\n        var bestbiasd;\n        var n;\n\n        bestd = ~(1 << 31);\n        bestbiasd = bestd;\n        bestpos = -1;\n        bestbiaspos = bestpos;\n\n        for (i = 0; i < netsize; i++) {\n\n            n = network[i];\n            dist = n[0] - b;\n\n            if (dist < 0) {\n                dist = -dist;\n            }\n\n            a = n[1] - g;\n\n            if (a < 0) {\n                a = -a;\n            }\n\n            dist += a;\n\n            a = n[2] - r;\n\n            if (a < 0) {\n                a = -a;\n            }\n\n            dist += a;\n\n            if (dist < bestd) {\n                bestd = dist;\n                bestpos = i;\n            }\n\n            biasdist = dist - ((bias[i]) >> (intbiasshift - netbiasshift));\n\n            if (biasdist < bestbiasd) {\n                bestbiasd = biasdist;\n                bestbiaspos = i;\n            }\n\n            betafreq = (freq[i] >> betashift);\n            freq[i] -= betafreq;\n            bias[i] += (betafreq << gammashift);\n\n        }\n\n        freq[bestpos] += beta;\n        bias[bestpos] -= betagamma;\n        return (bestbiaspos);\n\n    }\n\n    NeuQuantConstructor.apply(this, arguments);\n\n    var exports = {};\n    exports.map = map;\n    exports.process = process;\n\n    return exports;\n}\n\n},{}]},{},[2])'],{type:"text/javascript"})));v.push(X),W.push(X)}var S=function(){for(var e=[],t=0;t<256;t++)e[t]=String.fromCharCode(t);return function(t){for(var i=t.length,n="",a=0;a<i;a++)n+=e[t[a]];return n}}();this.setSize=function(e,t){d=e,u=t,(b=document.createElement("canvas")).width=e,b.height=t,p=b.getContext("2d")},this.setDelay=function(e){Z=.1*e},this.setRepeat=function(e){g=e},this.addFrame=function(e){null===p&&this.setSize(d,u),p.drawImage(e,0,0,d,u);var t=p.getImageData(0,0,d,u);this.addFrameImageData(t)},this.addFrameImageData=function(e){var t=(e.length,new Uint8Array(e.data));I.push({data:t,width:e.width,height:e.height,palette:m,dithering:h,done:!1,beingProcessed:!1,position:I.length})},this.onRenderProgress=function(e){f=e},this.isRendering=function(){return G},this.getBase64GIF=function(e){i((function(t){var i=S(t),n="data:image/gif;base64,"+btoa(i);e(n)}))},this.getBlobGIF=function(e){i((function(t){var i=new Uint8Array(t),n=new Blob([i],{type:"image/gif"});e(n)}))},this.destroy=function(){v.forEach((function(e){e.terminate()}))}}},{omggif:1}]},{},[2])(2)}))}},L={};function T(e){var t=L[e];if(void 0!==t)return t.exports;var i=L[e]={id:e,loaded:!1,exports:{}};return w[e](i,i.exports,T),i.loaded=!0,i.exports}T.amdO={},T.d=function(e,t){for(var i in t)T.o(t,i)&&!T.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},T.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(N){if("object"==typeof window)return window}}(),T.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},T.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var U={};!function(){T.d(U,{l:function(){return b}});var e={LivenessMode:{None:0,Passive:3},ExceptionType:{CameraError:0,ExtractorError:1,ControlNotInitializedError:2,ImageCropResizeError:3,UnexpectedCaptureError:4},TemplateFormat:{ByteArray:0,Base64:1},ImageFormat:{None:0,Gray_8bpp:1,RGB_24bpp:2,BGR_24bpp:3,ARGB_32bpp:4,YUV_NV21:5,ABGR_32bpp:6,BGRA_32bpp:7,RGBA_32bpp:8},SampleDiagnostic:{Ok:0,FaceNotFound:1,RightEyeNotFound:2,LeftEyeNotFound:3,EyesNotFound:4,FaceTooFar:5,FaceTooClose:6,TooCloseToWindowSide:7,AngleExceeded:8,QualityCheckFailed:9,NotRated:10},FinalDiagnostic:{InsufficientValidSamples:0,TemplateCreationInProgress:1,TemplateCreated:2},LivenessDiagnostic:{NotRated:0,PhotoDetected:1,LivenessDetected:2,Unsuccess:3,UnsuccessLowPerformance:4,UnsuccessGlasses:5,UnsuccessLight:6,UnsuccessNoMovement:7,UnsuccessWrongDirection:8,UnsuccessTooFar:9},RecorderType:{Local:0,Remote:1},CameraType:{Front:0,Back:1},TrackStatus:{ChangeState:0,Tap:1,FaceState:2,AccessibilityData:3,Diagnostic:4},Version:"5.16.0"},t=T(871),i=function(){function e(t,i,n,a,l,s,r){X(this,e);var c="";this.status=0,this.logDebug=!1,this.eventStatus=a,this.caller=n,this.baseURL=t,i.length>0&&(c=i+"."),this.widgetLoaded=0,this.languageCustomLoaded=0,this.languageDefaultLoaded=0,this.urlWidget=t+"widget.xml",this.urlLanguageCustom=t+"strings/strings."+c+"xml",this.resourceDict={},this.dpiList=l,this.browserDpi=s,this.scaleFactor=r;for(var o=163*s*r,d=this.dpiList.length-1,u=0;u<this.dpiList.length;u++)if(this.dpiList[u]>o){d=u;break}this.dpi=this.dpiList[d],this.imageScale=163/this.dpi,this.xmlHttpWidget=new XMLHttpRequest,this.xmlHttpWidget.rm=this,this.xmlHttpWidget.onreadystatechange=function(e){if(4==e.target.readyState&&200==e.target.status){var t=new DOMParser;e.target.rm.widgetLoaded=1,e.target.rm.xmlDoc=t.parseFromString(e.target.responseText,"text/xml")}else 4==e.target.readyState&&200!=e.target.status&&(e.target.rm.widgetLoaded=-1);e.target.rm.readyEvent(e)},this.xmlHttpWidget.open("GET",this.urlWidget),this.xmlHttpWidget.send(null),this.xmlHttpLanguageCustom=new XMLHttpRequest,this.xmlHttpLanguageCustom.rm=this,this.xmlHttpLanguageCustom.onreadystatechange=function(e){4==e.target.readyState&&200==e.target.status?e.target.rm.languageCustomLoaded=1:4==e.target.readyState&&200!=e.target.status&&(e.target.rm.languageCustomLoaded=-1),e.target.rm.readyEvent(e)},this.xmlHttpLanguageCustom.open("GET",this.urlLanguageCustom),this.xmlHttpLanguageCustom.send(null)}return C(e,[{key:"readyEvent",value:function(e){if(0!==e.target.rm.widgetLoaded&&(0!==e.target.rm.languageCustomLoaded||0!==e.target.rm.languageDefaultLoaded)){if(-1==e.target.rm.widgetLoaded)e.target.rm.status=-1;else if(1==e.target.rm.languageCustomLoaded){var t=e.target.rm.xmlHttpLanguageCustom.responseText,i=new DOMParser;e.target.rm.xmlLang=i.parseFromString(t,"text/xml"),e.target.rm.status=1}else 1==e.target.rm.languageDefaultLoaded?(t=e.target.rm.xmlHttpLanguageDefault.responseText,i=new DOMParser,e.target.rm.xmlLang=i.parseFromString(t,"text/xml"),e.target.rm.status=1):e.target.rm.status=-1;if(1==e.target.rm.status){for(var n,a={},l=e.target.rm.xmlDoc.querySelectorAll("[font]"),s=0;s<l.length;s++)(n=l[s].getAttribute("font")).length>0&&(a[n]=n);if(e.target.rm.fontRequestVector=[],null==document.getElementById("FPhi_Widget_style")){var r,c=document.createElement("style");for(r in c.id="FPhi_Widget_style",a){var o=e.target.rm.getResourceUrlBase(a[r]),d=a[r],u=new XMLHttpRequest;u.open("GET",o,!1),u.send(),200==u.status&&c.appendChild(document.createTextNode("@font-face { font-family: '"+d+"'; src: url('"+o+"'); }"))}document.head.appendChild(c)}e.target.rm.eventStatus(e.target.rm.caller,!0)}else e.target.rm.eventStatus(e.target.rm.caller,!1)}}},{key:"getElement",value:function(e,t,i){if("facephi-widget-conf"==e)return this.xmlDoc.getElementsByTagName("facephi-widget-conf")[0];var n="_portrait";i&&(n="_landscape");var a=this.xmlDoc.querySelector("[id="+e+n+"]");if(null!=a&&null!=a||(a=this.xmlDoc.querySelector("[id="+e+"]")),this.logDebug&&console.log(a),null!=a){var l=a.querySelector("[id="+t+"]");return this.logDebug&&console.log(l),null==l?void console.log("ResourceManager::getElement Error. elementId="+t+" undefined. Please verify resource's bundle."):l}console.log("ResourceManager::getElement Error. viewId="+e+" undefined. Please verify resource's bundle.")}},{key:"getElements",value:function(e,t){var i="_portrait";t&&(i="_landscape");var n=this.xmlDoc.querySelector("[id="+e+i+"]");null!=n&&null!=n||(n=this.xmlDoc.querySelector("[id="+e+"]"));var a=[];if(n)for(var l=0;l<n.childNodes.length;l++)if(n.childNodes[l].nodeType==Node.ELEMENT_NODE){var s=null;void 0!==n.childNodes[l].attributes.mode&&(s=n.childNodes[l].attributes.mode.value),a.push({type:n.childNodes[l].nodeName,id:n.childNodes[l].attributes.id.value,mode:s})}return 0==a.length&&console.log("FPhi.ResourceManager: No elements for view="+e),a}},{key:"isAttributeAvailable",value:function(e,t,i,n){var a=null;if("facephi-widget-conf"==e)a=this.xmlDoc.getElementsByTagName("facephi-widget-conf")[0];else{var l="_portrait";i&&(l="_landscape");var s=this.xmlDoc.querySelector("[id="+e+l+"]");if(null!=s&&null!=s||(s=this.xmlDoc.querySelector("[id="+e+"]")),null!=s){var r=s.querySelector("[id="+t+"]");null!=r&&(a=r)}}if(null==a||null==a)return!1;var c=a.getAttribute(n);return null!=c&&null!=c}},{key:"getSetupColor",value:function(e,t,i,n){var a=this.getElement(e,t,i);if(null==a||null==a)return null;var l,s,r,c,o=a.getAttribute(n);return null==o||null==o?null:(9==o.length&&(l=parseInt(o.substring(1,3),16),s=parseInt(o.substring(3,5),16),r=parseInt(o.substring(5,7),16),c=parseInt(o.substring(7,9),16),o="rgba("+l+", "+s+", "+r+", "+(c/=255).toFixed(3)+")"),o)}},{key:"getSetupColorWithAlpha",value:function(e,t,i,n,a){var l=this.getElement(e,t,i).getAttribute(n);return"rgba("+parseInt(l.substring(1,3),16)+", "+parseInt(l.substring(3,5),16)+", "+parseInt(l.substring(5,7),16)+", "+a.toFixed(3)+")"}},{key:"getSetupFloat",value:function(e,t,i,n){var a=this.getElement(e,t,i).getAttribute(n);return parseFloat(a)}},{key:"getSetupAlign",value:function(e,t,i,n){return this.getElement(e,t,i).getAttribute(n)}},{key:"getSetupResourceId",value:function(e,t,i,n){var a=this.getElement(e,t,i).getAttribute(n),l=a.split(",");return l&&l.length>1?l[Math.floor(Math.random()*l.length)].trim():a}},{key:"getSetupTextId",value:function(e,t,i,n){return this.getElement(e,t,i).getAttribute(n)}},{key:"getSetupNodeType",value:function(e,t,i){return this.getElement(e,t,i).getAttribute("content_type")}},{key:"getResourceUrl",value:function(e){return this.baseURL+"resources/"+this.dpi+"dpi/"+e}},{key:"getResourceUrlBase",value:function(e){return this.baseURL+"resources/"+this.dpiList[0]+"dpi/"+e}},{key:"getImageScale",value:function(){return this.imageScale}},{key:"getImage",value:function(e){if(!(e in this.resourceDict)){var t=this.getResourceUrl(e),i=document.createElement("img");i.src=t,this.resourceDict[e]=i}return this.resourceDict[e]}},{key:"translate",value:function(e){var t=e,i=this.xmlLang.querySelector("[id="+e+"]");return this.logDebug&&console.log(i),null!=i&&(t=i.textContent),t}}],[{key:"httpGet",value:function(e,t){var i=new XMLHttpRequest;return i.onreadystatechange=t,i.open("GET",e),i.send(null),200!=i.status?"":i.responseText}}]),e}();if(!n)var n={};n.SelphID=e;var a=function(e){W(i,e);var t=V(i);function i(e){var n;return X(this,i),(n=t.call(this,e)).livenessMode=e.livenessMode,n.stabilizationStage=e.stabilizationStage,n.canvasSizeFactor=e.canvasSizeFactor,n.fontSizeFactor=e.fontSizeFactor,n.buttonHeight=60*n.canvasSizeFactor,n.faceCenterOffset={x:0,y:0},n.faceCenterOffsetTarget={x:0,y:0},n}return C(i,[{key:"setCanvasSize",value:function(e,t){this.width=e,this.height=t,this.landscape=this.width>=this.height,this.circleX=this.width/2,this.circleY=.38*this.height,this.circleRadius=.31*this.height,this.circleRadius>this.width/2-15&&(this.circleRadius=this.width/2-15)}},{key:"getCameraRect",value:function(e,t,i,n){this.setCanvasSize(e.canvas.clientWidth,e.canvas.clientHeight);var a=this.scaleRect({width:t,height:i},{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius});return a.visible=!0,a}},{key:"faceInsideCircle",value:function(e){var t=this.circleRadius,i=this.circleX,n=this.circleY,a=i-t,l=i+t,s=n-t,r=n+t,c={x:e.x,y:e.y,width:e.width,height:e.height};return Math.max(0,Math.min(c.x+c.width,l)-Math.max(c.x,a))*Math.max(0,Math.min(c.y+c.height,r)-Math.max(c.y,s))/(c.width*c.height)>.75}},{key:"getResourceIdForState",value:function(e){return"UCWaitingFaceStart"==e?"StartExtractor":"UCExtracting"==e||"UCLivenessDetectionStep1"==e||"UCLivenessDetectionStep2"==e||"UCLivenessDetectionStep3"==e||"UCWaitingEyeDetection"==e?"Extractor":"UCLivenessMoveStabilizing"==e||"UCLivenessMoveStabilized"==e||"UCLivenessMoveDetecting"==e||"UCLivenessMoveProcessing"==e?"LivenessMove":"UCLivenessMoveInfo"==e?"LivenessInfo":"UCTutorialRegister1"==e?"RegistrationTips":"UCTutorialRegister2"==e?"FaceMovementTips":"UCShowResults"==e?"Results":"UCWizardCompleted"==e?"Success":"UCTutorialBlink1"==e?"Tutorial1":"UCTutorialBlink2"==e?"Tutorial2":"UCTutorialBlink3"==e?"Tutorial3":"UCTutorialMove1"==e?"TutorialMove1":"UCTutorialMove2"==e?"TutorialMove2":"UCTutorialMove3"==e?"TutorialMove3":"UCWaitRecording"==e?"WaitRecording":"UCErrors"==e||"UCErrorFinish"==e?"Error":"UCFinish"==e?"Finish":null}},{key:"onMouseMove",value:function(e,t,i,n,a){e.style.cursor="button"==a||"buttonImage"==a?"pointer":"default"}},{key:"draw",value:function(e,t,i,n,a,l,s,r,c){if(e.imageSmoothingEnabled=!0,"background"==a)this.drawBackground(e,t,i,n,l,s,r,c);else if("backgroundFull"==a)this.drawBackgroundFull(e,t,i,n,l,s,r,c);else if("button"==a)this.drawButton(e,t,i,n);else if("buttonImage"==a)this.drawButtonImage(e,t,i,n,l,s,r,c);else if("image"==a)this.drawImage(e,t,i,n,l,s,r,c);else if("imageError"==a)this.drawImageError(e,t,i,n,l,s,r,c);else if("text"==a)this.drawText(e,t,i,n,l,s,r,c);else if("faceSearcher"==a)this.drawFaceSearcher(e,t,i,n,l,s,r,c);else if("video"==a)"Extractor"==i||this.drawImageWithClippingCircle(e,t,c.player,t.x+t.width/2,t.y+t.height/2,t.width/2);else if("camera"==a){var o=c.progress,d=this.rm.getSetupFloat("facephi-widget-conf","",this.landscape,"width_progress_bar"),u=this.rm.getSetupColor("facephi-widget-conf","",this.landscape,"color_progress_bar"),h=this.rm.getSetupColor("facephi-widget-conf","",this.landscape,"color_warning_message"),m=this.rm.getSetupColor("facephi-widget-conf","",this.landscape,"color_quality_excellent"),b=this.rm.getSetupColor("facephi-widget-conf","",this.landscape,"color_quality_low"),p="solid";this.rm.isAttributeAvailable(i,n,this.landscape,"type")&&(p=this.rm.getSetupResourceId(i,n,this.landscape,"type")),e.save(),e.beginPath(),e.arc(this.circleX,this.circleY,this.circleRadius,0,2*Math.PI,!1),e.clip(),"UCLivenessMoveStabilizing"!=c.state&&"UCLivenessMoveStabilized"!=c.state&&"UCLivenessMoveDetecting"!=c.state&&"UCLivenessMoveProcessing"!=c.state||(e.fillStyle="#00000033",e.fillRect(t.x,t.y,t.width,t.height)),e.restore();var g=u;if("Warning"==r&&(g=h),"UCLivenessMoveStabilized"==c.state||"UCLivenessMoveDetecting"==c.state||"UCLivenessMoveProcessing"==c.state)o=1,g=c.liveness_move_last_result?m:b,"UCLivenessMoveDetecting"!=c.state&&"UCLivenessMoveProcessing"!=c.state||(e.beginPath(),e.strokeStyle=u,e.lineWidth=d,e.lineCap="round",e.arc(this.circleX,this.circleY,this.circleRadius-e.lineWidth/2+.5,-Math.PI/2,2*Math.PI-Math.PI/2),e.stroke());else if(o>1&&(o=1),o=o*o*(3-2*o),"solid"==p)"UCLivenessMoveStabilizing"==c.state&&(o=1),0==o&&"Warning"==r&&(e.beginPath(),e.strokeStyle=b,e.lineWidth=d,e.lineCap="round",e.arc(this.circleX,this.circleY,this.circleRadius-e.lineWidth/2+.5,-Math.PI/2,2*Math.PI-Math.PI/2),e.stroke()),e.beginPath(),e.strokeStyle=g,e.lineWidth=d,e.lineCap="round",e.arc(this.circleX,this.circleY,this.circleRadius-e.lineWidth/2+.5,-Math.PI/2,2*Math.PI*o-Math.PI/2),e.stroke();else if("bars"==p){var Z=this.rm.getSetupFloat(i,n,this.landscape,"elements"),I=this.rm.getSetupFloat(i,n,this.landscape,"area");I=2*Math.PI*this.circleRadius/Z*I;var y=2;this.rm.isAttributeAvailable(i,n,this.landscape,"offset")&&(y=this.rm.getSetupFloat(i,n,this.landscape,"offset"));var R="#939298";this.rm.isAttributeAvailable(i,n,this.landscape,"background_color")&&(R=this.rm.getSetupColor(i,n,this.landscape,"background_color")),"Warning"!=r&&0==o&&(g=R);var f=2*Math.PI*o;e.save(),e.translate(this.circleX,this.circleY);for(var v=2*Math.PI/Z,W=0;W<Z;W++)(v*W<f||0==f)&&"UCExtracting"==c.state?e.fillStyle=g:e.fillStyle=R,e.fillRect(-I/2,-this.circleRadius-y-d,I,d),e.rotate(v);e.restore()}}else if("results"==a){var G=s/(1+1.5*c.progress);G>1&&(G=1),G=(G*=2-G)<.5?2*G*G:(4-2*G)*G-1,e.beginPath(),e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"background_color"),e.arc(this.circleX,this.circleY,this.circleRadius,-Math.PI/2,2*Math.PI-Math.PI/2),e.fill();var V=this.rm.getSetupColor("facephi-widget-conf","",this.landscape,"color_quality_excellent");c.progress<=.33?V=this.rm.getSetupColor("facephi-widget-conf","",this.landscape,"color_quality_low"):c.progress<=.66&&(V=this.rm.getSetupColor("facephi-widget-conf","",this.landscape,"color_quality_good")),e.beginPath(),e.strokeStyle=V,e.lineWidth=this.rm.getSetupFloat("facephi-widget-conf","",this.landscape,"width_progress_bar"),e.lineCap="round",e.arc(this.circleX,this.circleY,this.circleRadius-e.lineWidth/2*.5,-Math.PI/2,2*Math.PI*c.progress*G-Math.PI/2),e.stroke();var X="",S="";c.progress>=1?(X=this.rm.translate("results_quality_excellent"),S=this.rm.translate("results_quality_message")):c.progress>=.333?(X=this.rm.translate("results_quality_good"),S=this.rm.translate("results_quality_message")):(X=this.rm.translate("results_quality_low"),S=this.rm.translate("results_quality_message"));var C=this.rm.getSetupFloat(i,n,this.landscape,"fontResult_size"),N=C+1,E=this.rm.getSetupResourceId(i,n,this.landscape,"fontResult"),Y="CENTER",F="TOP";this.drawStringMultiline(e,X,{x:0,y:this.circleY-5,width:this.width,height:this.height},V,E,C,N,Y,F),N=(C=this.rm.getSetupFloat(i,n,this.landscape,"fontQuality_size"))+1,E=this.rm.getSetupResourceId(i,n,this.landscape,"fontQuality"),Y="CENTER",F="TOP",this.drawStringMultiline(e,S,{x:0,y:this.circleY+5+C,width:this.width,height:this.height},V,E,C,N,Y,F)}else if("animation"==a){var k=0;"livenessMoveDirection"in c&&(k=c.livenessMoveDirection),"liveness_move"!=n&&(k=0),this.drawAnimation(e,t,i,n,l,s,r,c,k)}else if("progress"==n)e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"background_color"),e.fillRect(t.x,t.y,t.width,t.height),e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"progress_color"),e.fillRect(t.x,t.y,t.width*c.progress,t.height);else if("progressRecord"==n){e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"background_color"),e.fillRect(t.x,t.y,t.width,t.height),e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"progress_color");var x=.2*t.width,w=s%2/1.6,L=t.width*w-x,T=L+x;L<0&&(L=0),L>t.width&&(L=t.width),T>t.width&&(T=t.width),e.fillRect(t.x+L,t.y,T-L,t.height)}}},{key:"getLayout",value:function(e,t,i,n,a,l,s){if("Tutorial1"==e||"Tutorial2"==e||"Tutorial3"==e||"TutorialMove1"==e||"TutorialMove2"==e||"TutorialMove3"==e){if("background"==t)return{x:0,y:0,width:this.width,height:this.height};if("backgroundFull"==i)return{x:0,y:0,width:this.width,height:this.height};if("video"==i)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius};if("tip"==t)return{x:0,y:.75*this.height,width:this.width,height:.1*this.height};if("tip_detail"==t)return{x:0,y:.82*this.height,width:this.width,height:.1*this.height};if("button_skip"==t)return{x:0,y:this.height-this.buttonHeight,width:this.width/2,height:this.buttonHeight};if("button_back"==t)return{x:0,y:this.height-this.buttonHeight,width:this.width/2,height:this.buttonHeight};if("button_next"==t)return{x:this.width/2,y:this.height-this.buttonHeight,width:this.width/2,height:this.buttonHeight};if("button_done"==t)return{x:this.width/2,y:this.height-this.buttonHeight,width:this.width/2,height:this.buttonHeight};if("button_exit"==t){var r=this.rm.getSetupResourceId(e,t,this.landscape,"value"),c=this.rm.getImage(r),o=this.canvasSizeFactor*this.rm.getImageScale(),d=c.width*o,u=c.height*o;return{x:this.width-d-30,y:0,width:d+30,height:u+30}}if("liveness_move"==t)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius}}else{if("background"==t)return{x:0,y:0,width:this.width,height:this.height};if("backgroundFull"==i)return{x:0,y:0,width:this.width,height:this.height};if("tip_video"==t)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius};if("imageError"==t)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius};if("video_success"==t)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius};if("extraction_video"==t)return{x:this.width/2-.1*this.width,y:.73*this.height,width:.2*this.width,height:.2*this.width};if("tip"==t)return{x:0,y:.75*this.height,width:this.width,height:.1*this.height};if("text_error"==t)return{x:0,y:.75*this.height,width:this.width,height:.1*this.height};if("text"==t)return{x:0,y:this.circleY+this.circleRadius+10,width:this.width,height:this.height-this.buttonHeight+10-(this.circleY+this.circleRadius)};if("tip_detail"==t)return{x:0,y:.82*this.height,width:this.width,height:.1*this.height};if("button_skip"==t)return{x:0,y:this.height-this.buttonHeight,width:this.width/2,height:this.buttonHeight};if("button_next"==t)return{x:this.width/2,y:this.height-this.buttonHeight,width:this.width/2,height:this.buttonHeight};if("button_done"==t)return{x:this.width/2,y:this.height-this.buttonHeight,width:this.width/2,height:this.buttonHeight};if("button_start"==t){var h=209*this.canvasSizeFactor;return{x:this.width/2-h/2,y:this.height-this.buttonHeight+10,width:h,height:this.buttonHeight-10}}if("button_error"==t)return{x:this.width/4,y:this.height-this.buttonHeight+10,width:this.width/2,height:this.buttonHeight-10};if("button_back"==t)return{x:0,y:this.height-this.buttonHeight,width:this.width/2,height:this.buttonHeight};if("button_repeat"==t)return{x:.05*this.width,y:this.height-this.buttonHeight,width:.4*this.width,height:this.buttonHeight};if("button_finish"==t)return{x:.55*this.width,y:this.height-this.buttonHeight,width:.4*this.width,height:this.buttonHeight};if("button_exit"==t)return r=this.rm.getSetupResourceId(e,t,this.landscape,"value"),c=this.rm.getImage(r),o=this.canvasSizeFactor*this.rm.getImageScale(),d=c.width*o,u=c.height*o,{x:this.width-d-30,y:0,width:d+30,height:u+30};if("button_info"==t);else{if("warning"==t)return{x:0,y:this.circleY+this.circleRadius+10,width:this.width,height:this.height-this.buttonHeight+10-(this.circleY+this.circleRadius)};if("warningTooFar"==t)return{x:0,y:.89*this.height,width:this.width,height:.1*this.height};if("camera"==i)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius};if("results"==i)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius};if("liveness_move_text"==t)return"UCLivenessMoveProcessing"==s.state&&a<.5?null:{x:0,y:this.circleY+this.circleRadius+10,width:this.width,height:this.height-this.buttonHeight+10-(this.circleY+this.circleRadius)};if("liveness_move_tip_text"==t)return{x:this.circleX-this.circleRadius,y:this.circleY-.39*this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius};if("livenessInfo_text"==t)return{x:0,y:.89*this.height,width:this.width,height:.1*this.height};if("liveness_move"==t){if("UCLivenessMoveDetecting"==s.state&&a>=.25&&a<1.75){var m=!1;return this.rm.isAttributeAvailable(e,t,this.landscape,"fullscreen")&&"true"==this.rm.getSetupResourceId(e,t,this.landscape,"fullscreen")&&(m=!0),m?{x:0,y:0,width:this.width,height:this.height}:{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius}}return null}if("liveness_move_left"==t||"liveness_move_right"==t||"liveness_move_top"==t||"liveness_move_bottom"==t)return"UCLivenessMoveDetecting"==s.state&&a>=.25&&a<1.75?0==s.livenessMoveDirection&&"liveness_move_top"!=t||2==s.livenessMoveDirection&&"liveness_move_bottom"!=t||1==s.livenessMoveDirection&&"liveness_move_right"!=t||3==s.livenessMoveDirection&&"liveness_move_left"!=t?null:(m=!1,this.rm.isAttributeAvailable(e,t,this.landscape,"fullscreen")&&"true"==this.rm.getSetupResourceId(e,t,this.landscape,"fullscreen")&&(m=!0),m?{x:0,y:0,width:this.width,height:this.height}:{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius}):null;if("face_searcher"==t)return{x:0,y:0,width:this.width,height:this.height};if("livenessMoveGlasses"==t){if(0==s.livenessMoveFailReason)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius}}else if("livenessMoveInfo"==t){if(1==s.livenessMoveFailReason)return{x:this.circleX-this.circleRadius,y:this.circleY-this.circleRadius,width:2*this.circleRadius,height:2*this.circleRadius}}else if("progress"==t){if("UCLivenessMoveProcessing"==s.state&&a>this.processingMoveProgressStartTime)return{x:this.circleX-this.circleRadius,y:.8*this.height,width:2*this.circleRadius,height:19}}else if("progressRecord"==t)return{x:.146*this.width,y:.52*this.height,width:.7*this.width,height:18}}}return null}},{key:"drawBackground",value:function(e,t,i,n,a,l,s,r){e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"top"),e.fillRect(t.x,t.y,t.width,this.circleY-this.circleRadius+1),"true"==this.rm.getSetupResourceId(i,n,this.landscape,"clipped").toLowerCase()&&(e.save(),e.beginPath(),e.arc(this.circleX,this.circleY,this.circleRadius,0,2*Math.PI,!1),e.rect(0,0,this.width,this.height),e.clip("evenodd")),e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"middle_top"),e.fillRect(t.x,this.circleY-this.circleRadius,t.width,2*this.circleRadius+1),"true"==this.rm.getSetupResourceId(i,n,this.landscape,"clipped").toLowerCase()&&e.restore(),e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"middle_bottom"),e.fillRect(t.x,this.circleY+this.circleRadius,t.width,this.height-this.buttonHeight-(this.circleY+this.circleRadius)+1),e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"bottom"),e.fillRect(t.x,this.height-this.buttonHeight,t.width,this.buttonHeight);var c=this.rm.getSetupColor(i,n,this.landscape,"pagination_separator");null!=c&&(e.fillStyle=c,e.fillRect(0,this.height-this.buttonHeight-1,t.width,1))}},{key:"drawBackgroundFull",value:function(e,t,i,n,a,l,s,r){"true"==this.rm.getSetupResourceId(i,n,this.landscape,"clipped").toLowerCase()&&(e.save(),e.beginPath(),e.arc(this.circleX,this.circleY,this.circleRadius,0,2*Math.PI,!1),e.rect(0,0,this.width,this.height),e.clip("evenodd")),e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"color"),e.fillRect(t.x,t.y,t.width,t.height),"true"==this.rm.getSetupResourceId(i,n,this.landscape,"clipped").toLowerCase()&&e.restore()}},{key:"drawPoint",value:function(e,t,i,n,a){e.fillStyle=a,e.beginPath(),e.arc(t,i,n,0,2*Math.PI),e.fill()}},{key:"drawLine",value:function(e,t,i,n,a,l){e.lineWidth=1,e.strokeStyle=l,e.beginPath(),e.moveTo(t,i),e.lineTo(n,a),e.stroke()}},{key:"drawFaceSearcher",value:function(e,t,i,n,a,l,s,r){r.progress;var c=r.leftEyeData,o=r.rightEyeData,d=r.faceDataRect;d&&(this.lastMoveFace=d,null==this.moveFace&&(this.moveFace=this.lastMoveFace)),c&&(this.lastMoveLeftEye=c,null==this.moveLeftEye&&(this.moveLeftEye=this.lastMoveLeftEye)),o&&(this.lastMoveRightEye=o,null==this.moveRightEye&&(this.moveRightEye=this.lastMoveRightEye)),this.moveFace&&(this.moveFace.x+=.1*(this.lastMoveFace.x-this.moveFace.x),this.moveFace.y+=.1*(this.lastMoveFace.y-this.moveFace.y),this.moveFace.width+=.1*(this.lastMoveFace.width-this.moveFace.width),this.moveFace.height+=.1*(this.lastMoveFace.height-this.moveFace.height)),this.moveLeftEye&&(this.moveLeftEye.x+=.15*(this.lastMoveLeftEye.x-this.moveLeftEye.x),this.moveLeftEye.y+=.15*(this.lastMoveLeftEye.y-this.moveLeftEye.y),this.drawPoint(e,this.moveLeftEye.x-.05*this.width,this.moveLeftEye.y,2,"#ffffff"),this.drawPoint(e,this.moveLeftEye.x+.04*this.width,this.moveLeftEye.y,2,"#ffffff"),this.drawPoint(e,this.moveLeftEye.x-.02*this.width,this.moveLeftEye.y-.05*this.height,2,"#ffffff"),this.drawLine(e,this.moveLeftEye.x-.05*this.width,this.moveLeftEye.y,this.moveLeftEye.x+.04*this.width,this.moveLeftEye.y,"#ffffff"),this.drawLine(e,this.moveLeftEye.x-.05*this.width,this.moveLeftEye.y,this.moveLeftEye.x-.02*this.width,this.moveLeftEye.y-.05*this.height,"#ffffff"),this.drawLine(e,this.moveLeftEye.x+.04*this.width,this.moveLeftEye.y,this.moveLeftEye.x-.02*this.width,this.moveLeftEye.y-.05*this.height,"#ffffff"),this.moveFace&&(this.drawLine(e,this.moveLeftEye.x+.04*this.width,this.moveLeftEye.y,this.moveFace.x+this.moveFace.width/2,this.moveFace.y+this.moveFace.height/2+.05*this.moveFace.height,"#ffffff"),this.drawLine(e,this.moveLeftEye.x-.05*this.width,this.moveLeftEye.y,this.moveFace.x+this.moveFace.width/2,this.moveFace.y+this.moveFace.height/2+.05*this.moveFace.height,"#ffffff"),this.drawLine(e,this.moveFace.x+this.moveFace.width/2,this.moveFace.y+this.moveFace.height/2+.05*this.moveFace.height,this.moveFace.x+this.moveFace.width/2-.15*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.02*this.moveFace.height,"#ffffff"),this.drawLine(e,this.moveFace.x+this.moveFace.width/2-.15*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.02*this.moveFace.height,this.moveFace.x+this.moveFace.width/2-.35*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.3*this.moveFace.height,"#ffffff"),this.drawLine(e,this.moveFace.x+this.moveFace.width/2,this.moveFace.y+this.moveFace.height/2+.05*this.moveFace.height,this.moveFace.x+this.moveFace.width/2-.2*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.25*this.moveFace.height,"#ffffff"),this.drawLine(e,this.moveFace.x+this.moveFace.width/2-.2*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.25*this.moveFace.height,this.moveFace.x+this.moveFace.width/2,this.moveFace.y+this.moveFace.height/2+.5*this.moveFace.height,"#ffffff"),this.drawLine(e,this.moveFace.x+this.moveFace.width/2-.2*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.25*this.moveFace.height,this.moveFace.x+this.moveFace.width/2-.35*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.3*this.moveFace.height,"#ffffff"),this.drawLine(e,this.moveFace.x+this.moveFace.width/2-.35*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.3*this.moveFace.height,this.moveFace.x+this.moveFace.width/2,this.moveFace.y+this.moveFace.height/2+.5*this.moveFace.height,"#ffffff"))),this.moveRightEye&&(this.moveRightEye.x+=.15*(this.lastMoveRightEye.x-this.moveRightEye.x),this.moveRightEye.y+=.15*(this.lastMoveRightEye.y-this.moveRightEye.y),this.drawPoint(e,this.moveRightEye.x+.05*this.width,this.moveRightEye.y,2,"#ffffff"),this.drawPoint(e,this.moveRightEye.x-.04*this.width,this.moveRightEye.y,2,"#ffffff"),this.drawPoint(e,this.moveRightEye.x+.02*this.width,this.moveRightEye.y-.05*this.height,2,"#ffffff"),this.drawLine(e,this.moveRightEye.x+.05*this.width,this.moveRightEye.y,this.moveRightEye.x-.04*this.width,this.moveRightEye.y,"#ffffff"),this.drawLine(e,this.moveRightEye.x+.05*this.width,this.moveRightEye.y,this.moveRightEye.x+.02*this.width,this.moveRightEye.y-.05*this.height,"#ffffff"),this.drawLine(e,this.moveRightEye.x-.04*this.width,this.moveRightEye.y,this.moveRightEye.x+.02*this.width,this.moveRightEye.y-.05*this.height,"#ffffff"),this.moveFace&&(this.drawLine(e,this.moveRightEye.x-.04*this.width,this.moveRightEye.y,this.moveFace.x+this.moveFace.width/2,this.moveFace.y+this.moveFace.height/2+.05*this.moveFace.height,"#ffffff"),this.drawLine(e,this.moveRightEye.x+.05*this.width,this.moveRightEye.y,this.moveFace.x+this.moveFace.width/2,this.moveFace.y+this.moveFace.height/2+.05*this.moveFace.height,"#ffffff"),this.drawLine(e,this.moveFace.x+this.moveFace.width/2,this.moveFace.y+this.moveFace.height/2+.05*this.moveFace.height,this.moveFace.x+this.moveFace.width/2+.15*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.02*this.moveFace.height,"#ffffff"),this.drawLine(e,this.moveFace.x+this.moveFace.width/2+.15*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.02*this.moveFace.height,this.moveFace.x+this.moveFace.width/2+.35*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.3*this.moveFace.height,"#ffffff"),this.drawLine(e,this.moveFace.x+this.moveFace.width/2,this.moveFace.y+this.moveFace.height/2+.05*this.moveFace.height,this.moveFace.x+this.moveFace.width/2+.2*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.25*this.moveFace.height,"#ffffff"),this.drawLine(e,this.moveFace.x+this.moveFace.width/2+.2*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.25*this.moveFace.height,this.moveFace.x+this.moveFace.width/2,this.moveFace.y+this.moveFace.height/2+.5*this.moveFace.height,"#ffffff"),this.drawLine(e,this.moveFace.x+this.moveFace.width/2+.2*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.25*this.moveFace.height,this.moveFace.x+this.moveFace.width/2+.35*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.3*this.moveFace.height,"#ffffff"),this.drawLine(e,this.moveFace.x+this.moveFace.width/2+.35*this.moveFace.width,this.moveFace.y+this.moveFace.height/2+.3*this.moveFace.height,this.moveFace.x+this.moveFace.width/2,this.moveFace.y+this.moveFace.height/2+.5*this.moveFace.height,"#ffffff")))}},{key:"drawImageError",value:function(e,t,i,a,l,s,r,c){var o=this.rm.getImage("livenessError.png");switch(c.livenessDiagnostic){case-1:o=this.rm.getImage("timeout.png");break;case n.Selphi.LivenessDiagnostic.UnsuccessLowPerformance:o=this.rm.getImage("livenessPerformance.png");break;case n.Selphi.LivenessDiagnostic.UnsuccessGlasses:o=this.rm.getImage("livenessGlasses.png");break;case n.Selphi.LivenessDiagnostic.UnsuccessLight:o=this.rm.getImage("livenessLights.png")}this.canvasSizeFactor,this.rm.getImageScale(),o.width,o.height;var d=this.scaleRect({width:o.width,height:o.height},t);e.drawImage(o,d.x,d.y,d.width,d.height)}},{key:"drawAnimation",value:function(e,t,i,n,a,l,s,r,c){var o=l;switch((o/=2)>1&&(o=1),"videoProgress"in r&&(o=r.videoProgress),e.save(),e.translate(t.x+t.width/2,t.y+t.height/2),c){case 1:e.rotate(3*-Math.PI/2);break;case 2:e.rotate(Math.PI);break;case 3:e.rotate(1*-Math.PI/2)}e.translate(-(t.x+t.width/2),-(t.y+t.height/2));var d=this.rm.getSetupResourceId(i,n,this.landscape,"name"),u=this.rm.getSetupResourceId(i,n,this.landscape,"ext"),h=parseInt(this.rm.getSetupResourceId(i,n,this.landscape,"start")),m=parseInt(this.rm.getSetupResourceId(i,n,this.landscape,"end")),b=d+("0"+Math.floor((m-h)*o+h)).slice(-2)+"."+u,p=this.rm.getImage(b);e.drawImage(p,t.x,t.y,t.width,t.height),e.restore()}},{key:"drawText",value:function(e,t,i,a,l,s,r,c){var o=this.rm.getSetupFloat(i,a,this.landscape,"font_size"),d=o+1;this.rm.isAttributeAvailable(i,a,this.landscape,"line_height")&&(d=this.rm.getSetupFloat(i,a,this.landscape,"line_height"));var u=this.rm.getSetupColor(i,a,this.landscape,"color"),h=this.rm.getSetupResourceId(i,a,this.landscape,"font"),m="CENTER";this.rm.isAttributeAvailable(i,a,this.landscape,"align")&&(m=this.rm.getSetupAlign(i,a,this.landscape,"align"));var b="TOP";this.rm.isAttributeAvailable(i,a,this.landscape,"valign")&&(b=this.rm.getSetupAlign(i,a,this.landscape,"valign"));var p="";if("Tutorial1"==i)p="tip"==a?this.rm.translate("tutorial1_tip"):this.rm.translate("tutorial1_tip_detail");else if("Tutorial2"==i)p="tip"==a?this.rm.translate("tutorial2_tip"):this.rm.translate("tutorial2_tip_detail");else if("Tutorial3"==i)p="tip"==a?this.rm.translate("tutorial3_tip"):this.rm.translate("tutorial3_tip_detail");else if("TutorialMove1"==i)p="tip"==a?this.rm.translate("tutorialMove1_tip"):this.rm.translate("tutorialMove1_tip_detail");else if("TutorialMove2"==i)p="tip"==a?this.rm.translate("tutorialMove2_tip"):this.rm.translate("tutorialMove2_tip_detail");else if("TutorialMove3"==i)p="tip"==a?this.rm.translate("tutorialMove3_tip"):this.rm.translate("tutorialMove3_tip_detail");else if("RegistrationTips"==i)p="tip"==a?this.rm.translate("registration_tips_title"):this.rm.translate("registration_tips_detail");else if("FaceMovementTips"==i)p="tip"==a?this.rm.translate("face_movement_tips_title"):this.rm.translate("face_movement_tips_detail");else if("WaitRecording"==i)p=this.rm.translate("waitRecording");else if("StartExtractor"==i)"text"==a&&(p=this.rm.translate("start_extractor_title"));else if("Extractor"==i)"warning"==a&&(p=this.rm.translate("error_message_face"));else if("LivenessMove"==i){if("liveness_move_text"==a)if("UCLivenessMoveStabilizing"==c.state||"UCLivenessMoveStabilized"==c.state)p=this.rm.translate("extracting_title");else if("UCLivenessMoveDetecting"==c.state)switch(c.livenessMoveDirection){case 0:p=this.rm.translate("liveness_move_tip_up");break;case 1:p=this.rm.translate("liveness_move_tip_right");break;case 2:p=this.rm.translate("liveness_move_tip_down");break;case 3:p=this.rm.translate("liveness_move_tip_left")}else"UCLivenessMoveProcessing"==c.state&&(p=this.rm.translate("liveness_move_processing"));else if("warning"==a&&("UCLivenessMoveStabilizing"==c.state||"UCLivenessMoveStabilized"==c.state))switch(c.livenessMoveLastStabilizedStatus){case 1:p=this.rm.translate("liveness_move_stabilizing_ok");break;case 2:p=this.rm.translate("liveness_move_stabilizing_not_stabilized");break;case 3:p=this.rm.translate("liveness_move_stabilizing_not_stabilized_too_far");break;case 4:p=this.rm.translate("liveness_move_stabilizing_not_stabilized_sun_glasses");break;case 5:p=this.rm.translate("liveness_move_stabilizing_not_stabilized_too_close");break;case 6:p=this.rm.translate("liveness_move_stabilizing_not_stabilized_too_movement");break;case 7:p=this.rm.translate("liveness_move_stabilizing_not_stabilized_low_performance");break;case 8:p=this.rm.translate("liveness_move_stabilizing_not_stabilized_no_frontal");break;case 9:p=this.rm.translate("liveness_move_stabilizing_not_stabilized_no_frontal_too_left");break;case 10:p=this.rm.translate("liveness_move_stabilizing_not_stabilized_no_frontal_too_right");break;case 11:p=this.rm.translate("liveness_move_stabilizing_not_stabilized_no_frontal_too_down");break;case 12:p=this.rm.translate("liveness_move_stabilizing_not_stabilized_no_frontal_too_up");break;case 13:p=this.rm.translate("liveness_move_stabilizing_not_stabilized_no_color");break;case 14:p=this.rm.translate("liveness_move_stabilizing_not_stabilized_low_quality");break;case 15:p=this.rm.translate("liveness_move_stabilizing_not_stabilized_low_face_quality");break;case 16:p=this.rm.translate("liveness_move_stabilizing_not_stabilized_low_pattern_quality");break;case 17:p=this.rm.translate("liveness_move_stabilizing_ok_glasses");break;default:p=this.rm.translate("extracting_title")}}else if("LivenessInfo"==i)"livenessInfo_text"==a&&(p=0==c.livenessMoveFailReason?this.rm.translate("liveness_move_info_sunglasses"):this.rm.translate("liveness_move_info_unsuccess"));else if("Results"==i){if("tip"==a){if(s<1)u="#00000000";else if(s>=1){var g=2*(s-1);g>1&&(g=1),u=this.rm.getSetupColorWithAlpha(i,a,this.landscape,"color",g)}p=c.progress>=1?this.rm.translate("results_message_excellent"):c.progress>=.333?this.rm.translate("results_message_good"):this.rm.translate("results_message_low")}}else if("Error"==i&&"text_error"==a)switch(c.livenessDiagnostic){case-1:p=this.rm.translate("timeout");break;case n.Selphi.LivenessDiagnostic.UnsuccessLowPerformance:p=this.rm.translate("livenessErrorPerformance");break;case n.Selphi.LivenessDiagnostic.UnsuccessGlasses:p=this.rm.translate("livenessErrorGlasses");break;case n.Selphi.LivenessDiagnostic.UnsuccessLight:p=this.rm.translate("livenessErrorDark");break;case n.Selphi.LivenessDiagnostic.UnsuccessNoMovement:p=this.rm.translate("livenessErrorNoMovement");break;case n.Selphi.LivenessDiagnostic.UnsuccessWrongDirection:p=this.rm.translate("livenessErrorWrongDirection");break;case n.Selphi.LivenessDiagnostic.UnsuccessTooFar:p=this.rm.translate("livenessErrorTooFar");break;default:p=this.rm.translate("livenessMoveError")}this.drawStringMultiline(e,p,t,u,h,o,d,m,b)}},{key:"drawBlind",value:function(e,t,i,n,a,l,s,r){var c=(a-i)/n*.5+.5,o=2*n*c,d=2*n*(1-c);e.save(),e.beginPath(),e.arc(t,i,n,0,2*Math.PI,!1),e.clip(),e.fillStyle=s,e.fillRect(t-n,i-n,2*n,o*l),e.fillRect(t-n,i+n-d+d*(1-l),2*n,d*l),e.restore();var u=this.rm.getSetupResourceId("facephi-widget-conf","",this.landscape,"font_shutter_text");e.fillStyle=this.rm.getSetupColor("facephi-widget-conf","",this.landscape,"color_shutter_text"),e.font=26*this.fontSizeFactor+"px '"+u+"'";var h=e.measureText(r);e.fillText(r,t-h.width/2,i+n-d+d*(1-l)+30)}}]),i}(function(){function e(t){X(this,e),this.width=0,this.height=0,this.landscape=!1}return C(e,[{key:"cacheResources",value:function(){}},{key:"setCanvasSize",value:function(e,t){this.width=e,this.height=t,this.landscape=this.width>=this.height}},{key:"getCameraRect",value:function(e,t,i,n){this.setCanvasSize(e.canvas.clientWidth,e.canvas.clientHeight);var a=this.scaleRect({width:t,height:i},{x:0,y:0,width:this.width,height:this.height});return a.visible=!0,a}},{key:"getResourceIdForState",value:function(e){throw new Error("FPhi.Widget.drawer.abstract.js: Can't instantiate abstract class")}},{key:"onMouseMove",value:function(e,t,i,n,a){e.style.cursor="button"==a||"buttonImage"==a?"pointer":"default"}},{key:"draw",value:function(e,t,i,n,a,l,s,r,c){throw new Error("Can't instantiate abstract class")}},{key:"getLayout",value:function(e,t,i,n,a,l,s){throw new Error("Can't instantiate abstract class")}},{key:"cacheAnimation",value:function(e,t){if(this.rm.isAttributeAvailable(e,t,this.landscape,"id"))for(var i=this.rm.getSetupResourceId(e,t,this.landscape,"name"),n=this.rm.getSetupResourceId(e,t,this.landscape,"ext"),a=parseInt(this.rm.getSetupResourceId(e,t,this.landscape,"start")),l=parseInt(this.rm.getSetupResourceId(e,t,this.landscape,"end")),s=a;s<=l;s++){var r=i+("0"+s).slice(-2)+"."+n;this.rm.getImage(r)}}},{key:"scaleRect",value:function(e,t,i){var n=t.x+t.width/2,a=t.y+t.height/2,l=t.width/e.width,s=t.height/e.height,r=e.width*l,c=e.height*l;return null==i?c<t.height&&(r=e.width*s,c=e.height*s):c>=t.height&&(r=e.width*s,c=e.height*s),{x:n-r/2,y:a-c/2,width:r,height:c}}},{key:"drawButtonImage",value:function(e,t,i,n,a,l,s,r){var c=this.rm.getSetupResourceId(i,n,this.landscape,"value"),o=this.rm.getImage(c),d=this.canvasSizeFactor*this.rm.getImageScale(),u=o.width*d,h=o.height*d;e.drawImage(o,t.x+t.width/2-u/2,t.y+t.height/2-h/2,u,h)}},{key:"fillRoundRect",value:function(e,t,i,n,a,l){n<2*l&&(l=n/2),a<2*l&&(l=a/2),e.beginPath(),e.moveTo(t+l,i),e.arcTo(t+n,i,t+n,i+a,l),e.arcTo(t+n,i+a,t,i+a,l),e.arcTo(t,i+a,t,i,l),e.arcTo(t,i,t+n,i,l),e.closePath(),e.fill()}},{key:"drawButton",value:function(e,t,i,n){if(this.rm.isAttributeAvailable(i,n,this.landscape,"radius")){var a=this.rm.getSetupFloat(i,n,this.landscape,"radius");e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"decorator"),this.fillRoundRect(e,t.x,t.y+4,t.width,t.height-4,a),e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"background"),this.fillRoundRect(e,t.x,t.y,t.width,t.height-4,a)}else e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"decorator"),e.fillRect(t.x,t.y+4,t.width,t.height-4),e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"background"),e.fillRect(t.x,t.y,t.width,t.height-4);var l=this.rm.getSetupAlign(i,n,this.landscape,"align"),s=this.rm.getSetupNodeType(i,n),r=10*this.canvasSizeFactor;if("TEXT_ID"==s){var c=this.rm.getSetupTextId(i,n,this.landscape,"content"),o=this.rm.translate(c),d=this.rm.getSetupFloat(i,n,this.landscape,"font_size");d=Math.round(d*this.fontSizeFactor);var u=this.rm.getSetupResourceId(i,n,this.landscape,"font");e.font=d+"px '"+u+"'",e.fillStyle=this.rm.getSetupColor(i,n,this.landscape,"foreground");var h=e.measureText(o);"LEFT"==l?e.fillText(o,t.x+r,t.y+t.height/2):"RIGHT"==l?e.fillText(o,t.x+t.width-h.width-r,t.y+t.height/2):e.fillText(o,t.x+t.width/2-h.width/2,t.y+t.height/2)}else{c=this.rm.getSetupResourceId(i,n,this.landscape,"content");var m=this.rm.getImage(c),b=this.canvasSizeFactor*this.rm.getImageScale();"LEFT"==l?e.drawImage(m,t.x+r,t.y+t.height/2-m.height*b/2,m.width*b,m.height*b):"RIGHT"==l?e.drawImage(m,t.x+t.width-m.width*b-r,t.y+t.height/2-m.height*b/2,m.width*b,m.height*b):e.drawImage(m,t.x+t.width/2-m.width*b/2,t.y+t.height/2-m.height*b/2,m.width*b,m.height*b)}}},{key:"drawImage",value:function(e,t,i,n,a,l,s,r){var c=this.rm.getSetupResourceId(i,n,this.landscape,"value"),o=this.rm.getImage(c),d=!1;if(this.rm.isAttributeAvailable(i,n,this.landscape,"scale")&&"CONTAINER"==this.rm.getSetupResourceId(i,n,this.landscape,"scale")&&(d=!0),d)e.drawImage(o,t.x,t.y,t.width,t.height);else{var u=this.canvasSizeFactor*this.rm.getImageScale(),h=o.width*u,m=o.height*u;e.drawImage(o,t.x+t.width/2-h/2,t.y+t.height/2-m/2,h,m)}}},{key:"drawImageWithClippingCircle",value:function(e,t,i,n,a,l){e.save(),e.beginPath(),e.arc(n,a,l,0,2*Math.PI,!1),e.clip(),e.drawImage(i,t.x,t.y,t.width,t.height),e.restore()}},{key:"drawStringMultiline",value:function(e,t,i,n,a,l,s,r,c){var o=t.split("\n");e.imageSmoothingEnabled=!1,l=Math.round(l*this.fontSizeFactor),e.font=l+"px '"+a+"'",e.fillStyle=n,e.textBaseline="middle";var d=i.y;if("CENTER"==c){var u=o.length*s;d=i.y+i.height/2-u/2+l/2}else"BOTTOM"==c&&(u=o.length*s,d=i.y+i.height-u);for(var h=0;h<o.length;h++){var m=e.measureText(o[h]),b=i.width/2-m.width/2;"LEFT"==r?b=0:"RIGHT"==r&&(b=i.width-m.width),e.fillText(o[h],i.x+b,d+h*s)}}}]),e}()),l=function(){function e(t,i,n,a){X(this,e),this.width=t,this.height=i,this.rate=n,this.rateInv=1/this.rate,this.lastFrame=performance.now()}return C(e,[{key:"frameReady",value:function(){var e=performance.now();return(e-this.lastFrame)/1e3>this.rateInv&&(this.lastFrame=e,!0)}},{key:"addFrame",value:function(e){throw new Error("Method addFrame must be implemented.")}},{key:"generateVideo",value:function(){throw new Error("Method generateVideo must be implemented.")}},{key:"isReady",value:function(){throw new Error("Method isReady must be implemented")}}]),e}(),s=function(e){W(i,e);var t=V(i);function i(e,n,a,l){var s;return X(this,i),(s=t.call(this,e,n,a,l)).ag=new Animated_GIF,s.ag.setSize(e,n),s.ag.setDelay(s.rateInv),s.processing=!1,s}return C(i,[{key:"addFrame",value:function(e){this.frameReady()&&this.ag.addFrameImageData(e)}},{key:"generateVideo",value:function(){this.processing=!0;var e=this;return new Promise((function(t,i){e.ag.getBase64GIF((function(e){t(e)}))}))}},{key:"isReady",value:function(){return!this.processing}}]),i}(l),r=null,c=function(e){W(i,e);var t=V(i);function i(e,n,a,l){var s;return X(this,i),(s=t.call(this,e,n,a)).processing=!1,s.ready=!1,s.socketError=!1,s.worker=new Worker((null===r&&(r=URL.createObjectURL(new Blob([atob("c2VsZi53c1JlYWR5PSExLHNlbGYud3M9bmV3IFdlYlNvY2tldCgid3NzOi8vd3MtZGV2LmlkY2FwdHVyZS5lcyIpLHNlbGYud3Mub25vcGVuPWZ1bmN0aW9uKCl7cG9zdE1lc3NhZ2Uoe2NtZDoicmVhZHkifSl9LHNlbGYud3Mub25tZXNzYWdlPWZ1bmN0aW9uKGUpe3Bvc3RNZXNzYWdlKHtjbWQ6Im1lc3NhZ2UiLGRhdGE6ZS5kYXRhfSl9LHNlbGYud3Mub25lcnJvcj1mdW5jdGlvbihlKXtjb25zb2xlLmxvZyhlKSxwb3N0TWVzc2FnZSh7Y21kOiJ3c19vbmVycm9yIn0pfSxzZWxmLm9ubWVzc2FnZT1mdW5jdGlvbihlKXtpZigiYWRkRnJhbWUiPT1lLmRhdGEuY21kKXNlbGYud3Muc2VuZCgneyJ0eXBlIjoiVklERU9fRlJBTUUiLCJkYXRhVVJMIjoiJytlLmRhdGEuZGF0YSsnIn0nKTtlbHNlIGlmKCJnZW5lcmF0ZVZpZGVvIj09ZS5kYXRhLmNtZCl7bGV0IHM9J3sidHlwZSI6Ik1BS0VfVklERU8iLCJGUiI6JytlLmRhdGEuZnIrIn0iO3NlbGYud3Muc2VuZChzKX1lbHNlIHBvc3RNZXNzYWdlKHtjbWQ6InVua25vd25NZXNzYWdlIn0pfTs=")],{type:"text/javascript"}))),r)),s.worker.onmessage=s.onMessage.bind(v(s)),s.canvas=document.createElement("canvas"),s.canvas.width=e,s.canvas.height=n,s.promise=null,s.resolve=null,s.reject=null,s}return C(i,[{key:"onMessage",value:function(e){if("ready"==e.data.cmd)this.ready=!0;else if("message"==e.data.cmd){var t=JSON.parse(e.data.data);"SAVED_FRAME"==t.type?this.ready=!0:this.resolve(t.video)}else"ws_onerror"==e.data.cmd&&(this.socketError=!0)}},{key:"addFrame",value:function(e){if(this.frameReady()){this.canvas.getContext("2d").putImageData(e,0,0);var t=this.canvas.toDataURL("image/jpeg");this.worker.postMessage({cmd:"addFrame",data:t})}}},{key:"generateVideo",value:function(){console.log("generateVideo"),this.processing=!0;var e=this;return this.promise=new Promise((function(t,i){e.resolve=t,e.reject=i,e.socketError?e.reject():e.worker.postMessage({cmd:"generateVideo",fr:e.rate})})),this.promise}},{key:"isReady",value:function(){return!this.processing&&!!this.ready}}]),i}(l);if(!o)var o={};o.Selphi=e;var d=function(e){W(n,e);var i=V(n);function n(){var e;return X(this,n),(e=i.call(this)).__widgetContainer=e.attachShadow({mode:"closed"}),e.__widgetStyles=document.createElement("style"),e.__widgetStyles.innerText="\n            :host { display: block; position: relative; margin: 0; padding: 0; width: 100%; height: 100%; min-height: 300px; min-width: 300px }\n            #accessibilityContainer { position: absolute; z-index: 999; width: 100%; height: 100% }\n            #cameraContainer { width: 100%; height: 100%; min-height: 300px; min-width: 300px }\n        ",e.__widgetContainer.append(e.__widgetStyles),e.__config=new o.Selphi.ConfigurationManager,e.__config.setContainer(e.__widgetContainer),e.__elementMounted=!1,e.__accessibilityHasEnabled=!1,e}return C(n,[{key:"connectedCallback",value:function(){var e=this;queueMicrotask((function(){e.__createUserControl(e.__config).__startUserControl().then((function(){return e.__elementMounted=!0}))}))}},{key:"disconnectedCallback",value:function(){var e=this;queueMicrotask((function(){e.__stopUserControl().then((function(){return e.__elementMounted=!1}))}))}},{key:"attributeChangedCallback",value:function(e,t,i){this.__setNativeConfiguration(e,i)&&(this.disconnectedCallback(),this.connectedCallback())}},{key:"addWidgetEventListener",value:function(e,t){this.addEventListener(e,t,!0)}},{key:"addEventListener",value:function(e,t,i){var a=e.toLowerCase().replace("-",""),l=n.attributes[a];this.__widgetContainer.addEventListener(l.property,t,i)}},{key:"__createUserControl",value:function(e){return this.__fphiWidget=new o.Selphi.Widget(e),(null!==this.getAttribute("debugMode")&&void 0!==this.getAttribute("debugMode")||null!==this.getAttribute("debugmode")&&void 0!==this.getAttribute("debugmode"))&&(this.__fphiWidget.debug=n.__tryParsePrimitive(this.getAttribute("debugMode"))),this}},{key:"__startUserControl",value:function(){var e=m(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.__fphiWidget&&this.__fphiWidget.Start(),this));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"__stopUserControl",value:function(){var e=m(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.__fphiWidget&&this.__fphiWidget.Stop(),this));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"routeClick",value:function(e,t){this.__fphiWidget.routeClick(e,t)}},{key:"__setNativeConfiguration",value:function(e,t){var i=!1;if(void 0!==n.attributes[e]&&null!==n.attributes[e]){var a=n.attributes[e].property,l=n.attributes[e].type,s=t,r=Reflect.get(this.__config,a);if(null!=t&&s!==r){var c="event"!==l?n.__tryParsePrimitive(t):n.__tryParseFunction(t);if("debugMode"===a)void 0!==this.__fphiWidget&&null!==this.__fphiWidget&&"function"!=typeof c&&(this.__fphiWidget.debug=c,i=i||!1);else{if("accessibility"!==a||!0!==c||this.__accessibilityHasEnabled||(this.accessibilityRoot=document.createElement("div"),this.accessibilityRoot.id="accessibilityContainer",this.__widgetContainer.append(this.accessibilityRoot),this.__accessibilityHasEnabled=!0),"function"==typeof c&&"event"===l)this.__widgetContainer.addEventListener(a,c,!0);else{var o=n.__getSetterAttr(a,this.__config);(this.__config?o.bind(this.__config):o)(c)}i=this.__elementMounted}}}return i}}],[{key:"attributes",get:function(){return{bundlepath:{type:"string",property:"bundlePath"},resourcespath:{type:"string",property:"resourcesPath"},graphpath:{type:"string",property:"graphPath"},timeout:{type:"number",property:"timeout"},language:{type:"string",property:"language"},dpilist:{type:"string",property:"dpiList"},tutorial:{type:"boolean",property:"tutorial"},interactible:{type:"boolean",property:"interactible"},logimages:{type:"boolean",property:"logImages"},stabilizationstage:{type:"boolean",property:"stabilizationStage"},camerawidth:{type:"number",property:"cameraWidth"},cameraheight:{type:"number",property:"cameraHeight"},camerarotation:{type:"number",property:"cameraRotation"},cameratype:{type:"number",property:"cameraType"},livenessmode:{type:"number",property:"livenessMode"},livenessprecision:{type:"number",property:"livenessPrecision"},livenessmodeinitialerror:{type:"number",property:"livenessMoveInitialError"},livenessmoveinfotime:{type:"number",property:"livenessMoveInfoTime"},cropfactor:{type:"number",property:"cropFactor"},cropimage:{type:"boolean",property:"cropImage"},registertime:{type:"number",property:"registerTime"},authenticatetime:{type:"number",property:"authenticateTime"},imageformat:{type:"string",property:"imageFormat"},imagequality:{type:"number",property:"imageQuality"},templateformat:{type:"number",property:"templateFormat"},videorecord:{type:"boolean",property:"videoRecord"},videorecordrate:{type:"number",property:"videoRecordRate"},videorecordscale:{type:"number",property:"videoRecordScale"},videorecordtype:{type:"number",property:"videoRecordType"},showlog:{type:"boolean",property:"showLog"},debugmode:{type:"boolean",property:"debugMode"},accessibility:{type:"boolean",property:"accessibility"},accessibleelements:{type:"array",property:"accessibleElements"},onmoduleloaded:{type:"event",property:"FPhi.UserControl.ModuleLoaded.event"},onstabilizing:{type:"event",property:"FPhi.UserControl.Stabilizing.event"},onextractionfinish:{type:"event",property:"FPhi.UserControl.Finish.event"},onusercancel:{type:"event",property:"FPhi.UserControl.UserCancel.event"},onexceptioncaptured:{type:"event",property:"FPhi.UserControl.ExceptionCaptured.event"},onlivenesserror:{type:"event",property:"FPhi.UserControl.LivenessError.event"},onlivenesserrorbuttonclick:{type:"event",property:"FPhi.UserControl.LivenessErrorButtonClick.event"},onextractiontimeout:{type:"event",property:"FPhi.UserControl.ExtractionTimeout.event"},ontimeouterrorbuttonclick:{type:"event",property:"FPhi.UserControl.TimeoutErrorButtonClick.event"},ontrackstatus:{type:"event",property:"FPhi.UserControl.TrackStatus.event"}}}},{key:"observedAttributes",get:function(){return Object.getOwnPropertyNames(this.attributes)}},{key:"generateTemplateRawFromByteArray",value:function(e,t,i){var a=new o.Selphi.ConfigurationManager;"string"==typeof e?a.setBundlePath(e):"object"==typeof e&&Object.keys(e).forEach((function(t){var i=n.__getSetterAttr(t,a);(a?i.bind(a):i)(e[t])})),a.setContainer(document.createElement("div")),new o.Selphi.Widget(a).GenerateTemplateRawFromByteArray(t,i)}},{key:"checkCapabilities",value:function(){var e=m(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Selphi.CheckCapabilities();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"__getSetterAttr",value:function(e,t){return t["set"+e.charAt(0).toUpperCase()+e.slice(1)]}},{key:"__tryParsePrimitive",value:function(e){try{return JSON.parse(e)}catch(t){return e.toString()}}},{key:"__tryParseFunction",value:function(e){try{return new Function("event",e)}catch(t){return e.toString()}}}]),n}(f(HTMLElement)),h=null,b={};function p(e){for(var t="",i=new Uint8Array(e),n=i.byteLength,a=0;a<n;a++)t+=String.fromCharCode(i[a]);return window.btoa(t)}b.Selphi=e,b.Selphi.RecorderType={Local:0,Remote:1},b.Selphi.RecorderStatus={Ok:0,Unknown:1,SocketError:2},b.Selphi.ConfigurationManager=function(){function t(){X(this,t),this.container=null,this.language="es",this.dpiList=[163,326,489],this.cameraWidth=1280,this.cameraHeight=720,this.cameraType=e.CameraType.Front,this.cameraRotation=0,this.bundlePath="",this.resourcesPath=this.bundlePath+"/FPhi.Widget.Resources/",this.faceTracking=!1,this.accessibility=!1,this.accessibleElements=["button","buttonImage"],this.showLog=!1,this.onExtractionFinish=null,this.onUserCancel=null,this.onExceptionCaptured=null,this.onExtractionTimeout=null,this.onModuleLoaded=null,this.onLivenessError=null,this.onLivenessErrorButtonClick=null,this.onTimeoutErrorButtonClick=null,this.onStabilizing=null,this.onTrackStatus=null,this.livenessMode=e.LivenessMode.None,this.tutorial=!1,this.stabilizationStage=!1,this.livenessPrecision=2,this.livenessMoveInitialError=0,this.livenessMoveInfoTime=3,this.timeout=3e4,this.interactible=!0,this.registerTime=7,this.authenticateTime=1,this.graphPath=this.bundlePath+"/graph.xml",this.imageFormat="image/jpeg",this.imageQuality=.92,this.logImages=!1,this.cropFactor=1,this.cropImage=!0,this.templateFormat=e.TemplateFormat.Base64,this.videoRecord=!1,this.videoRecordRate=10,this.videoRecordScale=1,this.videoRecordType=e.RecorderType.Local}return C(t,[{key:"setContainer",value:function(e){this.container=e}},{key:"getContainer",value:function(){return this.container}},{key:"setLanguage",value:function(e){this.language=e}},{key:"getLanguage",value:function(){return this.language}},{key:"setDpiList",value:function(e){this.dpiList=e}},{key:"getDpiList",value:function(){return this.dpiList}},{key:"setCameraWidth",value:function(e){this.cameraWidth=e}},{key:"getCameraWidth",value:function(){return this.cameraWidth}},{key:"setCameraHeight",value:function(e){this.cameraHeight=e}},{key:"getCameraHeight",value:function(){return this.cameraHeight}},{key:"setCameraType",value:function(e){this.cameraType=e}},{key:"getCameraType",value:function(){return this.cameraType}},{key:"setCameraRotation",value:function(e){this.cameraRotation=e}},{key:"getCameraRotation",value:function(){return this.cameraRotation}},{key:"setResourcesPath",value:function(e){this.resourcesPath=e}},{key:"getResourcesPath",value:function(){return this.resourcesPath}},{key:"setBundlePath",value:function(e){var t=this.bundlePath;this.bundlePath=e,this.graphPath=this.bundlePath+"/graph.xml",this.resourcesPath===t+"/FPhi.Widget.Resources/"&&(this.resourcesPath=this.bundlePath+"/FPhi.Widget.Resources/")}},{key:"getTimeout",value:function(){return this.timeout}},{key:"setTimeout",value:function(e){this.timeout=e}},{key:"getBundlePath",value:function(){return this.bundlePath}},{key:"setOnExtractionFinish",value:function(e){this.onExtractionFinish=e}},{key:"getOnExtractionFinish",value:function(){return this.onExtractionFinish}},{key:"setOnUserCancel",value:function(e){this.onUserCancel=e}},{key:"getOnUserCancel",value:function(){return this.onUserCancel}},{key:"setOnExceptionCaptured",value:function(e){this.onExceptionCaptured=e}},{key:"getOnExceptionCaptured",value:function(){return this.onExceptionCaptured}},{key:"setOnExtractionTimeout",value:function(e){this.onExtractionTimeout=e}},{key:"getOnExtractionTimeout",value:function(){return this.onExtractionTimeout}},{key:"setOnModuleLoaded",value:function(e){this.onModuleLoaded=e}},{key:"getOnModuleLoaded",value:function(){return this.onModuleLoaded}},{key:"setOnLivenessError",value:function(e){this.onLivenessError=e}},{key:"getOnLivenessError",value:function(){return this.onLivenessError}},{key:"setOnLivenessErrorButtonClick",value:function(e){this.onLivenessErrorButtonClick=e}},{key:"getOnLivenessErrorButtonClick",value:function(){return this.onLivenessErrorButtonClick}},{key:"setOnTimeoutErrorButtonClick",value:function(e){this.onTimeoutErrorButtonClick=e}},{key:"getOnTimeoutErrorButtonClick",value:function(){return this.onTimeoutErrorButtonClick}},{key:"setOnStabilizing",value:function(e){this.onStabilizing=e}},{key:"getOnStabilizing",value:function(){return this.onStabilizing}},{key:"setOnTrackStatus",value:function(e){this.onTrackStatus=e}},{key:"getOnTrackStatus",value:function(){return this.onTrackStatus}},{key:"setLivenessMode",value:function(e){this.livenessMode=e}},{key:"getLivenessMode",value:function(){return this.livenessMode}},{key:"setTutorial",value:function(e){this.tutorial=e}},{key:"getTutorial",value:function(){return this.tutorial}},{key:"setStabilizationStage",value:function(e){this.stabilizationStage=e}},{key:"getStabilizationStage",value:function(){return this.stabilizationStage}},{key:"setLivenessPrecision",value:function(e){this.livenessPrecision=e}},{key:"getLivenessPrecision",value:function(){return this.livenessPrecision}},{key:"setLivenessMoveInitialError",value:function(e){this.livenessMoveInitialError=e}},{key:"getLivenessMoveInitialError",value:function(){return this.livenessMoveInitialError}},{key:"setLivenessMoveInfoTime",value:function(e){this.livenessMoveInfoTime=e}},{key:"getLivenessMoveInfoTime",value:function(){return this.livenessMoveInfoTime}},{key:"setInteractible",value:function(e){this.interactible=e}},{key:"getInteractible",value:function(){return this.interactible}},{key:"setRegisterTime",value:function(e){this.registerTime=e}},{key:"getRegisterTime",value:function(){return this.registerTime}},{key:"setAuthenticateTime",value:function(e){this.authenticateTime=e}},{key:"getAuthenticateTime",value:function(){return this.authenticateTime}},{key:"setGraphPath",value:function(e){this.graphPath=e}},{key:"getGraphPath",value:function(){return this.graphPath}},{key:"setImageFormat",value:function(e){this.imageFormat=e}},{key:"getImageFormat",value:function(){return this.imageFormat}},{key:"setImageQuality",value:function(e){this.imageQuality=e}},{key:"getImageQuality",value:function(){return this.imageQuality}},{key:"setLogImages",value:function(e){this.logImages=e}},{key:"getLogImages",value:function(){return this.logImages}},{key:"setCropFactor",value:function(e){this.cropFactor=e}},{key:"getCropFactor",value:function(){return this.cropFactor}},{key:"setCropImage",value:function(e){this.cropImage=e}},{key:"getCropImage",value:function(){return this.cropImage}},{key:"setTemplateFormat",value:function(e){this.templateFormat=e}},{key:"getTemplateFormat",value:function(){return this.templateFormat}},{key:"setVideoRecord",value:function(e){this.videoRecord=e}},{key:"getVideoRecord",value:function(){return this.videoRecord}},{key:"setVideoRecordRate",value:function(e){this.videoRecordRate=e}},{key:"getVideoRecordRate",value:function(){return this.videoRecordRate}},{key:"setVideoRecordScale",value:function(e){this.videoRecordScale=e}},{key:"getVideoRecordScale",value:function(){return this.videoRecordScale}},{key:"setVideoRecordType",value:function(e){this.videoRecordType=e}},{key:"getVideoRecordType",value:function(){return this.videoRecordType}},{key:"setShowLog",value:function(e){this.showLog=e}},{key:"getShowLog",value:function(){return this.showLog}},{key:"setFaceTracking",value:function(e){this.faceTracking=e}},{key:"getFaceTracking",value:function(){return this.faceTracking}},{key:"setAccessibility",value:function(e){this.accessibility=e}},{key:"getAccessibility",value:function(){return this.accessibility}},{key:"setAccessibleElements",value:function(e){this.accessibleElements=e}},{key:"getAccessibleElements",value:function(){return this.accessibleElements}}]),t}(),b.Selphi.Widget=function(e){this.showLog=e.getShowLog(),this.printLog("FPhi.Selphi.Widget: Selphi Widget Web Version: "+b.Selphi.Version),this.printLog("FPhi.Selphi.Widget: Debug log enabled!"),this.cm=e,this.divContainer=this.cm.getContainer(),this.livenessMode=this.cm.getLivenessMode(),this.tutorial=this.cm.getTutorial(),this.stabilizationStage=this.cm.getStabilizationStage(),this.onExtractionFinish=this.cm.getOnExtractionFinish(),this.onUserCancel=this.cm.getOnUserCancel(),this.onExceptionCaptured=this.cm.getOnExceptionCaptured(),this.onExtractionTimeout=this.cm.getOnExtractionTimeout(),this.onModuleLoaded=this.cm.getOnModuleLoaded(),this.onLivenessError=this.cm.getOnLivenessError(),this.onLivenessErrorButtonClick=this.cm.getOnLivenessErrorButtonClick(),this.onTimeoutErrorButtonClick=this.cm.getOnTimeoutErrorButtonClick(),this.onStabilizing=this.cm.getOnStabilizing(),this.onTrackStatus=this.cm.getOnTrackStatus(),this.livenessPrecision=this.cm.getLivenessPrecision(),this.livenessMoveInitialError=this.cm.getLivenessMoveInitialError(),this.livenessMoveInfoTime=this.cm.getLivenessMoveInfoTime(),this.interactible=this.cm.getInteractible(),this.registerTime=this.cm.getRegisterTime(),this.authenticateTime=this.cm.getAuthenticateTime(),this.graphPath=this.isPathAbsolute(this.cm.getGraphPath())?this.cm.getGraphPath():this.getScriptPath()+this.cm.getGraphPath(),this.imageFormat=this.cm.getImageFormat(),this.imageQuality=this.cm.getImageQuality(),this.logImages=this.cm.getLogImages(),this.cropFactor=this.cm.getCropFactor(),this.cropImage=this.cm.getCropImage(),this.devicePixelRatio=window.devicePixelRatio,this.cameraReady=!1,this.bundlePath=this.isPathAbsolute(this.cm.getBundlePath())?this.cm.getBundlePath():this.getScriptPath()+this.cm.getBundlePath(),this.printLog("FPhi.Selphi.Widget: Serving from URL: "+this.bundlePath),this.printLog("FPhi.Selphi.Widget: wasm path: "+this.bundlePath+"/FPhiExtractor.wasm"),this.wasmReady=!1,this.wasmInitiated=!1,this.worker=new Worker((null===h&&(h=URL.createObjectURL(new Blob([atob("Y29uc3QgZT0oLi4uZSk9PntlLmZvckVhY2goKGU9PntudWxsIT09ZSYmdm9pZCAwIT09ZS5kZWxldGUmJmUuZGVsZXRlKCl9KSl9LHI9KGUscix0KT0+e2xldCBuPXI7aWYobi5zYW1wbGVEaWFnbm9zdGljPXQuZ2V0U2FtcGxlRGlhZ25vc3RpYygpLnZhbHVlLHQuZ2V0U2FtcGxlRGlhZ25vc3RpYygpPT09ZS5TYW1wbGVEaWFnbm9zdGljLk9rKXtsZXQgcixvLGEsaSxzLHUsYyxsO251bGwhPT0ocz10LmdldFRlbXBsYXRlKCkpJiZudWxsIT09KGM9bmV3IFVpbnQ4QXJyYXkoZS5nZXRCeXRlcyhzKSkpJiYobi50ZW1wbGF0ZT1jLHMuZGVsZXRlKCkpLG51bGwhPT0odT10LmdldFRlbXBsYXRlUmF3KCkpJiZudWxsIT09KGw9bmV3IFVpbnQ4QXJyYXkoZS5nZXRCeXRlcyh1KSkpJiYobi50ZW1wbGF0ZVJhdz1sLHUuZGVsZXRlKCkpLG51bGwhPT0obz10LmdldEZhY2UoKSkmJihuLmZhY2U9e3g6by5YLHk6by5ZLHdpZHRoOm8uV2lkdGgsaGVpZ2h0Om8uSGVpZ2h0fSksbnVsbCE9PShhPXQuZ2V0TGVmdEV5ZSgpKSYmKG4ubGVmdEV5ZT17eDphLlgseTphLll9KSxudWxsIT09KGk9dC5nZXRSaWdodEV5ZSgpKSYmKG4ucmlnaHRFeWU9e3g6aS5YLHk6aS5ZfSksbnVsbCE9PShyPXQuZ2V0VGVtcGxhdGVJbmZvKCkpJiYobi50ZW1wbGF0ZVNjb3JlPXIuZ2V0VGVtcGxhdGVTY29yZSgpLG4uZmFjaWFsU2NvcmU9dC5nZXRGYWNpYWxTY29yZSgpLG4uc3VuR2xhc3Nlc1Njb3JlPXIuZ2V0U3VuR2xhc3Nlc1Njb3JlKCksci5kZWxldGUoKSl9cmV0dXJuIG59LHQ9YXN5bmMgZT0+bnVsbCxuPWFzeW5jIGU9Pm51bGw7dmFyIG8sYT0obz0idW5kZWZpbmVkIiE9dHlwZW9mIGRvY3VtZW50JiZkb2N1bWVudC5jdXJyZW50U2NyaXB0P2RvY3VtZW50LmN1cnJlbnRTY3JpcHQuc3JjOnZvaWQgMCxmdW5jdGlvbihlKXt2YXIgcix0OyhlPXZvaWQgMCE9PShlPWV8fHt9KT9lOnt9KS5yZWFkeT1uZXcgUHJvbWlzZSgoZnVuY3Rpb24oZSxuKXtyPWUsdD1ufSkpO3ZhciBuLGEsaT1PYmplY3QuYXNzaWduKHt9LGUpLHM9W10sdT0iLi90aGlzLnByb2dyYW0iLGM9IiI7InVuZGVmaW5lZCIhPXR5cGVvZiBkb2N1bWVudCYmZG9jdW1lbnQuY3VycmVudFNjcmlwdCYmKGM9ZG9jdW1lbnQuY3VycmVudFNjcmlwdC5zcmMpLG8mJihjPW8pLGM9MCE9PWMuaW5kZXhPZigiYmxvYjoiKT9jLnN1YnN0cigwLGMucmVwbGFjZSgvWz8jXS4qLywiIikubGFzdEluZGV4T2YoIi8iKSsxKToiIixuPWU9Pnt2YXIgcj1uZXcgWE1MSHR0cFJlcXVlc3Q7cmV0dXJuIHIub3BlbigiR0VUIixlLCExKSxyLnNlbmQobnVsbCksci5yZXNwb25zZVRleHR9LGE9KGUscix0KT0+e3ZhciBuPW5ldyBYTUxIdHRwUmVxdWVzdDtuLm9wZW4oIkdFVCIsZSwhMCksbi5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIixuLm9ubG9hZD0oKT0+ezIwMD09bi5zdGF0dXN8fDA9PW4uc3RhdHVzJiZuLnJlc3BvbnNlP3Iobi5yZXNwb25zZSk6dCgpfSxuLm9uZXJyb3I9dCxuLnNlbmQobnVsbCl9O3ZhciBsPWUucHJpbnR8fGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSksZD1lLnByaW50RXJyfHxjb25zb2xlLndhcm4uYmluZChjb25zb2xlKTtPYmplY3QuYXNzaWduKGUsaSksaT1udWxsLGUuYXJndW1lbnRzJiYocz1lLmFyZ3VtZW50cyksZS50aGlzUHJvZ3JhbSYmKHU9ZS50aGlzUHJvZ3JhbSksZS5xdWl0JiZlLnF1aXQ7dmFyIGYscD0wLGg9ZT0+e3A9ZX07ZS53YXNtQmluYXJ5JiYoZj1lLndhc21CaW5hcnkpLGUubm9FeGl0UnVudGltZSwib2JqZWN0IiE9dHlwZW9mIFdlYkFzc2VtYmx5JiZLKCJubyBuYXRpdmUgd2FzbSBzdXBwb3J0IGRldGVjdGVkIik7dmFyIG09ITE7ZnVuY3Rpb24gdihlLHIpe2V8fEsocil9dmFyIHk9InVuZGVmaW5lZCIhPXR5cGVvZiBUZXh0RGVjb2Rlcj9uZXcgVGV4dERlY29kZXIoInV0ZjgiKTp2b2lkIDA7ZnVuY3Rpb24gdyhlLHIsdCl7Zm9yKHZhciBuPXIrdCxvPXI7ZVtvXSYmIShvPj1uKTspKytvO2lmKG8tcj4xNiYmZS5idWZmZXImJnkpcmV0dXJuIHkuZGVjb2RlKGUuc3ViYXJyYXkocixvKSk7Zm9yKHZhciBhPSIiO3I8bzspe3ZhciBpPWVbcisrXTtpZigxMjgmaSl7dmFyIHM9NjMmZVtyKytdO2lmKDE5MiE9KDIyNCZpKSl7dmFyIHU9NjMmZVtyKytdO2lmKChpPTIyND09KDI0MCZpKT8oMTUmaSk8PDEyfHM8PDZ8dTooNyZpKTw8MTh8czw8MTJ8dTw8Nnw2MyZlW3IrK10pPDY1NTM2KWErPVN0cmluZy5mcm9tQ2hhckNvZGUoaSk7ZWxzZXt2YXIgYz1pLTY1NTM2O2ErPVN0cmluZy5mcm9tQ2hhckNvZGUoNTUyOTZ8Yz4+MTAsNTYzMjB8MTAyMyZjKX19ZWxzZSBhKz1TdHJpbmcuZnJvbUNoYXJDb2RlKCgzMSZpKTw8NnxzKX1lbHNlIGErPVN0cmluZy5mcm9tQ2hhckNvZGUoaSl9cmV0dXJuIGF9ZnVuY3Rpb24gZyhlLHIpe3JldHVybiBlP3coVCxlLHIpOiIifWZ1bmN0aW9uIEUoZSxyLHQsbil7aWYoIShuPjApKXJldHVybiAwO2Zvcih2YXIgbz10LGE9dCtuLTEsaT0wO2k8ZS5sZW5ndGg7KytpKXt2YXIgcz1lLmNoYXJDb2RlQXQoaSk7aWYocz49NTUyOTYmJnM8PTU3MzQzJiYocz02NTUzNisoKDEwMjMmcyk8PDEwKXwxMDIzJmUuY2hhckNvZGVBdCgrK2kpKSxzPD0xMjcpe2lmKHQ+PWEpYnJlYWs7clt0KytdPXN9ZWxzZSBpZihzPD0yMDQ3KXtpZih0KzE+PWEpYnJlYWs7clt0KytdPTE5MnxzPj42LHJbdCsrXT0xMjh8NjMmc31lbHNlIGlmKHM8PTY1NTM1KXtpZih0KzI+PWEpYnJlYWs7clt0KytdPTIyNHxzPj4xMixyW3QrK109MTI4fHM+PjYmNjMsclt0KytdPTEyOHw2MyZzfWVsc2V7aWYodCszPj1hKWJyZWFrO3JbdCsrXT0yNDB8cz4+MTgsclt0KytdPTEyOHxzPj4xMiY2MyxyW3QrK109MTI4fHM+PjYmNjMsclt0KytdPTEyOHw2MyZzfX1yZXR1cm4gclt0XT0wLHQtb31mdW5jdGlvbiBfKGUscix0KXtyZXR1cm4gRShlLFQscix0KX1mdW5jdGlvbiBiKGUpe2Zvcih2YXIgcj0wLHQ9MDt0PGUubGVuZ3RoOysrdCl7dmFyIG49ZS5jaGFyQ29kZUF0KHQpO24+PTU1Mjk2JiZuPD01NzM0MyYmKG49NjU1MzYrKCgxMDIzJm4pPDwxMCl8MTAyMyZlLmNoYXJDb2RlQXQoKyt0KSksbjw9MTI3PysrcjpyKz1uPD0yMDQ3PzI6bjw9NjU1MzU/Mzo0fXJldHVybiByfXZhciBrLFAsVCxTLEMsRCxGLEEsTSwkPSJ1bmRlZmluZWQiIT10eXBlb2YgVGV4dERlY29kZXI/bmV3IFRleHREZWNvZGVyKCJ1dGYtMTZsZSIpOnZvaWQgMDtmdW5jdGlvbiB4KGUscil7Zm9yKHZhciB0PWUsbj10Pj4xLG89bityLzI7IShuPj1vKSYmQ1tuXTspKytuO2lmKCh0PW48PDEpLWU+MzImJiQpcmV0dXJuICQuZGVjb2RlKFQuc3ViYXJyYXkoZSx0KSk7Zm9yKHZhciBhPSIiLGk9MDshKGk+PXIvMik7KytpKXt2YXIgcz1TW2UrMippPj4xXTtpZigwPT1zKWJyZWFrO2ErPVN0cmluZy5mcm9tQ2hhckNvZGUocyl9cmV0dXJuIGF9ZnVuY3Rpb24gTyhlLHIsdCl7aWYodm9pZCAwPT09dCYmKHQ9MjE0NzQ4MzY0NyksdDwyKXJldHVybiAwO2Zvcih2YXIgbj1yLG89KHQtPTIpPDIqZS5sZW5ndGg/dC8yOmUubGVuZ3RoLGE9MDthPG87KythKXt2YXIgaT1lLmNoYXJDb2RlQXQoYSk7U1tyPj4xXT1pLHIrPTJ9cmV0dXJuIFNbcj4+MV09MCxyLW59ZnVuY3Rpb24gUihlKXtyZXR1cm4gMiplLmxlbmd0aH1mdW5jdGlvbiBqKGUscil7Zm9yKHZhciB0PTAsbj0iIjshKHQ+PXIvNCk7KXt2YXIgbz1EW2UrNCp0Pj4yXTtpZigwPT1vKWJyZWFrO2lmKCsrdCxvPj02NTUzNil7dmFyIGE9by02NTUzNjtuKz1TdHJpbmcuZnJvbUNoYXJDb2RlKDU1Mjk2fGE+PjEwLDU2MzIwfDEwMjMmYSl9ZWxzZSBuKz1TdHJpbmcuZnJvbUNoYXJDb2RlKG8pfXJldHVybiBufWZ1bmN0aW9uIEkoZSxyLHQpe2lmKHZvaWQgMD09PXQmJih0PTIxNDc0ODM2NDcpLHQ8NClyZXR1cm4gMDtmb3IodmFyIG49cixvPW4rdC00LGE9MDthPGUubGVuZ3RoOysrYSl7dmFyIGk9ZS5jaGFyQ29kZUF0KGEpO2lmKGk+PTU1Mjk2JiZpPD01NzM0MyYmKGk9NjU1MzYrKCgxMDIzJmkpPDwxMCl8MTAyMyZlLmNoYXJDb2RlQXQoKythKSksRFtyPj4yXT1pLChyKz00KSs0Pm8pYnJlYWt9cmV0dXJuIERbcj4+Ml09MCxyLW59ZnVuY3Rpb24geihlKXtmb3IodmFyIHI9MCx0PTA7dDxlLmxlbmd0aDsrK3Qpe3ZhciBuPWUuY2hhckNvZGVBdCh0KTtuPj01NTI5NiYmbjw9NTczNDMmJisrdCxyKz00fXJldHVybiByfWUuSU5JVElBTF9NRU1PUlk7dmFyIEIsVyxOLEwsVSxIPVtdLFY9W10sWT1bXSxxPTAsRz1udWxsLFg9bnVsbDtmdW5jdGlvbiBKKHIpe3ErKyxlLm1vbml0b3JSdW5EZXBlbmRlbmNpZXMmJmUubW9uaXRvclJ1bkRlcGVuZGVuY2llcyhxKX1mdW5jdGlvbiBRKHIpe2lmKHEtLSxlLm1vbml0b3JSdW5EZXBlbmRlbmNpZXMmJmUubW9uaXRvclJ1bkRlcGVuZGVuY2llcyhxKSwwPT1xJiYobnVsbCE9PUcmJihjbGVhckludGVydmFsKEcpLEc9bnVsbCksWCkpe3ZhciB0PVg7WD1udWxsLHQoKX19ZnVuY3Rpb24gSyhyKXtlLm9uQWJvcnQmJmUub25BYm9ydChyKSxkKHI9IkFib3J0ZWQoIityKyIpIiksbT0hMCxyKz0iLiBCdWlsZCB3aXRoIC1zQVNTRVJUSU9OUyBmb3IgbW9yZSBpbmZvLiI7dmFyIG49bmV3IFdlYkFzc2VtYmx5LlJ1bnRpbWVFcnJvcihyKTt0aHJvdyB0KG4pLG59ZnVuY3Rpb24gWihyKXtmb3IoO3IubGVuZ3RoPjA7KXt2YXIgdD1yLnNoaWZ0KCk7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIHQpe3ZhciBuPXQuZnVuYzsibnVtYmVyIj09dHlwZW9mIG4/dm9pZCAwPT09dC5hcmc/cmUobikoKTpyZShuKSh0LmFyZyk6bih2b2lkIDA9PT10LmFyZz9udWxsOnQuYXJnKX1lbHNlIHQoZSl9fShXPSJGUGhpRXh0cmFjdG9yLndhc20iKS5zdGFydHNXaXRoKCJkYXRhOmFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbTtiYXNlNjQsIil8fChOPVcsVz1lLmxvY2F0ZUZpbGU/ZS5sb2NhdGVGaWxlKE4sYyk6YytOKTt2YXIgZWU9W107ZnVuY3Rpb24gcmUoZSl7dmFyIHI9ZWVbZV07cmV0dXJuIHJ8fChlPj1lZS5sZW5ndGgmJihlZS5sZW5ndGg9ZSsxKSxlZVtlXT1yPUIuZ2V0KGUpKSxyfXZhciB0ZT1bXSxuZT0wLG9lPTA7ZnVuY3Rpb24gYWUoZSl7dGhpcy5leGNQdHI9ZSx0aGlzLnB0cj1lLTI0LHRoaXMuc2V0X3R5cGU9ZnVuY3Rpb24oZSl7RFt0aGlzLnB0cis0Pj4yXT1lfSx0aGlzLmdldF90eXBlPWZ1bmN0aW9uKCl7cmV0dXJuIERbdGhpcy5wdHIrND4+Ml19LHRoaXMuc2V0X2Rlc3RydWN0b3I9ZnVuY3Rpb24oZSl7RFt0aGlzLnB0cis4Pj4yXT1lfSx0aGlzLmdldF9kZXN0cnVjdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIERbdGhpcy5wdHIrOD4+Ml19LHRoaXMuc2V0X3JlZmNvdW50PWZ1bmN0aW9uKGUpe0RbdGhpcy5wdHI+PjJdPWV9LHRoaXMuc2V0X2NhdWdodD1mdW5jdGlvbihlKXtlPWU/MTowLFBbdGhpcy5wdHIrMTI+PjBdPWV9LHRoaXMuZ2V0X2NhdWdodD1mdW5jdGlvbigpe3JldHVybiAwIT1QW3RoaXMucHRyKzEyPj4wXX0sdGhpcy5zZXRfcmV0aHJvd249ZnVuY3Rpb24oZSl7ZT1lPzE6MCxQW3RoaXMucHRyKzEzPj4wXT1lfSx0aGlzLmdldF9yZXRocm93bj1mdW5jdGlvbigpe3JldHVybiAwIT1QW3RoaXMucHRyKzEzPj4wXX0sdGhpcy5pbml0PWZ1bmN0aW9uKGUscil7dGhpcy5zZXRfYWRqdXN0ZWRfcHRyKDApLHRoaXMuc2V0X3R5cGUoZSksdGhpcy5zZXRfZGVzdHJ1Y3RvcihyKSx0aGlzLnNldF9yZWZjb3VudCgwKSx0aGlzLnNldF9jYXVnaHQoITEpLHRoaXMuc2V0X3JldGhyb3duKCExKX0sdGhpcy5hZGRfcmVmPWZ1bmN0aW9uKCl7dmFyIGU9RFt0aGlzLnB0cj4+Ml07RFt0aGlzLnB0cj4+Ml09ZSsxfSx0aGlzLnJlbGVhc2VfcmVmPWZ1bmN0aW9uKCl7dmFyIGU9RFt0aGlzLnB0cj4+Ml07cmV0dXJuIERbdGhpcy5wdHI+PjJdPWUtMSwxPT09ZX0sdGhpcy5zZXRfYWRqdXN0ZWRfcHRyPWZ1bmN0aW9uKGUpe0RbdGhpcy5wdHIrMTY+PjJdPWV9LHRoaXMuZ2V0X2FkanVzdGVkX3B0cj1mdW5jdGlvbigpe3JldHVybiBEW3RoaXMucHRyKzE2Pj4yXX0sdGhpcy5nZXRfZXhjZXB0aW9uX3B0cj1mdW5jdGlvbigpe2lmKFdyKHRoaXMuZ2V0X3R5cGUoKSkpcmV0dXJuIERbdGhpcy5leGNQdHI+PjJdO3ZhciBlPXRoaXMuZ2V0X2FkanVzdGVkX3B0cigpO3JldHVybiAwIT09ZT9lOnRoaXMuZXhjUHRyfX1mdW5jdGlvbiBpZShlKXt0cnl7cmV0dXJuIHhyKG5ldyBhZShlKS5wdHIpfWNhdGNoKGUpe319dmFyIHNlPSJUbyB1c2UgZGxvcGVuLCB5b3UgbmVlZCBlbmFibGUgZHluYW1pYyBsaW5raW5nLCBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2Vtc2NyaXB0ZW4tY29yZS9lbXNjcmlwdGVuL3dpa2kvTGlua2luZyIsdWU9e307ZnVuY3Rpb24gY2UoZSl7Zm9yKDtlLmxlbmd0aDspe3ZhciByPWUucG9wKCk7ZS5wb3AoKShyKX19ZnVuY3Rpb24gbGUoZSl7cmV0dXJuIHRoaXMuZnJvbVdpcmVUeXBlKEZbZT4+Ml0pfXZhciBkZT17fSxmZT17fSxwZT17fTtmdW5jdGlvbiBoZShlKXtpZih2b2lkIDA9PT1lKXJldHVybiJfdW5rbm93biI7dmFyIHI9KGU9ZS5yZXBsYWNlKC9bXmEtekEtWjAtOV9dL2csIiQiKSkuY2hhckNvZGVBdCgwKTtyZXR1cm4gcj49NDgmJnI8PTU3PyJfIitlOmV9ZnVuY3Rpb24gbWUoZSxyKXtyZXR1cm4gZT1oZShlKSxuZXcgRnVuY3Rpb24oImJvZHkiLCJyZXR1cm4gZnVuY3Rpb24gIitlKycoKSB7XG4gICAgInVzZSBzdHJpY3QiOyAgICByZXR1cm4gYm9keS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufTtcbicpKHIpfWZ1bmN0aW9uIHZlKGUscil7dmFyIHQ9bWUociwoZnVuY3Rpb24oZSl7dGhpcy5uYW1lPXIsdGhpcy5tZXNzYWdlPWU7dmFyIHQ9bmV3IEVycm9yKGUpLnN0YWNrO3ZvaWQgMCE9PXQmJih0aGlzLnN0YWNrPXRoaXMudG9TdHJpbmcoKSsiXG4iK3QucmVwbGFjZSgvXkVycm9yKDpbXlxuXSopP1xuLywiIikpfSkpO3JldHVybiB0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGUucHJvdG90eXBlKSx0LnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj10LHQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHZvaWQgMD09PXRoaXMubWVzc2FnZT90aGlzLm5hbWU6dGhpcy5uYW1lKyI6ICIrdGhpcy5tZXNzYWdlfSx0fXZhciB5ZT12b2lkIDA7ZnVuY3Rpb24gd2UoZSl7dGhyb3cgbmV3IHllKGUpfWZ1bmN0aW9uIGdlKGUscix0KXtmdW5jdGlvbiBuKHIpe3ZhciBuPXQocik7bi5sZW5ndGghPT1lLmxlbmd0aCYmd2UoIk1pc21hdGNoZWQgdHlwZSBjb252ZXJ0ZXIgY291bnQiKTtmb3IodmFyIG89MDtvPGUubGVuZ3RoOysrbylUZShlW29dLG5bb10pfWUuZm9yRWFjaCgoZnVuY3Rpb24oZSl7cGVbZV09cn0pKTt2YXIgbz1uZXcgQXJyYXkoci5sZW5ndGgpLGE9W10saT0wO3IuZm9yRWFjaCgoKGUscik9PntmZS5oYXNPd25Qcm9wZXJ0eShlKT9vW3JdPWZlW2VdOihhLnB1c2goZSksZGUuaGFzT3duUHJvcGVydHkoZSl8fChkZVtlXT1bXSksZGVbZV0ucHVzaCgoKCk9PntvW3JdPWZlW2VdLCsraT09PWEubGVuZ3RoJiZuKG8pfSkpKX0pKSwwPT09YS5sZW5ndGgmJm4obyl9ZnVuY3Rpb24gRWUoZSl7c3dpdGNoKGUpe2Nhc2UgMTpyZXR1cm4gMDtjYXNlIDI6cmV0dXJuIDE7Y2FzZSA0OnJldHVybiAyO2Nhc2UgODpyZXR1cm4gMztkZWZhdWx0OnRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gdHlwZSBzaXplOiAiK2UpfX12YXIgX2U9dm9pZCAwO2Z1bmN0aW9uIGJlKGUpe2Zvcih2YXIgcj0iIix0PWU7VFt0XTspcis9X2VbVFt0KytdXTtyZXR1cm4gcn12YXIga2U9dm9pZCAwO2Z1bmN0aW9uIFBlKGUpe3Rocm93IG5ldyBrZShlKX1mdW5jdGlvbiBUZShlLHIsdD17fSl7aWYoISgiYXJnUGFja0FkdmFuY2UiaW4gcikpdGhyb3cgbmV3IFR5cGVFcnJvcigicmVnaXN0ZXJUeXBlIHJlZ2lzdGVyZWRJbnN0YW5jZSByZXF1aXJlcyBhcmdQYWNrQWR2YW5jZSIpO3ZhciBuPXIubmFtZTtpZihlfHxQZSgndHlwZSAiJytuKyciIG11c3QgaGF2ZSBhIHBvc2l0aXZlIGludGVnZXIgdHlwZWlkIHBvaW50ZXInKSxmZS5oYXNPd25Qcm9wZXJ0eShlKSl7aWYodC5pZ25vcmVEdXBsaWNhdGVSZWdpc3RyYXRpb25zKXJldHVybjtQZSgiQ2Fubm90IHJlZ2lzdGVyIHR5cGUgJyIrbisiJyB0d2ljZSIpfWlmKGZlW2VdPXIsZGVsZXRlIHBlW2VdLGRlLmhhc093blByb3BlcnR5KGUpKXt2YXIgbz1kZVtlXTtkZWxldGUgZGVbZV0sby5mb3JFYWNoKChlPT5lKCkpKX19ZnVuY3Rpb24gU2UoZSl7UGUoZS4kJC5wdHJUeXBlLnJlZ2lzdGVyZWRDbGFzcy5uYW1lKyIgaW5zdGFuY2UgYWxyZWFkeSBkZWxldGVkIil9dmFyIENlPSExO2Z1bmN0aW9uIERlKGUpe31mdW5jdGlvbiBGZShlKXtlLmNvdW50LnZhbHVlLT0xLDA9PT1lLmNvdW50LnZhbHVlJiZmdW5jdGlvbihlKXtlLnNtYXJ0UHRyP2Uuc21hcnRQdHJUeXBlLnJhd0Rlc3RydWN0b3IoZS5zbWFydFB0cik6ZS5wdHJUeXBlLnJlZ2lzdGVyZWRDbGFzcy5yYXdEZXN0cnVjdG9yKGUucHRyKX0oZSl9ZnVuY3Rpb24gQWUoZSxyLHQpe2lmKHI9PT10KXJldHVybiBlO2lmKHZvaWQgMD09PXQuYmFzZUNsYXNzKXJldHVybiBudWxsO3ZhciBuPUFlKGUscix0LmJhc2VDbGFzcyk7cmV0dXJuIG51bGw9PT1uP251bGw6dC5kb3duY2FzdChuKX12YXIgTWU9e307dmFyICRlPVtdO2Z1bmN0aW9uIHhlKCl7Zm9yKDskZS5sZW5ndGg7KXt2YXIgZT0kZS5wb3AoKTtlLiQkLmRlbGV0ZVNjaGVkdWxlZD0hMSxlLmRlbGV0ZSgpfX12YXIgT2U9dm9pZCAwO3ZhciBSZT17fTtmdW5jdGlvbiBqZShlLHIpe3JldHVybiByLnB0clR5cGUmJnIucHRyfHx3ZSgibWFrZUNsYXNzSGFuZGxlIHJlcXVpcmVzIHB0ciBhbmQgcHRyVHlwZSIpLCEhci5zbWFydFB0clR5cGUhPSEhci5zbWFydFB0ciYmd2UoIkJvdGggc21hcnRQdHJUeXBlIGFuZCBzbWFydFB0ciBtdXN0IGJlIHNwZWNpZmllZCIpLHIuY291bnQ9e3ZhbHVlOjF9LEllKE9iamVjdC5jcmVhdGUoZSx7JCQ6e3ZhbHVlOnJ9fSkpfWZ1bmN0aW9uIEllKGUpe3JldHVybiJ1bmRlZmluZWQiPT10eXBlb2YgRmluYWxpemF0aW9uUmVnaXN0cnk/KEllPWU9PmUsZSk6KENlPW5ldyBGaW5hbGl6YXRpb25SZWdpc3RyeSgoZT0+e0ZlKGUuJCQpfSkpLEllPWU9Pnt2YXIgcj1lLiQkO2lmKHIuc21hcnRQdHIpe3ZhciB0PXskJDpyfTtDZS5yZWdpc3RlcihlLHQsZSl9cmV0dXJuIGV9LERlPWU9PkNlLnVucmVnaXN0ZXIoZSksSWUoZSkpfWZ1bmN0aW9uIHplKCl7fWZ1bmN0aW9uIEJlKGUscix0KXtpZih2b2lkIDA9PT1lW3JdLm92ZXJsb2FkVGFibGUpe3ZhciBuPWVbcl07ZVtyXT1mdW5jdGlvbigpe3JldHVybiBlW3JdLm92ZXJsb2FkVGFibGUuaGFzT3duUHJvcGVydHkoYXJndW1lbnRzLmxlbmd0aCl8fFBlKCJGdW5jdGlvbiAnIit0KyInIGNhbGxlZCB3aXRoIGFuIGludmFsaWQgbnVtYmVyIG9mIGFyZ3VtZW50cyAoIithcmd1bWVudHMubGVuZ3RoKyIpIC0gZXhwZWN0cyBvbmUgb2YgKCIrZVtyXS5vdmVybG9hZFRhYmxlKyIpISIpLGVbcl0ub3ZlcmxvYWRUYWJsZVthcmd1bWVudHMubGVuZ3RoXS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGVbcl0ub3ZlcmxvYWRUYWJsZT1bXSxlW3JdLm92ZXJsb2FkVGFibGVbbi5hcmdDb3VudF09bn19ZnVuY3Rpb24gV2Uocix0LG4pe2UuaGFzT3duUHJvcGVydHkocik/KCh2b2lkIDA9PT1ufHx2b2lkIDAhPT1lW3JdLm92ZXJsb2FkVGFibGUmJnZvaWQgMCE9PWVbcl0ub3ZlcmxvYWRUYWJsZVtuXSkmJlBlKCJDYW5ub3QgcmVnaXN0ZXIgcHVibGljIG5hbWUgJyIrcisiJyB0d2ljZSIpLEJlKGUscixyKSxlLmhhc093blByb3BlcnR5KG4pJiZQZSgiQ2Fubm90IHJlZ2lzdGVyIG11bHRpcGxlIG92ZXJsb2FkcyBvZiBhIGZ1bmN0aW9uIHdpdGggdGhlIHNhbWUgbnVtYmVyIG9mIGFyZ3VtZW50cyAoIituKyIpISIpLGVbcl0ub3ZlcmxvYWRUYWJsZVtuXT10KTooZVtyXT10LHZvaWQgMCE9PW4mJihlW3JdLm51bUFyZ3VtZW50cz1uKSl9ZnVuY3Rpb24gTmUoZSxyLHQsbixvLGEsaSxzKXt0aGlzLm5hbWU9ZSx0aGlzLmNvbnN0cnVjdG9yPXIsdGhpcy5pbnN0YW5jZVByb3RvdHlwZT10LHRoaXMucmF3RGVzdHJ1Y3Rvcj1uLHRoaXMuYmFzZUNsYXNzPW8sdGhpcy5nZXRBY3R1YWxUeXBlPWEsdGhpcy51cGNhc3Q9aSx0aGlzLmRvd25jYXN0PXMsdGhpcy5wdXJlVmlydHVhbEZ1bmN0aW9ucz1bXX1mdW5jdGlvbiBMZShlLHIsdCl7Zm9yKDtyIT09dDspci51cGNhc3R8fFBlKCJFeHBlY3RlZCBudWxsIG9yIGluc3RhbmNlIG9mICIrdC5uYW1lKyIsIGdvdCBhbiBpbnN0YW5jZSBvZiAiK3IubmFtZSksZT1yLnVwY2FzdChlKSxyPXIuYmFzZUNsYXNzO3JldHVybiBlfWZ1bmN0aW9uIFVlKGUscil7aWYobnVsbD09PXIpcmV0dXJuIHRoaXMuaXNSZWZlcmVuY2UmJlBlKCJudWxsIGlzIG5vdCBhIHZhbGlkICIrdGhpcy5uYW1lKSwwO3IuJCR8fFBlKCdDYW5ub3QgcGFzcyAiJyt1cihyKSsnIiBhcyBhICcrdGhpcy5uYW1lKSxyLiQkLnB0cnx8UGUoIkNhbm5vdCBwYXNzIGRlbGV0ZWQgb2JqZWN0IGFzIGEgcG9pbnRlciBvZiB0eXBlICIrdGhpcy5uYW1lKTt2YXIgdD1yLiQkLnB0clR5cGUucmVnaXN0ZXJlZENsYXNzO3JldHVybiBMZShyLiQkLnB0cix0LHRoaXMucmVnaXN0ZXJlZENsYXNzKX1mdW5jdGlvbiBIZShlLHIpe3ZhciB0O2lmKG51bGw9PT1yKXJldHVybiB0aGlzLmlzUmVmZXJlbmNlJiZQZSgibnVsbCBpcyBub3QgYSB2YWxpZCAiK3RoaXMubmFtZSksdGhpcy5pc1NtYXJ0UG9pbnRlcj8odD10aGlzLnJhd0NvbnN0cnVjdG9yKCksbnVsbCE9PWUmJmUucHVzaCh0aGlzLnJhd0Rlc3RydWN0b3IsdCksdCk6MDtyLiQkfHxQZSgnQ2Fubm90IHBhc3MgIicrdXIocikrJyIgYXMgYSAnK3RoaXMubmFtZSksci4kJC5wdHJ8fFBlKCJDYW5ub3QgcGFzcyBkZWxldGVkIG9iamVjdCBhcyBhIHBvaW50ZXIgb2YgdHlwZSAiK3RoaXMubmFtZSksIXRoaXMuaXNDb25zdCYmci4kJC5wdHJUeXBlLmlzQ29uc3QmJlBlKCJDYW5ub3QgY29udmVydCBhcmd1bWVudCBvZiB0eXBlICIrKHIuJCQuc21hcnRQdHJUeXBlP3IuJCQuc21hcnRQdHJUeXBlLm5hbWU6ci4kJC5wdHJUeXBlLm5hbWUpKyIgdG8gcGFyYW1ldGVyIHR5cGUgIit0aGlzLm5hbWUpO3ZhciBuPXIuJCQucHRyVHlwZS5yZWdpc3RlcmVkQ2xhc3M7aWYodD1MZShyLiQkLnB0cixuLHRoaXMucmVnaXN0ZXJlZENsYXNzKSx0aGlzLmlzU21hcnRQb2ludGVyKXN3aXRjaCh2b2lkIDA9PT1yLiQkLnNtYXJ0UHRyJiZQZSgiUGFzc2luZyByYXcgcG9pbnRlciB0byBzbWFydCBwb2ludGVyIGlzIGlsbGVnYWwiKSx0aGlzLnNoYXJpbmdQb2xpY3kpe2Nhc2UgMDpyLiQkLnNtYXJ0UHRyVHlwZT09PXRoaXM/dD1yLiQkLnNtYXJ0UHRyOlBlKCJDYW5ub3QgY29udmVydCBhcmd1bWVudCBvZiB0eXBlICIrKHIuJCQuc21hcnRQdHJUeXBlP3IuJCQuc21hcnRQdHJUeXBlLm5hbWU6ci4kJC5wdHJUeXBlLm5hbWUpKyIgdG8gcGFyYW1ldGVyIHR5cGUgIit0aGlzLm5hbWUpO2JyZWFrO2Nhc2UgMTp0PXIuJCQuc21hcnRQdHI7YnJlYWs7Y2FzZSAyOmlmKHIuJCQuc21hcnRQdHJUeXBlPT09dGhpcyl0PXIuJCQuc21hcnRQdHI7ZWxzZXt2YXIgbz1yLmNsb25lKCk7dD10aGlzLnJhd1NoYXJlKHQsYXIudG9IYW5kbGUoKGZ1bmN0aW9uKCl7by5kZWxldGUoKX0pKSksbnVsbCE9PWUmJmUucHVzaCh0aGlzLnJhd0Rlc3RydWN0b3IsdCl9YnJlYWs7ZGVmYXVsdDpQZSgiVW5zdXBwb3J0aW5nIHNoYXJpbmcgcG9saWN5Iil9cmV0dXJuIHR9ZnVuY3Rpb24gVmUoZSxyKXtpZihudWxsPT09cilyZXR1cm4gdGhpcy5pc1JlZmVyZW5jZSYmUGUoIm51bGwgaXMgbm90IGEgdmFsaWQgIit0aGlzLm5hbWUpLDA7ci4kJHx8UGUoJ0Nhbm5vdCBwYXNzICInK3VyKHIpKyciIGFzIGEgJyt0aGlzLm5hbWUpLHIuJCQucHRyfHxQZSgiQ2Fubm90IHBhc3MgZGVsZXRlZCBvYmplY3QgYXMgYSBwb2ludGVyIG9mIHR5cGUgIit0aGlzLm5hbWUpLHIuJCQucHRyVHlwZS5pc0NvbnN0JiZQZSgiQ2Fubm90IGNvbnZlcnQgYXJndW1lbnQgb2YgdHlwZSAiK3IuJCQucHRyVHlwZS5uYW1lKyIgdG8gcGFyYW1ldGVyIHR5cGUgIit0aGlzLm5hbWUpO3ZhciB0PXIuJCQucHRyVHlwZS5yZWdpc3RlcmVkQ2xhc3M7cmV0dXJuIExlKHIuJCQucHRyLHQsdGhpcy5yZWdpc3RlcmVkQ2xhc3MpfWZ1bmN0aW9uIFllKGUscix0LG4sbyxhLGkscyx1LGMsbCl7dGhpcy5uYW1lPWUsdGhpcy5yZWdpc3RlcmVkQ2xhc3M9cix0aGlzLmlzUmVmZXJlbmNlPXQsdGhpcy5pc0NvbnN0PW4sdGhpcy5pc1NtYXJ0UG9pbnRlcj1vLHRoaXMucG9pbnRlZVR5cGU9YSx0aGlzLnNoYXJpbmdQb2xpY3k9aSx0aGlzLnJhd0dldFBvaW50ZWU9cyx0aGlzLnJhd0NvbnN0cnVjdG9yPXUsdGhpcy5yYXdTaGFyZT1jLHRoaXMucmF3RGVzdHJ1Y3Rvcj1sLG98fHZvaWQgMCE9PXIuYmFzZUNsYXNzP3RoaXMudG9XaXJlVHlwZT1IZTpuPyh0aGlzLnRvV2lyZVR5cGU9VWUsdGhpcy5kZXN0cnVjdG9yRnVuY3Rpb249bnVsbCk6KHRoaXMudG9XaXJlVHlwZT1WZSx0aGlzLmRlc3RydWN0b3JGdW5jdGlvbj1udWxsKX1mdW5jdGlvbiBxZShyLHQsbil7ZS5oYXNPd25Qcm9wZXJ0eShyKXx8d2UoIlJlcGxhY2luZyBub25leGlzdGFudCBwdWJsaWMgc3ltYm9sIiksdm9pZCAwIT09ZVtyXS5vdmVybG9hZFRhYmxlJiZ2b2lkIDAhPT1uP2Vbcl0ub3ZlcmxvYWRUYWJsZVtuXT10OihlW3JdPXQsZVtyXS5hcmdDb3VudD1uKX1mdW5jdGlvbiBHZShyLHQsbil7cmV0dXJuIHIuaW5jbHVkZXMoImoiKT9mdW5jdGlvbihyLHQsbil7dmFyIG89ZVsiZHluQ2FsbF8iK3JdO3JldHVybiBuJiZuLmxlbmd0aD9vLmFwcGx5KG51bGwsW3RdLmNvbmNhdChuKSk6by5jYWxsKG51bGwsdCl9KHIsdCxuKTpyZSh0KS5hcHBseShudWxsLG4pfWZ1bmN0aW9uIFhlKGUscil7dmFyIHQsbixvLGE9KGU9YmUoZSkpLmluY2x1ZGVzKCJqIik/KHQ9ZSxuPXIsbz1bXSxmdW5jdGlvbigpe3JldHVybiBvLmxlbmd0aD0wLE9iamVjdC5hc3NpZ24obyxhcmd1bWVudHMpLEdlKHQsbixvKX0pOnJlKHIpO3JldHVybiJmdW5jdGlvbiIhPXR5cGVvZiBhJiZQZSgidW5rbm93biBmdW5jdGlvbiBwb2ludGVyIHdpdGggc2lnbmF0dXJlICIrZSsiOiAiK3IpLGF9dmFyIEplPXZvaWQgMDtmdW5jdGlvbiBRZShlKXt2YXIgcj1PcihlKSx0PWJlKHIpO3JldHVybiB4cihyKSx0fWZ1bmN0aW9uIEtlKGUscil7dmFyIHQ9W10sbj17fTt0aHJvdyByLmZvckVhY2goKGZ1bmN0aW9uIGUocil7bltyXXx8ZmVbcl18fChwZVtyXT9wZVtyXS5mb3JFYWNoKGUpOih0LnB1c2gociksbltyXT0hMCkpfSkpLG5ldyBKZShlKyI6ICIrdC5tYXAoUWUpLmpvaW4oWyIsICJdKSl9ZnVuY3Rpb24gWmUoZSxyKXtpZighKGUgaW5zdGFuY2VvZiBGdW5jdGlvbikpdGhyb3cgbmV3IFR5cGVFcnJvcigibmV3XyBjYWxsZWQgd2l0aCBjb25zdHJ1Y3RvciB0eXBlICIrdHlwZW9mIGUrIiB3aGljaCBpcyBub3QgYSBmdW5jdGlvbiIpO3ZhciB0PW1lKGUubmFtZXx8InVua25vd25GdW5jdGlvbk5hbWUiLChmdW5jdGlvbigpe30pKTt0LnByb3RvdHlwZT1lLnByb3RvdHlwZTt2YXIgbj1uZXcgdCxvPWUuYXBwbHkobixyKTtyZXR1cm4gbyBpbnN0YW5jZW9mIE9iamVjdD9vOm59ZnVuY3Rpb24gZXIoZSxyLHQsbixvKXt2YXIgYT1yLmxlbmd0aDthPDImJlBlKCJhcmdUeXBlcyBhcnJheSBzaXplIG1pc21hdGNoISBNdXN0IGF0IGxlYXN0IGdldCByZXR1cm4gdmFsdWUgYW5kICd0aGlzJyB0eXBlcyEiKTtmb3IodmFyIGk9bnVsbCE9PXJbMV0mJm51bGwhPT10LHM9ITEsdT0xO3U8ci5sZW5ndGg7Kyt1KWlmKG51bGwhPT1yW3VdJiZ2b2lkIDA9PT1yW3VdLmRlc3RydWN0b3JGdW5jdGlvbil7cz0hMDticmVha312YXIgYz0idm9pZCIhPT1yWzBdLm5hbWUsbD0iIixkPSIiO2Zvcih1PTA7dTxhLTI7Kyt1KWwrPSgwIT09dT8iLCAiOiIiKSsiYXJnIit1LGQrPSgwIT09dT8iLCAiOiIiKSsiYXJnIit1KyJXaXJlZCI7dmFyIGY9InJldHVybiBmdW5jdGlvbiAiK2hlKGUpKyIoIitsKyIpIHtcbmlmIChhcmd1bWVudHMubGVuZ3RoICE9PSAiKyhhLTIpKyIpIHtcbnRocm93QmluZGluZ0Vycm9yKCdmdW5jdGlvbiAiK2UrIiBjYWxsZWQgd2l0aCAnICsgYXJndW1lbnRzLmxlbmd0aCArICcgYXJndW1lbnRzLCBleHBlY3RlZCAiKyhhLTIpKyIgYXJncyEnKTtcbn1cbiI7cyYmKGYrPSJ2YXIgZGVzdHJ1Y3RvcnMgPSBbXTtcbiIpO3ZhciBwPXM/ImRlc3RydWN0b3JzIjoibnVsbCIsaD1bInRocm93QmluZGluZ0Vycm9yIiwiaW52b2tlciIsImZuIiwicnVuRGVzdHJ1Y3RvcnMiLCJyZXRUeXBlIiwiY2xhc3NQYXJhbSJdLG09W1BlLG4sbyxjZSxyWzBdLHJbMV1dO2ZvcihpJiYoZis9InZhciB0aGlzV2lyZWQgPSBjbGFzc1BhcmFtLnRvV2lyZVR5cGUoIitwKyIsIHRoaXMpO1xuIiksdT0wO3U8YS0yOysrdSlmKz0idmFyIGFyZyIrdSsiV2lyZWQgPSBhcmdUeXBlIit1KyIudG9XaXJlVHlwZSgiK3ArIiwgYXJnIit1KyIpOyAvLyAiK3JbdSsyXS5uYW1lKyJcbiIsaC5wdXNoKCJhcmdUeXBlIit1KSxtLnB1c2goclt1KzJdKTtpZihpJiYoZD0idGhpc1dpcmVkIisoZC5sZW5ndGg+MD8iLCAiOiIiKStkKSxmKz0oYz8idmFyIHJ2ID0gIjoiIikrImludm9rZXIoZm4iKyhkLmxlbmd0aD4wPyIsICI6IiIpK2QrIik7XG4iLHMpZis9InJ1bkRlc3RydWN0b3JzKGRlc3RydWN0b3JzKTtcbiI7ZWxzZSBmb3IodT1pPzE6Mjt1PHIubGVuZ3RoOysrdSl7dmFyIHY9MT09PXU/InRoaXNXaXJlZCI6ImFyZyIrKHUtMikrIldpcmVkIjtudWxsIT09clt1XS5kZXN0cnVjdG9yRnVuY3Rpb24mJihmKz12KyJfZHRvcigiK3YrIik7IC8vICIrclt1XS5uYW1lKyJcbiIsaC5wdXNoKHYrIl9kdG9yIiksbS5wdXNoKHJbdV0uZGVzdHJ1Y3RvckZ1bmN0aW9uKSl9cmV0dXJuIGMmJihmKz0idmFyIHJldCA9IHJldFR5cGUuZnJvbVdpcmVUeXBlKHJ2KTtcbnJldHVybiByZXQ7XG4iKSxmKz0ifVxuIixoLnB1c2goZiksWmUoRnVuY3Rpb24saCkuYXBwbHkobnVsbCxtKX1mdW5jdGlvbiBycihlLHIpe2Zvcih2YXIgdD1bXSxuPTA7bjxlO24rKyl0LnB1c2goRFsocj4+Mikrbl0pO3JldHVybiB0fXZhciB0cj1bXSxucj1be30se3ZhbHVlOnZvaWQgMH0se3ZhbHVlOm51bGx9LHt2YWx1ZTohMH0se3ZhbHVlOiExfV07ZnVuY3Rpb24gb3IoZSl7ZT40JiYwPT0tLW5yW2VdLnJlZmNvdW50JiYobnJbZV09dm9pZCAwLHRyLnB1c2goZSkpfXZhciBhcj17dG9WYWx1ZTplPT4oZXx8UGUoIkNhbm5vdCB1c2UgZGVsZXRlZCB2YWwuIGhhbmRsZSA9ICIrZSksbnJbZV0udmFsdWUpLHRvSGFuZGxlOmU9Pntzd2l0Y2goZSl7Y2FzZSB2b2lkIDA6cmV0dXJuIDE7Y2FzZSBudWxsOnJldHVybiAyO2Nhc2UhMDpyZXR1cm4gMztjYXNlITE6cmV0dXJuIDQ7ZGVmYXVsdDp2YXIgcj10ci5sZW5ndGg/dHIucG9wKCk6bnIubGVuZ3RoO3JldHVybiBucltyXT17cmVmY291bnQ6MSx2YWx1ZTplfSxyfX19O2Z1bmN0aW9uIGlyKGUscix0KXtzd2l0Y2gocil7Y2FzZSAwOnJldHVybiBmdW5jdGlvbihlKXt2YXIgcj10P1A6VDtyZXR1cm4gdGhpcy5mcm9tV2lyZVR5cGUocltlXSl9O2Nhc2UgMTpyZXR1cm4gZnVuY3Rpb24oZSl7dmFyIHI9dD9TOkM7cmV0dXJuIHRoaXMuZnJvbVdpcmVUeXBlKHJbZT4+MV0pfTtjYXNlIDI6cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciByPXQ/RDpGO3JldHVybiB0aGlzLmZyb21XaXJlVHlwZShyW2U+PjJdKX07ZGVmYXVsdDp0aHJvdyBuZXcgVHlwZUVycm9yKCJVbmtub3duIGludGVnZXIgdHlwZTogIitlKX19ZnVuY3Rpb24gc3IoZSxyKXt2YXIgdD1mZVtlXTtyZXR1cm4gdm9pZCAwPT09dCYmUGUocisiIGhhcyB1bmtub3duIHR5cGUgIitRZShlKSksdH1mdW5jdGlvbiB1cihlKXtpZihudWxsPT09ZSlyZXR1cm4ibnVsbCI7dmFyIHI9dHlwZW9mIGU7cmV0dXJuIm9iamVjdCI9PT1yfHwiYXJyYXkiPT09cnx8ImZ1bmN0aW9uIj09PXI/ZS50b1N0cmluZygpOiIiK2V9ZnVuY3Rpb24gY3IoZSxyKXtzd2l0Y2gocil7Y2FzZSAyOnJldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5mcm9tV2lyZVR5cGUoQVtlPj4yXSl9O2Nhc2UgMzpyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZnJvbVdpcmVUeXBlKE1bZT4+M10pfTtkZWZhdWx0OnRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gZmxvYXQgdHlwZTogIitlKX19ZnVuY3Rpb24gbHIoZSxyLHQpe3N3aXRjaChyKXtjYXNlIDA6cmV0dXJuIHQ/ZnVuY3Rpb24oZSl7cmV0dXJuIFBbZV19OmZ1bmN0aW9uKGUpe3JldHVybiBUW2VdfTtjYXNlIDE6cmV0dXJuIHQ/ZnVuY3Rpb24oZSl7cmV0dXJuIFNbZT4+MV19OmZ1bmN0aW9uKGUpe3JldHVybiBDW2U+PjFdfTtjYXNlIDI6cmV0dXJuIHQ/ZnVuY3Rpb24oZSl7cmV0dXJuIERbZT4+Ml19OmZ1bmN0aW9uKGUpe3JldHVybiBGW2U+PjJdfTtkZWZhdWx0OnRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gaW50ZWdlciB0eXBlOiAiK2UpfX12YXIgZHI9e307ZnVuY3Rpb24gZnIoZSl7dmFyIHI9ZHJbZV07cmV0dXJuIHZvaWQgMD09PXI/YmUoZSk6cn12YXIgcHIsaHI9W10sbXI9W107cHI9KCk9PnBlcmZvcm1hbmNlLm5vdygpO3ZhciB2cj17fTtmdW5jdGlvbiB5cigpe2lmKCF5ci5zdHJpbmdzKXt2YXIgZT17VVNFUjoid2ViX3VzZXIiLExPR05BTUU6IndlYl91c2VyIixQQVRIOiIvIixQV0Q6Ii8iLEhPTUU6Ii9ob21lL3dlYl91c2VyIixMQU5HOigib2JqZWN0Ij09dHlwZW9mIG5hdmlnYXRvciYmbmF2aWdhdG9yLmxhbmd1YWdlcyYmbmF2aWdhdG9yLmxhbmd1YWdlc1swXXx8IkMiKS5yZXBsYWNlKCItIiwiXyIpKyIuVVRGLTgiLF86dXx8Ii4vdGhpcy5wcm9ncmFtIn07Zm9yKHZhciByIGluIHZyKXZvaWQgMD09PXZyW3JdP2RlbGV0ZSBlW3JdOmVbcl09dnJbcl07dmFyIHQ9W107Zm9yKHZhciByIGluIGUpdC5wdXNoKHIrIj0iK2Vbcl0pO3lyLnN0cmluZ3M9dH1yZXR1cm4geXIuc3RyaW5nc312YXIgd3I9e2lzQWJzOmU9PiIvIj09PWUuY2hhckF0KDApLHNwbGl0UGF0aDplPT4vXihcLz98KShbXHNcU10qPykoKD86XC57MSwyfXxbXlwvXSs/fCkoXC5bXi5cL10qfCkpKD86W1wvXSopJC8uZXhlYyhlKS5zbGljZSgxKSxub3JtYWxpemVBcnJheTooZSxyKT0+e2Zvcih2YXIgdD0wLG49ZS5sZW5ndGgtMTtuPj0wO24tLSl7dmFyIG89ZVtuXTsiLiI9PT1vP2Uuc3BsaWNlKG4sMSk6Ii4uIj09PW8/KGUuc3BsaWNlKG4sMSksdCsrKTp0JiYoZS5zcGxpY2UobiwxKSx0LS0pfWlmKHIpZm9yKDt0O3QtLSllLnVuc2hpZnQoIi4uIik7cmV0dXJuIGV9LG5vcm1hbGl6ZTplPT57dmFyIHI9d3IuaXNBYnMoZSksdD0iLyI9PT1lLnN1YnN0cigtMSk7cmV0dXJuKGU9d3Iubm9ybWFsaXplQXJyYXkoZS5zcGxpdCgiLyIpLmZpbHRlcigoZT0+ISFlKSksIXIpLmpvaW4oIi8iKSl8fHJ8fChlPSIuIiksZSYmdCYmKGUrPSIvIiksKHI/Ii8iOiIiKStlfSxkaXJuYW1lOmU9Pnt2YXIgcj13ci5zcGxpdFBhdGgoZSksdD1yWzBdLG49clsxXTtyZXR1cm4gdHx8bj8obiYmKG49bi5zdWJzdHIoMCxuLmxlbmd0aC0xKSksdCtuKToiLiJ9LGJhc2VuYW1lOmU9PntpZigiLyI9PT1lKXJldHVybiIvIjt2YXIgcj0oZT0oZT13ci5ub3JtYWxpemUoZSkpLnJlcGxhY2UoL1wvJC8sIiIpKS5sYXN0SW5kZXhPZigiLyIpO3JldHVybi0xPT09cj9lOmUuc3Vic3RyKHIrMSl9LGpvaW46ZnVuY3Rpb24oKXt2YXIgZT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCk7cmV0dXJuIHdyLm5vcm1hbGl6ZShlLmpvaW4oIi8iKSl9LGpvaW4yOihlLHIpPT53ci5ub3JtYWxpemUoZSsiLyIrcil9LGdyPXtyZXNvbHZlOmZ1bmN0aW9uKCl7Zm9yKHZhciBlPSIiLHI9ITEsdD1hcmd1bWVudHMubGVuZ3RoLTE7dD49LTEmJiFyO3QtLSl7dmFyIG49dD49MD9hcmd1bWVudHNbdF06YnIuY3dkKCk7aWYoInN0cmluZyIhPXR5cGVvZiBuKXRocm93IG5ldyBUeXBlRXJyb3IoIkFyZ3VtZW50cyB0byBwYXRoLnJlc29sdmUgbXVzdCBiZSBzdHJpbmdzIik7aWYoIW4pcmV0dXJuIiI7ZT1uKyIvIitlLHI9d3IuaXNBYnMobil9cmV0dXJuKHI/Ii8iOiIiKSsoZT13ci5ub3JtYWxpemVBcnJheShlLnNwbGl0KCIvIikuZmlsdGVyKChlPT4hIWUpKSwhcikuam9pbigiLyIpKXx8Ii4ifSxyZWxhdGl2ZTooZSxyKT0+e2Z1bmN0aW9uIHQoZSl7Zm9yKHZhciByPTA7cjxlLmxlbmd0aCYmIiI9PT1lW3JdO3IrKyk7Zm9yKHZhciB0PWUubGVuZ3RoLTE7dD49MCYmIiI9PT1lW3RdO3QtLSk7cmV0dXJuIHI+dD9bXTplLnNsaWNlKHIsdC1yKzEpfWU9Z3IucmVzb2x2ZShlKS5zdWJzdHIoMSkscj1nci5yZXNvbHZlKHIpLnN1YnN0cigxKTtmb3IodmFyIG49dChlLnNwbGl0KCIvIikpLG89dChyLnNwbGl0KCIvIikpLGE9TWF0aC5taW4obi5sZW5ndGgsby5sZW5ndGgpLGk9YSxzPTA7czxhO3MrKylpZihuW3NdIT09b1tzXSl7aT1zO2JyZWFrfXZhciB1PVtdO2ZvcihzPWk7czxuLmxlbmd0aDtzKyspdS5wdXNoKCIuLiIpO3JldHVybih1PXUuY29uY2F0KG8uc2xpY2UoaSkpKS5qb2luKCIvIil9fSxFcj17dHR5czpbXSxpbml0OmZ1bmN0aW9uKCl7fSxzaHV0ZG93bjpmdW5jdGlvbigpe30scmVnaXN0ZXI6ZnVuY3Rpb24oZSxyKXtFci50dHlzW2VdPXtpbnB1dDpbXSxvdXRwdXQ6W10sb3BzOnJ9LGJyLnJlZ2lzdGVyRGV2aWNlKGUsRXIuc3RyZWFtX29wcyl9LHN0cmVhbV9vcHM6e29wZW46ZnVuY3Rpb24oZSl7dmFyIHI9RXIudHR5c1tlLm5vZGUucmRldl07aWYoIXIpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNDMpO2UudHR5PXIsZS5zZWVrYWJsZT0hMX0sY2xvc2U6ZnVuY3Rpb24oZSl7ZS50dHkub3BzLmZsdXNoKGUudHR5KX0sZmx1c2g6ZnVuY3Rpb24oZSl7ZS50dHkub3BzLmZsdXNoKGUudHR5KX0scmVhZDpmdW5jdGlvbihlLHIsdCxuLG8pe2lmKCFlLnR0eXx8IWUudHR5Lm9wcy5nZXRfY2hhcil0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig2MCk7Zm9yKHZhciBhPTAsaT0wO2k8bjtpKyspe3ZhciBzO3RyeXtzPWUudHR5Lm9wcy5nZXRfY2hhcihlLnR0eSl9Y2F0Y2goZSl7dGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoMjkpfWlmKHZvaWQgMD09PXMmJjA9PT1hKXRocm93IG5ldyBici5FcnJub0Vycm9yKDYpO2lmKG51bGw9PXMpYnJlYWs7YSsrLHJbdCtpXT1zfXJldHVybiBhJiYoZS5ub2RlLnRpbWVzdGFtcD1EYXRlLm5vdygpKSxhfSx3cml0ZTpmdW5jdGlvbihlLHIsdCxuLG8pe2lmKCFlLnR0eXx8IWUudHR5Lm9wcy5wdXRfY2hhcil0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig2MCk7dHJ5e2Zvcih2YXIgYT0wO2E8bjthKyspZS50dHkub3BzLnB1dF9jaGFyKGUudHR5LHJbdCthXSl9Y2F0Y2goZSl7dGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoMjkpfXJldHVybiBuJiYoZS5ub2RlLnRpbWVzdGFtcD1EYXRlLm5vdygpKSxhfX0sZGVmYXVsdF90dHlfb3BzOntnZXRfY2hhcjpmdW5jdGlvbihlKXtpZighZS5pbnB1dC5sZW5ndGgpe3ZhciByPW51bGw7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cmJiJmdW5jdGlvbiI9PXR5cGVvZiB3aW5kb3cucHJvbXB0P251bGwhPT0ocj13aW5kb3cucHJvbXB0KCJJbnB1dDogIikpJiYocis9IlxuIik6ImZ1bmN0aW9uIj09dHlwZW9mIHJlYWRsaW5lJiZudWxsIT09KHI9cmVhZGxpbmUoKSkmJihyKz0iXG4iKSwhcilyZXR1cm4gbnVsbDtlLmlucHV0PURyKHIsITApfXJldHVybiBlLmlucHV0LnNoaWZ0KCl9LHB1dF9jaGFyOmZ1bmN0aW9uKGUscil7bnVsbD09PXJ8fDEwPT09cj8obCh3KGUub3V0cHV0LDApKSxlLm91dHB1dD1bXSk6MCE9ciYmZS5vdXRwdXQucHVzaChyKX0sZmx1c2g6ZnVuY3Rpb24oZSl7ZS5vdXRwdXQmJmUub3V0cHV0Lmxlbmd0aD4wJiYobCh3KGUub3V0cHV0LDApKSxlLm91dHB1dD1bXSl9fSxkZWZhdWx0X3R0eTFfb3BzOntwdXRfY2hhcjpmdW5jdGlvbihlLHIpe251bGw9PT1yfHwxMD09PXI/KGQodyhlLm91dHB1dCwwKSksZS5vdXRwdXQ9W10pOjAhPXImJmUub3V0cHV0LnB1c2gocil9LGZsdXNoOmZ1bmN0aW9uKGUpe2Uub3V0cHV0JiZlLm91dHB1dC5sZW5ndGg+MCYmKGQodyhlLm91dHB1dCwwKSksZS5vdXRwdXQ9W10pfX19O3ZhciBfcj17b3BzX3RhYmxlOm51bGwsbW91bnQ6ZnVuY3Rpb24oZSl7cmV0dXJuIF9yLmNyZWF0ZU5vZGUobnVsbCwiLyIsMTY4OTUsMCl9LGNyZWF0ZU5vZGU6ZnVuY3Rpb24oZSxyLHQsbil7aWYoYnIuaXNCbGtkZXYodCl8fGJyLmlzRklGTyh0KSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig2Myk7X3Iub3BzX3RhYmxlfHwoX3Iub3BzX3RhYmxlPXtkaXI6e25vZGU6e2dldGF0dHI6X3Iubm9kZV9vcHMuZ2V0YXR0cixzZXRhdHRyOl9yLm5vZGVfb3BzLnNldGF0dHIsbG9va3VwOl9yLm5vZGVfb3BzLmxvb2t1cCxta25vZDpfci5ub2RlX29wcy5ta25vZCxyZW5hbWU6X3Iubm9kZV9vcHMucmVuYW1lLHVubGluazpfci5ub2RlX29wcy51bmxpbmsscm1kaXI6X3Iubm9kZV9vcHMucm1kaXIscmVhZGRpcjpfci5ub2RlX29wcy5yZWFkZGlyLHN5bWxpbms6X3Iubm9kZV9vcHMuc3ltbGlua30sc3RyZWFtOntsbHNlZWs6X3Iuc3RyZWFtX29wcy5sbHNlZWt9fSxmaWxlOntub2RlOntnZXRhdHRyOl9yLm5vZGVfb3BzLmdldGF0dHIsc2V0YXR0cjpfci5ub2RlX29wcy5zZXRhdHRyfSxzdHJlYW06e2xsc2Vlazpfci5zdHJlYW1fb3BzLmxsc2VlayxyZWFkOl9yLnN0cmVhbV9vcHMucmVhZCx3cml0ZTpfci5zdHJlYW1fb3BzLndyaXRlLGFsbG9jYXRlOl9yLnN0cmVhbV9vcHMuYWxsb2NhdGUsbW1hcDpfci5zdHJlYW1fb3BzLm1tYXAsbXN5bmM6X3Iuc3RyZWFtX29wcy5tc3luY319LGxpbms6e25vZGU6e2dldGF0dHI6X3Iubm9kZV9vcHMuZ2V0YXR0cixzZXRhdHRyOl9yLm5vZGVfb3BzLnNldGF0dHIscmVhZGxpbms6X3Iubm9kZV9vcHMucmVhZGxpbmt9LHN0cmVhbTp7fX0sY2hyZGV2Ontub2RlOntnZXRhdHRyOl9yLm5vZGVfb3BzLmdldGF0dHIsc2V0YXR0cjpfci5ub2RlX29wcy5zZXRhdHRyfSxzdHJlYW06YnIuY2hyZGV2X3N0cmVhbV9vcHN9fSk7dmFyIG89YnIuY3JlYXRlTm9kZShlLHIsdCxuKTtyZXR1cm4gYnIuaXNEaXIoby5tb2RlKT8oby5ub2RlX29wcz1fci5vcHNfdGFibGUuZGlyLm5vZGUsby5zdHJlYW1fb3BzPV9yLm9wc190YWJsZS5kaXIuc3RyZWFtLG8uY29udGVudHM9e30pOmJyLmlzRmlsZShvLm1vZGUpPyhvLm5vZGVfb3BzPV9yLm9wc190YWJsZS5maWxlLm5vZGUsby5zdHJlYW1fb3BzPV9yLm9wc190YWJsZS5maWxlLnN0cmVhbSxvLnVzZWRCeXRlcz0wLG8uY29udGVudHM9bnVsbCk6YnIuaXNMaW5rKG8ubW9kZSk/KG8ubm9kZV9vcHM9X3Iub3BzX3RhYmxlLmxpbmsubm9kZSxvLnN0cmVhbV9vcHM9X3Iub3BzX3RhYmxlLmxpbmsuc3RyZWFtKTpici5pc0NocmRldihvLm1vZGUpJiYoby5ub2RlX29wcz1fci5vcHNfdGFibGUuY2hyZGV2Lm5vZGUsby5zdHJlYW1fb3BzPV9yLm9wc190YWJsZS5jaHJkZXYuc3RyZWFtKSxvLnRpbWVzdGFtcD1EYXRlLm5vdygpLGUmJihlLmNvbnRlbnRzW3JdPW8sZS50aW1lc3RhbXA9by50aW1lc3RhbXApLG99LGdldEZpbGVEYXRhQXNUeXBlZEFycmF5OmZ1bmN0aW9uKGUpe3JldHVybiBlLmNvbnRlbnRzP2UuY29udGVudHMuc3ViYXJyYXk/ZS5jb250ZW50cy5zdWJhcnJheSgwLGUudXNlZEJ5dGVzKTpuZXcgVWludDhBcnJheShlLmNvbnRlbnRzKTpuZXcgVWludDhBcnJheSgwKX0sZXhwYW5kRmlsZVN0b3JhZ2U6ZnVuY3Rpb24oZSxyKXt2YXIgdD1lLmNvbnRlbnRzP2UuY29udGVudHMubGVuZ3RoOjA7aWYoISh0Pj1yKSl7cj1NYXRoLm1heChyLHQqKHQ8MTA0ODU3Nj8yOjEuMTI1KT4+PjApLDAhPXQmJihyPU1hdGgubWF4KHIsMjU2KSk7dmFyIG49ZS5jb250ZW50cztlLmNvbnRlbnRzPW5ldyBVaW50OEFycmF5KHIpLGUudXNlZEJ5dGVzPjAmJmUuY29udGVudHMuc2V0KG4uc3ViYXJyYXkoMCxlLnVzZWRCeXRlcyksMCl9fSxyZXNpemVGaWxlU3RvcmFnZTpmdW5jdGlvbihlLHIpe2lmKGUudXNlZEJ5dGVzIT1yKWlmKDA9PXIpZS5jb250ZW50cz1udWxsLGUudXNlZEJ5dGVzPTA7ZWxzZXt2YXIgdD1lLmNvbnRlbnRzO2UuY29udGVudHM9bmV3IFVpbnQ4QXJyYXkociksdCYmZS5jb250ZW50cy5zZXQodC5zdWJhcnJheSgwLE1hdGgubWluKHIsZS51c2VkQnl0ZXMpKSksZS51c2VkQnl0ZXM9cn19LG5vZGVfb3BzOntnZXRhdHRyOmZ1bmN0aW9uKGUpe3ZhciByPXt9O3JldHVybiByLmRldj1ici5pc0NocmRldihlLm1vZGUpP2UuaWQ6MSxyLmlubz1lLmlkLHIubW9kZT1lLm1vZGUsci5ubGluaz0xLHIudWlkPTAsci5naWQ9MCxyLnJkZXY9ZS5yZGV2LGJyLmlzRGlyKGUubW9kZSk/ci5zaXplPTQwOTY6YnIuaXNGaWxlKGUubW9kZSk/ci5zaXplPWUudXNlZEJ5dGVzOmJyLmlzTGluayhlLm1vZGUpP3Iuc2l6ZT1lLmxpbmsubGVuZ3RoOnIuc2l6ZT0wLHIuYXRpbWU9bmV3IERhdGUoZS50aW1lc3RhbXApLHIubXRpbWU9bmV3IERhdGUoZS50aW1lc3RhbXApLHIuY3RpbWU9bmV3IERhdGUoZS50aW1lc3RhbXApLHIuYmxrc2l6ZT00MDk2LHIuYmxvY2tzPU1hdGguY2VpbChyLnNpemUvci5ibGtzaXplKSxyfSxzZXRhdHRyOmZ1bmN0aW9uKGUscil7dm9pZCAwIT09ci5tb2RlJiYoZS5tb2RlPXIubW9kZSksdm9pZCAwIT09ci50aW1lc3RhbXAmJihlLnRpbWVzdGFtcD1yLnRpbWVzdGFtcCksdm9pZCAwIT09ci5zaXplJiZfci5yZXNpemVGaWxlU3RvcmFnZShlLHIuc2l6ZSl9LGxvb2t1cDpmdW5jdGlvbihlLHIpe3Rocm93IGJyLmdlbmVyaWNFcnJvcnNbNDRdfSxta25vZDpmdW5jdGlvbihlLHIsdCxuKXtyZXR1cm4gX3IuY3JlYXRlTm9kZShlLHIsdCxuKX0scmVuYW1lOmZ1bmN0aW9uKGUscix0KXtpZihici5pc0RpcihlLm1vZGUpKXt2YXIgbjt0cnl7bj1ici5sb29rdXBOb2RlKHIsdCl9Y2F0Y2goZSl7fWlmKG4pZm9yKHZhciBvIGluIG4uY29udGVudHMpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNTUpfWRlbGV0ZSBlLnBhcmVudC5jb250ZW50c1tlLm5hbWVdLGUucGFyZW50LnRpbWVzdGFtcD1EYXRlLm5vdygpLGUubmFtZT10LHIuY29udGVudHNbdF09ZSxyLnRpbWVzdGFtcD1lLnBhcmVudC50aW1lc3RhbXAsZS5wYXJlbnQ9cn0sdW5saW5rOmZ1bmN0aW9uKGUscil7ZGVsZXRlIGUuY29udGVudHNbcl0sZS50aW1lc3RhbXA9RGF0ZS5ub3coKX0scm1kaXI6ZnVuY3Rpb24oZSxyKXt2YXIgdD1ici5sb29rdXBOb2RlKGUscik7Zm9yKHZhciBuIGluIHQuY29udGVudHMpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNTUpO2RlbGV0ZSBlLmNvbnRlbnRzW3JdLGUudGltZXN0YW1wPURhdGUubm93KCl9LHJlYWRkaXI6ZnVuY3Rpb24oZSl7dmFyIHI9WyIuIiwiLi4iXTtmb3IodmFyIHQgaW4gZS5jb250ZW50cyllLmNvbnRlbnRzLmhhc093blByb3BlcnR5KHQpJiZyLnB1c2godCk7cmV0dXJuIHJ9LHN5bWxpbms6ZnVuY3Rpb24oZSxyLHQpe3ZhciBuPV9yLmNyZWF0ZU5vZGUoZSxyLDQxNDcxLDApO3JldHVybiBuLmxpbms9dCxufSxyZWFkbGluazpmdW5jdGlvbihlKXtpZighYnIuaXNMaW5rKGUubW9kZSkpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoMjgpO3JldHVybiBlLmxpbmt9fSxzdHJlYW1fb3BzOntyZWFkOmZ1bmN0aW9uKGUscix0LG4sbyl7dmFyIGE9ZS5ub2RlLmNvbnRlbnRzO2lmKG8+PWUubm9kZS51c2VkQnl0ZXMpcmV0dXJuIDA7dmFyIGk9TWF0aC5taW4oZS5ub2RlLnVzZWRCeXRlcy1vLG4pO2lmKGk+OCYmYS5zdWJhcnJheSlyLnNldChhLnN1YmFycmF5KG8sbytpKSx0KTtlbHNlIGZvcih2YXIgcz0wO3M8aTtzKyspclt0K3NdPWFbbytzXTtyZXR1cm4gaX0sd3JpdGU6ZnVuY3Rpb24oZSxyLHQsbixvLGEpe2lmKCFuKXJldHVybiAwO3ZhciBpPWUubm9kZTtpZihpLnRpbWVzdGFtcD1EYXRlLm5vdygpLHIuc3ViYXJyYXkmJighaS5jb250ZW50c3x8aS5jb250ZW50cy5zdWJhcnJheSkpe2lmKGEpcmV0dXJuIGkuY29udGVudHM9ci5zdWJhcnJheSh0LHQrbiksaS51c2VkQnl0ZXM9bixuO2lmKDA9PT1pLnVzZWRCeXRlcyYmMD09PW8pcmV0dXJuIGkuY29udGVudHM9ci5zbGljZSh0LHQrbiksaS51c2VkQnl0ZXM9bixuO2lmKG8rbjw9aS51c2VkQnl0ZXMpcmV0dXJuIGkuY29udGVudHMuc2V0KHIuc3ViYXJyYXkodCx0K24pLG8pLG59aWYoX3IuZXhwYW5kRmlsZVN0b3JhZ2UoaSxvK24pLGkuY29udGVudHMuc3ViYXJyYXkmJnIuc3ViYXJyYXkpaS5jb250ZW50cy5zZXQoci5zdWJhcnJheSh0LHQrbiksbyk7ZWxzZSBmb3IodmFyIHM9MDtzPG47cysrKWkuY29udGVudHNbbytzXT1yW3Qrc107cmV0dXJuIGkudXNlZEJ5dGVzPU1hdGgubWF4KGkudXNlZEJ5dGVzLG8rbiksbn0sbGxzZWVrOmZ1bmN0aW9uKGUscix0KXt2YXIgbj1yO2lmKDE9PT10P24rPWUucG9zaXRpb246Mj09PXQmJmJyLmlzRmlsZShlLm5vZGUubW9kZSkmJihuKz1lLm5vZGUudXNlZEJ5dGVzKSxuPDApdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoMjgpO3JldHVybiBufSxhbGxvY2F0ZTpmdW5jdGlvbihlLHIsdCl7X3IuZXhwYW5kRmlsZVN0b3JhZ2UoZS5ub2RlLHIrdCksZS5ub2RlLnVzZWRCeXRlcz1NYXRoLm1heChlLm5vZGUudXNlZEJ5dGVzLHIrdCl9LG1tYXA6ZnVuY3Rpb24oZSxyLHQsbixvLGEpe2lmKDAhPT1yKXRocm93IG5ldyBici5FcnJub0Vycm9yKDI4KTtpZighYnIuaXNGaWxlKGUubm9kZS5tb2RlKSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig0Myk7dmFyIGkscyx1PWUubm9kZS5jb250ZW50cztpZigyJmF8fHUuYnVmZmVyIT09ayl7aWYoKG4+MHx8bit0PHUubGVuZ3RoKSYmKHU9dS5zdWJhcnJheT91LnN1YmFycmF5KG4sbit0KTpBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh1LG4sbit0KSkscz0hMCwhKGk9ZnVuY3Rpb24oZSl7ZT1mdW5jdGlvbihlLHIpe3JldHVybiA2NTUzNipNYXRoLmNlaWwoZS82NTUzNil9KGUpO3ZhciByPVJyKDY1NTM2LGUpO3JldHVybiByPyhmdW5jdGlvbihlLHIpe1QuZmlsbCgwLGUsZStyKX0ocixlKSxyKTowfSh0KSkpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNDgpO1Auc2V0KHUsaSl9ZWxzZSBzPSExLGk9dS5ieXRlT2Zmc2V0O3JldHVybntwdHI6aSxhbGxvY2F0ZWQ6c319LG1zeW5jOmZ1bmN0aW9uKGUscix0LG4sbyl7aWYoIWJyLmlzRmlsZShlLm5vZGUubW9kZSkpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNDMpO3JldHVybiAyJm98fF9yLnN0cmVhbV9vcHMud3JpdGUoZSxyLDAsbix0LCExKSwwfX19LGJyPXtyb290Om51bGwsbW91bnRzOltdLGRldmljZXM6e30sc3RyZWFtczpbXSxuZXh0SW5vZGU6MSxuYW1lVGFibGU6bnVsbCxjdXJyZW50UGF0aDoiLyIsaW5pdGlhbGl6ZWQ6ITEsaWdub3JlUGVybWlzc2lvbnM6ITAsRXJybm9FcnJvcjpudWxsLGdlbmVyaWNFcnJvcnM6e30sZmlsZXN5c3RlbXM6bnVsbCxzeW5jRlNSZXF1ZXN0czowLGxvb2t1cFBhdGg6KGUscj17fSk9PntpZighKGU9Z3IucmVzb2x2ZShici5jd2QoKSxlKSkpcmV0dXJue3BhdGg6IiIsbm9kZTpudWxsfTtpZigocj1PYmplY3QuYXNzaWduKHtmb2xsb3dfbW91bnQ6ITAscmVjdXJzZV9jb3VudDowfSxyKSkucmVjdXJzZV9jb3VudD44KXRocm93IG5ldyBici5FcnJub0Vycm9yKDMyKTtmb3IodmFyIHQ9d3Iubm9ybWFsaXplQXJyYXkoZS5zcGxpdCgiLyIpLmZpbHRlcigoZT0+ISFlKSksITEpLG49YnIucm9vdCxvPSIvIixhPTA7YTx0Lmxlbmd0aDthKyspe3ZhciBpPWE9PT10Lmxlbmd0aC0xO2lmKGkmJnIucGFyZW50KWJyZWFrO2lmKG49YnIubG9va3VwTm9kZShuLHRbYV0pLG89d3Iuam9pbjIobyx0W2FdKSxici5pc01vdW50cG9pbnQobikmJighaXx8aSYmci5mb2xsb3dfbW91bnQpJiYobj1uLm1vdW50ZWQucm9vdCksIWl8fHIuZm9sbG93KWZvcih2YXIgcz0wO2JyLmlzTGluayhuLm1vZGUpOyl7dmFyIHU9YnIucmVhZGxpbmsobyk7aWYobz1nci5yZXNvbHZlKHdyLmRpcm5hbWUobyksdSksbj1ici5sb29rdXBQYXRoKG8se3JlY3Vyc2VfY291bnQ6ci5yZWN1cnNlX2NvdW50KzF9KS5ub2RlLHMrKz40MCl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcigzMil9fXJldHVybntwYXRoOm8sbm9kZTpufX0sZ2V0UGF0aDplPT57Zm9yKHZhciByOzspe2lmKGJyLmlzUm9vdChlKSl7dmFyIHQ9ZS5tb3VudC5tb3VudHBvaW50O3JldHVybiByPyIvIiE9PXRbdC5sZW5ndGgtMV0/dCsiLyIrcjp0K3I6dH1yPXI/ZS5uYW1lKyIvIityOmUubmFtZSxlPWUucGFyZW50fX0saGFzaE5hbWU6KGUscik9Pntmb3IodmFyIHQ9MCxuPTA7bjxyLmxlbmd0aDtuKyspdD0odDw8NSktdCtyLmNoYXJDb2RlQXQobil8MDtyZXR1cm4oZSt0Pj4+MCklYnIubmFtZVRhYmxlLmxlbmd0aH0saGFzaEFkZE5vZGU6ZT0+e3ZhciByPWJyLmhhc2hOYW1lKGUucGFyZW50LmlkLGUubmFtZSk7ZS5uYW1lX25leHQ9YnIubmFtZVRhYmxlW3JdLGJyLm5hbWVUYWJsZVtyXT1lfSxoYXNoUmVtb3ZlTm9kZTplPT57dmFyIHI9YnIuaGFzaE5hbWUoZS5wYXJlbnQuaWQsZS5uYW1lKTtpZihici5uYW1lVGFibGVbcl09PT1lKWJyLm5hbWVUYWJsZVtyXT1lLm5hbWVfbmV4dDtlbHNlIGZvcih2YXIgdD1ici5uYW1lVGFibGVbcl07dDspe2lmKHQubmFtZV9uZXh0PT09ZSl7dC5uYW1lX25leHQ9ZS5uYW1lX25leHQ7YnJlYWt9dD10Lm5hbWVfbmV4dH19LGxvb2t1cE5vZGU6KGUscik9Pnt2YXIgdD1ici5tYXlMb29rdXAoZSk7aWYodCl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcih0LGUpO2Zvcih2YXIgbj1ici5oYXNoTmFtZShlLmlkLHIpLG89YnIubmFtZVRhYmxlW25dO287bz1vLm5hbWVfbmV4dCl7dmFyIGE9by5uYW1lO2lmKG8ucGFyZW50LmlkPT09ZS5pZCYmYT09PXIpcmV0dXJuIG99cmV0dXJuIGJyLmxvb2t1cChlLHIpfSxjcmVhdGVOb2RlOihlLHIsdCxuKT0+e3ZhciBvPW5ldyBici5GU05vZGUoZSxyLHQsbik7cmV0dXJuIGJyLmhhc2hBZGROb2RlKG8pLG99LGRlc3Ryb3lOb2RlOmU9Pntici5oYXNoUmVtb3ZlTm9kZShlKX0saXNSb290OmU9PmU9PT1lLnBhcmVudCxpc01vdW50cG9pbnQ6ZT0+ISFlLm1vdW50ZWQsaXNGaWxlOmU9PjMyNzY4PT0oNjE0NDAmZSksaXNEaXI6ZT0+MTYzODQ9PSg2MTQ0MCZlKSxpc0xpbms6ZT0+NDA5NjA9PSg2MTQ0MCZlKSxpc0NocmRldjplPT44MTkyPT0oNjE0NDAmZSksaXNCbGtkZXY6ZT0+MjQ1NzY9PSg2MTQ0MCZlKSxpc0ZJRk86ZT0+NDA5Nj09KDYxNDQwJmUpLGlzU29ja2V0OmU9PjQ5MTUyPT0oNDkxNTImZSksZmxhZ01vZGVzOntyOjAsInIrIjoyLHc6NTc3LCJ3KyI6NTc4LGE6MTA4OSwiYSsiOjEwOTB9LG1vZGVTdHJpbmdUb0ZsYWdzOmU9Pnt2YXIgcj1ici5mbGFnTW9kZXNbZV07aWYodm9pZCAwPT09cil0aHJvdyBuZXcgRXJyb3IoIlVua25vd24gZmlsZSBvcGVuIG1vZGU6ICIrZSk7cmV0dXJuIHJ9LGZsYWdzVG9QZXJtaXNzaW9uU3RyaW5nOmU9Pnt2YXIgcj1bInIiLCJ3IiwicnciXVszJmVdO3JldHVybiA1MTImZSYmKHIrPSJ3Iikscn0sbm9kZVBlcm1pc3Npb25zOihlLHIpPT5ici5pZ25vcmVQZXJtaXNzaW9uc3x8KCFyLmluY2x1ZGVzKCJyIil8fDI5MiZlLm1vZGUpJiYoIXIuaW5jbHVkZXMoInciKXx8MTQ2JmUubW9kZSkmJighci5pbmNsdWRlcygieCIpfHw3MyZlLm1vZGUpPzA6MixtYXlMb29rdXA6ZT0+YnIubm9kZVBlcm1pc3Npb25zKGUsIngiKXx8KGUubm9kZV9vcHMubG9va3VwPzA6MiksbWF5Q3JlYXRlOihlLHIpPT57dHJ5e3JldHVybiBici5sb29rdXBOb2RlKGUsciksMjB9Y2F0Y2goZSl7fXJldHVybiBici5ub2RlUGVybWlzc2lvbnMoZSwid3giKX0sbWF5RGVsZXRlOihlLHIsdCk9Pnt2YXIgbjt0cnl7bj1ici5sb29rdXBOb2RlKGUscil9Y2F0Y2goZSl7cmV0dXJuIGUuZXJybm99dmFyIG89YnIubm9kZVBlcm1pc3Npb25zKGUsInd4Iik7aWYobylyZXR1cm4gbztpZih0KXtpZighYnIuaXNEaXIobi5tb2RlKSlyZXR1cm4gNTQ7aWYoYnIuaXNSb290KG4pfHxici5nZXRQYXRoKG4pPT09YnIuY3dkKCkpcmV0dXJuIDEwfWVsc2UgaWYoYnIuaXNEaXIobi5tb2RlKSlyZXR1cm4gMzE7cmV0dXJuIDB9LG1heU9wZW46KGUscik9PmU/YnIuaXNMaW5rKGUubW9kZSk/MzI6YnIuaXNEaXIoZS5tb2RlKSYmKCJyIiE9PWJyLmZsYWdzVG9QZXJtaXNzaW9uU3RyaW5nKHIpfHw1MTImcik/MzE6YnIubm9kZVBlcm1pc3Npb25zKGUsYnIuZmxhZ3NUb1Blcm1pc3Npb25TdHJpbmcocikpOjQ0LE1BWF9PUEVOX0ZEUzo0MDk2LG5leHRmZDooZT0wLHI9YnIuTUFYX09QRU5fRkRTKT0+e2Zvcih2YXIgdD1lO3Q8PXI7dCsrKWlmKCFici5zdHJlYW1zW3RdKXJldHVybiB0O3Rocm93IG5ldyBici5FcnJub0Vycm9yKDMzKX0sZ2V0U3RyZWFtOmU9PmJyLnN0cmVhbXNbZV0sY3JlYXRlU3RyZWFtOihlLHIsdCk9Pntici5GU1N0cmVhbXx8KGJyLkZTU3RyZWFtPWZ1bmN0aW9uKCl7dGhpcy5zaGFyZWQ9e319LGJyLkZTU3RyZWFtLnByb3RvdHlwZT17b2JqZWN0OntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlfSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5ub2RlPWV9fSxpc1JlYWQ6e2dldDpmdW5jdGlvbigpe3JldHVybiAxIT0oMjA5NzE1NSZ0aGlzLmZsYWdzKX19LGlzV3JpdGU6e2dldDpmdW5jdGlvbigpe3JldHVybiAwIT0oMjA5NzE1NSZ0aGlzLmZsYWdzKX19LGlzQXBwZW5kOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gMTAyNCZ0aGlzLmZsYWdzfX0sZmxhZ3M6e2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNoYXJlZC5mbGFnc30sc2V0OmZ1bmN0aW9uKGUpe3RoaXMuc2hhcmVkLmZsYWdzPWV9fSxwb3NpdGlvbjp7Z2V0IGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2hhcmVkLnBvc2l0aW9ufSxzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5zaGFyZWQucG9zaXRpb249ZX19fSksZT1PYmplY3QuYXNzaWduKG5ldyBici5GU1N0cmVhbSxlKTt2YXIgbj1ici5uZXh0ZmQocix0KTtyZXR1cm4gZS5mZD1uLGJyLnN0cmVhbXNbbl09ZSxlfSxjbG9zZVN0cmVhbTplPT57YnIuc3RyZWFtc1tlXT1udWxsfSxjaHJkZXZfc3RyZWFtX29wczp7b3BlbjplPT57dmFyIHI9YnIuZ2V0RGV2aWNlKGUubm9kZS5yZGV2KTtlLnN0cmVhbV9vcHM9ci5zdHJlYW1fb3BzLGUuc3RyZWFtX29wcy5vcGVuJiZlLnN0cmVhbV9vcHMub3BlbihlKX0sbGxzZWVrOigpPT57dGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNzApfX0sbWFqb3I6ZT0+ZT4+OCxtaW5vcjplPT4yNTUmZSxtYWtlZGV2OihlLHIpPT5lPDw4fHIscmVnaXN0ZXJEZXZpY2U6KGUscik9Pntici5kZXZpY2VzW2VdPXtzdHJlYW1fb3BzOnJ9fSxnZXREZXZpY2U6ZT0+YnIuZGV2aWNlc1tlXSxnZXRNb3VudHM6ZT0+e2Zvcih2YXIgcj1bXSx0PVtlXTt0Lmxlbmd0aDspe3ZhciBuPXQucG9wKCk7ci5wdXNoKG4pLHQucHVzaC5hcHBseSh0LG4ubW91bnRzKX1yZXR1cm4gcn0sc3luY2ZzOihlLHIpPT57ImZ1bmN0aW9uIj09dHlwZW9mIGUmJihyPWUsZT0hMSksYnIuc3luY0ZTUmVxdWVzdHMrKyxici5zeW5jRlNSZXF1ZXN0cz4xJiZkKCJ3YXJuaW5nOiAiK2JyLnN5bmNGU1JlcXVlc3RzKyIgRlMuc3luY2ZzIG9wZXJhdGlvbnMgaW4gZmxpZ2h0IGF0IG9uY2UsIHByb2JhYmx5IGp1c3QgZG9pbmcgZXh0cmEgd29yayIpO3ZhciB0PWJyLmdldE1vdW50cyhici5yb290Lm1vdW50KSxuPTA7ZnVuY3Rpb24gbyhlKXtyZXR1cm4gYnIuc3luY0ZTUmVxdWVzdHMtLSxyKGUpfWZ1bmN0aW9uIGEoZSl7aWYoZSlyZXR1cm4gYS5lcnJvcmVkP3ZvaWQgMDooYS5lcnJvcmVkPSEwLG8oZSkpOysrbj49dC5sZW5ndGgmJm8obnVsbCl9dC5mb3JFYWNoKChyPT57aWYoIXIudHlwZS5zeW5jZnMpcmV0dXJuIGEobnVsbCk7ci50eXBlLnN5bmNmcyhyLGUsYSl9KSl9LG1vdW50OihlLHIsdCk9Pnt2YXIgbixvPSIvIj09PXQsYT0hdDtpZihvJiZici5yb290KXRocm93IG5ldyBici5FcnJub0Vycm9yKDEwKTtpZighbyYmIWEpe3ZhciBpPWJyLmxvb2t1cFBhdGgodCx7Zm9sbG93X21vdW50OiExfSk7aWYodD1pLnBhdGgsbj1pLm5vZGUsYnIuaXNNb3VudHBvaW50KG4pKXRocm93IG5ldyBici5FcnJub0Vycm9yKDEwKTtpZighYnIuaXNEaXIobi5tb2RlKSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig1NCl9dmFyIHM9e3R5cGU6ZSxvcHRzOnIsbW91bnRwb2ludDp0LG1vdW50czpbXX0sdT1lLm1vdW50KHMpO3JldHVybiB1Lm1vdW50PXMscy5yb290PXUsbz9ici5yb290PXU6biYmKG4ubW91bnRlZD1zLG4ubW91bnQmJm4ubW91bnQubW91bnRzLnB1c2gocykpLHV9LHVubW91bnQ6ZT0+e3ZhciByPWJyLmxvb2t1cFBhdGgoZSx7Zm9sbG93X21vdW50OiExfSk7aWYoIWJyLmlzTW91bnRwb2ludChyLm5vZGUpKXRocm93IG5ldyBici5FcnJub0Vycm9yKDI4KTt2YXIgdD1yLm5vZGUsbj10Lm1vdW50ZWQsbz1ici5nZXRNb3VudHMobik7T2JqZWN0LmtleXMoYnIubmFtZVRhYmxlKS5mb3JFYWNoKChlPT57Zm9yKHZhciByPWJyLm5hbWVUYWJsZVtlXTtyOyl7dmFyIHQ9ci5uYW1lX25leHQ7by5pbmNsdWRlcyhyLm1vdW50KSYmYnIuZGVzdHJveU5vZGUocikscj10fX0pKSx0Lm1vdW50ZWQ9bnVsbDt2YXIgYT10Lm1vdW50Lm1vdW50cy5pbmRleE9mKG4pO3QubW91bnQubW91bnRzLnNwbGljZShhLDEpfSxsb29rdXA6KGUscik9PmUubm9kZV9vcHMubG9va3VwKGUsciksbWtub2Q6KGUscix0KT0+e3ZhciBuPWJyLmxvb2t1cFBhdGgoZSx7cGFyZW50OiEwfSkubm9kZSxvPXdyLmJhc2VuYW1lKGUpO2lmKCFvfHwiLiI9PT1vfHwiLi4iPT09byl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcigyOCk7dmFyIGE9YnIubWF5Q3JlYXRlKG4sbyk7aWYoYSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcihhKTtpZighbi5ub2RlX29wcy5ta25vZCl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig2Myk7cmV0dXJuIG4ubm9kZV9vcHMubWtub2QobixvLHIsdCl9LGNyZWF0ZTooZSxyKT0+KHI9dm9pZCAwIT09cj9yOjQzOCxyJj00MDk1LHJ8PTMyNzY4LGJyLm1rbm9kKGUsciwwKSksbWtkaXI6KGUscik9PihyPXZvaWQgMCE9PXI/cjo1MTEsciY9MTAyMyxyfD0xNjM4NCxici5ta25vZChlLHIsMCkpLG1rZGlyVHJlZTooZSxyKT0+e2Zvcih2YXIgdD1lLnNwbGl0KCIvIiksbj0iIixvPTA7bzx0Lmxlbmd0aDsrK28paWYodFtvXSl7bis9Ii8iK3Rbb107dHJ5e2JyLm1rZGlyKG4scil9Y2F0Y2goZSl7aWYoMjAhPWUuZXJybm8pdGhyb3cgZX19fSxta2RldjooZSxyLHQpPT4odm9pZCAwPT09dCYmKHQ9cixyPTQzOCkscnw9ODE5Mixici5ta25vZChlLHIsdCkpLHN5bWxpbms6KGUscik9PntpZighZ3IucmVzb2x2ZShlKSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig0NCk7dmFyIHQ9YnIubG9va3VwUGF0aChyLHtwYXJlbnQ6ITB9KS5ub2RlO2lmKCF0KXRocm93IG5ldyBici5FcnJub0Vycm9yKDQ0KTt2YXIgbj13ci5iYXNlbmFtZShyKSxvPWJyLm1heUNyZWF0ZSh0LG4pO2lmKG8pdGhyb3cgbmV3IGJyLkVycm5vRXJyb3Iobyk7aWYoIXQubm9kZV9vcHMuc3ltbGluayl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig2Myk7cmV0dXJuIHQubm9kZV9vcHMuc3ltbGluayh0LG4sZSl9LHJlbmFtZTooZSxyKT0+e3ZhciB0LG4sbz13ci5kaXJuYW1lKGUpLGE9d3IuZGlybmFtZShyKSxpPXdyLmJhc2VuYW1lKGUpLHM9d3IuYmFzZW5hbWUocik7aWYodD1ici5sb29rdXBQYXRoKGUse3BhcmVudDohMH0pLm5vZGUsbj1ici5sb29rdXBQYXRoKHIse3BhcmVudDohMH0pLm5vZGUsIXR8fCFuKXRocm93IG5ldyBici5FcnJub0Vycm9yKDQ0KTtpZih0Lm1vdW50IT09bi5tb3VudCl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig3NSk7dmFyIHUsYz1ici5sb29rdXBOb2RlKHQsaSksbD1nci5yZWxhdGl2ZShlLGEpO2lmKCIuIiE9PWwuY2hhckF0KDApKXRocm93IG5ldyBici5FcnJub0Vycm9yKDI4KTtpZigiLiIhPT0obD1nci5yZWxhdGl2ZShyLG8pKS5jaGFyQXQoMCkpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNTUpO3RyeXt1PWJyLmxvb2t1cE5vZGUobixzKX1jYXRjaChlKXt9aWYoYyE9PXUpe3ZhciBkPWJyLmlzRGlyKGMubW9kZSksZj1ici5tYXlEZWxldGUodCxpLGQpO2lmKGYpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoZik7aWYoZj11P2JyLm1heURlbGV0ZShuLHMsZCk6YnIubWF5Q3JlYXRlKG4scykpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoZik7aWYoIXQubm9kZV9vcHMucmVuYW1lKXRocm93IG5ldyBici5FcnJub0Vycm9yKDYzKTtpZihici5pc01vdW50cG9pbnQoYyl8fHUmJmJyLmlzTW91bnRwb2ludCh1KSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcigxMCk7aWYobiE9PXQmJihmPWJyLm5vZGVQZXJtaXNzaW9ucyh0LCJ3IikpKXRocm93IG5ldyBici5FcnJub0Vycm9yKGYpO2JyLmhhc2hSZW1vdmVOb2RlKGMpO3RyeXt0Lm5vZGVfb3BzLnJlbmFtZShjLG4scyl9Y2F0Y2goZSl7dGhyb3cgZX1maW5hbGx5e2JyLmhhc2hBZGROb2RlKGMpfX19LHJtZGlyOmU9Pnt2YXIgcj1ici5sb29rdXBQYXRoKGUse3BhcmVudDohMH0pLm5vZGUsdD13ci5iYXNlbmFtZShlKSxuPWJyLmxvb2t1cE5vZGUocix0KSxvPWJyLm1heURlbGV0ZShyLHQsITApO2lmKG8pdGhyb3cgbmV3IGJyLkVycm5vRXJyb3Iobyk7aWYoIXIubm9kZV9vcHMucm1kaXIpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNjMpO2lmKGJyLmlzTW91bnRwb2ludChuKSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcigxMCk7ci5ub2RlX29wcy5ybWRpcihyLHQpLGJyLmRlc3Ryb3lOb2RlKG4pfSxyZWFkZGlyOmU9Pnt2YXIgcj1ici5sb29rdXBQYXRoKGUse2ZvbGxvdzohMH0pLm5vZGU7aWYoIXIubm9kZV9vcHMucmVhZGRpcil0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig1NCk7cmV0dXJuIHIubm9kZV9vcHMucmVhZGRpcihyKX0sdW5saW5rOmU9Pnt2YXIgcj1ici5sb29rdXBQYXRoKGUse3BhcmVudDohMH0pLm5vZGU7aWYoIXIpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNDQpO3ZhciB0PXdyLmJhc2VuYW1lKGUpLG49YnIubG9va3VwTm9kZShyLHQpLG89YnIubWF5RGVsZXRlKHIsdCwhMSk7aWYobyl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcihvKTtpZighci5ub2RlX29wcy51bmxpbmspdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNjMpO2lmKGJyLmlzTW91bnRwb2ludChuKSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcigxMCk7ci5ub2RlX29wcy51bmxpbmsocix0KSxici5kZXN0cm95Tm9kZShuKX0scmVhZGxpbms6ZT0+e3ZhciByPWJyLmxvb2t1cFBhdGgoZSkubm9kZTtpZighcil0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig0NCk7aWYoIXIubm9kZV9vcHMucmVhZGxpbmspdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoMjgpO3JldHVybiBnci5yZXNvbHZlKGJyLmdldFBhdGgoci5wYXJlbnQpLHIubm9kZV9vcHMucmVhZGxpbmsocikpfSxzdGF0OihlLHIpPT57dmFyIHQ9YnIubG9va3VwUGF0aChlLHtmb2xsb3c6IXJ9KS5ub2RlO2lmKCF0KXRocm93IG5ldyBici5FcnJub0Vycm9yKDQ0KTtpZighdC5ub2RlX29wcy5nZXRhdHRyKXRocm93IG5ldyBici5FcnJub0Vycm9yKDYzKTtyZXR1cm4gdC5ub2RlX29wcy5nZXRhdHRyKHQpfSxsc3RhdDplPT5ici5zdGF0KGUsITApLGNobW9kOihlLHIsdCk9Pnt2YXIgbjtpZighKG49InN0cmluZyI9PXR5cGVvZiBlP2JyLmxvb2t1cFBhdGgoZSx7Zm9sbG93OiF0fSkubm9kZTplKS5ub2RlX29wcy5zZXRhdHRyKXRocm93IG5ldyBici5FcnJub0Vycm9yKDYzKTtuLm5vZGVfb3BzLnNldGF0dHIobix7bW9kZTo0MDk1JnJ8LTQwOTYmbi5tb2RlLHRpbWVzdGFtcDpEYXRlLm5vdygpfSl9LGxjaG1vZDooZSxyKT0+e2JyLmNobW9kKGUsciwhMCl9LGZjaG1vZDooZSxyKT0+e3ZhciB0PWJyLmdldFN0cmVhbShlKTtpZighdCl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig4KTtici5jaG1vZCh0Lm5vZGUscil9LGNob3duOihlLHIsdCxuKT0+e3ZhciBvO2lmKCEobz0ic3RyaW5nIj09dHlwZW9mIGU/YnIubG9va3VwUGF0aChlLHtmb2xsb3c6IW59KS5ub2RlOmUpLm5vZGVfb3BzLnNldGF0dHIpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNjMpO28ubm9kZV9vcHMuc2V0YXR0cihvLHt0aW1lc3RhbXA6RGF0ZS5ub3coKX0pfSxsY2hvd246KGUscix0KT0+e2JyLmNob3duKGUscix0LCEwKX0sZmNob3duOihlLHIsdCk9Pnt2YXIgbj1ici5nZXRTdHJlYW0oZSk7aWYoIW4pdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoOCk7YnIuY2hvd24obi5ub2RlLHIsdCl9LHRydW5jYXRlOihlLHIpPT57aWYocjwwKXRocm93IG5ldyBici5FcnJub0Vycm9yKDI4KTt2YXIgdDtpZighKHQ9InN0cmluZyI9PXR5cGVvZiBlP2JyLmxvb2t1cFBhdGgoZSx7Zm9sbG93OiEwfSkubm9kZTplKS5ub2RlX29wcy5zZXRhdHRyKXRocm93IG5ldyBici5FcnJub0Vycm9yKDYzKTtpZihici5pc0Rpcih0Lm1vZGUpKXRocm93IG5ldyBici5FcnJub0Vycm9yKDMxKTtpZighYnIuaXNGaWxlKHQubW9kZSkpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoMjgpO3ZhciBuPWJyLm5vZGVQZXJtaXNzaW9ucyh0LCJ3Iik7aWYobil0aHJvdyBuZXcgYnIuRXJybm9FcnJvcihuKTt0Lm5vZGVfb3BzLnNldGF0dHIodCx7c2l6ZTpyLHRpbWVzdGFtcDpEYXRlLm5vdygpfSl9LGZ0cnVuY2F0ZTooZSxyKT0+e3ZhciB0PWJyLmdldFN0cmVhbShlKTtpZighdCl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig4KTtpZigwPT0oMjA5NzE1NSZ0LmZsYWdzKSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcigyOCk7YnIudHJ1bmNhdGUodC5ub2RlLHIpfSx1dGltZTooZSxyLHQpPT57dmFyIG49YnIubG9va3VwUGF0aChlLHtmb2xsb3c6ITB9KS5ub2RlO24ubm9kZV9vcHMuc2V0YXR0cihuLHt0aW1lc3RhbXA6TWF0aC5tYXgocix0KX0pfSxvcGVuOihyLHQsbixvLGEpPT57aWYoIiI9PT1yKXRocm93IG5ldyBici5FcnJub0Vycm9yKDQ0KTt2YXIgaTtpZihuPXZvaWQgMD09PW4/NDM4Om4sbj02NCYodD0ic3RyaW5nIj09dHlwZW9mIHQ/YnIubW9kZVN0cmluZ1RvRmxhZ3ModCk6dCk/NDA5NSZufDMyNzY4OjAsIm9iamVjdCI9PXR5cGVvZiByKWk9cjtlbHNle3I9d3Iubm9ybWFsaXplKHIpO3RyeXtpPWJyLmxvb2t1cFBhdGgocix7Zm9sbG93OiEoMTMxMDcyJnQpfSkubm9kZX1jYXRjaChlKXt9fXZhciBzPSExO2lmKDY0JnQpaWYoaSl7aWYoMTI4JnQpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoMjApfWVsc2UgaT1ici5ta25vZChyLG4sMCkscz0hMDtpZighaSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig0NCk7aWYoYnIuaXNDaHJkZXYoaS5tb2RlKSYmKHQmPS01MTMpLDY1NTM2JnQmJiFici5pc0RpcihpLm1vZGUpKXRocm93IG5ldyBici5FcnJub0Vycm9yKDU0KTtpZighcyl7dmFyIHU9YnIubWF5T3BlbihpLHQpO2lmKHUpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IodSl9NTEyJnQmJmJyLnRydW5jYXRlKGksMCksdCY9LTEzMTcxMzt2YXIgYz1ici5jcmVhdGVTdHJlYW0oe25vZGU6aSxwYXRoOmJyLmdldFBhdGgoaSksZmxhZ3M6dCxzZWVrYWJsZTohMCxwb3NpdGlvbjowLHN0cmVhbV9vcHM6aS5zdHJlYW1fb3BzLHVuZ290dGVuOltdLGVycm9yOiExfSxvLGEpO3JldHVybiBjLnN0cmVhbV9vcHMub3BlbiYmYy5zdHJlYW1fb3BzLm9wZW4oYyksIWUubG9nUmVhZEZpbGVzfHwxJnR8fChici5yZWFkRmlsZXN8fChici5yZWFkRmlsZXM9e30pLHIgaW4gYnIucmVhZEZpbGVzfHwoYnIucmVhZEZpbGVzW3JdPTEpKSxjfSxjbG9zZTplPT57aWYoYnIuaXNDbG9zZWQoZSkpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoOCk7ZS5nZXRkZW50cyYmKGUuZ2V0ZGVudHM9bnVsbCk7dHJ5e2Uuc3RyZWFtX29wcy5jbG9zZSYmZS5zdHJlYW1fb3BzLmNsb3NlKGUpfWNhdGNoKGUpe3Rocm93IGV9ZmluYWxseXtici5jbG9zZVN0cmVhbShlLmZkKX1lLmZkPW51bGx9LGlzQ2xvc2VkOmU9Pm51bGw9PT1lLmZkLGxsc2VlazooZSxyLHQpPT57aWYoYnIuaXNDbG9zZWQoZSkpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoOCk7aWYoIWUuc2Vla2FibGV8fCFlLnN0cmVhbV9vcHMubGxzZWVrKXRocm93IG5ldyBici5FcnJub0Vycm9yKDcwKTtpZigwIT10JiYxIT10JiYyIT10KXRocm93IG5ldyBici5FcnJub0Vycm9yKDI4KTtyZXR1cm4gZS5wb3NpdGlvbj1lLnN0cmVhbV9vcHMubGxzZWVrKGUscix0KSxlLnVuZ290dGVuPVtdLGUucG9zaXRpb259LHJlYWQ6KGUscix0LG4sbyk9PntpZihuPDB8fG88MCl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcigyOCk7aWYoYnIuaXNDbG9zZWQoZSkpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoOCk7aWYoMT09KDIwOTcxNTUmZS5mbGFncykpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoOCk7aWYoYnIuaXNEaXIoZS5ub2RlLm1vZGUpKXRocm93IG5ldyBici5FcnJub0Vycm9yKDMxKTtpZighZS5zdHJlYW1fb3BzLnJlYWQpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoMjgpO3ZhciBhPXZvaWQgMCE9PW87aWYoYSl7aWYoIWUuc2Vla2FibGUpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNzApfWVsc2Ugbz1lLnBvc2l0aW9uO3ZhciBpPWUuc3RyZWFtX29wcy5yZWFkKGUscix0LG4sbyk7cmV0dXJuIGF8fChlLnBvc2l0aW9uKz1pKSxpfSx3cml0ZTooZSxyLHQsbixvLGEpPT57aWYobjwwfHxvPDApdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoMjgpO2lmKGJyLmlzQ2xvc2VkKGUpKXRocm93IG5ldyBici5FcnJub0Vycm9yKDgpO2lmKDA9PSgyMDk3MTU1JmUuZmxhZ3MpKXRocm93IG5ldyBici5FcnJub0Vycm9yKDgpO2lmKGJyLmlzRGlyKGUubm9kZS5tb2RlKSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcigzMSk7aWYoIWUuc3RyZWFtX29wcy53cml0ZSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcigyOCk7ZS5zZWVrYWJsZSYmMTAyNCZlLmZsYWdzJiZici5sbHNlZWsoZSwwLDIpO3ZhciBpPXZvaWQgMCE9PW87aWYoaSl7aWYoIWUuc2Vla2FibGUpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNzApfWVsc2Ugbz1lLnBvc2l0aW9uO3ZhciBzPWUuc3RyZWFtX29wcy53cml0ZShlLHIsdCxuLG8sYSk7cmV0dXJuIGl8fChlLnBvc2l0aW9uKz1zKSxzfSxhbGxvY2F0ZTooZSxyLHQpPT57aWYoYnIuaXNDbG9zZWQoZSkpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoOCk7aWYocjwwfHx0PD0wKXRocm93IG5ldyBici5FcnJub0Vycm9yKDI4KTtpZigwPT0oMjA5NzE1NSZlLmZsYWdzKSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig4KTtpZighYnIuaXNGaWxlKGUubm9kZS5tb2RlKSYmIWJyLmlzRGlyKGUubm9kZS5tb2RlKSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig0Myk7aWYoIWUuc3RyZWFtX29wcy5hbGxvY2F0ZSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcigxMzgpO2Uuc3RyZWFtX29wcy5hbGxvY2F0ZShlLHIsdCl9LG1tYXA6KGUscix0LG4sbyxhKT0+e2lmKDAhPSgyJm8pJiYwPT0oMiZhKSYmMiE9KDIwOTcxNTUmZS5mbGFncykpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoMik7aWYoMT09KDIwOTcxNTUmZS5mbGFncykpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoMik7aWYoIWUuc3RyZWFtX29wcy5tbWFwKXRocm93IG5ldyBici5FcnJub0Vycm9yKDQzKTtyZXR1cm4gZS5zdHJlYW1fb3BzLm1tYXAoZSxyLHQsbixvLGEpfSxtc3luYzooZSxyLHQsbixvKT0+ZSYmZS5zdHJlYW1fb3BzLm1zeW5jP2Uuc3RyZWFtX29wcy5tc3luYyhlLHIsdCxuLG8pOjAsbXVubWFwOmU9PjAsaW9jdGw6KGUscix0KT0+e2lmKCFlLnN0cmVhbV9vcHMuaW9jdGwpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNTkpO3JldHVybiBlLnN0cmVhbV9vcHMuaW9jdGwoZSxyLHQpfSxyZWFkRmlsZTooZSxyPXt9KT0+e2lmKHIuZmxhZ3M9ci5mbGFnc3x8MCxyLmVuY29kaW5nPXIuZW5jb2Rpbmd8fCJiaW5hcnkiLCJ1dGY4IiE9PXIuZW5jb2RpbmcmJiJiaW5hcnkiIT09ci5lbmNvZGluZyl0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgZW5jb2RpbmcgdHlwZSAiJytyLmVuY29kaW5nKyciJyk7dmFyIHQsbj1ici5vcGVuKGUsci5mbGFncyksbz1ici5zdGF0KGUpLnNpemUsYT1uZXcgVWludDhBcnJheShvKTtyZXR1cm4gYnIucmVhZChuLGEsMCxvLDApLCJ1dGY4Ij09PXIuZW5jb2Rpbmc/dD13KGEsMCk6ImJpbmFyeSI9PT1yLmVuY29kaW5nJiYodD1hKSxici5jbG9zZShuKSx0fSx3cml0ZUZpbGU6KGUscix0PXt9KT0+e3QuZmxhZ3M9dC5mbGFnc3x8NTc3O3ZhciBuPWJyLm9wZW4oZSx0LmZsYWdzLHQubW9kZSk7aWYoInN0cmluZyI9PXR5cGVvZiByKXt2YXIgbz1uZXcgVWludDhBcnJheShiKHIpKzEpLGE9RShyLG8sMCxvLmxlbmd0aCk7YnIud3JpdGUobixvLDAsYSx2b2lkIDAsdC5jYW5Pd24pfWVsc2V7aWYoIUFycmF5QnVmZmVyLmlzVmlldyhyKSl0aHJvdyBuZXcgRXJyb3IoIlVuc3VwcG9ydGVkIGRhdGEgdHlwZSIpO2JyLndyaXRlKG4sciwwLHIuYnl0ZUxlbmd0aCx2b2lkIDAsdC5jYW5Pd24pfWJyLmNsb3NlKG4pfSxjd2Q6KCk9PmJyLmN1cnJlbnRQYXRoLGNoZGlyOmU9Pnt2YXIgcj1ici5sb29rdXBQYXRoKGUse2ZvbGxvdzohMH0pO2lmKG51bGw9PT1yLm5vZGUpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNDQpO2lmKCFici5pc0RpcihyLm5vZGUubW9kZSkpdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoNTQpO3ZhciB0PWJyLm5vZGVQZXJtaXNzaW9ucyhyLm5vZGUsIngiKTtpZih0KXRocm93IG5ldyBici5FcnJub0Vycm9yKHQpO2JyLmN1cnJlbnRQYXRoPXIucGF0aH0sY3JlYXRlRGVmYXVsdERpcmVjdG9yaWVzOigpPT57YnIubWtkaXIoIi90bXAiKSxici5ta2RpcigiL2hvbWUiKSxici5ta2RpcigiL2hvbWUvd2ViX3VzZXIiKX0sY3JlYXRlRGVmYXVsdERldmljZXM6KCk9Pntici5ta2RpcigiL2RldiIpLGJyLnJlZ2lzdGVyRGV2aWNlKGJyLm1ha2VkZXYoMSwzKSx7cmVhZDooKT0+MCx3cml0ZTooZSxyLHQsbixvKT0+bn0pLGJyLm1rZGV2KCIvZGV2L251bGwiLGJyLm1ha2VkZXYoMSwzKSksRXIucmVnaXN0ZXIoYnIubWFrZWRldig1LDApLEVyLmRlZmF1bHRfdHR5X29wcyksRXIucmVnaXN0ZXIoYnIubWFrZWRldig2LDApLEVyLmRlZmF1bHRfdHR5MV9vcHMpLGJyLm1rZGV2KCIvZGV2L3R0eSIsYnIubWFrZWRldig1LDApKSxici5ta2RldigiL2Rldi90dHkxIixici5tYWtlZGV2KDYsMCkpO3ZhciBlPWZ1bmN0aW9uKCl7aWYoIm9iamVjdCI9PXR5cGVvZiBjcnlwdG8mJiJmdW5jdGlvbiI9PXR5cGVvZiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKXt2YXIgZT1uZXcgVWludDhBcnJheSgxKTtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhlKSxlWzBdfX1yZXR1cm4gZnVuY3Rpb24oKXtLKCJyYW5kb21EZXZpY2UiKX19KCk7YnIuY3JlYXRlRGV2aWNlKCIvZGV2IiwicmFuZG9tIixlKSxici5jcmVhdGVEZXZpY2UoIi9kZXYiLCJ1cmFuZG9tIixlKSxici5ta2RpcigiL2Rldi9zaG0iKSxici5ta2RpcigiL2Rldi9zaG0vdG1wIil9LGNyZWF0ZVNwZWNpYWxEaXJlY3RvcmllczooKT0+e2JyLm1rZGlyKCIvcHJvYyIpO3ZhciBlPWJyLm1rZGlyKCIvcHJvYy9zZWxmIik7YnIubWtkaXIoIi9wcm9jL3NlbGYvZmQiKSxici5tb3VudCh7bW91bnQ6KCk9Pnt2YXIgcj1ici5jcmVhdGVOb2RlKGUsImZkIiwxNjg5NSw3Myk7cmV0dXJuIHIubm9kZV9vcHM9e2xvb2t1cDooZSxyKT0+e3ZhciB0PStyLG49YnIuZ2V0U3RyZWFtKHQpO2lmKCFuKXRocm93IG5ldyBici5FcnJub0Vycm9yKDgpO3ZhciBvPXtwYXJlbnQ6bnVsbCxtb3VudDp7bW91bnRwb2ludDoiZmFrZSJ9LG5vZGVfb3BzOntyZWFkbGluazooKT0+bi5wYXRofX07cmV0dXJuIG8ucGFyZW50PW8sb319LHJ9fSx7fSwiL3Byb2Mvc2VsZi9mZCIpfSxjcmVhdGVTdGFuZGFyZFN0cmVhbXM6KCk9PntlLnN0ZGluP2JyLmNyZWF0ZURldmljZSgiL2RldiIsInN0ZGluIixlLnN0ZGluKTpici5zeW1saW5rKCIvZGV2L3R0eSIsIi9kZXYvc3RkaW4iKSxlLnN0ZG91dD9ici5jcmVhdGVEZXZpY2UoIi9kZXYiLCJzdGRvdXQiLG51bGwsZS5zdGRvdXQpOmJyLnN5bWxpbmsoIi9kZXYvdHR5IiwiL2Rldi9zdGRvdXQiKSxlLnN0ZGVycj9ici5jcmVhdGVEZXZpY2UoIi9kZXYiLCJzdGRlcnIiLG51bGwsZS5zdGRlcnIpOmJyLnN5bWxpbmsoIi9kZXYvdHR5MSIsIi9kZXYvc3RkZXJyIiksYnIub3BlbigiL2Rldi9zdGRpbiIsMCksYnIub3BlbigiL2Rldi9zdGRvdXQiLDEpLGJyLm9wZW4oIi9kZXYvc3RkZXJyIiwxKX0sZW5zdXJlRXJybm9FcnJvcjooKT0+e2JyLkVycm5vRXJyb3J8fChici5FcnJub0Vycm9yPWZ1bmN0aW9uKGUscil7dGhpcy5ub2RlPXIsdGhpcy5zZXRFcnJubz1mdW5jdGlvbihlKXt0aGlzLmVycm5vPWV9LHRoaXMuc2V0RXJybm8oZSksdGhpcy5tZXNzYWdlPSJGUyBlcnJvciJ9LGJyLkVycm5vRXJyb3IucHJvdG90eXBlPW5ldyBFcnJvcixici5FcnJub0Vycm9yLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1ici5FcnJub0Vycm9yLFs0NF0uZm9yRWFjaCgoZT0+e2JyLmdlbmVyaWNFcnJvcnNbZV09bmV3IGJyLkVycm5vRXJyb3IoZSksYnIuZ2VuZXJpY0Vycm9yc1tlXS5zdGFjaz0iPGdlbmVyaWMgZXJyb3IsIG5vIHN0YWNrPiJ9KSkpfSxzdGF0aWNJbml0OigpPT57YnIuZW5zdXJlRXJybm9FcnJvcigpLGJyLm5hbWVUYWJsZT1uZXcgQXJyYXkoNDA5NiksYnIubW91bnQoX3Ise30sIi8iKSxici5jcmVhdGVEZWZhdWx0RGlyZWN0b3JpZXMoKSxici5jcmVhdGVEZWZhdWx0RGV2aWNlcygpLGJyLmNyZWF0ZVNwZWNpYWxEaXJlY3RvcmllcygpLGJyLmZpbGVzeXN0ZW1zPXtNRU1GUzpfcn19LGluaXQ6KHIsdCxuKT0+e2JyLmluaXQuaW5pdGlhbGl6ZWQ9ITAsYnIuZW5zdXJlRXJybm9FcnJvcigpLGUuc3RkaW49cnx8ZS5zdGRpbixlLnN0ZG91dD10fHxlLnN0ZG91dCxlLnN0ZGVycj1ufHxlLnN0ZGVycixici5jcmVhdGVTdGFuZGFyZFN0cmVhbXMoKX0scXVpdDooKT0+e2JyLmluaXQuaW5pdGlhbGl6ZWQ9ITE7Zm9yKHZhciBlPTA7ZTxici5zdHJlYW1zLmxlbmd0aDtlKyspe3ZhciByPWJyLnN0cmVhbXNbZV07ciYmYnIuY2xvc2Uocil9fSxnZXRNb2RlOihlLHIpPT57dmFyIHQ9MDtyZXR1cm4gZSYmKHR8PTM2NSksciYmKHR8PTE0NiksdH0sZmluZE9iamVjdDooZSxyKT0+e3ZhciB0PWJyLmFuYWx5emVQYXRoKGUscik7cmV0dXJuIHQuZXhpc3RzP3Qub2JqZWN0Om51bGx9LGFuYWx5emVQYXRoOihlLHIpPT57dHJ5e2U9KG49YnIubG9va3VwUGF0aChlLHtmb2xsb3c6IXJ9KSkucGF0aH1jYXRjaChlKXt9dmFyIHQ9e2lzUm9vdDohMSxleGlzdHM6ITEsZXJyb3I6MCxuYW1lOm51bGwscGF0aDpudWxsLG9iamVjdDpudWxsLHBhcmVudEV4aXN0czohMSxwYXJlbnRQYXRoOm51bGwscGFyZW50T2JqZWN0Om51bGx9O3RyeXt2YXIgbj1ici5sb29rdXBQYXRoKGUse3BhcmVudDohMH0pO3QucGFyZW50RXhpc3RzPSEwLHQucGFyZW50UGF0aD1uLnBhdGgsdC5wYXJlbnRPYmplY3Q9bi5ub2RlLHQubmFtZT13ci5iYXNlbmFtZShlKSxuPWJyLmxvb2t1cFBhdGgoZSx7Zm9sbG93OiFyfSksdC5leGlzdHM9ITAsdC5wYXRoPW4ucGF0aCx0Lm9iamVjdD1uLm5vZGUsdC5uYW1lPW4ubm9kZS5uYW1lLHQuaXNSb290PSIvIj09PW4ucGF0aH1jYXRjaChlKXt0LmVycm9yPWUuZXJybm99cmV0dXJuIHR9LGNyZWF0ZVBhdGg6KGUscix0LG4pPT57ZT0ic3RyaW5nIj09dHlwZW9mIGU/ZTpici5nZXRQYXRoKGUpO2Zvcih2YXIgbz1yLnNwbGl0KCIvIikucmV2ZXJzZSgpO28ubGVuZ3RoOyl7dmFyIGE9by5wb3AoKTtpZihhKXt2YXIgaT13ci5qb2luMihlLGEpO3RyeXtici5ta2RpcihpKX1jYXRjaChlKXt9ZT1pfX1yZXR1cm4gaX0sY3JlYXRlRmlsZTooZSxyLHQsbixvKT0+e3ZhciBhPXdyLmpvaW4yKCJzdHJpbmciPT10eXBlb2YgZT9lOmJyLmdldFBhdGgoZSksciksaT1ici5nZXRNb2RlKG4sbyk7cmV0dXJuIGJyLmNyZWF0ZShhLGkpfSxjcmVhdGVEYXRhRmlsZTooZSxyLHQsbixvLGEpPT57dmFyIGk9cjtlJiYoZT0ic3RyaW5nIj09dHlwZW9mIGU/ZTpici5nZXRQYXRoKGUpLGk9cj93ci5qb2luMihlLHIpOmUpO3ZhciBzPWJyLmdldE1vZGUobixvKSx1PWJyLmNyZWF0ZShpLHMpO2lmKHQpe2lmKCJzdHJpbmciPT10eXBlb2YgdCl7Zm9yKHZhciBjPW5ldyBBcnJheSh0Lmxlbmd0aCksbD0wLGQ9dC5sZW5ndGg7bDxkOysrbCljW2xdPXQuY2hhckNvZGVBdChsKTt0PWN9YnIuY2htb2QodSwxNDZ8cyk7dmFyIGY9YnIub3Blbih1LDU3Nyk7YnIud3JpdGUoZix0LDAsdC5sZW5ndGgsMCxhKSxici5jbG9zZShmKSxici5jaG1vZCh1LHMpfXJldHVybiB1fSxjcmVhdGVEZXZpY2U6KGUscix0LG4pPT57dmFyIG89d3Iuam9pbjIoInN0cmluZyI9PXR5cGVvZiBlP2U6YnIuZ2V0UGF0aChlKSxyKSxhPWJyLmdldE1vZGUoISF0LCEhbik7YnIuY3JlYXRlRGV2aWNlLm1ham9yfHwoYnIuY3JlYXRlRGV2aWNlLm1ham9yPTY0KTt2YXIgaT1ici5tYWtlZGV2KGJyLmNyZWF0ZURldmljZS5tYWpvcisrLDApO3JldHVybiBici5yZWdpc3RlckRldmljZShpLHtvcGVuOmU9PntlLnNlZWthYmxlPSExfSxjbG9zZTplPT57biYmbi5idWZmZXImJm4uYnVmZmVyLmxlbmd0aCYmbigxMCl9LHJlYWQ6KGUscixuLG8sYSk9Pntmb3IodmFyIGk9MCxzPTA7czxvO3MrKyl7dmFyIHU7dHJ5e3U9dCgpfWNhdGNoKGUpe3Rocm93IG5ldyBici5FcnJub0Vycm9yKDI5KX1pZih2b2lkIDA9PT11JiYwPT09aSl0aHJvdyBuZXcgYnIuRXJybm9FcnJvcig2KTtpZihudWxsPT11KWJyZWFrO2krKyxyW24rc109dX1yZXR1cm4gaSYmKGUubm9kZS50aW1lc3RhbXA9RGF0ZS5ub3coKSksaX0sd3JpdGU6KGUscix0LG8sYSk9Pntmb3IodmFyIGk9MDtpPG87aSsrKXRyeXtuKHJbdCtpXSl9Y2F0Y2goZSl7dGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoMjkpfXJldHVybiBvJiYoZS5ub2RlLnRpbWVzdGFtcD1EYXRlLm5vdygpKSxpfX0pLGJyLm1rZGV2KG8sYSxpKX0sZm9yY2VMb2FkRmlsZTplPT57aWYoZS5pc0RldmljZXx8ZS5pc0ZvbGRlcnx8ZS5saW5rfHxlLmNvbnRlbnRzKXJldHVybiEwO2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgWE1MSHR0cFJlcXVlc3QpdGhyb3cgbmV3IEVycm9yKCJMYXp5IGxvYWRpbmcgc2hvdWxkIGhhdmUgYmVlbiBwZXJmb3JtZWQgKGNvbnRlbnRzIHNldCkgaW4gY3JlYXRlTGF6eUZpbGUsIGJ1dCBpdCB3YXMgbm90LiBMYXp5IGxvYWRpbmcgb25seSB3b3JrcyBpbiB3ZWIgd29ya2Vycy4gVXNlIC0tZW1iZWQtZmlsZSBvciAtLXByZWxvYWQtZmlsZSBpbiBlbWNjIG9uIHRoZSBtYWluIHRocmVhZC4iKTtpZighbil0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBsb2FkIHdpdGhvdXQgcmVhZCgpIG9yIFhNTEh0dHBSZXF1ZXN0LiIpO3RyeXtlLmNvbnRlbnRzPURyKG4oZS51cmwpLCEwKSxlLnVzZWRCeXRlcz1lLmNvbnRlbnRzLmxlbmd0aH1jYXRjaChlKXt0aHJvdyBuZXcgYnIuRXJybm9FcnJvcigyOSl9fSxjcmVhdGVMYXp5RmlsZTooZSxyLHQsbixvKT0+e2Z1bmN0aW9uIGEoKXt0aGlzLmxlbmd0aEtub3duPSExLHRoaXMuY2h1bmtzPVtdfWlmKGEucHJvdG90eXBlLmdldD1mdW5jdGlvbihlKXtpZighKGU+dGhpcy5sZW5ndGgtMXx8ZTwwKSl7dmFyIHI9ZSV0aGlzLmNodW5rU2l6ZSx0PWUvdGhpcy5jaHVua1NpemV8MDtyZXR1cm4gdGhpcy5nZXR0ZXIodClbcl19fSxhLnByb3RvdHlwZS5zZXREYXRhR2V0dGVyPWZ1bmN0aW9uKGUpe3RoaXMuZ2V0dGVyPWV9LGEucHJvdG90eXBlLmNhY2hlTGVuZ3RoPWZ1bmN0aW9uKCl7dmFyIGU9bmV3IFhNTEh0dHBSZXF1ZXN0O2lmKGUub3BlbigiSEVBRCIsdCwhMSksZS5zZW5kKG51bGwpLCEoZS5zdGF0dXM+PTIwMCYmZS5zdGF0dXM8MzAwfHwzMDQ9PT1lLnN0YXR1cykpdGhyb3cgbmV3IEVycm9yKCJDb3VsZG4ndCBsb2FkICIrdCsiLiBTdGF0dXM6ICIrZS5zdGF0dXMpO3ZhciByLG49TnVtYmVyKGUuZ2V0UmVzcG9uc2VIZWFkZXIoIkNvbnRlbnQtbGVuZ3RoIikpLG89KHI9ZS5nZXRSZXNwb25zZUhlYWRlcigiQWNjZXB0LVJhbmdlcyIpKSYmImJ5dGVzIj09PXIsYT0ocj1lLmdldFJlc3BvbnNlSGVhZGVyKCJDb250ZW50LUVuY29kaW5nIikpJiYiZ3ppcCI9PT1yLGk9MTA0ODU3NjtvfHwoaT1uKTt2YXIgcz10aGlzO3Muc2V0RGF0YUdldHRlcigoZT0+e3ZhciByPWUqaSxvPShlKzEpKmktMTtpZihvPU1hdGgubWluKG8sbi0xKSx2b2lkIDA9PT1zLmNodW5rc1tlXSYmKHMuY2h1bmtzW2VdPSgoZSxyKT0+e2lmKGU+cil0aHJvdyBuZXcgRXJyb3IoImludmFsaWQgcmFuZ2UgKCIrZSsiLCAiK3IrIikgb3Igbm8gYnl0ZXMgcmVxdWVzdGVkISIpO2lmKHI+bi0xKXRocm93IG5ldyBFcnJvcigib25seSAiK24rIiBieXRlcyBhdmFpbGFibGUhIHByb2dyYW1tZXIgZXJyb3IhIik7dmFyIG89bmV3IFhNTEh0dHBSZXF1ZXN0O2lmKG8ub3BlbigiR0VUIix0LCExKSxuIT09aSYmby5zZXRSZXF1ZXN0SGVhZGVyKCJSYW5nZSIsImJ5dGVzPSIrZSsiLSIrciksby5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIixvLm92ZXJyaWRlTWltZVR5cGUmJm8ub3ZlcnJpZGVNaW1lVHlwZSgidGV4dC9wbGFpbjsgY2hhcnNldD14LXVzZXItZGVmaW5lZCIpLG8uc2VuZChudWxsKSwhKG8uc3RhdHVzPj0yMDAmJm8uc3RhdHVzPDMwMHx8MzA0PT09by5zdGF0dXMpKXRocm93IG5ldyBFcnJvcigiQ291bGRuJ3QgbG9hZCAiK3QrIi4gU3RhdHVzOiAiK28uc3RhdHVzKTtyZXR1cm4gdm9pZCAwIT09by5yZXNwb25zZT9uZXcgVWludDhBcnJheShvLnJlc3BvbnNlfHxbXSk6RHIoby5yZXNwb25zZVRleHR8fCIiLCEwKX0pKHIsbykpLHZvaWQgMD09PXMuY2h1bmtzW2VdKXRocm93IG5ldyBFcnJvcigiZG9YSFIgZmFpbGVkISIpO3JldHVybiBzLmNodW5rc1tlXX0pKSwhYSYmbnx8KGk9bj0xLG49dGhpcy5nZXR0ZXIoMCkubGVuZ3RoLGk9bixsKCJMYXp5RmlsZXMgb24gZ3ppcCBmb3JjZXMgZG93bmxvYWQgb2YgdGhlIHdob2xlIGZpbGUgd2hlbiBsZW5ndGggaXMgYWNjZXNzZWQiKSksdGhpcy5fbGVuZ3RoPW4sdGhpcy5fY2h1bmtTaXplPWksdGhpcy5sZW5ndGhLbm93bj0hMH0sInVuZGVmaW5lZCIhPXR5cGVvZiBYTUxIdHRwUmVxdWVzdCl0aHJvdyJDYW5ub3QgZG8gc3luY2hyb25vdXMgYmluYXJ5IFhIUnMgb3V0c2lkZSB3ZWJ3b3JrZXJzIGluIG1vZGVybiBicm93c2Vycy4gVXNlIC0tZW1iZWQtZmlsZSBvciAtLXByZWxvYWQtZmlsZSBpbiBlbWNjIjt2YXIgaT17aXNEZXZpY2U6ITEsdXJsOnR9LHM9YnIuY3JlYXRlRmlsZShlLHIsaSxuLG8pO2kuY29udGVudHM/cy5jb250ZW50cz1pLmNvbnRlbnRzOmkudXJsJiYocy5jb250ZW50cz1udWxsLHMudXJsPWkudXJsKSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyhzLHt1c2VkQnl0ZXM6e2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRlbnRzLmxlbmd0aH19fSk7dmFyIHU9e307cmV0dXJuIE9iamVjdC5rZXlzKHMuc3RyZWFtX29wcykuZm9yRWFjaCgoZT0+e3ZhciByPXMuc3RyZWFtX29wc1tlXTt1W2VdPWZ1bmN0aW9uKCl7cmV0dXJuIGJyLmZvcmNlTG9hZEZpbGUocyksci5hcHBseShudWxsLGFyZ3VtZW50cyl9fSkpLHUucmVhZD0oZSxyLHQsbixvKT0+e2JyLmZvcmNlTG9hZEZpbGUocyk7dmFyIGE9ZS5ub2RlLmNvbnRlbnRzO2lmKG8+PWEubGVuZ3RoKXJldHVybiAwO3ZhciBpPU1hdGgubWluKGEubGVuZ3RoLW8sbik7aWYoYS5zbGljZSlmb3IodmFyIHU9MDt1PGk7dSsrKXJbdCt1XT1hW28rdV07ZWxzZSBmb3IodT0wO3U8aTt1Kyspclt0K3VdPWEuZ2V0KG8rdSk7cmV0dXJuIGl9LHMuc3RyZWFtX29wcz11LHN9LGNyZWF0ZVByZWxvYWRlZEZpbGU6KGUscix0LG4sbyxpLHMsdSxjLGwpPT57dmFyIGQ9cj9nci5yZXNvbHZlKHdyLmpvaW4yKGUscikpOmU7ZnVuY3Rpb24gZih0KXtmdW5jdGlvbiBhKHQpe2wmJmwoKSx1fHxici5jcmVhdGVEYXRhRmlsZShlLHIsdCxuLG8sYyksaSYmaSgpLFEoKX1Ccm93c2VyLmhhbmRsZWRCeVByZWxvYWRQbHVnaW4odCxkLGEsKCgpPT57cyYmcygpLFEoKX0pKXx8YSh0KX1KKCksInN0cmluZyI9PXR5cGVvZiB0P2Z1bmN0aW9uKGUscix0LG4pe3ZhciBvPSJhbCAiK2U7YShlLChmdW5jdGlvbihyKXt2KHIsJ0xvYWRpbmcgZGF0YSBmaWxlICInK2UrJyIgZmFpbGVkIChubyBhcnJheUJ1ZmZlcikuJyksZihuZXcgVWludDhBcnJheShyKSksbyYmUSgpfSksKGZ1bmN0aW9uKHIpe2lmKCF0KXRocm93J0xvYWRpbmcgZGF0YSBmaWxlICInK2UrJyIgZmFpbGVkLic7dCgpfSkpLG8mJkooKX0odCwwLHMpOmYodCl9LGluZGV4ZWREQjooKT0+d2luZG93LmluZGV4ZWREQnx8d2luZG93Lm1vekluZGV4ZWREQnx8d2luZG93LndlYmtpdEluZGV4ZWREQnx8d2luZG93Lm1zSW5kZXhlZERCLERCX05BTUU6KCk9PiJFTV9GU18iK3dpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSxEQl9WRVJTSU9OOjIwLERCX1NUT1JFX05BTUU6IkZJTEVfREFUQSIsc2F2ZUZpbGVzVG9EQjooZSxyLHQpPT57cj1yfHwoKCk9Pnt9KSx0PXR8fCgoKT0+e30pO3ZhciBuPWJyLmluZGV4ZWREQigpO3RyeXt2YXIgbz1uLm9wZW4oYnIuREJfTkFNRSgpLGJyLkRCX1ZFUlNJT04pfWNhdGNoKGUpe3JldHVybiB0KGUpfW8ub251cGdyYWRlbmVlZGVkPSgpPT57bCgiY3JlYXRpbmcgZGIiKSxvLnJlc3VsdC5jcmVhdGVPYmplY3RTdG9yZShici5EQl9TVE9SRV9OQU1FKX0sby5vbnN1Y2Nlc3M9KCk9Pnt2YXIgbj1vLnJlc3VsdC50cmFuc2FjdGlvbihbYnIuREJfU1RPUkVfTkFNRV0sInJlYWR3cml0ZSIpLGE9bi5vYmplY3RTdG9yZShici5EQl9TVE9SRV9OQU1FKSxpPTAscz0wLHU9ZS5sZW5ndGg7ZnVuY3Rpb24gYygpezA9PXM/cigpOnQoKX1lLmZvckVhY2goKGU9Pnt2YXIgcj1hLnB1dChici5hbmFseXplUGF0aChlKS5vYmplY3QuY29udGVudHMsZSk7ci5vbnN1Y2Nlc3M9KCk9PnsrK2krcz09dSYmYygpfSxyLm9uZXJyb3I9KCk9PntzKyssaStzPT11JiZjKCl9fSkpLG4ub25lcnJvcj10fSxvLm9uZXJyb3I9dH0sbG9hZEZpbGVzRnJvbURCOihlLHIsdCk9PntyPXJ8fCgoKT0+e30pLHQ9dHx8KCgpPT57fSk7dmFyIG49YnIuaW5kZXhlZERCKCk7dHJ5e3ZhciBvPW4ub3Blbihici5EQl9OQU1FKCksYnIuREJfVkVSU0lPTil9Y2F0Y2goZSl7cmV0dXJuIHQoZSl9by5vbnVwZ3JhZGVuZWVkZWQ9dCxvLm9uc3VjY2Vzcz0oKT0+e3ZhciBuPW8ucmVzdWx0O3RyeXt2YXIgYT1uLnRyYW5zYWN0aW9uKFtici5EQl9TVE9SRV9OQU1FXSwicmVhZG9ubHkiKX1jYXRjaChlKXtyZXR1cm4gdm9pZCB0KGUpfXZhciBpPWEub2JqZWN0U3RvcmUoYnIuREJfU1RPUkVfTkFNRSkscz0wLHU9MCxjPWUubGVuZ3RoO2Z1bmN0aW9uIGwoKXswPT11P3IoKTp0KCl9ZS5mb3JFYWNoKChlPT57dmFyIHI9aS5nZXQoZSk7ci5vbnN1Y2Nlc3M9KCk9Pntici5hbmFseXplUGF0aChlKS5leGlzdHMmJmJyLnVubGluayhlKSxici5jcmVhdGVEYXRhRmlsZSh3ci5kaXJuYW1lKGUpLHdyLmJhc2VuYW1lKGUpLHIucmVzdWx0LCEwLCEwLCEwKSwrK3MrdT09YyYmbCgpfSxyLm9uZXJyb3I9KCk9Pnt1Kysscyt1PT1jJiZsKCl9fSkpLGEub25lcnJvcj10fSxvLm9uZXJyb3I9dH19LGtyPXtERUZBVUxUX1BPTExNQVNLOjUsY2FsY3VsYXRlQXQ6ZnVuY3Rpb24oZSxyLHQpe2lmKHdyLmlzQWJzKHIpKXJldHVybiByO3ZhciBuO2lmKC0xMDA9PT1lKW49YnIuY3dkKCk7ZWxzZXt2YXIgbz1ici5nZXRTdHJlYW0oZSk7aWYoIW8pdGhyb3cgbmV3IGJyLkVycm5vRXJyb3IoOCk7bj1vLnBhdGh9aWYoMD09ci5sZW5ndGgpe2lmKCF0KXRocm93IG5ldyBici5FcnJub0Vycm9yKDQ0KTtyZXR1cm4gbn1yZXR1cm4gd3Iuam9pbjIobixyKX0sZG9TdGF0OmZ1bmN0aW9uKGUscix0KXt0cnl7dmFyIG49ZShyKX1jYXRjaChlKXtpZihlJiZlLm5vZGUmJndyLm5vcm1hbGl6ZShyKSE9PXdyLm5vcm1hbGl6ZShici5nZXRQYXRoKGUubm9kZSkpKXJldHVybi01NDt0aHJvdyBlfXJldHVybiBEW3Q+PjJdPW4uZGV2LERbdCs0Pj4yXT0wLERbdCs4Pj4yXT1uLmlubyxEW3QrMTI+PjJdPW4ubW9kZSxEW3QrMTY+PjJdPW4ubmxpbmssRFt0KzIwPj4yXT1uLnVpZCxEW3QrMjQ+PjJdPW4uZ2lkLERbdCsyOD4+Ml09bi5yZGV2LERbdCszMj4+Ml09MCxVPVtuLnNpemU+Pj4wLChMPW4uc2l6ZSwrTWF0aC5hYnMoTCk+PTE/TD4wPygwfE1hdGgubWluKCtNYXRoLmZsb29yKEwvNDI5NDk2NzI5NiksNDI5NDk2NzI5NSkpPj4+MDp+fitNYXRoLmNlaWwoKEwtKyh+fkw+Pj4wKSkvNDI5NDk2NzI5Nik+Pj4wOjApXSxEW3QrNDA+PjJdPVVbMF0sRFt0KzQ0Pj4yXT1VWzFdLERbdCs0OD4+Ml09NDA5NixEW3QrNTI+PjJdPW4uYmxvY2tzLERbdCs1Nj4+Ml09bi5hdGltZS5nZXRUaW1lKCkvMWUzfDAsRFt0KzYwPj4yXT0wLERbdCs2ND4+Ml09bi5tdGltZS5nZXRUaW1lKCkvMWUzfDAsRFt0KzY4Pj4yXT0wLERbdCs3Mj4+Ml09bi5jdGltZS5nZXRUaW1lKCkvMWUzfDAsRFt0Kzc2Pj4yXT0wLFU9W24uaW5vPj4+MCwoTD1uLmlubywrTWF0aC5hYnMoTCk+PTE/TD4wPygwfE1hdGgubWluKCtNYXRoLmZsb29yKEwvNDI5NDk2NzI5NiksNDI5NDk2NzI5NSkpPj4+MDp+fitNYXRoLmNlaWwoKEwtKyh+fkw+Pj4wKSkvNDI5NDk2NzI5Nik+Pj4wOjApXSxEW3QrODA+PjJdPVVbMF0sRFt0Kzg0Pj4yXT1VWzFdLDB9LGRvTXN5bmM6ZnVuY3Rpb24oZSxyLHQsbixvKXt2YXIgYT1ULnNsaWNlKGUsZSt0KTtici5tc3luYyhyLGEsbyx0LG4pfSxkb01rbm9kOmZ1bmN0aW9uKGUscix0KXtzd2l0Y2goNjE0NDAmcil7Y2FzZSAzMjc2ODpjYXNlIDgxOTI6Y2FzZSAyNDU3NjpjYXNlIDQwOTY6Y2FzZSA0OTE1MjpicmVhaztkZWZhdWx0OnJldHVybi0yOH1yZXR1cm4gYnIubWtub2QoZSxyLHQpLDB9LGRvUmVhZGxpbms6ZnVuY3Rpb24oZSxyLHQpe2lmKHQ8PTApcmV0dXJuLTI4O3ZhciBuPWJyLnJlYWRsaW5rKGUpLG89TWF0aC5taW4odCxiKG4pKSxhPVBbcitvXTtyZXR1cm4gXyhuLHIsdCsxKSxQW3Irb109YSxvfSxkb0FjY2VzczpmdW5jdGlvbihlLHIpe2lmKC04JnIpcmV0dXJuLTI4O3ZhciB0PWJyLmxvb2t1cFBhdGgoZSx7Zm9sbG93OiEwfSkubm9kZTtpZighdClyZXR1cm4tNDQ7dmFyIG49IiI7cmV0dXJuIDQmciYmKG4rPSJyIiksMiZyJiYobis9InciKSwxJnImJihuKz0ieCIpLG4mJmJyLm5vZGVQZXJtaXNzaW9ucyh0LG4pPy0yOjB9LGRvUmVhZHY6ZnVuY3Rpb24oZSxyLHQsbil7Zm9yKHZhciBvPTAsYT0wO2E8dDthKyspe3ZhciBpPURbcj4+Ml0scz1EW3IrND4+Ml07cis9ODt2YXIgdT1ici5yZWFkKGUsUCxpLHMsbik7aWYodTwwKXJldHVybi0xO2lmKG8rPXUsdTxzKWJyZWFrfXJldHVybiBvfSxkb1dyaXRldjpmdW5jdGlvbihlLHIsdCxuKXtmb3IodmFyIG89MCxhPTA7YTx0O2ErKyl7dmFyIGk9RFtyPj4yXSxzPURbcis0Pj4yXTtyKz04O3ZhciB1PWJyLndyaXRlKGUsUCxpLHMsbik7aWYodTwwKXJldHVybi0xO28rPXV9cmV0dXJuIG99LHZhcmFyZ3M6dm9pZCAwLGdldDpmdW5jdGlvbigpe3JldHVybiBrci52YXJhcmdzKz00LERba3IudmFyYXJncy00Pj4yXX0sZ2V0U3RyOmZ1bmN0aW9uKGUpe3JldHVybiBnKGUpfSxnZXRTdHJlYW1Gcm9tRkQ6ZnVuY3Rpb24oZSl7dmFyIHI9YnIuZ2V0U3RyZWFtKGUpO2lmKCFyKXRocm93IG5ldyBici5FcnJub0Vycm9yKDgpO3JldHVybiByfX07ZnVuY3Rpb24gUHIoZSl7cmV0dXJuIGUlND09MCYmKGUlMTAwIT0wfHxlJTQwMD09MCl9dmFyIFRyPVszMSwyOSwzMSwzMCwzMSwzMCwzMSwzMSwzMCwzMSwzMCwzMV0sU3I9WzMxLDI4LDMxLDMwLDMxLDMwLDMxLDMxLDMwLDMxLDMwLDMxXTt5ZT1lLkludGVybmFsRXJyb3I9dmUoRXJyb3IsIkludGVybmFsRXJyb3IiKSxmdW5jdGlvbigpe2Zvcih2YXIgZT1uZXcgQXJyYXkoMjU2KSxyPTA7cjwyNTY7KytyKWVbcl09U3RyaW5nLmZyb21DaGFyQ29kZShyKTtfZT1lfSgpLGtlPWUuQmluZGluZ0Vycm9yPXZlKEVycm9yLCJCaW5kaW5nRXJyb3IiKSx6ZS5wcm90b3R5cGUuaXNBbGlhc09mPWZ1bmN0aW9uKGUpe2lmKCEodGhpcyBpbnN0YW5jZW9mIHplKSlyZXR1cm4hMTtpZighKGUgaW5zdGFuY2VvZiB6ZSkpcmV0dXJuITE7Zm9yKHZhciByPXRoaXMuJCQucHRyVHlwZS5yZWdpc3RlcmVkQ2xhc3MsdD10aGlzLiQkLnB0cixuPWUuJCQucHRyVHlwZS5yZWdpc3RlcmVkQ2xhc3Msbz1lLiQkLnB0cjtyLmJhc2VDbGFzczspdD1yLnVwY2FzdCh0KSxyPXIuYmFzZUNsYXNzO2Zvcig7bi5iYXNlQ2xhc3M7KW89bi51cGNhc3Qobyksbj1uLmJhc2VDbGFzcztyZXR1cm4gcj09PW4mJnQ9PT1vfSx6ZS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtpZih0aGlzLiQkLnB0cnx8U2UodGhpcyksdGhpcy4kJC5wcmVzZXJ2ZVBvaW50ZXJPbkRlbGV0ZSlyZXR1cm4gdGhpcy4kJC5jb3VudC52YWx1ZSs9MSx0aGlzO3ZhciBlLHI9SWUoT2JqZWN0LmNyZWF0ZShPYmplY3QuZ2V0UHJvdG90eXBlT2YodGhpcykseyQkOnt2YWx1ZTooZT10aGlzLiQkLHtjb3VudDplLmNvdW50LGRlbGV0ZVNjaGVkdWxlZDplLmRlbGV0ZVNjaGVkdWxlZCxwcmVzZXJ2ZVBvaW50ZXJPbkRlbGV0ZTplLnByZXNlcnZlUG9pbnRlck9uRGVsZXRlLHB0cjplLnB0cixwdHJUeXBlOmUucHRyVHlwZSxzbWFydFB0cjplLnNtYXJ0UHRyLHNtYXJ0UHRyVHlwZTplLnNtYXJ0UHRyVHlwZX0pfX0pKTtyZXR1cm4gci4kJC5jb3VudC52YWx1ZSs9MSxyLiQkLmRlbGV0ZVNjaGVkdWxlZD0hMSxyfSx6ZS5wcm90b3R5cGUuZGVsZXRlPWZ1bmN0aW9uKCl7dGhpcy4kJC5wdHJ8fFNlKHRoaXMpLHRoaXMuJCQuZGVsZXRlU2NoZWR1bGVkJiYhdGhpcy4kJC5wcmVzZXJ2ZVBvaW50ZXJPbkRlbGV0ZSYmUGUoIk9iamVjdCBhbHJlYWR5IHNjaGVkdWxlZCBmb3IgZGVsZXRpb24iKSxEZSh0aGlzKSxGZSh0aGlzLiQkKSx0aGlzLiQkLnByZXNlcnZlUG9pbnRlck9uRGVsZXRlfHwodGhpcy4kJC5zbWFydFB0cj12b2lkIDAsdGhpcy4kJC5wdHI9dm9pZCAwKX0semUucHJvdG90eXBlLmlzRGVsZXRlZD1mdW5jdGlvbigpe3JldHVybiF0aGlzLiQkLnB0cn0semUucHJvdG90eXBlLmRlbGV0ZUxhdGVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJCQucHRyfHxTZSh0aGlzKSx0aGlzLiQkLmRlbGV0ZVNjaGVkdWxlZCYmIXRoaXMuJCQucHJlc2VydmVQb2ludGVyT25EZWxldGUmJlBlKCJPYmplY3QgYWxyZWFkeSBzY2hlZHVsZWQgZm9yIGRlbGV0aW9uIiksJGUucHVzaCh0aGlzKSwxPT09JGUubGVuZ3RoJiZPZSYmT2UoeGUpLHRoaXMuJCQuZGVsZXRlU2NoZWR1bGVkPSEwLHRoaXN9LGUuZ2V0SW5oZXJpdGVkSW5zdGFuY2VDb3VudD1mdW5jdGlvbigpe3JldHVybiBPYmplY3Qua2V5cyhSZSkubGVuZ3RofSxlLmdldExpdmVJbmhlcml0ZWRJbnN0YW5jZXM9ZnVuY3Rpb24oKXt2YXIgZT1bXTtmb3IodmFyIHIgaW4gUmUpUmUuaGFzT3duUHJvcGVydHkocikmJmUucHVzaChSZVtyXSk7cmV0dXJuIGV9LGUuZmx1c2hQZW5kaW5nRGVsZXRlcz14ZSxlLnNldERlbGF5RnVuY3Rpb249ZnVuY3Rpb24oZSl7T2U9ZSwkZS5sZW5ndGgmJk9lJiZPZSh4ZSl9LFllLnByb3RvdHlwZS5nZXRQb2ludGVlPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnJhd0dldFBvaW50ZWUmJihlPXRoaXMucmF3R2V0UG9pbnRlZShlKSksZX0sWWUucHJvdG90eXBlLmRlc3RydWN0b3I9ZnVuY3Rpb24oZSl7dGhpcy5yYXdEZXN0cnVjdG9yJiZ0aGlzLnJhd0Rlc3RydWN0b3IoZSl9LFllLnByb3RvdHlwZS5hcmdQYWNrQWR2YW5jZT04LFllLnByb3RvdHlwZS5yZWFkVmFsdWVGcm9tUG9pbnRlcj1sZSxZZS5wcm90b3R5cGUuZGVsZXRlT2JqZWN0PWZ1bmN0aW9uKGUpe251bGwhPT1lJiZlLmRlbGV0ZSgpfSxZZS5wcm90b3R5cGUuZnJvbVdpcmVUeXBlPWZ1bmN0aW9uKGUpe3ZhciByPXRoaXMuZ2V0UG9pbnRlZShlKTtpZighcilyZXR1cm4gdGhpcy5kZXN0cnVjdG9yKGUpLG51bGw7dmFyIHQ9ZnVuY3Rpb24oZSxyKXtyZXR1cm4gcj1mdW5jdGlvbihlLHIpe2Zvcih2b2lkIDA9PT1yJiZQZSgicHRyIHNob3VsZCBub3QgYmUgdW5kZWZpbmVkIik7ZS5iYXNlQ2xhc3M7KXI9ZS51cGNhc3QociksZT1lLmJhc2VDbGFzcztyZXR1cm4gcn0oZSxyKSxSZVtyXX0odGhpcy5yZWdpc3RlcmVkQ2xhc3Mscik7aWYodm9pZCAwIT09dCl7aWYoMD09PXQuJCQuY291bnQudmFsdWUpcmV0dXJuIHQuJCQucHRyPXIsdC4kJC5zbWFydFB0cj1lLHQuY2xvbmUoKTt2YXIgbj10LmNsb25lKCk7cmV0dXJuIHRoaXMuZGVzdHJ1Y3RvcihlKSxufWZ1bmN0aW9uIG8oKXtyZXR1cm4gdGhpcy5pc1NtYXJ0UG9pbnRlcj9qZSh0aGlzLnJlZ2lzdGVyZWRDbGFzcy5pbnN0YW5jZVByb3RvdHlwZSx7cHRyVHlwZTp0aGlzLnBvaW50ZWVUeXBlLHB0cjpyLHNtYXJ0UHRyVHlwZTp0aGlzLHNtYXJ0UHRyOmV9KTpqZSh0aGlzLnJlZ2lzdGVyZWRDbGFzcy5pbnN0YW5jZVByb3RvdHlwZSx7cHRyVHlwZTp0aGlzLHB0cjplfSl9dmFyIGEsaT10aGlzLnJlZ2lzdGVyZWRDbGFzcy5nZXRBY3R1YWxUeXBlKHIpLHM9TWVbaV07aWYoIXMpcmV0dXJuIG8uY2FsbCh0aGlzKTthPXRoaXMuaXNDb25zdD9zLmNvbnN0UG9pbnRlclR5cGU6cy5wb2ludGVyVHlwZTt2YXIgdT1BZShyLHRoaXMucmVnaXN0ZXJlZENsYXNzLGEucmVnaXN0ZXJlZENsYXNzKTtyZXR1cm4gbnVsbD09PXU/by5jYWxsKHRoaXMpOnRoaXMuaXNTbWFydFBvaW50ZXI/amUoYS5yZWdpc3RlcmVkQ2xhc3MuaW5zdGFuY2VQcm90b3R5cGUse3B0clR5cGU6YSxwdHI6dSxzbWFydFB0clR5cGU6dGhpcyxzbWFydFB0cjplfSk6amUoYS5yZWdpc3RlcmVkQ2xhc3MuaW5zdGFuY2VQcm90b3R5cGUse3B0clR5cGU6YSxwdHI6dX0pfSxKZT1lLlVuYm91bmRUeXBlRXJyb3I9dmUoRXJyb3IsIlVuYm91bmRUeXBlRXJyb3IiKSxlLmNvdW50X2VtdmFsX2hhbmRsZXM9ZnVuY3Rpb24oKXtmb3IodmFyIGU9MCxyPTU7cjxuci5sZW5ndGg7KytyKXZvaWQgMCE9PW5yW3JdJiYrK2U7cmV0dXJuIGV9LGUuZ2V0X2ZpcnN0X2VtdmFsPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPTU7ZTxuci5sZW5ndGg7KytlKWlmKHZvaWQgMCE9PW5yW2VdKXJldHVybiBucltlXTtyZXR1cm4gbnVsbH07dmFyIENyPWZ1bmN0aW9uKGUscix0LG4pe2V8fChlPXRoaXMpLHRoaXMucGFyZW50PWUsdGhpcy5tb3VudD1lLm1vdW50LHRoaXMubW91bnRlZD1udWxsLHRoaXMuaWQ9YnIubmV4dElub2RlKyssdGhpcy5uYW1lPXIsdGhpcy5tb2RlPXQsdGhpcy5ub2RlX29wcz17fSx0aGlzLnN0cmVhbV9vcHM9e30sdGhpcy5yZGV2PW59O2Z1bmN0aW9uIERyKGUscix0KXt2YXIgbj10PjA/dDpiKGUpKzEsbz1uZXcgQXJyYXkobiksYT1FKGUsbywwLG8ubGVuZ3RoKTtyZXR1cm4gciYmKG8ubGVuZ3RoPWEpLG99T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoQ3IucHJvdG90eXBlLHtyZWFkOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gMzY1PT0oMzY1JnRoaXMubW9kZSl9LHNldDpmdW5jdGlvbihlKXtlP3RoaXMubW9kZXw9MzY1OnRoaXMubW9kZSY9LTM2Nn19LHdyaXRlOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gMTQ2PT0oMTQ2JnRoaXMubW9kZSl9LHNldDpmdW5jdGlvbihlKXtlP3RoaXMubW9kZXw9MTQ2OnRoaXMubW9kZSY9LTE0N319LGlzRm9sZGVyOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gYnIuaXNEaXIodGhpcy5tb2RlKX19LGlzRGV2aWNlOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gYnIuaXNDaHJkZXYodGhpcy5tb2RlKX19fSksYnIuRlNOb2RlPUNyLGJyLnN0YXRpY0luaXQoKTt2YXIgRnIsQXI9e2E6ZnVuY3Rpb24oZSxyLHQsbil7SygiQXNzZXJ0aW9uIGZhaWxlZDogIitnKGUpKyIsIGF0OiAiK1tyP2cocik6InVua25vd24gZmlsZW5hbWUiLHQsbj9nKG4pOiJ1bmtub3duIGZ1bmN0aW9uIl0pfSxnOmZ1bmN0aW9uKGUpe3JldHVybiAkcihlKzI0KSsyNH0sdzpmdW5jdGlvbihlKXt2YXIgcj1uZXcgYWUoZSk7cmV0dXJuIHIuZ2V0X2NhdWdodCgpfHwoci5zZXRfY2F1Z2h0KCEwKSxuZS0tKSxyLnNldF9yZXRocm93bighMSksdGUucHVzaChyKSxmdW5jdGlvbihlKXtlLmFkZF9yZWYoKX0ociksci5nZXRfZXhjZXB0aW9uX3B0cigpfSx6OmZ1bmN0aW9uKCl7anIoMCksZnVuY3Rpb24oZSl7aWYoZS5yZWxlYXNlX3JlZigpJiYhZS5nZXRfcmV0aHJvd24oKSl7dmFyIHI9ZS5nZXRfZGVzdHJ1Y3RvcigpO3ImJnJlKHIpKGUuZXhjUHRyKSxpZShlLmV4Y1B0cil9fSh0ZS5wb3AoKSksb2U9MH0sZDpmdW5jdGlvbigpe3ZhciBlPW9lO2lmKCFlKXJldHVybiBoKDApLDA7dmFyIHI9bmV3IGFlKGUpO3Iuc2V0X2FkanVzdGVkX3B0cihlKTt2YXIgdD1yLmdldF90eXBlKCk7aWYoIXQpcmV0dXJuIGgoMCksMHxlO2Zvcih2YXIgbj1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLG89MDtvPG4ubGVuZ3RoO28rKyl7dmFyIGE9bltvXTtpZigwPT09YXx8YT09PXQpYnJlYWs7dmFyIGk9ci5wdHIrMTY7aWYoQnIoYSx0LGkpKXJldHVybiBoKGEpLDB8ZX1yZXR1cm4gaCh0KSwwfGV9LGw6ZnVuY3Rpb24oKXt2YXIgZT1vZTtpZighZSlyZXR1cm4gaCgwKSwwO3ZhciByPW5ldyBhZShlKTtyLnNldF9hZGp1c3RlZF9wdHIoZSk7dmFyIHQ9ci5nZXRfdHlwZSgpO2lmKCF0KXJldHVybiBoKDApLDB8ZTtmb3IodmFyIG49QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKSxvPTA7bzxuLmxlbmd0aDtvKyspe3ZhciBhPW5bb107aWYoMD09PWF8fGE9PT10KWJyZWFrO3ZhciBpPXIucHRyKzE2O2lmKEJyKGEsdCxpKSlyZXR1cm4gaChhKSwwfGV9cmV0dXJuIGgodCksMHxlfSxDOmllLFg6ZnVuY3Rpb24oKXt2YXIgZT10ZS5wb3AoKTtlfHxLKCJubyBleGNlcHRpb24gdG8gdGhyb3ciKTt2YXIgcj1lLmV4Y1B0cjt0aHJvdyBlLmdldF9yZXRocm93bigpfHwodGUucHVzaChlKSxlLnNldF9yZXRocm93bighMCksZS5zZXRfY2F1Z2h0KCExKSxuZSsrKSxvZT1yLHJ9LGY6ZnVuY3Rpb24oZSxyLHQpe3Rocm93IG5ldyBhZShlKS5pbml0KHIsdCksb2U9ZSxuZSsrLGV9LGdhOmZ1bmN0aW9uKCl7cmV0dXJuIG5lfSxpOmZ1bmN0aW9uKGUpe3Rocm93IG9lfHwob2U9ZSksZX0scWE6ZnVuY3Rpb24oZSl7fSxzYTpmdW5jdGlvbihlLHIpe0soc2UpfSxyYTpmdW5jdGlvbihlLHIpe0soc2UpfSxZOmZ1bmN0aW9uKGUpe3ZhciByPXVlW2VdO2RlbGV0ZSB1ZVtlXTt2YXIgdD1yLnJhd0NvbnN0cnVjdG9yLG49ci5yYXdEZXN0cnVjdG9yLG89ci5maWVsZHM7Z2UoW2VdLG8ubWFwKChlPT5lLmdldHRlclJldHVyblR5cGUpKS5jb25jYXQoby5tYXAoKGU9PmUuc2V0dGVyQXJndW1lbnRUeXBlKSkpLChlPT57dmFyIGE9e307cmV0dXJuIG8uZm9yRWFjaCgoKHIsdCk9Pnt2YXIgbj1yLmZpZWxkTmFtZSxpPWVbdF0scz1yLmdldHRlcix1PXIuZ2V0dGVyQ29udGV4dCxjPWVbdCtvLmxlbmd0aF0sbD1yLnNldHRlcixkPXIuc2V0dGVyQ29udGV4dDthW25dPXtyZWFkOmU9PmkuZnJvbVdpcmVUeXBlKHModSxlKSksd3JpdGU6KGUscik9Pnt2YXIgdD1bXTtsKGQsZSxjLnRvV2lyZVR5cGUodCxyKSksY2UodCl9fX0pKSxbe25hbWU6ci5uYW1lLGZyb21XaXJlVHlwZTpmdW5jdGlvbihlKXt2YXIgcj17fTtmb3IodmFyIHQgaW4gYSlyW3RdPWFbdF0ucmVhZChlKTtyZXR1cm4gbihlKSxyfSx0b1dpcmVUeXBlOmZ1bmN0aW9uKGUscil7Zm9yKHZhciBvIGluIGEpaWYoIShvIGluIHIpKXRocm93IG5ldyBUeXBlRXJyb3IoJ01pc3NpbmcgZmllbGQ6ICAiJytvKyciJyk7dmFyIGk9dCgpO2ZvcihvIGluIGEpYVtvXS53cml0ZShpLHJbb10pO3JldHVybiBudWxsIT09ZSYmZS5wdXNoKG4saSksaX0sYXJnUGFja0FkdmFuY2U6OCxyZWFkVmFsdWVGcm9tUG9pbnRlcjpsZSxkZXN0cnVjdG9yRnVuY3Rpb246bn1dfSkpfSxjYTpmdW5jdGlvbihlLHIsdCxuLG8pe30sd2E6ZnVuY3Rpb24oZSxyLHQsbixvKXt2YXIgYT1FZSh0KTtUZShlLHtuYW1lOnI9YmUociksZnJvbVdpcmVUeXBlOmZ1bmN0aW9uKGUpe3JldHVybiEhZX0sdG9XaXJlVHlwZTpmdW5jdGlvbihlLHIpe3JldHVybiByP246b30sYXJnUGFja0FkdmFuY2U6OCxyZWFkVmFsdWVGcm9tUG9pbnRlcjpmdW5jdGlvbihlKXt2YXIgbjtpZigxPT09dCluPVA7ZWxzZSBpZigyPT09dCluPVM7ZWxzZXtpZig0IT09dCl0aHJvdyBuZXcgVHlwZUVycm9yKCJVbmtub3duIGJvb2xlYW4gdHlwZSBzaXplOiAiK3IpO249RH1yZXR1cm4gdGhpcy5mcm9tV2lyZVR5cGUobltlPj5hXSl9LGRlc3RydWN0b3JGdW5jdGlvbjpudWxsfSl9LHg6ZnVuY3Rpb24oZSxyLHQsbixvLGEsaSxzLHUsYyxsLGQsZil7bD1iZShsKSxhPVhlKG8sYSkscyYmKHM9WGUoaSxzKSksYyYmKGM9WGUodSxjKSksZj1YZShkLGYpO3ZhciBwPWhlKGwpO1dlKHAsKGZ1bmN0aW9uKCl7S2UoIkNhbm5vdCBjb25zdHJ1Y3QgIitsKyIgZHVlIHRvIHVuYm91bmQgdHlwZXMiLFtuXSl9KSksZ2UoW2Uscix0XSxuP1tuXTpbXSwoZnVuY3Rpb24ocil7dmFyIHQsbztyPXJbMF0sbz1uPyh0PXIucmVnaXN0ZXJlZENsYXNzKS5pbnN0YW5jZVByb3RvdHlwZTp6ZS5wcm90b3R5cGU7dmFyIGk9bWUocCwoZnVuY3Rpb24oKXtpZihPYmplY3QuZ2V0UHJvdG90eXBlT2YodGhpcykhPT11KXRocm93IG5ldyBrZSgiVXNlICduZXcnIHRvIGNvbnN0cnVjdCAiK2wpO2lmKHZvaWQgMD09PWQuY29uc3RydWN0b3JfYm9keSl0aHJvdyBuZXcga2UobCsiIGhhcyBubyBhY2Nlc3NpYmxlIGNvbnN0cnVjdG9yIik7dmFyIGU9ZC5jb25zdHJ1Y3Rvcl9ib2R5W2FyZ3VtZW50cy5sZW5ndGhdO2lmKHZvaWQgMD09PWUpdGhyb3cgbmV3IGtlKCJUcmllZCB0byBpbnZva2UgY3RvciBvZiAiK2wrIiB3aXRoIGludmFsaWQgbnVtYmVyIG9mIHBhcmFtZXRlcnMgKCIrYXJndW1lbnRzLmxlbmd0aCsiKSAtIGV4cGVjdGVkICgiK09iamVjdC5rZXlzKGQuY29uc3RydWN0b3JfYm9keSkudG9TdHJpbmcoKSsiKSBwYXJhbWV0ZXJzIGluc3RlYWQhIik7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSkpLHU9T2JqZWN0LmNyZWF0ZShvLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6aX19KTtpLnByb3RvdHlwZT11O3ZhciBkPW5ldyBOZShsLGksdSxmLHQsYSxzLGMpLGg9bmV3IFllKGwsZCwhMCwhMSwhMSksbT1uZXcgWWUobCsiKiIsZCwhMSwhMSwhMSksdj1uZXcgWWUobCsiIGNvbnN0KiIsZCwhMSwhMCwhMSk7cmV0dXJuIE1lW2VdPXtwb2ludGVyVHlwZTptLGNvbnN0UG9pbnRlclR5cGU6dn0scWUocCxpKSxbaCxtLHZdfSkpfSxPOmZ1bmN0aW9uKGUscix0LG4sbyxhLGkpe3ZhciBzPXJyKHQsbik7cj1iZShyKSxhPVhlKG8sYSksZ2UoW10sW2VdLChmdW5jdGlvbihlKXt2YXIgbj0oZT1lWzBdKS5uYW1lKyIuIityO2Z1bmN0aW9uIG8oKXtLZSgiQ2Fubm90IGNhbGwgIituKyIgZHVlIHRvIHVuYm91bmQgdHlwZXMiLHMpfXIuc3RhcnRzV2l0aCgiQEAiKSYmKHI9U3ltYm9sW3Iuc3Vic3RyaW5nKDIpXSk7dmFyIHU9ZS5yZWdpc3RlcmVkQ2xhc3MuY29uc3RydWN0b3I7cmV0dXJuIHZvaWQgMD09PXVbcl0/KG8uYXJnQ291bnQ9dC0xLHVbcl09byk6KEJlKHUscixuKSx1W3JdLm92ZXJsb2FkVGFibGVbdC0xXT1vKSxnZShbXSxzLChmdW5jdGlvbihlKXt2YXIgbz1bZVswXSxudWxsXS5jb25jYXQoZS5zbGljZSgxKSkscz1lcihuLG8sbnVsbCxhLGkpO3JldHVybiB2b2lkIDA9PT11W3JdLm92ZXJsb2FkVGFibGU/KHMuYXJnQ291bnQ9dC0xLHVbcl09cyk6dVtyXS5vdmVybG9hZFRhYmxlW3QtMV09cyxbXX0pKSxbXX0pKX0sdTpmdW5jdGlvbihlLHIsdCxuLG8sYSl7dihyPjApO3ZhciBpPXJyKHIsdCk7bz1YZShuLG8pLGdlKFtdLFtlXSwoZnVuY3Rpb24oZSl7dmFyIHQ9ImNvbnN0cnVjdG9yICIrKGU9ZVswXSkubmFtZTtpZih2b2lkIDA9PT1lLnJlZ2lzdGVyZWRDbGFzcy5jb25zdHJ1Y3Rvcl9ib2R5JiYoZS5yZWdpc3RlcmVkQ2xhc3MuY29uc3RydWN0b3JfYm9keT1bXSksdm9pZCAwIT09ZS5yZWdpc3RlcmVkQ2xhc3MuY29uc3RydWN0b3JfYm9keVtyLTFdKXRocm93IG5ldyBrZSgiQ2Fubm90IHJlZ2lzdGVyIG11bHRpcGxlIGNvbnN0cnVjdG9ycyB3aXRoIGlkZW50aWNhbCBudW1iZXIgb2YgcGFyYW1ldGVycyAoIisoci0xKSsiKSBmb3IgY2xhc3MgJyIrZS5uYW1lKyInISBPdmVybG9hZCByZXNvbHV0aW9uIGlzIGN1cnJlbnRseSBvbmx5IHBlcmZvcm1lZCB1c2luZyB0aGUgcGFyYW1ldGVyIGNvdW50LCBub3QgYWN0dWFsIHR5cGUgaW5mbyEiKTtyZXR1cm4gZS5yZWdpc3RlcmVkQ2xhc3MuY29uc3RydWN0b3JfYm9keVtyLTFdPSgpPT57S2UoIkNhbm5vdCBjb25zdHJ1Y3QgIitlLm5hbWUrIiBkdWUgdG8gdW5ib3VuZCB0eXBlcyIsaSl9LGdlKFtdLGksKGZ1bmN0aW9uKG4pe3JldHVybiBuLnNwbGljZSgxLDAsbnVsbCksZS5yZWdpc3RlcmVkQ2xhc3MuY29uc3RydWN0b3JfYm9keVtyLTFdPWVyKHQsbixudWxsLG8sYSksW119KSksW119KSl9LGo6ZnVuY3Rpb24oZSxyLHQsbixvLGEsaSxzKXt2YXIgdT1ycih0LG4pO3I9YmUociksYT1YZShvLGEpLGdlKFtdLFtlXSwoZnVuY3Rpb24oZSl7dmFyIG49KGU9ZVswXSkubmFtZSsiLiIrcjtmdW5jdGlvbiBvKCl7S2UoIkNhbm5vdCBjYWxsICIrbisiIGR1ZSB0byB1bmJvdW5kIHR5cGVzIix1KX1yLnN0YXJ0c1dpdGgoIkBAIikmJihyPVN5bWJvbFtyLnN1YnN0cmluZygyKV0pLHMmJmUucmVnaXN0ZXJlZENsYXNzLnB1cmVWaXJ0dWFsRnVuY3Rpb25zLnB1c2gocik7dmFyIGM9ZS5yZWdpc3RlcmVkQ2xhc3MuaW5zdGFuY2VQcm90b3R5cGUsbD1jW3JdO3JldHVybiB2b2lkIDA9PT1sfHx2b2lkIDA9PT1sLm92ZXJsb2FkVGFibGUmJmwuY2xhc3NOYW1lIT09ZS5uYW1lJiZsLmFyZ0NvdW50PT09dC0yPyhvLmFyZ0NvdW50PXQtMixvLmNsYXNzTmFtZT1lLm5hbWUsY1tyXT1vKTooQmUoYyxyLG4pLGNbcl0ub3ZlcmxvYWRUYWJsZVt0LTJdPW8pLGdlKFtdLHUsKGZ1bmN0aW9uKG8pe3ZhciBzPWVyKG4sbyxlLGEsaSk7cmV0dXJuIHZvaWQgMD09PWNbcl0ub3ZlcmxvYWRUYWJsZT8ocy5hcmdDb3VudD10LTIsY1tyXT1zKTpjW3JdLm92ZXJsb2FkVGFibGVbdC0yXT1zLFtdfSkpLFtdfSkpfSx1YTpmdW5jdGlvbihlLHIpe1RlKGUse25hbWU6cj1iZShyKSxmcm9tV2lyZVR5cGU6ZnVuY3Rpb24oZSl7dmFyIHI9YXIudG9WYWx1ZShlKTtyZXR1cm4gb3IoZSkscn0sdG9XaXJlVHlwZTpmdW5jdGlvbihlLHIpe3JldHVybiBhci50b0hhbmRsZShyKX0sYXJnUGFja0FkdmFuY2U6OCxyZWFkVmFsdWVGcm9tUG9pbnRlcjpsZSxkZXN0cnVjdG9yRnVuY3Rpb246bnVsbH0pfSx5OmZ1bmN0aW9uKGUscix0LG4pe3ZhciBvPUVlKHQpO2Z1bmN0aW9uIGEoKXt9cj1iZShyKSxhLnZhbHVlcz17fSxUZShlLHtuYW1lOnIsY29uc3RydWN0b3I6YSxmcm9tV2lyZVR5cGU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuY29uc3RydWN0b3IudmFsdWVzW2VdfSx0b1dpcmVUeXBlOmZ1bmN0aW9uKGUscil7cmV0dXJuIHIudmFsdWV9LGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6aXIocixvLG4pLGRlc3RydWN0b3JGdW5jdGlvbjpudWxsfSksV2UocixhKX0sbTpmdW5jdGlvbihlLHIsdCl7dmFyIG49c3IoZSwiZW51bSIpO3I9YmUocik7dmFyIG89bi5jb25zdHJ1Y3RvcixhPU9iamVjdC5jcmVhdGUobi5jb25zdHJ1Y3Rvci5wcm90b3R5cGUse3ZhbHVlOnt2YWx1ZTp0fSxjb25zdHJ1Y3Rvcjp7dmFsdWU6bWUobi5uYW1lKyJfIityLChmdW5jdGlvbigpe30pKX19KTtvLnZhbHVlc1t0XT1hLG9bcl09YX0sVzpmdW5jdGlvbihlLHIsdCl7dmFyIG49RWUodCk7VGUoZSx7bmFtZTpyPWJlKHIpLGZyb21XaXJlVHlwZTpmdW5jdGlvbihlKXtyZXR1cm4gZX0sdG9XaXJlVHlwZTpmdW5jdGlvbihlLHIpe3JldHVybiByfSxhcmdQYWNrQWR2YW5jZTo4LHJlYWRWYWx1ZUZyb21Qb2ludGVyOmNyKHIsbiksZGVzdHJ1Y3RvckZ1bmN0aW9uOm51bGx9KX0seWE6ZnVuY3Rpb24oZSxyLHQsbixvLGEpe3ZhciBpPXJyKHIsdCk7ZT1iZShlKSxvPVhlKG4sbyksV2UoZSwoZnVuY3Rpb24oKXtLZSgiQ2Fubm90IGNhbGwgIitlKyIgZHVlIHRvIHVuYm91bmQgdHlwZXMiLGkpfSksci0xKSxnZShbXSxpLChmdW5jdGlvbih0KXt2YXIgbj1bdFswXSxudWxsXS5jb25jYXQodC5zbGljZSgxKSk7cmV0dXJuIHFlKGUsZXIoZSxuLG51bGwsbyxhKSxyLTEpLFtdfSkpfSxBOmZ1bmN0aW9uKGUscix0LG4sbyl7cj1iZShyKSwtMT09PW8mJihvPTQyOTQ5NjcyOTUpO3ZhciBhPUVlKHQpLGk9ZT0+ZTtpZigwPT09bil7dmFyIHM9MzItOCp0O2k9ZT0+ZTw8cz4+PnN9dmFyIHU9ci5pbmNsdWRlcygidW5zaWduZWQiKTtUZShlLHtuYW1lOnIsZnJvbVdpcmVUeXBlOmksdG9XaXJlVHlwZTp1P2Z1bmN0aW9uKGUscil7cmV0dXJuIHRoaXMubmFtZSxyPj4+MH06ZnVuY3Rpb24oZSxyKXtyZXR1cm4gdGhpcy5uYW1lLHJ9LGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6bHIocixhLDAhPT1uKSxkZXN0cnVjdG9yRnVuY3Rpb246bnVsbH0pfSxxOmZ1bmN0aW9uKGUscix0KXt2YXIgbj1bSW50OEFycmF5LFVpbnQ4QXJyYXksSW50MTZBcnJheSxVaW50MTZBcnJheSxJbnQzMkFycmF5LFVpbnQzMkFycmF5LEZsb2F0MzJBcnJheSxGbG9hdDY0QXJyYXldW3JdO2Z1bmN0aW9uIG8oZSl7dmFyIHI9Rix0PXJbZT4+PTJdLG89cltlKzFdO3JldHVybiBuZXcgbihrLG8sdCl9VGUoZSx7bmFtZTp0PWJlKHQpLGZyb21XaXJlVHlwZTpvLGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6b30se2lnbm9yZUR1cGxpY2F0ZVJlZ2lzdHJhdGlvbnM6ITB9KX0sVjpmdW5jdGlvbihlLHIpe3ZhciB0PSJzdGQ6OnN0cmluZyI9PT0ocj1iZShyKSk7VGUoZSx7bmFtZTpyLGZyb21XaXJlVHlwZTpmdW5jdGlvbihlKXt2YXIgcixuPUZbZT4+Ml07aWYodClmb3IodmFyIG89ZSs0LGE9MDthPD1uOysrYSl7dmFyIGk9ZSs0K2E7aWYoYT09bnx8MD09VFtpXSl7dmFyIHM9ZyhvLGktbyk7dm9pZCAwPT09cj9yPXM6KHIrPVN0cmluZy5mcm9tQ2hhckNvZGUoMCkscis9cyksbz1pKzF9fWVsc2V7dmFyIHU9bmV3IEFycmF5KG4pO2ZvcihhPTA7YTxuOysrYSl1W2FdPVN0cmluZy5mcm9tQ2hhckNvZGUoVFtlKzQrYV0pO3I9dS5qb2luKCIiKX1yZXR1cm4geHIoZSkscn0sdG9XaXJlVHlwZTpmdW5jdGlvbihlLHIpe3IgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciYmKHI9bmV3IFVpbnQ4QXJyYXkocikpO3ZhciBuPSJzdHJpbmciPT10eXBlb2YgcjtufHxyIGluc3RhbmNlb2YgVWludDhBcnJheXx8ciBpbnN0YW5jZW9mIFVpbnQ4Q2xhbXBlZEFycmF5fHxyIGluc3RhbmNlb2YgSW50OEFycmF5fHxQZSgiQ2Fubm90IHBhc3Mgbm9uLXN0cmluZyB0byBzdGQ6OnN0cmluZyIpO3ZhciBvPSh0JiZuPygpPT5iKHIpOigpPT5yLmxlbmd0aCkoKSxhPSRyKDQrbysxKTtpZihGW2E+PjJdPW8sdCYmbilfKHIsYSs0LG8rMSk7ZWxzZSBpZihuKWZvcih2YXIgaT0wO2k8bzsrK2kpe3ZhciBzPXIuY2hhckNvZGVBdChpKTtzPjI1NSYmKHhyKGEpLFBlKCJTdHJpbmcgaGFzIFVURi0xNiBjb2RlIHVuaXRzIHRoYXQgZG8gbm90IGZpdCBpbiA4IGJpdHMiKSksVFthKzQraV09c31lbHNlIGZvcihpPTA7aTxvOysraSlUW2ErNCtpXT1yW2ldO3JldHVybiBudWxsIT09ZSYmZS5wdXNoKHhyLGEpLGF9LGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6bGUsZGVzdHJ1Y3RvckZ1bmN0aW9uOmZ1bmN0aW9uKGUpe3hyKGUpfX0pfSxOOmZ1bmN0aW9uKGUscix0KXt2YXIgbixvLGEsaSxzO3Q9YmUodCksMj09PXI/KG49eCxvPU8saT1SLGE9KCk9PkMscz0xKTo0PT09ciYmKG49aixvPUksaT16LGE9KCk9PkYscz0yKSxUZShlLHtuYW1lOnQsZnJvbVdpcmVUeXBlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdCxvPUZbZT4+Ml0saT1hKCksdT1lKzQsYz0wO2M8PW87KytjKXt2YXIgbD1lKzQrYypyO2lmKGM9PW98fDA9PWlbbD4+c10pe3ZhciBkPW4odSxsLXUpO3ZvaWQgMD09PXQ/dD1kOih0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKDApLHQrPWQpLHU9bCtyfX1yZXR1cm4geHIoZSksdH0sdG9XaXJlVHlwZTpmdW5jdGlvbihlLG4peyJzdHJpbmciIT10eXBlb2YgbiYmUGUoIkNhbm5vdCBwYXNzIG5vbi1zdHJpbmcgdG8gQysrIHN0cmluZyB0eXBlICIrdCk7dmFyIGE9aShuKSx1PSRyKDQrYStyKTtyZXR1cm4gRlt1Pj4yXT1hPj5zLG8obix1KzQsYStyKSxudWxsIT09ZSYmZS5wdXNoKHhyLHUpLHV9LGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6bGUsZGVzdHJ1Y3RvckZ1bmN0aW9uOmZ1bmN0aW9uKGUpe3hyKGUpfX0pfSxaOmZ1bmN0aW9uKGUscix0LG4sbyxhKXt1ZVtlXT17bmFtZTpiZShyKSxyYXdDb25zdHJ1Y3RvcjpYZSh0LG4pLHJhd0Rlc3RydWN0b3I6WGUobyxhKSxmaWVsZHM6W119fSxHOmZ1bmN0aW9uKGUscix0LG4sbyxhLGkscyx1LGMpe3VlW2VdLmZpZWxkcy5wdXNoKHtmaWVsZE5hbWU6YmUociksZ2V0dGVyUmV0dXJuVHlwZTp0LGdldHRlcjpYZShuLG8pLGdldHRlckNvbnRleHQ6YSxzZXR0ZXJBcmd1bWVudFR5cGU6aSxzZXR0ZXI6WGUocyx1KSxzZXR0ZXJDb250ZXh0OmN9KX0seGE6ZnVuY3Rpb24oZSxyKXtUZShlLHtpc1ZvaWQ6ITAsbmFtZTpyPWJlKHIpLGFyZ1BhY2tBZHZhbmNlOjAsZnJvbVdpcmVUeXBlOmZ1bmN0aW9uKCl7fSx0b1dpcmVUeXBlOmZ1bmN0aW9uKGUscil7fX0pfSxVOmZ1bmN0aW9uKCl7cmV0dXJuIERhdGUubm93KCl9LG9hOmZ1bmN0aW9uKCl7cmV0dXJuITB9LGhhOmZ1bmN0aW9uKGUscix0KXtlPWFyLnRvVmFsdWUoZSkscj1zcihyLCJlbXZhbDo6YXMiKTt2YXIgbj1bXSxvPWFyLnRvSGFuZGxlKG4pO3JldHVybiBEW3Q+PjJdPW8sci50b1dpcmVUeXBlKG4sZSl9LHphOmZ1bmN0aW9uKGUscix0LG4peyhlPWhyW2VdKShyPWFyLnRvVmFsdWUociksdD1mcih0KSxudWxsLG4pfSxGOm9yLF86ZnVuY3Rpb24oZSxyKXt2YXIgdD1mdW5jdGlvbihlLHIpe2Zvcih2YXIgdD1uZXcgQXJyYXkoZSksbj0wO248ZTsrK24pdFtuXT1zcihEWyhyPj4yKStuXSwicGFyYW1ldGVyICIrbik7cmV0dXJuIHR9KGUsciksbj10WzBdLG89bi5uYW1lKyJfJCIrdC5zbGljZSgxKS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBlLm5hbWV9KSkuam9pbigiXyIpKyIkIixhPW1yW29dO2lmKHZvaWQgMCE9PWEpcmV0dXJuIGE7Zm9yKHZhciBpPVsicmV0VHlwZSJdLHM9W25dLHU9IiIsYz0wO2M8ZS0xOysrYyl1Kz0oMCE9PWM/IiwgIjoiIikrImFyZyIrYyxpLnB1c2goImFyZ1R5cGUiK2MpLHMucHVzaCh0WzErY10pO3ZhciBsLGQsZj0icmV0dXJuIGZ1bmN0aW9uICIraGUoIm1ldGhvZENhbGxlcl8iK28pKyIoaGFuZGxlLCBuYW1lLCBkZXN0cnVjdG9ycywgYXJncykge1xuIixwPTA7Zm9yKGM9MDtjPGUtMTsrK2MpZis9IiAgICB2YXIgYXJnIitjKyIgPSBhcmdUeXBlIitjKyIucmVhZFZhbHVlRnJvbVBvaW50ZXIoYXJncyIrKHA/IisiK3A6IiIpKyIpO1xuIixwKz10W2MrMV0uYXJnUGFja0FkdmFuY2U7Zm9yKGYrPSIgICAgdmFyIHJ2ID0gaGFuZGxlW25hbWVdKCIrdSsiKTtcbiIsYz0wO2M8ZS0xOysrYyl0W2MrMV0uZGVsZXRlT2JqZWN0JiYoZis9IiAgICBhcmdUeXBlIitjKyIuZGVsZXRlT2JqZWN0KGFyZyIrYysiKTtcbiIpO3JldHVybiBuLmlzVm9pZHx8KGYrPSIgICAgcmV0dXJuIHJldFR5cGUudG9XaXJlVHlwZShkZXN0cnVjdG9ycywgcnYpO1xuIiksZis9In07XG4iLGkucHVzaChmKSxsPVplKEZ1bmN0aW9uLGkpLmFwcGx5KG51bGwscyksZD1oci5sZW5ndGgsaHIucHVzaChsKSxhPWQsbXJbb109YSxhfSxuYTpmdW5jdGlvbihlLHIpe3JldHVybiBlPWFyLnRvVmFsdWUoZSkscj1hci50b1ZhbHVlKHIpLGFyLnRvSGFuZGxlKGVbcl0pfSxQOmZ1bmN0aW9uKGUpe2U+NCYmKG5yW2VdLnJlZmNvdW50Kz0xKX0sdmE6ZnVuY3Rpb24oZSl7cmV0dXJuIGFyLnRvSGFuZGxlKGZyKGUpKX0sZWE6ZnVuY3Rpb24oZSl7Y2UoYXIudG9WYWx1ZShlKSksb3IoZSl9LEQ6ZnVuY3Rpb24oZSxyKXt2YXIgdD0oZT1zcihlLCJfZW12YWxfdGFrZV92YWx1ZSIpKS5yZWFkVmFsdWVGcm9tUG9pbnRlcihyKTtyZXR1cm4gYXIudG9IYW5kbGUodCl9LGI6ZnVuY3Rpb24oKXtLKCIiKX0samE6ZnVuY3Rpb24oKXtyZXR1cm4gVC5sZW5ndGh9LE06cHIscGE6ZnVuY3Rpb24oZSxyLHQpe1QuY29weVdpdGhpbihlLHIscit0KX0saWE6ZnVuY3Rpb24oZSl7VC5sZW5ndGgsSygiT09NIil9LGthOmZ1bmN0aW9uKGUscil7dmFyIHQ9MDtyZXR1cm4geXIoKS5mb3JFYWNoKChmdW5jdGlvbihuLG8pe3ZhciBhPXIrdDtEW2UrNCpvPj4yXT1hLGZ1bmN0aW9uKGUscix0KXtmb3IodmFyIG49MDtuPGUubGVuZ3RoOysrbilQW3IrKz4+MF09ZS5jaGFyQ29kZUF0KG4pO1Bbcj4+MF09MH0obixhKSx0Kz1uLmxlbmd0aCsxfSkpLDB9LGxhOmZ1bmN0aW9uKGUscil7dmFyIHQ9eXIoKTtEW2U+PjJdPXQubGVuZ3RoO3ZhciBuPTA7cmV0dXJuIHQuZm9yRWFjaCgoZnVuY3Rpb24oZSl7bis9ZS5sZW5ndGgrMX0pKSxEW3I+PjJdPW4sMH0sdGE6ZnVuY3Rpb24oZSl7dHJ5e3ZhciByPWtyLmdldFN0cmVhbUZyb21GRChlKTtyZXR1cm4gYnIuY2xvc2UociksMH1jYXRjaChlKXtpZih2b2lkIDA9PT1icnx8IShlIGluc3RhbmNlb2YgYnIuRXJybm9FcnJvcikpdGhyb3cgZTtyZXR1cm4gZS5lcnJub319LG1hOmZ1bmN0aW9uKGUscix0LG4pe3RyeXt2YXIgbz1rci5nZXRTdHJlYW1Gcm9tRkQoZSksYT1rci5kb1JlYWR2KG8scix0KTtyZXR1cm4gRFtuPj4yXT1hLDB9Y2F0Y2goZSl7aWYodm9pZCAwPT09YnJ8fCEoZSBpbnN0YW5jZW9mIGJyLkVycm5vRXJyb3IpKXRocm93IGU7cmV0dXJuIGUuZXJybm99fSxiYTpmdW5jdGlvbihlLHIsdCxuLG8pe3RyeXt2YXIgYT1rci5nZXRTdHJlYW1Gcm9tRkQoZSksaT00Mjk0OTY3Mjk2KnQrKHI+Pj4wKSxzPTkwMDcxOTkyNTQ3NDA5OTI7cmV0dXJuIGk8PS1zfHxpPj1zPy02MTooYnIubGxzZWVrKGEsaSxuKSxVPVthLnBvc2l0aW9uPj4+MCwoTD1hLnBvc2l0aW9uLCtNYXRoLmFicyhMKT49MT9MPjA/KDB8TWF0aC5taW4oK01hdGguZmxvb3IoTC80Mjk0OTY3Mjk2KSw0Mjk0OTY3Mjk1KSk+Pj4wOn5+K01hdGguY2VpbCgoTC0rKH5+TD4+PjApKS80Mjk0OTY3Mjk2KT4+PjA6MCldLERbbz4+Ml09VVswXSxEW28rND4+Ml09VVsxXSxhLmdldGRlbnRzJiYwPT09aSYmMD09PW4mJihhLmdldGRlbnRzPW51bGwpLDApfWNhdGNoKGUpe2lmKHZvaWQgMD09PWJyfHwhKGUgaW5zdGFuY2VvZiBici5FcnJub0Vycm9yKSl0aHJvdyBlO3JldHVybiBlLmVycm5vfX0sVDpmdW5jdGlvbihlLHIsdCxuKXt0cnl7dmFyIG89a3IuZ2V0U3RyZWFtRnJvbUZEKGUpLGE9a3IuZG9Xcml0ZXYobyxyLHQpO3JldHVybiBEW24+PjJdPWEsMH1jYXRjaChlKXtpZih2b2lkIDA9PT1icnx8IShlIGluc3RhbmNlb2YgYnIuRXJybm9FcnJvcikpdGhyb3cgZTtyZXR1cm4gZS5lcnJub319LGM6ZnVuY3Rpb24oKXtyZXR1cm4gcH0sUTpmdW5jdGlvbihlLHIsdCxuKXt2YXIgbz1JcigpO3RyeXtyZXR1cm4gcmUoZSkocix0LG4pfWNhdGNoKGUpe2lmKHpyKG8pLGUhPT1lKzApdGhyb3cgZTtqcigxLDApfX0sUjpmdW5jdGlvbihlLHIsdCxuKXt2YXIgbz1JcigpO3RyeXtyZXR1cm4gcmUoZSkocix0LG4pfWNhdGNoKGUpe2lmKHpyKG8pLGUhPT1lKzApdGhyb3cgZTtqcigxLDApfX0scDpmdW5jdGlvbihlKXt2YXIgcj1JcigpO3RyeXtyZXR1cm4gcmUoZSkoKX1jYXRjaChlKXtpZih6cihyKSxlIT09ZSswKXRocm93IGU7anIoMSwwKX19LGU6ZnVuY3Rpb24oZSxyKXt2YXIgdD1JcigpO3RyeXtyZXR1cm4gcmUoZSkocil9Y2F0Y2goZSl7aWYoenIodCksZSE9PWUrMCl0aHJvdyBlO2pyKDEsMCl9fSxrOmZ1bmN0aW9uKGUscix0KXt2YXIgbj1JcigpO3RyeXtyZXR1cm4gcmUoZSkocix0KX1jYXRjaChlKXtpZih6cihuKSxlIT09ZSswKXRocm93IGU7anIoMSwwKX19LHI6ZnVuY3Rpb24oZSxyLHQsbil7dmFyIG89SXIoKTt0cnl7cmV0dXJuIHJlKGUpKHIsdCxuKX1jYXRjaChlKXtpZih6cihvKSxlIT09ZSswKXRocm93IGU7anIoMSwwKX19LG46ZnVuY3Rpb24oZSxyLHQsbixvKXt2YXIgYT1JcigpO3RyeXtyZXR1cm4gcmUoZSkocix0LG4sbyl9Y2F0Y2goZSl7aWYoenIoYSksZSE9PWUrMCl0aHJvdyBlO2pyKDEsMCl9fSxmYTpmdW5jdGlvbihlLHIsdCxuLG8sYSl7dmFyIGk9SXIoKTt0cnl7cmV0dXJuIHJlKGUpKHIsdCxuLG8sYSl9Y2F0Y2goZSl7aWYoenIoaSksZSE9PWUrMCl0aHJvdyBlO2pyKDEsMCl9fSxLOmZ1bmN0aW9uKGUscix0LG4sbyxhKXt2YXIgaT1JcigpO3RyeXtyZXR1cm4gcmUoZSkocix0LG4sbyxhKX1jYXRjaChlKXtpZih6cihpKSxlIT09ZSswKXRocm93IGU7anIoMSwwKX19LEI6ZnVuY3Rpb24oZSxyLHQsbixvLGEsaSl7dmFyIHM9SXIoKTt0cnl7cmV0dXJuIHJlKGUpKHIsdCxuLG8sYSxpKX1jYXRjaChlKXtpZih6cihzKSxlIT09ZSswKXRocm93IGU7anIoMSwwKX19LFM6ZnVuY3Rpb24oZSxyLHQsbixvLGEsaSxzKXt2YXIgdT1JcigpO3RyeXtyZXR1cm4gcmUoZSkocix0LG4sbyxhLGkscyl9Y2F0Y2goZSl7aWYoenIodSksZSE9PWUrMCl0aHJvdyBlO2pyKDEsMCl9fSxKOmZ1bmN0aW9uKGUscix0LG4sbyxhLGkscyx1LGMsbCxkKXt2YXIgZj1JcigpO3RyeXtyZXR1cm4gcmUoZSkocix0LG4sbyxhLGkscyx1LGMsbCxkKX1jYXRjaChlKXtpZih6cihmKSxlIT09ZSswKXRocm93IGU7anIoMSwwKX19LGFhOmZ1bmN0aW9uKGUpe3ZhciByPUlyKCk7dHJ5e3JldHVybiBOcihlKX1jYXRjaChlKXtpZih6cihyKSxlIT09ZSswKXRocm93IGU7anIoMSwwKX19LCQ6ZnVuY3Rpb24oZSxyLHQsbixvKXt2YXIgYT1JcigpO3RyeXtyZXR1cm4gTHIoZSxyLHQsbixvKX1jYXRjaChlKXtpZih6cihhKSxlIT09ZSswKXRocm93IGU7anIoMSwwKX19LG86ZnVuY3Rpb24oZSl7dmFyIHI9SXIoKTt0cnl7cmUoZSkoKX1jYXRjaChlKXtpZih6cihyKSxlIT09ZSswKXRocm93IGU7anIoMSwwKX19LHQ6ZnVuY3Rpb24oZSxyKXt2YXIgdD1JcigpO3RyeXtyZShlKShyKX1jYXRjaChlKXtpZih6cih0KSxlIT09ZSswKXRocm93IGU7anIoMSwwKX19LGg6ZnVuY3Rpb24oZSxyLHQpe3ZhciBuPUlyKCk7dHJ5e3JlKGUpKHIsdCl9Y2F0Y2goZSl7aWYoenIobiksZSE9PWUrMCl0aHJvdyBlO2pyKDEsMCl9fSxzOmZ1bmN0aW9uKGUscix0LG4pe3ZhciBvPUlyKCk7dHJ5e3JlKGUpKHIsdCxuKX1jYXRjaChlKXtpZih6cihvKSxlIT09ZSswKXRocm93IGU7anIoMSwwKX19LEw6ZnVuY3Rpb24oZSxyLHQsbixvKXt2YXIgYT1JcigpO3RyeXtyZShlKShyLHQsbixvKX1jYXRjaChlKXtpZih6cihhKSxlIT09ZSswKXRocm93IGU7anIoMSwwKX19LHY6ZnVuY3Rpb24oZSxyLHQsbixvLGEsaSxzKXt2YXIgdT1JcigpO3RyeXtyZShlKShyLHQsbixvLGEsaSxzKX1jYXRjaChlKXtpZih6cih1KSxlIT09ZSswKXRocm93IGU7anIoMSwwKX19LEU6ZnVuY3Rpb24oZSxyLHQsbixvLGEsaSxzLHUsYyxsKXt2YXIgZD1JcigpO3RyeXtyZShlKShyLHQsbixvLGEsaSxzLHUsYyxsKX1jYXRjaChlKXtpZih6cihkKSxlIT09ZSswKXRocm93IGU7anIoMSwwKX19LEk6ZnVuY3Rpb24oZSxyLHQsbixvLGEsaSxzLHUsYyxsLGQsZixwLGgsbSl7dmFyIHY9SXIoKTt0cnl7cmUoZSkocix0LG4sbyxhLGkscyx1LGMsbCxkLGYscCxoLG0pfWNhdGNoKGUpe2lmKHpyKHYpLGUhPT1lKzApdGhyb3cgZTtqcigxLDApfX0sSDpmdW5jdGlvbihlKXtoKGUpfSxkYTpmdW5jdGlvbihlLHIsdCxuKXtyZXR1cm4gZnVuY3Rpb24oZSxyLHQsbil7dmFyIG89RFtuKzQwPj4yXSxhPXt0bV9zZWM6RFtuPj4yXSx0bV9taW46RFtuKzQ+PjJdLHRtX2hvdXI6RFtuKzg+PjJdLHRtX21kYXk6RFtuKzEyPj4yXSx0bV9tb246RFtuKzE2Pj4yXSx0bV95ZWFyOkRbbisyMD4+Ml0sdG1fd2RheTpEW24rMjQ+PjJdLHRtX3lkYXk6RFtuKzI4Pj4yXSx0bV9pc2RzdDpEW24rMzI+PjJdLHRtX2dtdG9mZjpEW24rMzY+PjJdLHRtX3pvbmU6bz9nKG8pOiIifSxpPWcodCkscz17IiVjIjoiJWEgJWIgJWQgJUg6JU06JVMgJVkiLCIlRCI6IiVtLyVkLyV5IiwiJUYiOiIlWS0lbS0lZCIsIiVoIjoiJWIiLCIlciI6IiVJOiVNOiVTICVwIiwiJVIiOiIlSDolTSIsIiVUIjoiJUg6JU06JVMiLCIleCI6IiVtLyVkLyV5IiwiJVgiOiIlSDolTTolUyIsIiVFYyI6IiVjIiwiJUVDIjoiJUMiLCIlRXgiOiIlbS8lZC8leSIsIiVFWCI6IiVIOiVNOiVTIiwiJUV5IjoiJXkiLCIlRVkiOiIlWSIsIiVPZCI6IiVkIiwiJU9lIjoiJWUiLCIlT0giOiIlSCIsIiVPSSI6IiVJIiwiJU9tIjoiJW0iLCIlT00iOiIlTSIsIiVPUyI6IiVTIiwiJU91IjoiJXUiLCIlT1UiOiIlVSIsIiVPViI6IiVWIiwiJU93IjoiJXciLCIlT1ciOiIlVyIsIiVPeSI6IiV5In07Zm9yKHZhciB1IGluIHMpaT1pLnJlcGxhY2UobmV3IFJlZ0V4cCh1LCJnIiksc1t1XSk7dmFyIGM9WyJTdW5kYXkiLCJNb25kYXkiLCJUdWVzZGF5IiwiV2VkbmVzZGF5IiwiVGh1cnNkYXkiLCJGcmlkYXkiLCJTYXR1cmRheSJdLGw9WyJKYW51YXJ5IiwiRmVicnVhcnkiLCJNYXJjaCIsIkFwcmlsIiwiTWF5IiwiSnVuZSIsIkp1bHkiLCJBdWd1c3QiLCJTZXB0ZW1iZXIiLCJPY3RvYmVyIiwiTm92ZW1iZXIiLCJEZWNlbWJlciJdO2Z1bmN0aW9uIGQoZSxyLHQpe2Zvcih2YXIgbj0ibnVtYmVyIj09dHlwZW9mIGU/ZS50b1N0cmluZygpOmV8fCIiO24ubGVuZ3RoPHI7KW49dFswXStuO3JldHVybiBufWZ1bmN0aW9uIGYoZSxyKXtyZXR1cm4gZChlLHIsIjAiKX1mdW5jdGlvbiBwKGUscil7ZnVuY3Rpb24gdChlKXtyZXR1cm4gZTwwPy0xOmU+MD8xOjB9dmFyIG47cmV0dXJuIDA9PT0obj10KGUuZ2V0RnVsbFllYXIoKS1yLmdldEZ1bGxZZWFyKCkpKSYmMD09PShuPXQoZS5nZXRNb250aCgpLXIuZ2V0TW9udGgoKSkpJiYobj10KGUuZ2V0RGF0ZSgpLXIuZ2V0RGF0ZSgpKSksbn1mdW5jdGlvbiBoKGUpe3N3aXRjaChlLmdldERheSgpKXtjYXNlIDA6cmV0dXJuIG5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKS0xLDExLDI5KTtjYXNlIDE6cmV0dXJuIGU7Y2FzZSAyOnJldHVybiBuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCksMCwzKTtjYXNlIDM6cmV0dXJuIG5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKSwwLDIpO2Nhc2UgNDpyZXR1cm4gbmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLDAsMSk7Y2FzZSA1OnJldHVybiBuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCktMSwxMSwzMSk7Y2FzZSA2OnJldHVybiBuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCktMSwxMSwzMCl9fWZ1bmN0aW9uIG0oZSl7dmFyIHI9ZnVuY3Rpb24oZSxyKXtmb3IodmFyIHQ9bmV3IERhdGUoZS5nZXRUaW1lKCkpO3I+MDspe3ZhciBuPVByKHQuZ2V0RnVsbFllYXIoKSksbz10LmdldE1vbnRoKCksYT0obj9UcjpTcilbb107aWYoIShyPmEtdC5nZXREYXRlKCkpKXJldHVybiB0LnNldERhdGUodC5nZXREYXRlKCkrciksdDtyLT1hLXQuZ2V0RGF0ZSgpKzEsdC5zZXREYXRlKDEpLG88MTE/dC5zZXRNb250aChvKzEpOih0LnNldE1vbnRoKDApLHQuc2V0RnVsbFllYXIodC5nZXRGdWxsWWVhcigpKzEpKX1yZXR1cm4gdH0obmV3IERhdGUoZS50bV95ZWFyKzE5MDAsMCwxKSxlLnRtX3lkYXkpLHQ9bmV3IERhdGUoci5nZXRGdWxsWWVhcigpLDAsNCksbj1uZXcgRGF0ZShyLmdldEZ1bGxZZWFyKCkrMSwwLDQpLG89aCh0KSxhPWgobik7cmV0dXJuIHAobyxyKTw9MD9wKGEscik8PTA/ci5nZXRGdWxsWWVhcigpKzE6ci5nZXRGdWxsWWVhcigpOnIuZ2V0RnVsbFllYXIoKS0xfXZhciB2PXsiJWEiOmZ1bmN0aW9uKGUpe3JldHVybiBjW2UudG1fd2RheV0uc3Vic3RyaW5nKDAsMyl9LCIlQSI6ZnVuY3Rpb24oZSl7cmV0dXJuIGNbZS50bV93ZGF5XX0sIiViIjpmdW5jdGlvbihlKXtyZXR1cm4gbFtlLnRtX21vbl0uc3Vic3RyaW5nKDAsMyl9LCIlQiI6ZnVuY3Rpb24oZSl7cmV0dXJuIGxbZS50bV9tb25dfSwiJUMiOmZ1bmN0aW9uKGUpe3JldHVybiBmKChlLnRtX3llYXIrMTkwMCkvMTAwfDAsMil9LCIlZCI6ZnVuY3Rpb24oZSl7cmV0dXJuIGYoZS50bV9tZGF5LDIpfSwiJWUiOmZ1bmN0aW9uKGUpe3JldHVybiBkKGUudG1fbWRheSwyLCIgIil9LCIlZyI6ZnVuY3Rpb24oZSl7cmV0dXJuIG0oZSkudG9TdHJpbmcoKS5zdWJzdHJpbmcoMil9LCIlRyI6ZnVuY3Rpb24oZSl7cmV0dXJuIG0oZSl9LCIlSCI6ZnVuY3Rpb24oZSl7cmV0dXJuIGYoZS50bV9ob3VyLDIpfSwiJUkiOmZ1bmN0aW9uKGUpe3ZhciByPWUudG1faG91cjtyZXR1cm4gMD09cj9yPTEyOnI+MTImJihyLT0xMiksZihyLDIpfSwiJWoiOmZ1bmN0aW9uKGUpe3JldHVybiBmKGUudG1fbWRheStmdW5jdGlvbihlLHIpe2Zvcih2YXIgdD0wLG49MDtuPD1yO3QrPWVbbisrXSk7cmV0dXJuIHR9KFByKGUudG1feWVhcisxOTAwKT9UcjpTcixlLnRtX21vbi0xKSwzKX0sIiVtIjpmdW5jdGlvbihlKXtyZXR1cm4gZihlLnRtX21vbisxLDIpfSwiJU0iOmZ1bmN0aW9uKGUpe3JldHVybiBmKGUudG1fbWluLDIpfSwiJW4iOmZ1bmN0aW9uKCl7cmV0dXJuIlxuIn0sIiVwIjpmdW5jdGlvbihlKXtyZXR1cm4gZS50bV9ob3VyPj0wJiZlLnRtX2hvdXI8MTI/IkFNIjoiUE0ifSwiJVMiOmZ1bmN0aW9uKGUpe3JldHVybiBmKGUudG1fc2VjLDIpfSwiJXQiOmZ1bmN0aW9uKCl7cmV0dXJuIlx0In0sIiV1IjpmdW5jdGlvbihlKXtyZXR1cm4gZS50bV93ZGF5fHw3fSwiJVUiOmZ1bmN0aW9uKGUpe3ZhciByPWUudG1feWRheSs3LWUudG1fd2RheTtyZXR1cm4gZihNYXRoLmZsb29yKHIvNyksMil9LCIlViI6ZnVuY3Rpb24oZSl7dmFyIHI9TWF0aC5mbG9vcigoZS50bV95ZGF5KzctKGUudG1fd2RheSs2KSU3KS83KTtpZigoZS50bV93ZGF5KzM3MS1lLnRtX3lkYXktMiklNzw9MiYmcisrLHIpe2lmKDUzPT1yKXt2YXIgdD0oZS50bV93ZGF5KzM3MS1lLnRtX3lkYXkpJTc7ND09dHx8Mz09dCYmUHIoZS50bV95ZWFyKXx8KHI9MSl9fWVsc2V7cj01Mjt2YXIgbj0oZS50bV93ZGF5KzctZS50bV95ZGF5LTEpJTc7KDQ9PW58fDU9PW4mJlByKGUudG1feWVhciU0MDAtMSkpJiZyKyt9cmV0dXJuIGYociwyKX0sIiV3IjpmdW5jdGlvbihlKXtyZXR1cm4gZS50bV93ZGF5fSwiJVciOmZ1bmN0aW9uKGUpe3ZhciByPWUudG1feWRheSs3LShlLnRtX3dkYXkrNiklNztyZXR1cm4gZihNYXRoLmZsb29yKHIvNyksMil9LCIleSI6ZnVuY3Rpb24oZSl7cmV0dXJuKGUudG1feWVhcisxOTAwKS50b1N0cmluZygpLnN1YnN0cmluZygyKX0sIiVZIjpmdW5jdGlvbihlKXtyZXR1cm4gZS50bV95ZWFyKzE5MDB9LCIleiI6ZnVuY3Rpb24oZSl7dmFyIHI9ZS50bV9nbXRvZmYsdD1yPj0wO3JldHVybiByPShyPU1hdGguYWJzKHIpLzYwKS82MCoxMDArciU2MCwodD8iKyI6Ii0iKStTdHJpbmcoIjAwMDAiK3IpLnNsaWNlKC00KX0sIiVaIjpmdW5jdGlvbihlKXtyZXR1cm4gZS50bV96b25lfSwiJSUiOmZ1bmN0aW9uKCl7cmV0dXJuIiUifX07Zm9yKHZhciB1IGluIGk9aS5yZXBsYWNlKC8lJS9nLCJcMFwwIiksdilpLmluY2x1ZGVzKHUpJiYoaT1pLnJlcGxhY2UobmV3IFJlZ0V4cCh1LCJnIiksdlt1XShhKSkpO3ZhciB5PURyKGk9aS5yZXBsYWNlKC9cMFwwL2csIiUiKSwhMSk7cmV0dXJuIHkubGVuZ3RoPnI/MDooZnVuY3Rpb24oZSxyKXtQLnNldChlLHIpfSh5LGUpLHkubGVuZ3RoLTEpfShlLHIsdCxuKX19LE1yPWZ1bmN0aW9uKCl7dmFyIHI9e2E6QXJ9O2Z1bmN0aW9uIHQocix0KXt2YXIgbixvLGE9ci5leHBvcnRzO2UuYXNtPWEsbj1lLmFzbS5BYS5idWZmZXIsaz1uLGUuSEVBUDg9UD1uZXcgSW50OEFycmF5KG4pLGUuSEVBUDE2PVM9bmV3IEludDE2QXJyYXkobiksZS5IRUFQMzI9RD1uZXcgSW50MzJBcnJheShuKSxlLkhFQVBVOD1UPW5ldyBVaW50OEFycmF5KG4pLGUuSEVBUFUxNj1DPW5ldyBVaW50MTZBcnJheShuKSxlLkhFQVBVMzI9Rj1uZXcgVWludDMyQXJyYXkobiksZS5IRUFQRjMyPUE9bmV3IEZsb2F0MzJBcnJheShuKSxlLkhFQVBGNjQ9TT1uZXcgRmxvYXQ2NEFycmF5KG4pLEI9ZS5hc20uQ2Esbz1lLmFzbS5CYSxWLnVuc2hpZnQobyksUSgpfWlmKEooKSxlLmluc3RhbnRpYXRlV2FzbSl0cnl7cmV0dXJuIGUuaW5zdGFudGlhdGVXYXNtKHIsdCl9Y2F0Y2goZSl7cmV0dXJuIGQoIk1vZHVsZS5pbnN0YW50aWF0ZVdhc20gY2FsbGJhY2sgZmFpbGVkIHdpdGggZXJyb3I6ICIrZSksITF9cmV0dXJuIHQoZnVuY3Rpb24oZSxyKXt2YXIgdCxuLG87dHJ5e289ZnVuY3Rpb24oZSl7dHJ5e2lmKGU9PVcmJmYpcmV0dXJuIG5ldyBVaW50OEFycmF5KGYpO3Rocm93InN5bmMgZmV0Y2hpbmcgb2YgdGhlIHdhc20gZmFpbGVkOiB5b3UgY2FuIHByZWxvYWQgaXQgdG8gTW9kdWxlWyd3YXNtQmluYXJ5J10gbWFudWFsbHksIG9yIGVtY2MucHkgd2lsbCBkbyB0aGF0IGZvciB5b3Ugd2hlbiBnZW5lcmF0aW5nIEhUTUwgKGJ1dCBub3QgSlMpIn1jYXRjaChlKXtLKGUpfX0oZSksbj1uZXcgV2ViQXNzZW1ibHkuTW9kdWxlKG8pLHQ9bmV3IFdlYkFzc2VtYmx5Lkluc3RhbmNlKG4scil9Y2F0Y2goZSl7dmFyIGE9ZS50b1N0cmluZygpO3Rocm93IGQoImZhaWxlZCB0byBjb21waWxlIHdhc20gbW9kdWxlOiAiK2EpLChhLmluY2x1ZGVzKCJpbXBvcnRlZCBNZW1vcnkiKXx8YS5pbmNsdWRlcygibWVtb3J5IGltcG9ydCIpKSYmZCgiTWVtb3J5IHNpemUgaW5jb21wYXRpYmlsaXR5IGlzc3VlcyBtYXkgYmUgZHVlIHRvIGNoYW5naW5nIElOSVRJQUxfTUVNT1JZIGF0IHJ1bnRpbWUgdG8gc29tZXRoaW5nIHRvbyBsYXJnZS4gVXNlIEFMTE9XX01FTU9SWV9HUk9XVEggdG8gYWxsb3cgYW55IHNpemUgbWVtb3J5IChhbmQgYWxzbyBtYWtlIHN1cmUgbm90IHRvIHNldCBJTklUSUFMX01FTU9SWSBhdCBydW50aW1lIHRvIHNvbWV0aGluZyBzbWFsbGVyIHRoYW4gaXQgd2FzIGF0IGNvbXBpbGUgdGltZSkuIiksZX1yZXR1cm5bdCxuXX0oVyxyKVswXSksZS5hc219KCksJHI9KGUuX19fd2FzbV9jYWxsX2N0b3JzPU1yLkJhLGUuX21hbGxvYz1Nci5EYSkseHI9ZS5fZnJlZT1Nci5FYSxPcj1lLl9fX2dldFR5cGVOYW1lPU1yLkZhLFJyPShlLl9fX2VtYmluZF9yZWdpc3Rlcl9uYXRpdmVfYW5kX2J1aWx0aW5fdHlwZXM9TXIuR2EsZS5fZW1zY3JpcHRlbl9idWlsdGluX21lbWFsaWduPU1yLkhhKSxqcj1lLl9zZXRUaHJldz1Nci5JYSxJcj1lLnN0YWNrU2F2ZT1Nci5KYSx6cj1lLnN0YWNrUmVzdG9yZT1Nci5LYSxCcj1lLl9fX2N4YV9jYW5fY2F0Y2g9TXIuTGEsV3I9ZS5fX19jeGFfaXNfcG9pbnRlcl90eXBlPU1yLk1hLE5yPShlLmR5bkNhbGxfampqPU1yLk5hLGUuZHluQ2FsbF9qaWppPU1yLk9hLGUuZHluQ2FsbF9qPU1yLlBhKSxMcj0oZS5keW5DYWxsX3ZpaWppaT1Nci5RYSxlLmR5bkNhbGxfamlpaWk9TXIuUmEpO2Z1bmN0aW9uIFVyKHQpe2Z1bmN0aW9uIG4oKXtGcnx8KEZyPSEwLGUuY2FsbGVkUnVuPSEwLG18fChlLm5vRlNJbml0fHxici5pbml0LmluaXRpYWxpemVkfHxici5pbml0KCksYnIuaWdub3JlUGVybWlzc2lvbnM9ITEsRXIuaW5pdCgpLFooVikscihlKSxlLm9uUnVudGltZUluaXRpYWxpemVkJiZlLm9uUnVudGltZUluaXRpYWxpemVkKCksZnVuY3Rpb24oKXtpZihlLnBvc3RSdW4pZm9yKCJmdW5jdGlvbiI9PXR5cGVvZiBlLnBvc3RSdW4mJihlLnBvc3RSdW49W2UucG9zdFJ1bl0pO2UucG9zdFJ1bi5sZW5ndGg7KXI9ZS5wb3N0UnVuLnNoaWZ0KCksWS51bnNoaWZ0KHIpO3ZhciByO1ooWSl9KCkpKX10PXR8fHMscT4wfHwoZnVuY3Rpb24oKXtpZihlLnByZVJ1bilmb3IoImZ1bmN0aW9uIj09dHlwZW9mIGUucHJlUnVuJiYoZS5wcmVSdW49W2UucHJlUnVuXSk7ZS5wcmVSdW4ubGVuZ3RoOylyPWUucHJlUnVuLnNoaWZ0KCksSC51bnNoaWZ0KHIpO3ZhciByO1ooSCl9KCkscT4wfHwoZS5zZXRTdGF0dXM/KGUuc2V0U3RhdHVzKCJSdW5uaW5nLi4uIiksc2V0VGltZW91dCgoZnVuY3Rpb24oKXtzZXRUaW1lb3V0KChmdW5jdGlvbigpe2Uuc2V0U3RhdHVzKCIiKX0pLDEpLG4oKX0pLDEpKTpuKCkpKX1pZihlLmR5bkNhbGxfaWlpaWlqPU1yLlNhLGUuZHluQ2FsbF9paWlpaWpqPU1yLlRhLGUuZHluQ2FsbF9paWlpaWlqaj1Nci5VYSxYPWZ1bmN0aW9uIGUoKXtGcnx8VXIoKSxGcnx8KFg9ZSl9LGUucnVuPVVyLGUucHJlSW5pdClmb3IoImZ1bmN0aW9uIj09dHlwZW9mIGUucHJlSW5pdCYmKGUucHJlSW5pdD1bZS5wcmVJbml0XSk7ZS5wcmVJbml0Lmxlbmd0aD4wOyllLnByZUluaXQucG9wKCkoKTtyZXR1cm4gVXIoKSxlfSk7Y29uc3QgaT1hO3ZhciBzPW51bGwsdT1udWxsLGM9bnVsbCxsPSIiO2NvbnN0IGQ9YXN5bmMoKT0+e2UodSxjLG51bGwscyksY2xvc2UoKX07c2VsZi5vbm1lc3NhZ2U9bz0+e3N3aXRjaChvLmRhdGEuY21kKXtjYXNlInByZUluaXQiOihhc3luYyBlPT57dCgpLGw9ZS5idW5kbGVQYXRoO3RyeXtsZXQgZT1hd2FpdChhd2FpdCBmZXRjaChsKyIvRlBoaUV4dHJhY3Rvci53YXNtIikpLmFycmF5QnVmZmVyKCk7cz1hd2FpdCBpKHt3YXNtQmluYXJ5OmUsb25SdW50aW1lSW5pdGlhbGl6ZWQ6KCk9PnNlbGYucG9zdE1lc3NhZ2Uoe2NtZDoicmVhZHkifSl9KSx0KCl9Y2F0Y2goZSl7bigpfX0pKG8uZGF0YSk7YnJlYWs7Y2FzZSJpbml0IjooYXN5bmMgcj0+e2xldCBvPXIubWluSU9EO3RyeXtsZXQgcj1uZXcgcy5FeHRyYWN0b3JDb25maWd1cmF0aW9uTWFuYWdlcjtyLnNldE1pbmltdW1EaXN0YW5jZUJldHdlZW5FeWVzQWxsb3dlZChvKSxyLnNldEltYWdlUXVhbGl0eUZpbHRlcihzLkltYWdlUXVhbGl0eUZpbHRlci5NZWRpdW0pLHIuc2V0UGF0dGVyblF1YWxpdHlGaWx0ZXIocy5QYXR0ZXJuUXVhbGl0eUZpbHRlci5NZWRpdW0pLHU9bmV3IHMuRXh0cmFjdG9yKHIpLGUociksdCgpLHNlbGYucG9zdE1lc3NhZ2Uoe2NtZDoiaW5pdCJ9KX1jYXRjaChlKXtuKCl9fSkoby5kYXRhKTticmVhaztjYXNlInRva2VuaXplIjooYXN5bmMgcj0+e2xldCBuPXtjbWQ6InRva2VuaXplIn07dCgpO2xldCBvPXIuZGF0YSxhPXIuZGF0YS5sZW5ndGgsaT1uZXcgcy5FeHRyYWN0b3IsdT1uZXcgcy5WZWN0b3JVY2hhcjtmb3IobGV0IGU9MDtlPGE7ZSsrKXUucHVzaF9iYWNrKG8uY2hhckNvZGVBdChlKSk7bGV0IGM9aS50b2tlbml6ZSh1KTtuLmRhdGE9YnRvYSgoZT0+e2xldCByPVtdO2ZvcihsZXQgdD0wO3Q8ZS5sZW5ndGg7dCs9MzI3Njgpci5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCxlLnN1YmFycmF5KHQsdCszMjc2OCkpKTtyZXR1cm4gci5qb2luKCIiKX0pKHMuZ2V0Qnl0ZXMoYykpKSxlKHUsaSksdCgpLHNlbGYucG9zdE1lc3NhZ2UobiksYXdhaXQgZCgpfSkoby5kYXRhKTticmVhaztjYXNlImRldGVjdCI6KGFzeW5jIG49PntsZXQgbz17Y21kOiJkZXRlY3QifTt0KCk7bGV0IGE9cy5JbWFnZS5nZXRGUGhpSW1hZ2Uobi5kYXRhLG4uaGVpZ2h0LG4ud2lkdGgscy5JbWFnZUZvcm1hdC5SR0JBXzMyYnBwKSxpPXUuZGV0ZWN0KGEpLGM9bnVsbDtpJiYoYz1pLmdldCgwKSxvPXIocyxvLGMpKSxlKGMsYSxpKSx0KCksc2VsZi5wb3N0TWVzc2FnZShvKX0pKG8uZGF0YSk7YnJlYWs7Y2FzZSJpbml0U3RyZWFtRXh0cmFjdGlvbiI6KGFzeW5jIHI9Pnt1LnN0b3BTdHJlYW1FeHRyYWN0aW9uKCksdCgpO2xldCBuPW51bGwsbz1uZXcgcy5FeHRyYWN0aW9uT3B0aW9uczsxPT09ci5leHRyYWN0aW9uTW9kZT9uPXMuRXh0cmFjdGlvbk1vZGUuUmVnaXN0ZXI6KG49cy5FeHRyYWN0aW9uTW9kZS5BdXRoZW50aWNhdGUsMD09PXIubGl2ZW5lc3NNb2RlP28uc2V0TGl2ZW5lc3NUYWcoMCk6by5zZXRMaXZlbmVzc1RhZygxKSksby5zZXRFeHRyYWN0aW9uTW9kZShuKSxvLnNldFJhd1RlbXBsYXRlcygxKSx1LmluaXRTdHJlYW1FeHRyYWN0aW9uU21hcnRXaXRoRXh0cmFjdGlvbk9wdGlvbnMobyksZShvKSx0KCksc2VsZi5wb3N0TWVzc2FnZSh7Y21kOiJpbml0U3RyZWFtRXh0cmFjdGlvbiJ9KX0pKG8uZGF0YSk7YnJlYWs7Y2FzZSJleHRyYWN0TmV4dFNtYXJ0IjooYXN5bmMgbj0+e2xldCBvPXtjbWQ6ImV4dHJhY3ROZXh0U21hcnQifTt0KCk7bGV0IGE9cy5JbWFnZS5nZXRGUGhpSW1hZ2Uobi5kYXRhLG4uaGVpZ2h0LG4ud2lkdGgscy5JbWFnZUZvcm1hdC5SR0JBXzMyYnBwKSxpPXUuZXh0cmFjdE5leHRTbWFydChhKTtudWxsIT09YyYmYy5kZWxldGUoKSxjPWksbz1yKHMsbyxpKSxlKGEpLHQoKSxzZWxmLnBvc3RNZXNzYWdlKG8pfSkoby5kYXRhKTticmVhaztjYXNlImluaXRMaXZlbmVzc01vdmVTdGFiaWxpemF0aW9uIjooYXN5bmMoKT0+e3QoKSx1LmluaXRMaXZlbmVzc0hNQ0NTdGFiaWxpemF0aW9uKCksdCgpLHNlbGYucG9zdE1lc3NhZ2Uoe2NtZDoiaW5pdExpdmVuZXNzTW92ZVN0YWJpbGl6YXRpb24ifSl9KShvLmRhdGEpO2JyZWFrO2Nhc2UibmV4dExpdmVuZXNzTW92ZVN0YWJpbGl6YXRpb24iOihhc3luYyBuPT57bGV0IG89e2NtZDoibmV4dExpdmVuZXNzTW92ZVN0YWJpbGl6YXRpb24ifTt0KCk7bGV0IGE9cy5JbWFnZS5nZXRGUGhpSW1hZ2Uobi5kYXRhLG4uaGVpZ2h0LG4ud2lkdGgscy5JbWFnZUZvcm1hdC5SR0JBXzMyYnBwKSxpPXUubmV4dExpdmVuZXNzSE1DQ1N0YWJpbGl6YXRpb24oYSxwZXJmb3JtYW5jZS5ub3coKSk7bnVsbCE9PWMmJmMuZGVsZXRlKCksYz1pLG8uZmFjZVN0YWJpbGl6ZWQ9aS5nZXRGYWNlU3RhYmlsaXplZFN0YXR1cygpLG89cihzLG8saSksZShhKSx0KCksc2VsZi5wb3N0TWVzc2FnZShvKX0pKG8uZGF0YSk7YnJlYWs7Y2FzZSJ2ZXJzaW9uIjooYXN5bmMoKT0+e2xldCBlPXtjbWQ6InZlcnNpb24ifTtlLnZlcnNpb249cy5FeHRyYWN0b3IuZ2V0VmVyc2lvbigpLHNlbGYucG9zdE1lc3NhZ2UoZSl9KShvLmRhdGEpO2JyZWFrO2Nhc2UiZGVzdHJveSI6ZChvLmRhdGEpO2JyZWFrO2RlZmF1bHQ6dCgpfX07")],{type:"text/javascript"}))),h)),this.worker.onmessage=this.handleExtractorMessage.bind(this),this.worker.postMessage({cmd:"preInit",bundlePath:this.bundlePath,debugMode:this.showLog}),this.queuedCommands=0,this.resourceParent=null,this.language=this.cm.getLanguage(),this.cameraWidth=this.cm.getCameraWidth(),this.cameraHeight=this.cm.getCameraHeight(),this.cameraType=this.cm.getCameraType(),this.cameraRotation=this.cm.getCameraRotation(),this.canvasWidth=500,this.canvasHeight=500,this.detectionTimeout=this.cm.getTimeout(),this.extractionTimeout=this.cm.getTimeout(),this.fontSizeFactor=this.canvasHeight/500,this.canvasSizeFactor=this.canvasHeight/500,this.baseURL=this.isPathAbsolute(this.cm.getResourcesPath())?this.cm.getResourcesPath():this.getScriptPath()+this.cm.getResourcesPath(),this.dpiList=this.cm.getDpiList(),this.livenessMode===b.Selphi.LivenessMode.Passive&&(this.livenessMode=b.Selphi.LivenessMode.None,this.cameraWidth=1280,this.cameraHeight=720,this.cropImage=!1),this.rmReady=!1,this.graphReady=!1,this.rm=new i(this.baseURL,this.language,this,this.OnResourceManagerStatus,this.dpiList,window.devicePixelRatio,this.canvasSizeFactor),this.graph=new t.k(this.graphPath,this.OnGraphReady.bind(this),this.OnGraphNewState.bind(this)),this.drawer=new a({livenessMode:this.cm.getLivenessMode(),stabilizationStage:this.cm.getStabilizationStage(),canvasSizeFactor:this.canvasSizeFactor,fontSizeFactor:this.fontSizeFactor}),this.divContainer.addEventListener("FPhi.UserControl.Finish.event",this.onExtractionFinish,!0),this.divContainer.addEventListener("FPhi.UserControl.UserCancel.event",this.onUserCancel,!0),this.divContainer.addEventListener("FPhi.UserControl.ExtractionTimeout.event",this.onExtractionTimeout,!0),this.divContainer.addEventListener("FPhi.UserControl.LivenessError.event",this.onLivenessError,!0),this.divContainer.addEventListener("FPhi.UserControl.LivenessErrorButtonClick.event",this.onLivenessErrorButtonClick,!0),this.divContainer.addEventListener("FPhi.UserControl.TimeoutErrorButtonClick.event",this.onTimeoutErrorButtonClick,!0),this.divContainer.addEventListener("FPhi.UserControl.ModuleLoaded.event",this.onModuleLoaded,!0),this.divContainer.addEventListener("FPhi.UserControl.ExceptionCaptured.event",this.onExceptionCaptured,!0),this.divContainer.addEventListener("FPhi.UserControl.Stabilizing.event",this.onStabilizing,!0),this.divContainer.addEventListener("FPhi.UserControl.TrackStatus.event",this.onTrackStatus,!0)},b.Selphi.Widget.prototype={constructor:b.Selphi.Widget,language:"es",userTags:null,privateCanvas:null,extractor:null,extractorLiveness:null,extractorVersion:"",lastDetectResult:null,lastExtractionResult:null,lastExtractionResultWizard:null,faceAvailable:!0,faceDataRect:null,faceAvailableDelayed:!1,faceTooFar:!1,bestScore:0,actualTime:0,actualTimePrev:0,clockWaitingFace:null,clockWaitingStart:null,clockExtraction:null,clockExtractionPure:null,clockCycleTip:null,clockWizardCompleted:null,clockShowResults:null,clockImprove:null,clockLiveness1:null,clockLiveness2:null,clockLiveness3:null,clockLiveness3_finish:null,clockFinish:null,clockNewScenario:null,clockWarningIn:null,clockWarningOut:null,clockEyeDetection:null,clockEyeDetectionDetected:null,waitingTimeStart:3,extractionTime:5,extractionTimePartial:0,extractionSmartMinScore:.5,face_mo:function(){return"MO"},face_o:function(){return"O"},face_sn:function(){return"SN"},face_spl:function(){return"SPL"},liveness1Time:.5,liveness3Time:.25,livenessActualRetrain:0,livenessCalculating:!1,livenessErrorString:"",livenessErrorImage:null,livenessMoveDirection:-1,livenessMoveActualSuccessfulAttempts:0,livenessMoveActualFailedAttempts:0,livenessMoveNextIndex:0,livenessMoveGlassesFail:0,livenessMoveInit:!1,livenessMoveFailReason:0,livenessMoveInfoTime:3,livenessMoveLastStabilizedStatus:0,livenessMoveStabilizedStatusHistory:[],livenessMoveHistory:[],livenessPrecision:0,showImproveButton:!1,face_alpha:function(){return String.fromCharCode(89,52,77)},maxResults:15,graphicalScoreMax:0,privateLastImage:null,privateImages:[],logImages:!1,privateLivenessImages:[],privateLivenessImageTemp:null,privateLivenessTimerDiagnostic:null,privateLivenessResults:[],privateEyesYLevel:0,idContainer:null,divContainer:null,extractorContainer:null,videoSelectId:null,cameraContainer:null,cameraWidth:null,cameraHeight:null,cameraRotation:0,canvasWidth:null,canvasHeight:null,cameraStream:null,selectedSource:null,samplePeriod:0,face_defa:function(){return"DEFA"},face_ke:function(){return"KE"},face_ck:function(){return"CK"},face_ap:function(){return"AP"},buttonHeight:50,debug:!1,interactible:!0,imageFormat:"image/jpeg",forceMoveDirection:-1,registerTime:7,authenticateTime:1,globalTimeout:30,fps:0,fpse:0,fpsframes:0,fpseFrames:0,fpsTime:null,fontSizeFactor:1,canvasSizeFactor:1,imageTips1:null,imageTips2:null,imageFaceMoving:[],imageCheck:null,imageError:null,imageArrow:null,face_cam:function(){return"CAM"},face_t:function(){return"TUAL"},face_ult:function(){return"ULT"},face_b:function(){return"B"},imageCamera:null,cropImage:!0,cropFactor:1,warningInTime:.8,warningOutTime:0,detectionTimeout:0,extractionTimeout:0,sceneTimeout:0,secondsWidget:0,secondsState:0,sendingTimeout:2,cameraList:[],graphPath:"graph.xml",testedResolutions:[],facePositions:[],face_v:function(){return"VIR"},face_it:function(){return"IT"},face_s:function(){return"S"},face_fa:function(){return"FA"},tokenizerEvent:null,GenerateTemplateRawFromByteArrayComplete:function(e,t,i){e.tokenizerEvent=i;var n=document.createElement("canvas");n.width=t.naturalWidth,n.height=t.naturalHeight,n.getContext("2d").drawImage(t,0,0);var a=n.toDataURL("image/jpeg");a=a.split(",")[1];var l=window.atob(a);e.postMessage(e,{cmd:"tokenize",data:l})},GenerateTemplateRawFromByteArray:function(e,t){var i=this;if(!0===this.wasmReady)if(e.complete)this.GenerateTemplateRawFromByteArrayComplete(this,e,t);else{var n=this;e.onload=function(){n.GenerateTemplateRawFromByteArrayComplete(n,e,t)}}else setTimeout((function(){i.GenerateTemplateRawFromByteArray(e,t)}),1e3)},Start:function(){this.qualityCheckFailed=!1,this.Start_()},Start_:function(){if(this.fpsTime=performance.now(),this.cameraContainer=document.createElement("div"),this.cameraContainer.id="cameraContainer",this.cameraContainer.style.overflow="hidden",this.cameraContainer.style.position="relative",this.cameraContainer.style.width=this.divContainer.offsetWidth+"px",this.cameraContainer.style.height=this.divContainer.offsetHeight+"px",this.divContainer.appendChild(this.cameraContainer),this.cropFactor<=0){var e=new CustomEvent("FPhi.UserControl.ExceptionCaptured.event",{detail:{message:"Invalid value of CropFactor. Must be greather than 0.",exceptionType:3}});this.divContainer.dispatchEvent(e),this.cropFactor=1}this.sceneTimeout<=0&&(this.sceneTimeout=0);var t=this;this.gifWait=document.createElement("img"),this.gifWait.style.display="none",this.gifWait.addEventListener("load",this.onWaitingLoaded),this.gifWait.onload=function(){var e=t.canvas.height/2-t.gifWait.height/2,i=t.canvas.width/2-t.gifWait.width/2;t.gifWait.style="position:absolute; top:"+e+"px; left:"+i+"px;"},this.gifWait.src=this.baseURL+"resources/163dpi/2_loading_selphi.gif",document.featurePolicy&&!1===document.featurePolicy.allowsFeature("camera")&&(this.printLog("Selphi: Feature Policy issue: Camera feature is restricted in the actual environment. Check your server HTTP Headers."),this.printLog("https://developers.google.com/web/updates/2018/06/feature-policy#js")),window.location!==window.parent.location&&this.printLog("Selphi: widget running inside iframe."),this.selectedSource=null;var i=document.createElement("canvas");i.id="display",i.style="position:absolute; top:-1px; left:-1px; zIndex:1;",this.cameraContainer.appendChild(i),i.width=this.cameraContainer.offsetWidth+2,i.height=this.cameraContainer.offsetHeight+2,this.canvas=i,this.onCanvasResizeContext=this.onCanvasResize.bind(this),window.addEventListener("resize",this.onCanvasResizeContext,!1),this.initCamera(this.cameraContainer,this.cameraWidth,this.cameraHeight),this.setVideoInput(this),this.widgetTime=performance.now(),this.stateTime=this.widgetTime,this.cameraContainer.appendChild(this.gifWait),this.printLog("Selphi: Hardware concurrency: "+window.navigator.hardwareConcurrency)},Finalize:function(){null!=this.worker&&(this.postMessage(this,{cmd:"destroy"}),this.worker=null),null!=this.drawer&&(this.drawer=null)},Stop:function(){if(null!=this.divContainer){this.onCanvasResizeContext&&(window.removeEventListener("resize",this.onCanvasResizeContext,!1),this.onCanvasResizeContext=void 0),this.onVideoResizeContext&&(this.video.removeEventListener("resize",this.onVideoResizeContext,!1),this.onVideoResizeContext=void 0),this.divContainer.removeEventListener("FPhi.UserControl.Finish.event",this.onExtractionFinish,!0),this.divContainer.removeEventListener("FPhi.UserControl.UserCancel.event",this.onUserCancel,!0),this.divContainer.removeEventListener("FPhi.UserControl.ExtractionTimeout.event",this.onExtractionTimeout,!0),this.divContainer.removeEventListener("FPhi.UserControl.LivenessError.event",this.onLivenessError,!0),this.divContainer.removeEventListener("FPhi.UserControl.LivenessErrorButtonClick.event",this.onLivenessErrorButtonClick,!0),this.divContainer.removeEventListener("FPhi.UserControl.TimeoutErrorButtonClick.event",this.onTimeoutErrorButtonClick,!0),this.divContainer.removeEventListener("FPhi.UserControl.ModuleLoaded.event",this.onModuleLoaded,!0),this.divContainer.removeEventListener("FPhi.UserControl.ExceptionCaptured.event",this.onExceptionCaptured,!0),this.divContainer.removeEventListener("FPhi.UserControl.Stabilizing.event",this.onStabilizing,!0),this.divContainer.removeEventListener("FPhi.UserControl.TrackStatus.event",this.onTrackStatus,!0),this.video.onloadedmetadata=null;var e=this.canvas;e.onmousemove=null,e.onclick=null,this.gifWait.onload=null,this.divContainer.removeChild(this.cameraContainer),this.divContainer=null,this.cameraContainer=null}null!=this.cameraStream&&this.cameraStream.getVideoTracks()[0].stop(),null!=this.rm&&(this.rm.caller=null,this.rm=null),null!=this.graph&&(this.graph=null),null!=this.rmScript&&(this.rmScript.onreadystatechange=null,this.rmScript.onload=null,this.rmScript=null),null!=this.graphScript&&(this.graphScript.onreadystatechange=null,this.graphScript.onload=null,this.graphScript=null),null!=this.drawerScript&&(this.drawerScript.onload=null,this.drawerScript=null),this.Finalize()},reconfigureWidget:function(e){this.imageFormat=e.getImageFormat(),this.imageQuality=e.getImageQuality(),this.cropFactor=e.getCropFactor(),this.cropImage=e.getCropImage(),this.printLog("FPhi.Selphi.Widget.reconfigureWidget fired"),this.printLog("  imageFormat: "+this.imageFormat),this.printLog("  imageQuality: "+this.imageQuality),this.printLog("  cropFactor: "+this.cropFactor),this.printLog("  cropImage: "+this.cropImage)},printLog:function(e){this.showLog&&console.log(e)},onVideoResize:function(){this.cameraWidth=this.video.videoWidth,this.cameraHeight=this.video.videoHeight;var e=this.canvas.getContext("2d",{alpha:!0});this.setCameraPosition(e,this.video)},onCanvasResize:function(){var e=this.canvas,t=e.getContext("2d",{alpha:!0}),i=this.video;if(this.cameraWidth=i.videoWidth,this.cameraHeight=i.videoHeight,0===this.cameraRotation||2===this.cameraRotation?(this.privateCanvas.width=this.cameraWidth,this.privateCanvas.height=this.cameraHeight):(this.privateCanvas.width=this.cameraHeight,this.privateCanvas.height=this.cameraWidth),this.cameraContainer.style.width=this.divContainer.offsetWidth+"px",this.cameraContainer.style.height=this.divContainer.offsetHeight+"px",e.width=this.cameraContainer.offsetWidth+2,e.height=this.cameraContainer.offsetHeight+2,this.drawer.setCanvasSize(e.clientWidth,e.clientHeight),null!=this.elements)for(var n=0;n<this.elements.length;n++)null!=this.elements[n].videoPlayer&&(this.elements[n].videoPlayer.pause(),this.elements[n].videoPlayer.removeAttribute("src"),this.elements[n].videoPlayer.removeEventListener("ended",this.videoplayerEnded.bind(self),!1),this.elements[n].videoPlayer.load(),this.elements[n].videoPlayer=null);this.elements=this.rm.getElements(this.resourceParent,this.drawer.landscape),this.startVideos(this),this.setCameraPosition(t,this.video)},GetAvailableCameras:function(){return navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then(this.gotDevices).catch(this.handleCameraError):null},postMessage:function(e,t){e.queuedCommands++,e.worker.postMessage(t)},setLastExtractionResult:function(e,t){null!=e.lastExtractionResult&&e.lastExtractionResult.delete(),e.lastExtractionResult=t},setCameraPosition:function(e,t){this.cameraVisibleRegion=this.drawer.getCameraRect(e,this.cameraWidth,this.cameraHeight,this.resourceParent);var i="";this.cameraType===b.Selphi.CameraType.Front&&(i="rotateY(180deg) "),1===this.cameraRotation?i+="rotateZ(90deg) ":2===this.cameraRotation?i+="rotateZ(180deg) ":3===this.cameraRotation&&(i+="rotateZ(270deg) "),this.cameraVisibleRegion.visible?(t.style.position="absolute",t.style.top=this.cameraVisibleRegion.y+"px",t.style.left=this.cameraVisibleRegion.x+"px",t.style.width=this.cameraVisibleRegion.width+"px",t.style.height=this.cameraVisibleRegion.height+"px",t.style.transform=i,t.style.zIndex=0):(t.style.position="absolute",t.style.top="-10000px",t.style.left="0px",t.style.width=this.cameraVisibleRegion.width+"px",t.style.height=this.cameraVisibleRegion.height+"px",t.style.transform=i,t.style.zIndex=0),t.style.position="sticky",t.style.position="absolute"},OnGraphNewState:function(e){var t=this;this.stateTime=performance.now();var i=this.canvas;"UCNothing"!==this.state&&void 0!==this.state||(this.actualTime=this.stateTime,this.widgetTime=this.stateTime),this.secondsWidget=(this.actualTime-this.widgetTime)/1e3,this.secondsState=(this.actualTime-this.stateTime)/1e3,this.state=e,this.resourceParent=this.drawer.getResourceIdForState(e);var n=this.video;if(this.setCameraPosition(i.getContext("2d",{alpha:!0}),n),this.printLog("Selphi: state: "+e),null!=this.elements)for(var a=0;a<this.elements.length;a++)null!=this.elements[a].videoPlayer&&(this.elements[a].videoPlayer.pause(),this.elements[a].videoPlayer.removeAttribute("src"),this.elements[a].videoPlayer.removeEventListener("ended",this.videoplayerEnded.bind(self),!1),this.elements[a].videoPlayer.load(),this.elements[a].videoPlayer=null);if(this.elements=null,null!=this.resourceParent&&(this.elements=this.rm.getElements(this.resourceParent,this.drawer.landscape),this.startVideos(this)),"UCNothing"===e)this.clockNewScenario=performance.now(),this.lastExtractionResult=null,this.bestScore=0,this.faceAvailable=!1,this.clockWaitingStart=null,this.clockExtraction=null,this.clockExtractionPure=null,this.clockLiveness=null,this.extractionTime=this.authenticateTime,this.livenessCalculating=!1,this.privateLastImage=null,this.privateImages=[],this.privateLivenessImages=[],this.privateLivenessResults=[],this.livenessActualRetrain=0,this.livenessErrorString=null;else if("UCTutorialRegister2"===e)this.clockNewScenario=performance.now();else if("UCWaitingFaceStart"===e)this.clockNewScenario=performance.now(),!1===this.interactible&&this.graph.sendMessage("Click//button_start");else if("UCSelectTutorial"===e)this.graph.sendMessage("SetMode//"+self.livenessMode+","+(self.tutorial?1:0));else if("UCExtracting"===e)this.clockNewScenario=performance.now(),this.clockExtraction=performance.now(),this.clockExtractionPure=this.clockExtraction,this.extractionTimePartial=0,this.postMessage(this,{cmd:"initStreamExtraction",mode:this.mode,livenessMode:this.livenessMode,userTags:this.userTags});else if("UCShowResults"===e)this.clockNewScenario=performance.now(),this.clockShowResults=performance.now(),null!=this.lastExtractionResultWizard&&(this.setLastExtractionResult(this.lastExtractionResultWizard),this.lastExtractionResultWizard=null);else if("UCCancelByUser"===e){this.clockNewScenario=performance.now();var l=new CustomEvent("FPhi.UserControl.UserCancel.event");this.divContainer.dispatchEvent(l),this.Stop()}else if("UCLivenessDetectionStep1"===e)this.clockNewScenario=performance.now(),this.clockLiveness1=performance.now();else if("UCLivenessDetectionStep2"===e)this.clockLiveness2=performance.now(),this.privateLivenessImages=[],this.privateLivenessResults=[],this.postMessage(this,{cmd:"livenessTimerReset"});else if("UCLivenessDetectionStep3"===e)this.clockLiveness3_finish=null,this.clockLiveness3=performance.now(),this.postMessage(this,{cmd:"evaluateLiveness",images:this.privateLivenessImages,template:this.lastExtractionResult.Template});else if("UCWaitingEyeDetection"===e)this.clockNewScenario=performance.now(),this.clockEyeDetection=performance.now(),this.clockEyeDetectionDetected=null;else if("UCFinish"===e){this.clockNewScenario=performance.now(),this.clockFinish=performance.now();var s=Array.from(this.privateImages);this.sortImagesByFacialScore(this,s);var r,c=this.getImgTag(s[0],!1,this.cropFactor,this.imageFormat,this.imageQuality),o=this.getImgTag(s[0],!0,this.cropFactor,this.imageFormat,this.imageQuality),d=[];if(this.logImages)for(var u=0;u<this.privateImages.length;u++)void 0!==this.privateImages[u]&&d.push(this.getImgTag(this.privateImages[u],this.cropImage,this.cropFactor,"image/jpeg",this.imageQuality));void 0!==this.lastExtractionResult.templateRaw&&(r=this.lastExtractionResult.templateRaw,this.cm.getTemplateFormat()===b.Selphi.TemplateFormat.Base64&&(r=p(r)));var h=this.lastExtractionResult.template;this.cm.getTemplateFormat()===b.Selphi.TemplateFormat.Base64&&(h=p(h));var m={template:h,bestImage:c,bestImageCropped:o,images:d,timeStamp:this.privateLivenessResults,templateRaw:r,livenessMoveFails:this.livenessMoveActualFailedAttempts,sunGlassesScore:this.lastExtractionResult.sunGlassesScore,livenessMoveHistory:this.livenessMoveHistory,livenessMoveStabilizedHistory:this.livenessMoveStabilizedStatusHistory,livenessMoveStabilizedStatus:this.livenessMoveLastStabilizedStatus};this.cm.getVideoRecord()&&(this.recordedVideo?(m.video=this.recordedVideo,m.videoStatus=b.Selphi.RecorderStatus.Ok):m.videoStatus=b.Selphi.RecorderStatus.SocketError),this.GenerateTemplateRawFromByteArray(c,(function(e){m.bestImageTokenized=e;var i=new CustomEvent("FPhi.UserControl.Finish.event",{detail:m});t.divContainer.dispatchEvent(i),t.Stop()}))}else if("UCErrors"===e){var g={livenessMoveFails:this.livenessMoveActualFailedAttempts,livenessMoveHistory:this.livenessMoveHistory,livenessMoveStabilizedHistory:this.livenessMoveStabilizedStatusHistory,livenessMoveStabilizedStatus:this.livenessMoveLastStabilizedStatus};if(null!=this.lastExtractionResult&&null!=this.lastExtractionResult.sunGlassesScore&&(g.sunGlassesScore=this.lastExtractionResult.sunGlassesScore),this.logImages){for(var Z=[],I=0;I<this.privateImages.length;I++)void 0!==this.privateImages[I]&&Z.push(this.getImgTag(this.privateImages[I],this.cropImage,this.cropFactor,this.imageFormat,this.imageQuality));g.images=Z,g.timeStamp=this.privateLivenessResults}if(this.clockNewScenario=performance.now(),this.livenessDiagnostic<0)this.divContainer.dispatchEvent(new CustomEvent("FPhi.UserControl.ExtractionTimeout.event",{detail:g}));else{g.livenessErrorType=this.livenessDiagnostic;var y=new CustomEvent("FPhi.UserControl.LivenessError.event",{detail:g});this.divContainer.dispatchEvent(y)}}else if("UCErrorFinish"===e){var R;-1===this.livenessDiagnostic?(R=new CustomEvent("FPhi.UserControl.TimeoutErrorButtonClick.event"),this.divContainer.dispatchEvent(R)):(R=new CustomEvent("FPhi.UserControl.LivenessErrorButtonClick.event"),this.divContainer.dispatchEvent(R)),this.Stop()}else if("UCLivenessMoveStabilizing"===e)this.postMessage(this,{cmd:"initLivenessMoveStabilization"});else if("UCLivenessMoveStabilized"===e)this.livenessMode===b.Selphi.LivenessMode.Move?(!1===this.livenessMoveInit&&(this.postMessage(this,{cmd:"initLivenessMoveSequence",livenessPrecision:this.livenessPrecision}),this.livenessMoveInit=!0),this.postMessage(this,{cmd:"nextLivenessMoveSequence"}),this.livenessMoveNextIndex=0,this.graph.sendMessage("Move")):this.graph.sendMessage("NoMove");else if("UCLivenessMoveDetecting"===e)this.privateLivenessImages=[];else if("UCLivenessMoveProcessing"===e)this.processingIndexBase=this.livenessMoveNextIndex;else if("UCWaitRecording"===e&&this.cm.getVideoRecord()){this.printLog("Selphi: generating movie"),this.agProcessing=!0;var f=this;this.agProcessingFirst=performance.now(),this.recorder.generateVideo().then((function(e){f.recorderFinish=!0,f.recordedVideo=e}),(function(e){f.recorderFinish=!0}))}if(this.divContainer){var v=new CustomEvent("FPhi.UserControl.TrackStatus.event",{detail:{code:b.Selphi.TrackStatus.ChangeState,timeStamp:this.secondsWidget,data:e}});if(this.divContainer.dispatchEvent(v),this.cm.getAccessibility()&&void 0!==this.elements){var W=this.canvas.getContext("2d",{alpha:!0});this.canvas.width<this.canvas.height&&this.cm.forceLandscape&&(W=this.canvasRotated.getContext("2d",{alpha:!0}));var G=W.canvas.width,V=W.canvas.height,X={};X.state=this.state;var S=[];null===this.elements&&(this.elements=[]);for(var C=0;C<this.elements.length;C++)if(this.cm.getAccessibleElements().includes(this.elements[C].type)){var N=this.drawer.getLayout(this.resourceParent,this.elements[C].id,this.elements[C].type,this.secondsWidget,this.secondsState,"Normal",X);null!=N&&(N=this.getLayoutFromXML(this.resourceParent,this.elements[C].id,N,G,V)),null!=N&&S.push({id:this.elements[C].id,type:this.elements[C].type,x:N.x,y:N.y,width:N.width,height:N.height})}var E=new CustomEvent("FPhi.UserControl.TrackStatus.event",{detail:{code:b.Selphi.TrackStatus.AccessibilityData,timeStamp:this.secondsWidget,data:S}});this.divContainer.dispatchEvent(E)}}null!=this.graph&&this.graph.sendMessage("SetStatusFinished")},getImageData:function(e){var t=e.getContext("2d"),i=e.height,n=e.width;return{width:n,height:i,pixels:t.getImageData(0,0,n,i),time:performance.now()}},getImgTag:function(e,t,i,n,a){var l=document.createElement("canvas");l.width=e.width,l.height=e.height,l.getContext("2d").putImageData(e.pixels,0,0);var s=document.createElement("canvas");if(t&&void 0!==e.extractionResult&&void 0!==e.extractionResult.face){var r=e.extractionResult.face.width*i,c=e.extractionResult.face.height*i,o=e.extractionResult.face.x-(i-1)*e.extractionResult.face.width/2,d=e.extractionResult.face.y-(i-1)*e.extractionResult.face.height/2;o<0&&(r+=o,o=0),d<0&&(c+=d,d=0),o+r>=e.width&&(r=e.width-o),d+c>=e.height&&(c=e.height-d),s.width=r,s.height=c,s.getContext("2d").drawImage(l,o,d,r,c,0,0,s.width,s.height)}else s.width=e.width,s.height=e.height,s.getContext("2d").drawImage(l,0,0,s.width,s.height);var u=document.createElement("img");return u.src=s.toDataURL(n,a),u},handleExtractorMessage:function(e){if(null!=this.worker&&null!=this.drawer)if("crticalMessage"===e.data.cmd)console.error(e.data.message);else if("debugMessage"===e.data.cmd)console.debug(e.data.message);else if("infoMessage"===e.data.cmd)console.info(e.data.message);else if("warningMessage"===e.data.cmd)console.warn(e.data.message);else{this.fpseframes++;var t=this.faceAvailable;if(this.queuedCommands--,"tokenize"===e.data.cmd)this.tokenizerEvent&&this.tokenizerEvent(e.data.data);else if("ready"===e.data.cmd)this.queuedCommands++,this.wasmReady=!0,this.CheckDependencies(this);else if("detect"===e.data.cmd){this.lastDetectResult=e.data,this.faceAvailable=!1;var i=this.lastDetectResult;if(i.sampleDiagnostic===b.Selphi.SampleDiagnostic.Ok){if(i.face){var n=this.fromCameraToScreenDetection(this,i.face);this.drawer.faceInsideCircle(n)&&(this.faceAvailable=!0,this.faceDataRect=n)}if(i.leftEye){var a=this.fromCameraToScreenDetection(this,{x:i.leftEye.x,y:i.leftEye.y,width:1,height:1});this.privateEyesYLevel=a.y,this.leftEyeData=a}if(i.rightEye){var l=this.fromCameraToScreenDetection(this,{x:i.rightEye.x,y:i.rightEye.y,width:1,height:1});this.rightEyeData=l}}if(this.faceTooFar=i.sampleDiagnostic===b.Selphi.SampleDiagnostic.FaceTooFar,i.face){var s=this.fromCameraToScreenDetection(this,i.face);(this.drawer.faceInsideCircle(s)||this.cm.getFaceTracking())&&(this.faceAvailable=!0,this.faceDataRect=s)}var r=i.sampleDiagnostic===b.Selphi.SampleDiagnostic.NotRated;if(!1===this.qualityCheckFailed&&!0===r&&this.printLog("Selphi: timeout by phi_code_3"),this.qualityCheckFailed=this.qualityCheckFailed||r,i.leftEye){var c=this.fromCameraToScreenDetection(this,{x:i.leftEye.x,y:i.leftEye.y,width:1,height:1});this.privateEyesYLevel=c.y,this.leftEyeData=c}if(i.rightEye){var o=this.fromCameraToScreenDetection(this,{x:i.rightEye.x,y:i.rightEye.y,width:1,height:1});this.privateEyesYLevel=o.y,this.rightEyeData=o}this.lastExtractionResult&&this.lastExtractionResult.face?this.facePositions.push(this.lastExtractionResult.SampleDiagnostic===b.Selphi.SampleDiagnostic.NotRated):this.facePositions.push(!0),"UCExtracting"===this.state&&(this.qualityCheckFailed&&(i.sampleDiagnostic=b.Selphi.SampleDiagnostic.NotRated),this.privateLastImage.extractionResult=i,i.sampleDiagnostic===b.Selphi.SampleDiagnostic.Ok&&!0===this.faceAvailable&&(this.privateImages.length<5?this.privateImages.push(this.privateLastImage):this.betterSustitution(this,this.privateImages,this.privateLastImage)))}else if("evaluateLiveness"===e.data.cmd)e.data.livenessDiagnostic===b.Selphi.LivenessDiagnostic.LivenessDetected?this.graph.sendMessage("AuthenticationFinished"):(this.livenessActualRetrain+=e.data.penalty,this.livenessActualRetrain>=3?(this.livenessDiagnostic=e.data.livenessDiagnostic,this.graph.sendMessage("Errors")):this.clockLiveness3_finish=this.actualTime);else if("livenessTimerReset"===e.data.cmd);else if("livenessTimerSetValues"===e.data.cmd);else if("livenessTimerAdd"===e.data.cmd)!0===e.data.status&&this.privateLivenessImages.push(this.privateLivenessImageTemp),!0===e.data.isFull&&(this.privateLivenessTimerDiagnostic=e.data.livenessTimerDiagnostic,this.graph.sendMessage("LivenessTimerFull"));else if("nextLivenessMoveSequence"===e.data.cmd)this.livenessMoveDirection=e.data.direction,-1!==this.forceMoveDirection&&(this.livenessMoveDirection=this.forceMoveDirection);else if("nextLivenessMoveStabilization"===e.data.cmd){var d=e.data;if(this.livenessMoveLastStabilizedStatus=d.faceStabilized,this.faceTooFar=3===d.faceStabilized,this.faceAvailable=!1,d.sampleDiagnostic===b.Selphi.SampleDiagnostic.Ok&&(this.lastExtractionResult=e.data),d.face){var u=this.fromCameraToScreenDetection(this,d.face);(this.drawer.faceInsideCircle(u)||this.cm.getFaceTracking())&&(this.faceAvailable=!0,this.faceDataRect=u)}if(d.leftEye){var h=this.fromCameraToScreenDetection(this,{x:d.leftEye.x,y:d.leftEye.y,width:1,height:1});this.privateEyesYLevel=h.y,this.leftEyeData=h}if(d.rightEye){var m=this.fromCameraToScreenDetection(this,{x:d.rightEye.x,y:d.rightEye.y,width:1,height:1});this.privateEyesYLevel=m.y,this.rightEyeData=m}if(this.privateLastImage.extractionResult=d,1!==d.faceStabilized&&17!==d.faceStabilized||(this.livenessMoveStabilizedStatusHistory.push(d.faceStabilized),this.graph.sendMessage("FaceStabilized")),4===d.faceStabilized&&(this.livenessMoveGlassesFail++,this.livenessMoveFailReason=0,this.livenessMoveStabilizedStatusHistory.push(d.faceStabilized),this.graph.sendMessage("GlassesFound//"+this.livenessMoveGlassesFail)),null!=d.faceStabilized){var p=new CustomEvent("FPhi.UserControl.Stabilizing.event",{detail:d.faceStabilized});this.divContainer.dispatchEvent(p)}}else if("nextLivenessMoveImage"===e.data.cmd){this.livenessCalculating=!1;var g=e.data;this.privateImages[this.livenessMoveNextIndex].extractionResult=g,this.privateLivenessImages[this.livenessMoveNextIndex]=null,this.livenessMoveNextIndex++}else if("evaluateLivenessMove"===e.data.cmd){this.livenessCalculating=!1;var Z=e.data;this.lastExtractionResult=e.data,this.livenessMoveHistory.push(Z.livenessDiagnostic),Z.livenessDiagnostic===b.Selphi.LivenessDiagnostic.LivenessDetected?(this.livenessMoveActualSuccessfulAttempts++,this.livenessMoveLastAttempSuccessful=!0,this.graph.sendMessage("LivenessMoveRetry//"+this.livenessMoveActualSuccessfulAttempts+","+this.livenessMoveActualFailedAttempts)):(this.livenessMoveFailReason=1,this.livenessDiagnostic=Z.livenessDiagnostic,this.livenessMoveActualFailedAttempts++,this.livenessMoveLastAttempSuccessful=!1,this.graph.sendMessage("LivenessMoveRetry//"+this.livenessMoveActualSuccessfulAttempts+","+this.livenessMoveActualFailedAttempts))}else if("extractNextSmart"===e.data.cmd){var I=e.data;if(this.faceTooFar=e.data.sampleDiagnostic===b.Selphi.SampleDiagnostic.FaceTooFar,this.faceAvailable=!1,I.sampleDiagnostic===b.Selphi.SampleDiagnostic.Ok){this.lastExtractionResult=e.data;var y=this.fromCameraToScreenDetection(this,this.lastExtractionResult.face);this.drawer.faceInsideCircle(y)&&(this.faceAvailable=!0,this.faceDataRect=y)}var R=I.sampleDiagnostic===b.Selphi.SampleDiagnostic.NotRated;if(!1===this.qualityCheckFailed&&!0===R&&this.printLog("Selphi: timeout by phi_code_3"),this.qualityCheckFailed=this.qualityCheckFailed||R,I.leftEye){var f=this.fromCameraToScreenDetection(this,{x:I.leftEye.x,y:I.leftEye.y,width:1,height:1});this.privateEyesYLevel=f.y,this.leftEyeData=f}if(I.rightEye){var v=this.fromCameraToScreenDetection(this,{x:I.rightEye.x,y:I.rightEye.y,width:1,height:1});this.privateEyesYLevel=v.y,this.rightEyeData=v}this.lastExtractionResult&&this.lastExtractionResult.face?this.facePositions.push(this.lastExtractionResult.SampleDiagnostic===b.Selphi.SampleDiagnostic.NotRated):this.facePositions.push(!0),"UCExtracting"===this.state&&(this.qualityCheckFailed&&(I.sampleDiagnostic=b.Selphi.SampleDiagnostic.NotRated),this.privateLastImage.extractionResult=I,I.sampleDiagnostic===b.Selphi.SampleDiagnostic.Ok&&!0===this.faceAvailable&&(this.privateImages.length<5?this.privateImages.push(this.privateLastImage):this.betterSustitution(this,this.privateImages,this.privateLastImage)))}if(this.faceTooFar&&(this.faceAvailable=!1),this.oldFaceAvailableDelayed=this.faceAvailableDelayed,!0===t&&!1===this.faceAvailable?this.clockWarningIn=this.actualTime:!1===t&&!0===this.faceAvailable?this.clockWarningOut=this.actualTime:(this.faceAvailable&&this.actualTime-this.clockWarningOut>1e3*this.warningOutTime||!this.faceAvailable&&this.actualTime-this.clockWarningIn>1e3*this.warningInTime)&&(this.faceAvailableDelayed=this.faceAvailable),this.oldFaceAvailableDelayed!==this.faceAvailableDelayed&&this.divContainer){var W=new CustomEvent("FPhi.UserControl.TrackStatus.event",{detail:{code:b.Selphi.TrackStatus.FaceState,timeStamp:this.secondsWidget,data:this.faceAvailableDelayed}});this.divContainer.dispatchEvent(W)}}},faceTrack:function(){if(null!=this.faceDataRect){var e=Math.round(this.drawer.circleX-(this.faceDataRect.x+this.faceDataRect.width/2)),t=Math.round(this.drawer.circleY-(this.faceDataRect.y+this.faceDataRect.height/2));e>this.drawer.circleX-this.drawer.circleRadius&&(e=this.drawer.circleX-this.drawer.circleRadius),t>this.drawer.circleY-this.drawer.circleRadius&&(t=this.drawer.circleY-this.drawer.circleRadius),e+this.cameraVisibleRegion.width<this.drawer.circleX+this.drawer.circleRadius&&(e=this.drawer.circleX+this.drawer.circleRadius-this.cameraVisibleRegion.width),t+this.cameraVisibleRegion.height<this.drawer.circleY+this.drawer.circleRadius&&(t=this.drawer.circleY+this.drawer.circleRadius-this.cameraVisibleRegion.height),null==this.faceTrackingOffset&&(this.faceTrackingOffset={x:this.cameraVisibleRegion.x,y:this.cameraVisibleRegion.y}),this.faceTrackingOffset.x+=1.5*(e-this.faceTrackingOffset.x)/this.fps,this.faceTrackingOffset.y+=1.5*(t-this.faceTrackingOffset.y)/this.fps,this.video.style.left=this.faceTrackingOffset.x+"px",this.video.style.top=this.faceTrackingOffset.y+"px"}},startVideos:function(e){if(null!=e.elements)for(var t=0;t<e.elements.length;t++)if("video"===e.elements[t].type){var i=document.createElement("video");i.hidden=!0,i.playsinline=!0,i.loop=!1,i.muted=!0,i.autoplay=!0,i.controls=!0,i.src=e.rm.getResourceUrlBase(e.rm.getSetupResourceId(e.resourceParent,e.elements[t].id,e.drawer.landscape,"value")),i.addEventListener("ended",e.videoplayerEnded.bind(e),!1),i.setAttribute("playsinline",""),i.setAttribute("webkit-playsinline",""),i.play(),e.elements[t].videoPlayer=i}},canvasOnMove:function(e){if(void 0!==this.elements&&null!=this.elements)for(var t=this.elements.length-1;t>=0;t--)if(void 0!==this.elements[t].layout&&e.offsetX>=this.elements[t].layout.x&&e.offsetX<this.elements[t].layout.x+this.elements[t].layout.width&&e.offsetY>=this.elements[t].layout.y&&e.offsetY<this.elements[t].layout.y+this.elements[t].layout.height){if("button_info"===this.elements[t].id)break;this.drawer.onMouseMove(e.target,this.elements[t].layout,this.resourceParent,this.elements[t].id,this.elements[t].type);break}},routeClick:function(e,t){this.canvasOnClick({offsetX:e,offsetY:t})},canvasOnClick:function(e){if("UCErrors"===this.state){e.offsetX;var t=e.offsetY,i=this.canvasHeight-this.buttonHeight;this.printLog("Selphi: canvasOnClick",this.canvasHeight,i,t),t>i&&this.graph.sendMessage("Click//button_error")}else{if(void 0===this.elements)return;for(var n=null,a=this.elements.length-1;a>=0;a--)if(null!=this.elements[a].layout&&e.offsetX>=this.elements[a].layout.x&&e.offsetX<this.elements[a].layout.x+this.elements[a].layout.width&&e.offsetY>=this.elements[a].layout.y&&e.offsetY<this.elements[a].layout.y+this.elements[a].layout.height){n=this.elements[a].id;var l="Click//"+this.elements[a].id;this.graph.sendMessage(l);break}if(this.divContainer){var s=new CustomEvent("FPhi.UserControl.TrackStatus.event",{detail:{code:b.Selphi.TrackStatus.Tap,timeStamp:this.secondsWidget,data:n}});this.divContainer.dispatchEvent(s)}}},initCamera:function(e,t,i){var n=this.canvas;if(!this.video){var a=document.createElement("video");a.id="live",a.setAttribute("playsinline",""),a.setAttribute("webkit-playsinline",""),a.setAttribute("autoplay",""),a.setAttribute("muted",""),a.style.display="none",e.insertBefore(a,e.firstChild),this.video=a,this.onVideoResizeContext=this.onVideoResize.bind(this),a.addEventListener("resize",this.onVideoResizeContext,!1)}n.imageSmoothingEnabled=!0,n.clientWidth,n.clientHeight,n&&(n.style.display="none",n.onclick=this.canvasOnClick.bind(this),n.onmousemove=this.canvasOnMove.bind(this),this.privateCanvas=document.createElement("canvas"),0===this.cameraRotation||2===this.cameraRotation?(this.privateCanvas.width=t,this.privateCanvas.height=i):(this.privateCanvas.width=i,this.privateCanvas.height=t))},userMedia:function(){return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||null},setVideoInput:function(e){e.canvas&&e.playDevice(e)},playDevice:function(e){var t,i=e.video,n=e.canvas.getContext("2d",{alpha:!0}),a=null;"undefined"!=typeof facePhiUserControl&&null!==facePhiUserControl.config.videoSelectId&&(a=facePhiUserControl.config.videoSelectId),window.stream&&window.stream.getTracks().forEach((function(e){e.stop()})),t={video:{deviceId:a?{exact:a}:void 0,width:e.cameraWidth,height:e.cameraHeight,facingMode:e.cameraType===b.Selphi.CameraType.Front?"user":"environment"},audio:!1},navigator.mediaDevices.getUserMedia(t).then((function(t){e.cameraStream=t,i.srcObject=t;var n=t.getVideoTracks()[0];e.cameraName=n.label,e.printLog("Selphi: Camera selected for widget: "+n.label),i.onloadedmetadata=e.videoLoaded.bind(e),i.play()})).catch((function(t){e.draw(e,e.imageCamera,n);var i=new CustomEvent("FPhi.UserControl.ExceptionCaptured.event",{detail:{message:"Camera not found.",exceptionType:0}});e.divContainer.dispatchEvent(i)}))},addCameraResolution:function(e,t,i){for(var n=0;n<e.length;n++)if(e[n].width===t&&e[n].height===i)return;e.push({width:t,height:i})},checkCameraResolutions:function(){var e=m(u().mark((function e(t,i,n){var a,l,s,r,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=document.createElement("video"),e.next=3,navigator.mediaDevices.enumerateDevices();case 3:for(l=e.sent,s=0;s<l.length;s++)n.printLog("Selphi: "+l[s]);return r={video:{width:n.cameraWidth,height:n.cameraHeight,facingMode:n.cameraType===b.Selphi.CameraType.Front?"user":"environment"},audio:!1},e.prev=6,e.next=9,navigator.mediaDevices.getUserMedia(r);case 9:c=e.sent,a.srcObject=c,a.onloadedmetadata=function(){var e=m(u().mark((function e(i){var a,l,s,r,o,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.getVideoTracks()[0],a=0;case 2:if(!(a<t.length)){e.next=17;break}return l={width:{exact:t[a].width},height:{exact:t[a].height}},e.prev=4,s=c.getVideoTracks()[0],e.next=8,s.applyConstraints(l);case 8:(r=s.getSettings()).resizeMode?"none"===r.resizeMode&&n.addCameraResolution(n.testedResolutions,t[a].width,t[a].height):n.addCameraResolution(n.testedResolutions,t[a].width,t[a].height),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(4);case 14:a++,e.next=2;break;case 17:for(o="Camera resolutions: ",d=0;d<n.testedResolutions.length;d++)o=o+"["+n.testedResolutions[d].width+"x"+n.testedResolutions[d].height+"]";n.printLog("Selphi: "+o),c.getTracks().forEach((function(e){e.stop()})),n.Start_();case 20:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}(),a.play(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),self_Start_();case 16:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(t,i,n){return e.apply(this,arguments)}}(),handleRecorderDataAvailable:function(e){e.data&&e.data.size>0&&this.recordedBlobs.push(e.data)},handleRecorderOnStop:function(e){this.recorderFinish=!0},mobileCheck:function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},isIpadOS:function(){return navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform)},gotDevices:function(e){for(var t=0,i=0;i!==e.length;++i)"videoinput"===e[i].kind&&t++;this.cameraList=new Array(t);for(var n=0,a=0;a!==e.length;++a){var l=e[a];if("videoinput"===l.kind){var s=document.createElement("option");s.value=l.deviceId,s.text=l.label,this.cameraList[n]=s,n++}}var r=new CustomEvent("FPhi.UserControl.Cameras.event",{detail:{cameras:this.cameraList}});this.divContainer.dispatchEvent(r)},handleCameraError:function(e){},fromCameraToScreen:function(e,t){var i=e.cameraWidth,n=e.cameraHeight;1!==e.cameraRotation&&3!==e.cameraRotation||(i=e.cameraHeight,n=e.cameraWidth);var a=e.canvas.getContext("2d",{alpha:!0}),l=e.drawer.getCameraRect(a,i,n),s=l.width/i,r=l.height/n,c={x:t.x*s,y:t.y*r,width:t.width*s,height:t.height*r},o=e.reflectedX(l.width,c.x+c.width);return c.x=o,c.x+=l.x,c.y+=l.y,c},fromCameraToScreenDetection:function(e,t){var i=e.cameraWidth,n=e.cameraHeight;1!==e.cameraRotation&&3!==e.cameraRotation||(i=e.cameraHeight,n=e.cameraWidth);var a=e.canvas.getContext("2d",{alpha:!0}),l=e.drawer.getCameraRect(a,i,n),s=l.width/i,r=l.height/n,c={x:t.x*s,y:t.y*r,width:t.width*s,height:t.height*r},o=e.reflectedX(l.width,c.x+c.width);return c.x=o,c.x+=l.x,c.y+=l.y,c},scaleRect:function(e,t,i){var n=t.x+t.width/2,a=t.y+t.height/2,l=t.width/e.width,s=t.height/e.height,r=e.width*l,c=e.height*l;return void 0===i?c<t.height&&(r=e.width*s,c=e.height*s):c>=t.height&&(r=e.width*s,c=e.height*s),{x:n-r/2,y:a-c/2,width:r,height:c}},scaleRectByFactor:function(e,t,i){var n=e.x+.5*e.width,a=e.y+.5*e.height,l={x:0,y:0,width:0,height:0};l.width=e.width*=t,l.height=e.height*=i,l.x=e.x,l.y=e.y;var s=e.x+.5*e.width-n,r=e.y+.5*e.height-a;return l.x-=s,l.y-=r,l},getGraphicalScore:function(e){var t=100*e/90*(100*e/90)*.9+.1;return t>1&&(t=1),t},saveImageToCanvas:function(e,t){var i=e.privateCanvas.getContext("2d");switch(e.cameraRotation){case 0:i.drawImage(t,0,0,e.cameraWidth,e.cameraHeight);break;case 1:case 3:i.save(),i.translate(e.cameraHeight/2,e.cameraWidth/2),i.rotate(Math.PI/2*e.cameraRotation),i.drawImage(t,-e.cameraWidth/2,-e.cameraHeight/2),i.restore();break;case 2:i.save(),i.translate(e.cameraWidth/2,e.cameraHeight/2),i.rotate(Math.PI/2*e.cameraRotation),i.drawImage(t,-e.cameraWidth/2,-e.cameraHeight/2),i.restore()}},getLayoutFromXML:function(e,t,i,n,a){var l="LEFT",s="TOP",r=i;if(this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"width")){null==r&&(r={});var c=this.rm.getSetupFloat(e,t,this.drawer.landscape,"width");r.width=c<=1?c*n:c,!0}if(this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"height")){null==r&&(r={});var o=this.rm.getSetupFloat(e,t,this.drawer.landscape,"height");r.height=o<=1?o*a:o,!0}if(this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"xAnchor")&&(l=this.rm.getSetupAlign(e,t,this.drawer.landscape,"xAnchor")),this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"yAnchor")&&(s=this.rm.getSetupAlign(e,t,this.drawer.landscape,"yAnchor")),this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"x")){null==r&&(r={});var d=this.rm.getSetupFloat(e,t,this.drawer.landscape,"x");r.x=d<=1&&d>=-1?d*n:d,"CENTER"===l?r.x=n/2-r.width/2+r.x:"RIGHT"===l&&(r.x=n-r.width+r.x),!0}if(this.rm.isAttributeAvailable(e,t,this.drawer.landscape,"y")){null==r&&(r={});var u=this.rm.getSetupFloat(e,t,this.drawer.landscape,"y");r.y=u<=1&&u>=-1?u*a:u,"CENTER"===s?r.y=a/2-r.height/2+r.y:"BOTTOM"===s&&(r.y=a-r.height+r.y),!0}return r},draw:function(e){if(null!=this.drawer&&null!=this.divContainer){this.cm.getFaceTracking()&&this.faceTrack();var t=this,i=t.video,n=t.canvas.getContext("2d",{alpha:!0}),a=n.canvas.clientWidth,l=n.canvas.clientHeight;t.canvasWidth=a,t.canvasHeight=l,n.clearRect(0,0,a,l),t.fpsframes++,t.actualTimePrev=t.actualTime,t.actualTime=performance.now();var s=(t.actualTime-t.fpsTime)/1e3;s>1&&(t.fps=t.fpsframes/s,t.fpseframes>0?t.fpse=t.fpseframes/s:t.fpse=0,t.fpsTime=t.actualTime,t.fpsframes=0,t.fpseframes=0);var r="Normal";if(t.actualTime-t.widgetTime>500&&("UCWaitingFaceStart"!==t.state&&"UCExtracting"!==t.state||t.faceAvailableDelayed||(r="Warning"),"UCLivenessMoveStabilizing"===t.state&&1!==t.livenessMoveLastStabilizedStatus&&2!==t.livenessMoveLastStabilizedStatus&&17!==t.livenessMoveLastStabilizedStatus&&(r="Warning")),t.iterateAutomata(t,i,n),t.secondsWidget=(t.actualTime-t.widgetTime)/1e3,t.secondsState=(t.actualTime-t.stateTime)/1e3,void 0!==t.elements&&null!==t.elements){var c={progress:0};c.faceDataRect=t.faceDataRect,c.leftEyeData=t.leftEyeData,c.rightEyeData=t.rightEyeData,c.state=t.state,c.livenessMoveLastStabilizedStatus=t.livenessMoveLastStabilizedStatus,c.interactible=t.interactible,"UCExtracting"===t.state?0!==t.extractionTime?c.progress=t.extractionTimePartial/(1e3*t.extractionTime):c.progress=0:"UCShowResults"===t.state?c.progress=t.getGraphicalScore(t.lastExtractionResult.templateScore):"UCLivenessMoveDetecting"===t.state?c.livenessMoveDirection=t.livenessMoveDirection:"UCWaitingFaceStart"===t.state||"UCWaitingFaceStartDecision"===t.state?c.progress=1:"UCErrors"!==t.state&&"UCErrorFinish"!==t.state||(c.livenessDiagnostic=t.livenessDiagnostic),c.livenessMoveFailReason=t.livenessMoveFailReason;for(var o=0;o<t.elements.length;o++)if("button"!==t.elements[o].type&&"buttonImage"!==t.elements[o].type||!1!==t.interactible){var d=null;if(null!==t.rm&&(d=t.drawer.getLayout(t.resourceParent,t.elements[o].id,t.elements[o].type,t.secondsWidget,t.secondsState,r,c)),null!==d&&(d=t.getLayoutFromXML(t.resourceParent,t.elements[o].id,d,a,l)),null!==d){t.elements[o].layout=d;var u=t.elements[o].mode,h=!1;if(null!=u){for(var m=u.split("|"),b=0;b<m.length;b++)if(m[b]===r){h=!0;break}}else h=!0;if(!0===h){if("video"===t.elements[o].type)c.player=t.elements[o].videoPlayer;else if("camera"===t.elements[o].type)if(c.eyesYLevel=t.privateEyesYLevel,c.blindText="","UCLivenessDetectionStep1"===t.state){var p=t.actualTime-t.clockLiveness1;(p/=1e3*t.liveness1Time)>1&&(p=1),p=(p-1)*(p-1)*(p-1)+1,c.blind=.8*p}else if("UCLivenessDetectionStep2"===t.state)c.blind=.8,c.blindText=t.rm.translate("message_blink");else if("UCLivenessDetectionStep3"===t.state){var g=0;(g=(g=t.actualTime-t.clockLiveness3)/(1e3*t.liveness3Time)*.2)>.2&&(g=.2),c.blind=.8+g}else if("UCWaitingEyeDetection"===t.state)if(null==t.clockEyeDetectionDetected){var Z=t.actualTime-t.clockEyeDetection,I=0;Z<1e3?I=1:((I=(Z-1e3)/(1e3*t.liveness1Time))<0?I=0:I>1&&(I=1),I=1-I),c.blind=I}else{var y=(t.actualTime-t.clockEyeDetectionDetected)/(1e3*t.liveness3Time)*.2;y<0?y=0:y>.2&&(y=.2),c.blind=1-y}else c.blind=0;"button_info"===t.elements[o].id||t.cm.getAccessibility()&&t.cm.getAccessibleElements().includes(t.elements[o].type)||t.drawer.draw(n,d,t.resourceParent,t.elements[o].id,t.elements[o].type,t.secondsWidget,t.secondsState,r,c)}}}}else if("UCErrors"===t.state){n.fillStyle="white",n.fillRect(0,0,a,l);var R=t.livenessErrorString,f=15*t.fontSizeFactor,v=t.rm.getSetupResourceId("facephi-widget-conf","",t.drawer.landscape,"font_warning_message");n.font=f+"px '"+v+"'",n.fillStyle="black";for(var W=R.split("\n"),G=0;G<W.length;G++){var V=n.measureText(W[G]),X=330*t.canvasSizeFactor+f*G;n.fillText(W[G],a/2-V.width/2,X)}var S=t.livenessErrorImage,C=t.scaleRect({width:S.width,height:S.height},{x:.03*a,y:.378*l,width:.94*a,height:.1*l},!0);n.drawImage(S,C.x,C.y,C.width,C.height),t.drawButton(t,n,{x:0,y:l-t.buttonHeight,width:a,height:t.buttonHeight},"Results","button_finish"),t.secondsState}if(t.debug&&null!=t.worker){var N=1;n.font="12px Verdana",n.fillStyle="gray",n.fillText("Version: "+t.extractorVersion,0,20*N),N++,n.fillText("State: "+t.state,0,20*N),N++,n.fillText("FPS: "+t.fps.toFixed(2),0,20*N),N++,n.fillText("FPS Extractor: "+t.fpse.toFixed(2),0,20*N),N++,n.fillText("Camera size: "+t.cameraWidth+"x"+t.cameraHeight+"px",0,20*N),N++,n.fillText("Canvas size: "+a+"x"+l+"px",0,20*N),N++,n.fillText("Camera rotation: "+t.cameraRotation,0,20*N),N++,n.fillText("WidgetTime: "+t.secondsWidget,0,20*N),N++,n.fillText("StateTime: "+t.secondsState,0,20*N),N++,n.fillText("Mode: "+r,0,20*N),N++,n.fillText("Images: "+t.privateImages.length,0,20*N),N++,n.fillText("Face available: "+t.faceAvailable,0,20*N),N++,n.fillText("EyesYLevel: "+Math.round(t.privateEyesYLevel),0,20*N),N++;var E=t.lastDetectResult;if(null!=E){if(void 0!==E.face){n.fillText("Face: ["+E.face.x+","+E.face.y+","+E.face.width+","+E.face.height+"]",0,20*N),N++,n.beginPath(),n.lineWidth="3",n.strokeStyle="red";var Y=t.fromCameraToScreen(t,{x:E.face.x,y:E.face.y,width:E.face.width,height:E.face.height});n.rect(Y.x,Y.y,Y.width,Y.height),n.stroke()}if(void 0!==E.leftEye){n.beginPath(),n.lineWidth="6",n.strokeStyle="red";var F=t.fromCameraToScreen(t,{x:E.leftEye.x,y:E.leftEye.y,width:1,height:1});n.rect(F.x,F.y,F.width,F.height),n.stroke()}if(void 0!==E.rightEye){n.beginPath(),n.lineWidth="6",n.strokeStyle="red";var k=t.fromCameraToScreen(t,{x:E.rightEye.x,y:E.rightEye.y,width:1,height:1});n.rect(k.x,k.y,k.width,k.height),n.stroke()}}}null!=t.worker&&setTimeout(t.draw.bind(this),t.samplePeriod)}},reduceRect:function(e,t){var i=e.width*(1-t),n=e.height*(1-t);return e.x=e.x+(e.width-i)/2,e.y=e.y+(e.height-n)/2,e.width=i,e.height=n,e},drawStringMultiline:function(e,t,i,n,a,l,s){var r=i.split("\n");t.imageSmoothingEnabled=!1,s=Math.round(s*e.fontSizeFactor),t.font="normal "+s+"px '"+l+"'",t.fillStyle=a;for(var c=0;c<r.length;c++){var o=t.measureText(r[c]);t.fillText(r[c],e.canvasWidth/2-o.width/2,n+c*(s+1))}},setOffInterface:function(e,t,i){e.beginPath(),e.lineWidth="5",e.fillStyle="gray",e.fillRect(0,0,i,i),e.stroke()},adaptText:function(e,t,i,n){if(t.font=n,t.measureText(i).width>e){var a=n.indexOf("px"),l=n.substring(0,a);return n=--l+n.substring(a,n.length),t.font=n,this.adaptText(e,t,i,n)}return!0},reflectedX:function(e,t){return e-t},iterateAutomata:function(e,t,i){if(!1!==e.cameraReady){if(!1===e.wasmInitiated){e.wasmInitiated=!0;var n=e.privateCanvas.width;n>e.privateCanvas.height&&(n=e.privateCanvas.height),e.postMessage(e,{cmd:"init",livenessMode:e.livenessMode,stabilizationStage:e.stabilizationStage,minIOD:.125*n,maxIOD:.27*n,cameraWidth:e.privateCanvas.width,cameraHeight:e.privateCanvas.height})}if("UCNothing"===e.state){var a=e.canvas;null!=a&&(a.style.display="inline-block");var l="SetMode//"+e.livenessMode+","+(e.tutorial?1:0);e.printLog(l),e.graph.sendMessage(l)}else if("UCErrors"===e.state)!1===e.interactible&&e.secondsState>2&&e.graph.sendMessage("Click//button_error");else if("UCTutorialRegister1"===e.state)e.evaluateScenarioTimeout(e);else if("UCTutorialRegister2"===e.state)e.evaluateScenarioTimeout(e);else if("UCWaitingFaceStart"===e.state)0===e.queuedCommands&&e.wasmReady&&(e.saveImageToCanvas(e,t),e.privateLastImage=e.getImageData(e.privateCanvas),e.postMessage(e,{cmd:"detect",data:e.privateLastImage.pixels.data,width:e.privateLastImage.width,height:e.privateLastImage.height,format:b.Selphi.ImageFormat.RGBA_32bpp}),e.evaluateScenarioTimeout(e));else if("UCWaitingFaceStartDecision"===e.state)!0===e.stabilizationStage?e.graph.sendMessage("Stabilize"):e.graph.sendMessage("Extract");else if("UCExtracting"===e.state){navigator.userAgent&&(navigator.userAgent.includes("Macintosh")&&!0,navigator.userAgent.includes("Chrome")&&!0),e.cameraName.toUpperCase().includes(e.face_v()+e.face_t())||e.cameraName.toUpperCase().includes(e.face_o()+e.face_b()+e.face_s())||e.cameraName.toUpperCase().includes(e.face_spl()+e.face_it()+e.face_cam())||e.cameraName.toUpperCase().includes(e.face_fa()+e.face_ke())||e.cameraName.toUpperCase().includes(e.face_sn()+e.face_ap())||e.cameraName.toUpperCase().includes(e.face_defa()+e.face_ult())||e.cameraName.toUpperCase().includes(e.face_mo()+e.face_ck())||e.cameraName.toUpperCase().includes(e.face_alpha())?e.actualTime-e.clockExtractionPure>e.extractionTimeout&&(e.livenessDiagnostic=-1,e.graph.sendMessage("Timeout"),e.printLog("Selphi: timeout by phi_code_2")):e.faceAvailableDelayed&&(e.extractionTimePartial+=e.actualTime-e.actualTimePrev),0===e.queuedCommands&&(e.actualTime-e.clockExtractionPure>e.detectionTimeout&&0===e.privateImages.length?(e.livenessDiagnostic=-1,e.graph.sendMessage("Timeout")):e.extractionTime>0&&(e.extractionTimePartial<1e3*e.extractionTime||0===e.privateImages.length)?e.actualTime-e.clockExtractionPure>e.extractionTimeout?(e.livenessDiagnostic=-1,e.graph.sendMessage("Timeout")):(e.saveImageToCanvas(e,t),e.privateLastImage=e.getImageData(e.privateCanvas),e.postMessage(e,{cmd:"extractNextSmart",data:e.privateLastImage.pixels.data,width:e.privateLastImage.width,height:e.privateLastImage.height,format:b.Selphi.ImageFormat.RGBA_32bpp})):17==e.livenessMoveLastStabilizedStatus?(e.livenessMoveFailReason=2,e.livenessMoveActualFailedGlassesAttempts++,e.livenessMoveActualFailedAttempts++,e.graph.sendMessage("LivenessMoveGlasses//"+e.livenessMoveActualFailedAttempts)):e.graph.sendMessage("AuthenticationFinished"))}else if("UCShowResults"===e.state)e.evaluateScenarioTimeout(e);else if("UCWaitingEyeDetection"===e.state){if(performance.now()-e.clockEyeDetection>e.detectionTimeout)return e.livenessDiagnostic=-1,void e.graph.sendMessage("Timeout");var s=performance.now()-e.clockEyeDetection;if(s>1e3&&null==e.clockEyeDetectionDetected&&s<1e3+1e3*e.liveness1Time)return;if(s>1e3+1e3*e.liveness1Time&&null!=e.clockEyeDetectionDetected)return void e.graph.sendMessage("ResetLivenessBlink");null!=e.clockEyeDetectionDetected&&performance.now()-e.clockEyeDetectionDetected>1e3*e.liveness3Time&&e.graph.sendMessage("Timer"),null==e.clockEyeDetectionDetected&&0===e.queuedCommands&&e.wasmReady&&(e.saveImageToCanvas(e,t),e.privateLastImage=e.getImageData(e.privateCanvas),e.postMessage(e,{cmd:"detect",data:e.privateLastImage.pixels.data,width:e.privateLastImage.width,height:e.privateLastImage.height,format:b.Selphi.ImageFormat.RGBA_32bpp}),e.evaluateScenarioTimeout(e))}else if("UCLivenessDetectionStep1"===e.state)performance.now()-e.clockLiveness1>1e3*e.liveness1Time&&e.graph.sendMessage("Timer");else if("UCLivenessDetectionStep2"===e.state)0===e.queuedCommands&&e.wasmReady&&(e.saveImageToCanvas(e,t),e.privateLivenessImageTemp=e.getImageData(e.privateCanvas),e.postMessage(e,{cmd:"livenessTimerAdd",milliseconds:performance.now()-e.clockLiveness2}));else if("UCLivenessDetectionStep3"===e.state)null!=e.clockLiveness3_finish&&performance.now()-e.clockLiveness3_finish>1e3*e.liveness3Time&&e.graph.sendMessage("EyeDetectionNeeded");else if("UCLivenessMoveStabilizing"===e.state)if(e.secondsState>=10){e.livenessDiagnostic=-1,e.livenessMoveStabilizedStatusHistory.push(-1),e.graph.sendMessage("Timeout");var r=new CustomEvent("FPhi.UserControl.Stabilizing.event",{detail:-1});this.divContainer.dispatchEvent(r)}else 0===e.queuedCommands&&e.wasmReady&&(e.saveImageToCanvas(e,t),e.privateLastImage=e.getImageData(e.privateCanvas),e.postMessage(e,{cmd:"nextLivenessMoveStabilization",data:e.privateLastImage.pixels.data,width:e.privateLastImage.width,height:e.privateLastImage.height,format:b.Selphi.ImageFormat.RGBA_32bpp}));else if("UCLivenessMoveDetecting"===e.state){if(e.secondsState>.5){var c=Math.round(1e3*e.secondsState);if(e.livenessMoveTimer.Add(c)){e.saveImageToCanvas(e,t);var o=e.getImageData(e.privateCanvas);e.privateLivenessImages.push(o),this.privateImages.push(o),this.privateLivenessResults.push(this.secondsWidget),0===e.queuedCommands&&e.wasmReady&&!e.livenessCalculating&&e.livenessMoveNextIndex<e.privateLivenessImages.length&&e.privateLivenessImages.length>0&&(e.livenessCalculating=!0,o=e.privateLivenessImages[e.livenessMoveNextIndex],e.printLog({"Selphi: image":e.getImgTag(o,!1,1,"image/jpeg",e.imageQuality)}),e.postMessage(e,{cmd:"nextLivenessMoveImage",data:o.pixels.data,width:o.width,height:o.height,format:b.Selphi.ImageFormat.RGBA_32bpp}))}e.livenessMoveTimer.IsFull()&&e.graph.sendMessage("LivenessTimerFull")}}else if("UCLivenessMoveProcessing"===e.state){if(0===e.queuedCommands&&e.wasmReady)if(!e.livenessCalculating&&e.livenessMoveNextIndex>=e.privateLivenessImages.length)e.livenessCalculating=!0,e.postMessage(e,{cmd:"evaluateLivenessMove",timer:e.livenessMoveTimer});else if(!e.livenessCalculating&&e.livenessMoveNextIndex<e.privateLivenessImages.length&&e.privateLivenessImages.length>0){e.livenessCalculating=!0;var d=e.privateLivenessImages[e.livenessMoveNextIndex];e.printLog({"Selphi: image":e.getImgTag(d,!1,1,"image/jpeg",e.imageQuality)}),e.postMessage(e,{cmd:"nextLivenessMoveImage",data:d.pixels.data,width:d.width,height:d.height,format:b.Selphi.ImageFormat.RGBA_32bpp})}}else"UCLivenessMoveInfo"===e.state?e.secondsState>e.livenessMoveInfoTime&&(e.livenessDiagnostic=-1,e.graph.sendMessage("Timeout")):"UCWaitRecording"===e.state&&(e.cm.getVideoRecord()?e.recorderFinish&&e.graph.sendMessage("Finish"):e.graph.sendMessage("Finish"));if(e.cm.getVideoRecord()&&e.recorder.isReady()){e.privateRecordCanvasContext.drawImage(t,0,0,e.privateRecordCanvas.width,e.privateRecordCanvas.height);var u=e.privateRecordCanvasContext.getImageData(0,0,e.privateRecordCanvas.width,e.privateRecordCanvas.height);e.recorder.addFrame(u)}}},evaluateScenarioTimeout:function(e){e.sceneTimeout>0&&performance.now()-e.clockNewScenario>1e3*e.sceneTimeout&&(e.livenessDiagnostic=-1,e.graph.sendMessage("Timeout"))},getVideoSources:function(e){if(navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then((function(t){t.filter((function(e){return"video"===e.kind})).map((function(e,t){return e.id}))[0],e.setVideoInput(e)})):MediaStreamTrack.getSources((function(t){t.filter((function(e){return"video"===e.kind})).map((function(e,t){return e.id}))[0],e.setVideoInput(e)})),null==selectedSource){FacePhiDisplayErrorImage(facePhiUserControl.config.width,folderPath+commonPath+"/Images/errorNoCamsEs.png",folderPath+commonPath+"/Images/errorNoCamsEn.png","FacePhiWidgetWeb",e.divContainer,0,"","",0,Verdana,"Bold","black",0);var t=new CustomEvent("FPhi.UserControl.ExceptionCaptured.event",{detail:{message:"Camera not found.",exceptionType:0}});e.divContainer.dispatchEvent(t)}},isPathAbsolute:function(e){return/^(?:\/|.+:\/\/|http)/.test(e)},getScriptPath:function(){return String((new Error).stack).replace(/^Error.*\n/,"").split("\n")[1].match(/http.*\.js/)[0].split("/").slice(0,-1).join("/")+"/"},distAlgSustitution:function(e,t,i){for(var n,a=Number.MAX_VALUE,l=1;l<t.length;l++){var s=t.slice();s[l]=i,s.sort((function(e,t){return e.time-t.time}));var r=e.desviacionTipica(e,s);r<a&&(a=r,n=s)}return n},betterSustitution:function(e,t,i){for(var n=Number.MAX_VALUE,a=0,l=0;l<t.length;l++){var s=t[l].extractionResult.facialScore;s<n&&(n=s,a=l)}i.extractionResult.facialScore>n&&(t[a]=i)},sortImagesByFacialScore:function(e,t){t.sort((function(e,t){var i=void 0!==e.extractionResult?e.extractionResult.facialScore:0;return(void 0!==t.extractionResult?t.extractionResult.facialScore:0)-i}))},desviacionTipica:function(e,t){for(var i=e.media(e,t),n=0,a=1;a<t.length;a++){var l=t[a].time-t[a-1].time;n+=(l-i)*(l-i)}return n=Math.sqrt(n/(t.length-2))},media:function(e,t){for(var i=0,n=1;n<t.length;n++)i+=t[n].time-t[n-1].time;return i/(t.length-1)},OnResourceManagerLoaded:function(e){this.rm=new b.ResourceManager(this.baseURL,this.language,this,this.OnResourceManagerStatus,this.dpiList,window.devicePixelRatio,this.canvasSizeFactor)},OnResourceManagerStatus:function(e,t){t&&(e.rmReady=!0,e.CheckDependencies(e))},OnGraphLoaded:function(e){this.graph=new b.Graph(this.path+this.graphPath,this.OnGraphReady.bind(this),this.OnGraphNewState.bind(this))},OnGraphReady:function(e){this.graphReady=!0,this.CheckDependencies(this)},OnDrawerLoaded:function(e){this.drawer=new b.Drawer(this.mode,this.livenessMode,this.stabilizationStage,this.canvasSizeFactor,this.fontSizeFactor),this.CheckDependencies(this)},CheckDependencies:function(e){if(!0===e.rmReady&&void 0!==e.drawer&&!0!==e.resourcesCached&&(e.drawer.rm=e.rm,e.drawer.cacheResources(),e.resourcesCached=!0),!0===e.rmReady&&void 0!==e.drawer&&!0===e.graphReady&&!0===e.wasmReady&&!0===e.cameraReady&&"UCNothing"!==e.graph.state){var t=e.canvas;null!=t&&(t.style.display="none"),e.video.style.display="inline-block",e.drawer.setCanvasSize(t.clientWidth,t.clientHeight),e.graph.setInitialState("UCNothing");var i=new CustomEvent("FPhi.UserControl.ModuleLoaded.event",{detail:{cameraWidth:e.cameraWidth,cameraHeight:e.cameraHeight,instance:e}});e.divContainer.dispatchEvent(i),setTimeout(e.draw.bind(e),e.samplePeriod),e.cameraContainer.contains(e.gifWait)&&e.cameraContainer.removeChild(e.gifWait)}},videoLoaded:function(e){if(this.cameraWidth=e.target.videoWidth,this.cameraHeight=e.target.videoHeight,0===this.cameraRotation||2===this.cameraRotation?(this.privateCanvas.width=this.cameraWidth,this.privateCanvas.height=this.cameraHeight):(this.privateCanvas.width=this.cameraHeight,this.privateCanvas.height=this.cameraWidth),this.cameraReady=!0,this.printLog("Selphi: Timing-Camera-ready: "+performance.now()),this.video,this.canvas.getContext("2d",{alpha:!0}),this.cm.getVideoRecord()){switch(this.printLog("Selphi: Video recording enabled..."),this.videoRecordWidth=this.cameraWidth*this.cm.getVideoRecordScale(),this.videoRecordHeight=this.cameraHeight*this.cm.getVideoRecordScale(),this.cm.getVideoRecordType()){case b.Selphi.RecorderType.Local:this.recorder=new s(this.cameraWidth*this.cm.getVideoRecordScale(),this.cameraHeight*this.cm.getVideoRecordScale(),this.cm.getVideoRecordRate(),this.bundlePath);break;case b.Selphi.RecorderType.Remote:this.recorder=new c(this.cameraWidth*this.cm.getVideoRecordScale(),this.cameraHeight*this.cm.getVideoRecordScale(),this.cm.getVideoRecordRate(),this.bundlePath)}this.privateRecordCanvas=document.createElement("canvas"),this.privateRecordCanvas.width=this.videoRecordWidth,this.privateRecordCanvas.height=this.videoRecordHeight,this.privateRecordCanvasContext=this.privateRecordCanvas.getContext("2d")}this.CheckDependencies(this)},videoFrame:function(e){this.canvasVideoPlayer.getContext("2d").drawImage(e.target,0,0)},videoplayerEnded:function(e){"UCWizardCompleted"===this.state?this.graph.sendMessage("VideoFinished"):e.target.play()}},b.Selphi.CheckCapabilities=m(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,navigator.mediaDevices.enumerateDevices();case 3:return e.next=5,e.sent.filter((function(e){return"videoinput"==e.kind})).length;case 5:return e.t0=e.sent,t.video_devices=e.t0>0,t.wasm=function(){try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var e=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(e instanceof WebAssembly.Module)return new WebAssembly.Instance(e)instanceof WebAssembly.Instance}}catch(t){}return!1}(),t.wasm_pthreads=!1,!0===t.wasm&&"function"==typeof SharedArrayBuffer&&(t.wasm_pthreads=!0),e.abrupt("return",t);case 11:case"end":return e.stop()}}),e)}))),b.Selphi.Component=d,customElements.define("facephi-selphi",b.Selphi.Component)}();var K=U.l,J=function(t){var i=(0,e.useContext)(c).setActiveView,n={res480p:{title:"640x480",width:640,height:480},res600p:{title:"800x600",width:800,height:600},res768p:{title:"1024x768",width:1024,height:768},res720p:{title:"1280x720 (720p)",width:1280,height:720},res1080p:{title:"1920x1080 (1080p)",width:1920,height:1080}},a=l((0,e.useState)(!0),2),s=a[0],o=a[1],d=l((0,e.useState)(K.Selphi.LivenessMode.Passive),2),u=d[0],h=(d[1],l((0,e.useState)(!0),2)),m=h[0],b=(h[1],l((0,e.useState)(!1),2)),p=b[0],g=(b[1],l((0,e.useState)(!1),2)),Z=g[0],I=(g[1],l((0,e.useState)(!1),2)),y=I[0],R=(I[1],l((0,e.useState)(!1),2)),f=R[0],v=(R[1],l((0,e.useState)(!1),2)),W=v[0],G=(v[1],l((0,e.useState)("res720p"),2)),V=(G[0],G[1],l((0,e.useState)(K.Selphi.CameraType.Front),2)),X=V[0],S=(V[1],l((0,e.useState)(n.res720p.width),2)),C=S[0],N=(S[1],l((0,e.useState)(n.res720p.height),2)),E=N[0],Y=(N[1],(0,e.createRef)()),F=(0,e.useRef)();function k(e){console.warn("[Selphi] onModuleLoaded"),console.log(e)}function x(e){console.warn("[Selphi] onStabilizing"),console.log(e)}function w(e){console.warn("[Selphi] onExtractionFinish"),console.log(e),console.log("Images returned: ",e.detail.images);for(var t=0;t<e.detail.images.length;t++){var n=e.detail.images[t];console.log("Image ".concat(t,": ").concat(n.src))}e.detail.bestImage&&console.log("BestImage: ",e.detail.bestImage.src),e.detail.bestImageCropped&&console.log("BestImageCropped: ",e.detail.bestImageCropped.src),console.log("Template: ",e.detail.template),console.log("TemplateRaw: ",e.detail.templateRaw),console.log("TimeStamp: ",e.detail.timeStamp),console.log("LivenessMoveFails: ",e.detail.livenessMoveFails),console.log("SunGlassesScore: ",e.detail.sunGlassesScore),console.log("LivenessMoveHistory: ",e.detail.livenessMoveHistory),console.log("LivenessMoveStabilizedStatusHistory: ",e.detail.livenessMoveStabilizedStatusHistory),console.log("LivenessMoveLastStabilizedStatus: ",e.detail.livenessMoveLastStabilizedStatus),e.detail.bestImage?K.Selphi.Component.generateTemplateRawFromByteArray("../../assets/selphi",e.detail.bestImage,(function(e){console.log("BestImage Template Raw: ",e),o(!1)})):o(!1),i("next")}function L(){console.warn("[Selphi] onUserCancel"),o(!1)}function T(e){console.warn("[Selphi] onExceptionCaptured"),console.log("exceptionType: ".concat(e.detail.exceptionType)),console.log("exceptionMessage: ".concat(e.detail.message)),console.log(e),o(!1)}function U(e){switch(console.warn("[Selphi] onLivenessError"),console.log(e),e.detail.livenessErrorType){case K.Selphi.LivenessDiagnostic.Unsuccess:console.log("[Selphi] Liveness error: Blink or movement not detected");break;case K.Selphi.LivenessDiagnostic.UnsuccessLowPerformance:console.log("[Selphi] Liveness error: Low performance");break;case K.Selphi.LivenessDiagnostic.UnsuccessGlasses:console.log("[Selphi] Liveness error: Glasses detected");break;case K.Selphi.LivenessDiagnostic.UnsuccessLight:console.log("[Selphi] Liveness error: Bad lighting conditions");break;case K.Selphi.LivenessDiagnostic.UnsuccessNoMovement:console.log("[Selphi] Liveness error: No movement");break;case K.Selphi.LivenessDiagnostic.UnsuccessWrongDirection:console.log("[Selphi] Liveness error: Wrong direction");break;case K.Selphi.LivenessDiagnostic.UnsuccessTooFar:console.log("[Selphi] Liveness error: Face too far");break;default:console.log("[Selphi] Liveness error")}}function J(){console.warn("[Selphi] onLivenessErrorButtonClick"),o(!1)}function H(e){console.warn("[Selphi] onExtractionTimeout"),console.log(e)}function A(){console.warn("[Selphi] onTimeoutErrorButtonClick"),o(!1)}function M(e){var t=Object.entries(K.Selphi.TrackStatus).find((function(t){return t[1]===e.detail.code}));console.warn("[Selphi] onTrackStatus (Code: ".concat(t[1]," - ").concat(t[0],", Timestamp: ").concat(e.detail.timeStamp)),console.log(e)}return(0,e.useEffect)((function(){if(F.current){if(s){var e=Y.current;e.addWidgetEventListener("onModuleLoaded",k),e.addWidgetEventListener("onStabilizing",x),e.addWidgetEventListener("onExtractionFinish",w),e.addWidgetEventListener("onUserCancel",L),e.addWidgetEventListener("onExceptionCaptured",T),e.addWidgetEventListener("onLivenessError",U),e.addWidgetEventListener("onLivenessErrorButtonClick",J),e.addWidgetEventListener("onExtractionTimeout",H),e.addWidgetEventListener("onTimeoutErrorButtonClick",A),e.addWidgetEventListener("onTrackStatus",M)}}else F.current=!0})),(0,r.jsx)("div",{className:"row min-h-100",children:(0,r.jsx)("div",{className:"col-12 col-md-9",style:{minHeight:550},children:s&&(0,r.jsx)("facephi-selphi",{className:"min-h-100",ref:Y,bundlePath:"../../assets/selphi",language:"es",livenessMode:u,cameraWidth:C,cameraHeight:E,cameraType:X,interactible:m,tutorial:p,stabilizationStage:Z,logImages:!0,cropFactor:1.7,videoRecord:y,videoRecordType:K.Selphi.RecorderType.Remote,videoRecordScale:C<1280?1:.5,showLog:f,debugMode:W})})})},H=function(){var t=(0,e.useContext)(c),i=t.activeView;t.setActiveView;return(0,r.jsx)("div",{id:"biometric",children:function e(){return console.log(e),"SelphId"===i?(0,r.jsx)(x,{}):"Selphi"===i?(0,r.jsx)(J,{}):(0,r.jsx)("div",{children:" Fin del proceso "})}()})},A=function(){return(0,r.jsx)("div",{id:"biometric",children:(0,r.jsx)(o,{children:(0,r.jsx)(H,{})})})};t.createRoot(document.getElementById("root")).render((0,r.jsx)(e.StrictMode,{children:(0,r.jsx)(A,{})}))}()}();
//# sourceMappingURL=main.1b094571.js.map